%META:TOPICINFO{author="X509_2fDC_3dorg_2fDC_3ddoegrids_2fOU_3dPeople_2fCN_3dKarthik_20Arunachalam_20265532" date="1295905547" format="1.1" reprev="1.3" version="1.3"}%
-- Main.KarthikArun - 12 Jan 2011
%TOC%

---+++ Installation of mailed gratia accounting summary reports

The gratia central reports are being run at Fermilab and then emailed to the subscribers of the report. You could get more details about these reports and how to receive them at <a href=https://twiki.grid.iu.edu/bin/view/Accounting/ReportsDescription>mailed reports</a>. But if you want to run these reports locally on your own terms, then you could download and install the scripts that generate and email these reports. Instructions for the download and the configuration of the gratia summary reports as described below.

<ul>
<li>Create a directory in which you want to install/store the reporting related files.
<pre>
mkdir gratiaReports
cd gratiaReports
</pre>
Note: You could replace "gratiaReports" by any other name of your choice!
<li><a href=https://twiki.grid.iu.edu/twiki/pub/Accounting/WebHome/gratiaReports.tar.gz>Download </a> to the gratiaReports directory, the tar file containing the scripts/software for the mailed summary reports. 
<li>Untar the file: <pre>tar -zxvf gratiaReports.tar.gz</pre>
<li>Copy the configuration template file to the one that will be used by the gratia reports (gratiareports.conf is the default conig file. You could also use another file that could be specified using the --config option while running the reporting scipts): <pre>cp gratiareports.conf.template gratiareports.conf</pre>
<li>Edit gratiareports.conf and fill in appropriate values. Please follow the instructions provided in gratiareports.conf</li>
<li>Run the report configure script. This will verify the contens of the config file and setup the cronjob for the mailed reports if setup so in the config file. It is assumed that the user running this script has the appropriate permissions to setup the cronjob. 
<pre>
python configReport.py
# If you expect cronjob to be set, verify if that was the case by doing "crontab -l". 
# It should like the cron jobs in addition to whatever you already had in the crontab. 
</pre>
<li>Some examples of how to run the mailed gratia summary reports are given below. Please note that the default options for running the reports are fetched from the configuration file (gratiareports.conf by default). These options could be overridden by or merged with the command line options given directly when the script is invoked from command line. 
<pre>
cd &lt Directory where gratia reports have been installed&gt

sh daily_mutt.sh 
# (options in config file (gratiareports.conf by default) will be used)

sh daily_mutt.sh --mail myEmail@myDomain.edu 
# (this email will override the default choice from the config file)

sh daily_mutt.sh --production 
# (this report will be emailed to production email. 
# Set in the config file and if not assigned in the script). 
</pre>
You could substitute daily_mutt.sh by range_mutt.sh in the above examples. 
</ul>
