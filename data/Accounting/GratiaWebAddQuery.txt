%META:TOPICINFO{author="JuanFelipeMosqueraMorales" date="1424852008" format="1.1" reprev="1.10" version="1.10"}%
---+ Guide to create a new Query in Gratia Web 
The Gratia Web queries are defined in !XML files. These files are located at in the =OSG-Measurements-Metrics= project in this path =./src/gratia/config=. If you are working in a machine with a working installation these files will be located in the =site-packages= folder of the python installation in the machine. For example in a SL5 machine with python 2.4 the path would be =/usr/lib/python2.4/site-packages/gratia/config=, or in a SL6 machine with python 2.6 it would be =/usr/lib/python2.6/site-packages/gratia/config=.

%NOTE% After modifying the XML files the server will require a restart to load the changes made to the queries.

The queries are organized in different groups. Each group has a correspondent XML file that defines the queries. These groups and the related XML files are:

   *  =GratiaStatusQueries --&gt; gratia_status_queries.xml=
   *  =GratiaEventsQueries --&gt; gratia_events_queries.xml=
   *  =GratiaDataQueries --&gt; gratia_data_queries.xml=
   *  =GratiaPieQueries --&gt; gratia_pie_queries.xml=
   *  =GratiaGlideinBarQueries --&gt; gratia_glidein_bar_queries.xml=
   *  =GratiaBarQueries --&gt; gratia_bar_queries.xml=
   *  =GratiaRTQueries --&gt; gratia_realtime_queries.xml=
   *  =GratiaTransferQueries --&gt; gratia_transfer_queries.xml=
   *  =GratiaCumulativeQueries --&gt; gratia_cumulative_queries.xml=
   *  =GridScanQueries --&gt; gridscan_queries.xml=
   *  =GIPQueries --&gt; gip_queries.xml=
   *  =RSVQueries --&gt; rsv_queries.xml=
   *  =RSVWLCGQueries --&gt; rsv_wlcg.xml=
   *  =RSVSummaryQueries --&gt; rsv_summary.xml=

This queries groups is defined in =text_queries.xml=, and can be examined on a running server on =http://ip:[port]/gratia/xml=.
<pre class="file">
%BLUE%&lt;graphtool-config&gt;%ENDCOLOR%  
  ...
  %BLUE%&lt;class %PURPLE%type=%ENDCOLOR%%GREEN%"XmlGenerator"%ENDCOLOR% %PURPLE%name=%ENDCOLOR%%GREEN%"query_xml"%ENDCOLOR%&gt;%ENDCOLOR%
    %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"timeout"%ENDCOLOR%&gt;%ENDCOLOR%900%BLUE%&lt;attribute&gt;%ENDCOLOR%
    %BLUE%&lt;queryobj&gt;%ENDCOLOR% GratiaStatusQueries %BLUE%&lt;queryobj&gt;%ENDCOLOR%
    %BLUE%&lt;queryobj&gt;%ENDCOLOR% GratiaEventsQueries %BLUE%&lt;queryobj&gt;%ENDCOLOR%
    %BLUE%&lt;queryobj&gt;%ENDCOLOR% GratiaDataQueries %BLUE%&lt;queryobj&gt;%ENDCOLOR%
    %BLUE%&lt;queryobj&gt;%ENDCOLOR% GratiaPieQueries %BLUE%&lt;queryobj&gt;%ENDCOLOR%
    %BLUE%&lt;queryobj&gt;%ENDCOLOR% GratiaGlideinBarQueries %BLUE%&lt;queryobj&gt;%ENDCOLOR%
    %BLUE%&lt;queryobj&gt;%ENDCOLOR% GratiaBarQueries %BLUE%&lt;queryobj&gt;%ENDCOLOR%
    %BLUE%&lt;queryobj&gt;%ENDCOLOR% GratiaRTQueries %BLUE%&lt;queryobj&gt;%ENDCOLOR%
    %BLUE%&lt;queryobj&gt;%ENDCOLOR% GratiaTransferQueries %BLUE%&lt;queryobj&gt;%ENDCOLOR%
    %BLUE%&lt;queryobj&gt;%ENDCOLOR% GratiaCumulativeQueries %BLUE%&lt;queryobj&gt;%ENDCOLOR%
    %BLUE%&lt;queryobj&gt;%ENDCOLOR% GridScanQueries %BLUE%&lt;queryobj&gt;%ENDCOLOR%
    %BLUE%&lt;queryobj&gt;%ENDCOLOR% GIPQueries %BLUE%&lt;queryobj&gt;%ENDCOLOR%
    %BLUE%&lt;queryobj&gt;%ENDCOLOR% RSVQueries %BLUE%&lt;queryobj&gt;%ENDCOLOR%
    %BLUE%&lt;queryobj&gt;%ENDCOLOR% RSVWLCGQueries %BLUE%&lt;queryobj&gt;%ENDCOLOR%
    %BLUE%&lt;queryobj&gt;%ENDCOLOR% RSVSummaryQueries %BLUE%&lt;queryobj&gt;%ENDCOLOR%
  %BLUE%&lt;class&gt;%ENDCOLOR%
  ...
%BLUE%&lt;/graphtool-config&gt;%ENDCOLOR%
</pre>

---++ Modifying/adding queries to an existing group

%WARNING% Remember to escape reserved XML characters like ='&gt;'= and ='&lt;'= when modifying XML files.

Most of the queries defined in the different groups extend from queries that are defined in =generic_queries.xml=. To add a new query to a group you must go to the XML where the group is defined, and add a new =&lt;query&gt;= node to the =&lt;class type="SqlQueries" name="GROUP_NAME"&gt;= node.
<pre class="file">
%BLUE%&lt;graphtool-config&gt;%ENDCOLOR%
  ...
  %BLUE%&lt;class %PURPLE%type=%ENDCOLOR%%GREEN%"SqlQueries"%ENDCOLOR% %PURPLE%name=%ENDCOLOR%%GREEN%"GROUP_NAME"%ENDCOLOR%&gt;%ENDCOLOR%
      ...
      %BLUE%&lt;query %PURPLE%name=%ENDCOLOR%%GREEN%"NEW_QUERY_NAME"%ENDCOLOR%&gt;%ENDCOLOR%
      ...
      %BLUE%&lt;query&gt;%ENDCOLOR%
      ...
  %BLUE%&lt;class&gt;%ENDCOLOR%
  ...
%BLUE%&lt;/graphtool-config&gt;%ENDCOLOR%
</pre>
%IMPORTANT% The query name will also be the path to access the query in the URL (=http://ip:[port]/gratia/xml/<b>&lt;query_name&gt;</b>=). Do not use spaces or special characters in the query name. Do not use a query name that is already in use by other query.

Query can inherit all of its attributes from another query. To do this you must include the =base= attribute and reference %RED%GroupName%ENDCOLOR%.%BROWN%query_to_extend%ENDCOLOR%.
<pre class="file">
%BLUE%&lt;query %PURPLE%name=%ENDCOLOR%%GREEN%"NEW_QUERY_NAME"%ENDCOLOR% %PURPLE%base=%ENDCOLOR%%GREEN%"%RED%GroupName%ENDCOLOR%.%BROWN%query_to_extend%ENDCOLOR%"%ENDCOLOR%&gt;%ENDCOLOR%
...
...
%BLUE%&lt;query %PURPLE%name=%ENDCOLOR%%GREEN%"user_site_quality"%ENDCOLOR% %PURPLE%base=%ENDCOLOR%%GREEN%"%RED%GratiaSecureStorageQuery%ENDCOLOR%.%BROWN%user_summary%ENDCOLOR%"%ENDCOLOR%&gt;%ENDCOLOR%
</pre>
To define the inputs, the SQL, and other query metadata. The =query= node is composed of the following nodes:

---+++ Query =inputs= tag
This nodes defines all the input variables that will be included by default in the query. The =inputs= node is composed of =input= nodes. An input node can be defined using the following attributes. 
   * *name (REQUIRED):* The name of the input parameter. Must not contain spaces nor special characters. Must be unique per each query
   * *type (OPTIONAL):* The type of the input parameter. If not specified will default to string. The accepted values are:
      * *int*
      * *float*
      * *eval:* Will try to evaluate the expression using the python buiultin =eval()= function. Will try to evaluate with the following call =eval(str(%RED%INPUT_PARAMETER%ENDCOLOR%),{'__builtins__':None,'time':time},{})=.
      * *datetime:* Will try to parse the input parameter to a datetime python object. Will accept a timestamp in seconds, a date-time string with the following format ='%Y-%m-%d %H:%M:%S'= or and expression like =time.time()= or =time.time()-2*86400=.
      * *timestamp:* Will try to parse the input parameter to a datetime python object, like the =datetime= type, but will get the timestam of the datetime afterwards.
      * *bool/boolean:* Will accept either =bool= or =boolean= as type, do not use the string ="bool/boolean"=. The only accepted string values are =false= or =true=
   * *kind (OPTIONAL):* The only accepted value is ="sql"=. If it is not specified, the input parameters will be able to be used in any python callback function, but will not be included in the SQL query parameters for the query. If specified with =kind="sql"= it will be available to usage in the SQL query as =:input_parameter_name=.
   * *partial (OPTIONAL):* Only for *datetime* parameters. Only works if there is a numeric parameter named =span=. Values accepted are:
      * *down:* If =span= is exactly =3600= will set the datetime object minutes and seconds to 0:0. If  =span= is bigger than =3600= will set the datetime object hours, minutes and seconds to 0:0:0.
      * *up:* If =span= is exactly =3600= will set the datetime object minutes and seconds to 59:59. If  =span= is bigger than =3600= will set the datetime object hours, minutes and seconds to 23:59:59.
---++++ Example:
%TWISTY{%TWISTY_OPTS_OUTPUT% showlink="Show Inputs Example" hidelink="Hide Inputs example"}%
<pre class="file">
%BLUE%&lt;query %PURPLE%name=%ENDCOLOR%%GREEN%"site_summary"%ENDCOLOR%&gt;%ENDCOLOR%
  %BLUE%&lt;inputs&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"span"%ENDCOLOR% %PURPLE%type=%ENDCOLOR%%GREEN%"int"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%3600%BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"starttime"%ENDCOLOR% %PURPLE%partial=%ENDCOLOR%%GREEN%"down"%ENDCOLOR% %PURPLE%type=%ENDCOLOR%%GREEN%"datetime"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%time.time()-13*86400%BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"endtime"%ENDCOLOR% %PURPLE%partial=%ENDCOLOR%%GREEN%"up"%ENDCOLOR% %PURPLE%type=%ENDCOLOR%%GREEN%"datetime"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%time.time()%BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"facility"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% Unknown %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"vo"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% .* %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"exclude-vo"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% other %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"user"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% .* %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;inputs&gt;%ENDCOLOR%
    %BLUE%&lt;sql&gt;%ENDCOLOR%
    SELECT
    ....
 %BLUE%&lt;query&gt;%ENDCOLOR%
</pre>
%ENDTWISTY%
---+++ Query =sql= tag
If you are creating a new query that does not inherit from other queries you must specify the SQL query here. You can leave slots that can be filled by child queries. To do this you must include a =slot= tag. This tag only requires a name attribute that must not included spaces nor special characters. There can be multiple slots with the same name. 
To fill this slots from a child query you can use a =filler= tag with the name of the slot that want to be filled. 
%WARNING% Non filled slots will be replaced with empty strings. This could lead to a syntax error on the SQL query when executed. 
The SQL query text can include references to the input parameters with  =:input_parameter_name=. The input parameter must specify the =kind="sql"= attribute to be used.
---++++ Example:
%TWISTY{%TWISTY_OPTS_OUTPUT% showlink="Show Parent Query Example" hidelink="Hide Parent Query example"}%
<pre class="file">
 %BLUE%&lt;query %PURPLE%name=%ENDCOLOR%%GREEN%"site_summary"%ENDCOLOR%&gt;%ENDCOLOR%
      ...
      %BLUE%&lt;inputs&gt;%ENDCOLOR%
  %BLUE%&lt;sql&gt;%ENDCOLOR%
    SELECT
      %RED%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"group"%ENDCOLOR%&gt;%ENDCOLOR%,
      truncate( unix_timestamp(StartTime) / %BROWN%:span%ENDCOLOR%, 0 ) * %BROWN%:span%ENDCOLOR% as time,
      %BROWN%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"column"%ENDCOLOR%&gt;%ENDCOLOR%
    FROM
      MasterTransferSummary R FORCE INDEX (index01)
    JOIN
      Probe P on R.ProbeName = P.probename
    JOIN
      Site S on S.siteid = P.siteid
    JOIN
      VONameCorrection VC ON (VC.corrid=R.VOcorrid)
    JOIN
      VO on (VC.void = VO.void)
      %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"JOIN"%ENDCOLOR%&gt;%ENDCOLOR%
    WHERE
      StartTime &amp;gt;= %BROWN%:starttime%ENDCOLOR% AND
      StartTime &amp;lt; %BROWN%:endtime%ENDCOLOR% AND 
      S.SiteName=%BROWN%:facility%ENDCOLOR% AND
      VO.VOName regexp %BROWN%:vo%ENDCOLOR% AND
      (NOT (VO.VOName regexp %BROWN%:exclude-vo%ENDCOLOR%)) AND
      CommonName regexp %BROWN%:user%ENDCOLOR%
      %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"where"%ENDCOLOR%&gt;%ENDCOLOR%
    GROUP BY
      %RED%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"group"%ENDCOLOR%&gt;%ENDCOLOR%,
      time
  %BLUE%&lt;sql&gt;%ENDCOLOR%
  %BLUE%&lt;results %PURPLE%module=%ENDCOLOR%%GREEN%"graphtool.database.query_handler"%ENDCOLOR% %PURPLE%function=%ENDCOLOR%%GREEN%"results_parser"%ENDCOLOR%&gt;%ENDCOLOR%
  ...
%BLUE%&lt;query&gt;%ENDCOLOR%
</pre>
%ENDTWISTY%
%TWISTY{%TWISTY_OPTS_OUTPUT% showlink="Show Child Query Example" hidelink="Hide Child Query example"}%
<pre class="file">
%BLUE%&lt;query %PURPLE%name=%ENDCOLOR%%GREEN%"site_user_transfer_quality"%ENDCOLOR% %PURPLE%base=%ENDCOLOR%%GREEN%"GratiaStorageQuery.site_summary"%ENDCOLOR%&gt;%ENDCOLOR%
  ...
  %BLUE%&lt;sql&gt;%ENDCOLOR%
    %RED%&lt;filler %PURPLE%name=%ENDCOLOR%%GREEN%"group"%ENDCOLOR%&gt;%ENDCOLOR% DN %RED%&lt;filler&gt;%ENDCOLOR%
    %BROWN%&lt;filler %PURPLE%name=%ENDCOLOR%%GREEN%"column"%ENDCOLOR%&gt;%ENDCOLOR%
      sum(CASE StatusCode WHEN 0 THEN 1 ELSE 0 END) as Successes,
      sum(CASE StatusCode WHEN 0 THEN 0 ELSE 1 END) as Failures
    %BROWN%&lt;filler&gt;%ENDCOLOR%
  %BLUE%&lt;sql&gt;%ENDCOLOR%
  %BLUE%&lt;results&gt;%ENDCOLOR%
  ...
%BLUE%&lt;query&gt;%ENDCOLOR%
</pre>
%ENDTWISTY%
---+++ Query =results= and =attribute=  tags
This tag defines how results must be transformed after they are retrieved from the database. This data transformation is required by =graphtool= to generate the plots. Moreover, this allows to transform the data that come from the database to format, join data with external data sources (like OIM), or do additional calculations. =graphtool= offers a group of result parsing functions that are useful depending in the desired kind of plot. 
The =attribute= tag defines additional METADATA to be include when executing the query and creating the plot. One of this extra parameters is =graph_type= that defines which kind of plots will be rendered. 
---++++ Plots Examples:
%TWISTY{%TWISTY_OPTS_OUTPUT% showlink="Show !GratiaHorizontalBar Example" hidelink="Hide !GratiaHorizontalBar example"}%
<img src="%ATTACHURLPATH%/GratiaHorizontalBar.png" alt="GratiaHorizontalBar.png" width='800' height='500' />    
   * %TWISTY{%TWISTY_OPTS_OUTPUT% showlink="Show Parent XML" hidelink="Hide Parent XML"}%
     <pre class="file">
  %BLUE%&lt;query %PURPLE%name=%ENDCOLOR%%GREEN%"simple_master_summary"%ENDCOLOR%&gt;%ENDCOLOR%
    %BLUE%&lt;inputs&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"starttime"%ENDCOLOR% %PURPLE%partial=%ENDCOLOR%%GREEN%"down"%ENDCOLOR% %PURPLE%type=%ENDCOLOR%%GREEN%"datetime"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%time.time()-13*86400%BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"endtime"%ENDCOLOR% %PURPLE%partial=%ENDCOLOR%%GREEN%"up"%ENDCOLOR% %PURPLE%type=%ENDCOLOR%%GREEN%"datetime"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%time.time()%BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"includeFailed"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%true%BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"includeSuccess"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%true%BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"facility"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%.*%BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"probe"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%.*%BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"user"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%.*%BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"vo"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%.*%BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"role"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%.*%BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"exclude-role"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%NONE%BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"exclude-vo"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%Unknown|unknown|other%BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"exclude-facility"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%NONE|Generic|Obsolete%BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"exclude-user"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%NONE%BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"resource-type"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%^Batch$%BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;inputs&gt;%ENDCOLOR%
    %BLUE%&lt;sql&gt;%ENDCOLOR%
      SELECT
      %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"group"%ENDCOLOR%&gt;%ENDCOLOR%
      ,
      %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"column"%ENDCOLOR%&gt;%ENDCOLOR%
      FROM
                MasterSummaryData R
            JOIN
                Probe P on R.ProbeName = P.probename
            JOIN
                Site S on S.siteid = P.siteid
            JOIN
                VONameCorrection VC ON (VC.corrid=R.VOcorrid)
            JOIN
                VO on (VC.void = VO.void)
      %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"join"%ENDCOLOR%&gt;%ENDCOLOR%
      WHERE
                R.EndTime &amp;gt;= :starttime AND
                R.EndTime &amp;lt; :endtime AND
                S.SiteName regexp :facility AND
                VO.VOName regexp :vo AND
                VC.VOName regexp :role AND
                (NOT (VC.VOName regexp :exclude-role)) AND
                (R.ResourceType regexp :resource-type or R.ResourceType = '') AND
                (:includeFailed='true' OR ApplicationExitCode=0) AND
                (:includeSuccess ='true' OR ApplicationExitCode!=0) AND
                (NOT (S.SiteName regexp :exclude-facility)) AND
                (NOT (VO.VOName regexp :exclude-vo)) AND
                R.WallDuration &amp;lt; 1100000000 AND
                R.ProbeName regexp :probe AND
                (NOT (R.CommonName regexp :exclude-user)) AND
                R.CommonName regexp :user
      %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"where"%ENDCOLOR%&gt;%ENDCOLOR%
      GROUP BY
      %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"group"%ENDCOLOR%&gt;%ENDCOLOR%
      %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"having"%ENDCOLOR%&gt;%ENDCOLOR%
    %BLUE%&lt;sql&gt;%ENDCOLOR%
    %BLUE%&lt;results %PURPLE%module=%ENDCOLOR%%GREEN%"graphtool.database.query_handler"%ENDCOLOR% %PURPLE%function=%ENDCOLOR%%GREEN%"simple_results_parser"%ENDCOLOR%&gt;%ENDCOLOR%
      %BLUE%&lt;inputs&gt;%ENDCOLOR%
        %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"pivots"%ENDCOLOR%&gt;%ENDCOLOR%0%BLUE%&lt;input&gt;%ENDCOLOR%
        %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"results"%ENDCOLOR%&gt;%ENDCOLOR%1%BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;inputs&gt;%ENDCOLOR%
    %BLUE%&lt;results&gt;%ENDCOLOR%
    %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"graph_type"%ENDCOLOR%&gt;%ENDCOLOR%GratiaPie%BLUE%&lt;attribute&gt;%ENDCOLOR%
    %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"pivot_name"%ENDCOLOR%&gt;%ENDCOLOR%
    %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"title"%ENDCOLOR%&gt;%ENDCOLOR%
    %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"column_names"%ENDCOLOR%&gt;%ENDCOLOR%
    %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"column_units"%ENDCOLOR%&gt;%ENDCOLOR%
  %BLUE%&lt;query&gt;%ENDCOLOR%
     </pre>
     %ENDTWISTY%
   * %TWISTY{%TWISTY_OPTS_OUTPUT% showlink="Show Child XML" hidelink="Hide Child XML"}%
     <pre class="file">
  %BLUE%&lt;query %PURPLE%name=%ENDCOLOR%%GREEN%"job_avg"%ENDCOLOR% %PURPLE%base=%ENDCOLOR%%GREEN%"GratiaGenericQuery.simple_master_summary"%ENDCOLOR%&gt;%ENDCOLOR%
    %BLUE%&lt;inputs&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"min_jobs"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%0%BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"max_avg"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%10000%BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"fixed-height"%ENDCOLOR%&gt;%ENDCOLOR%False%BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;inputs&gt;%ENDCOLOR%
    %BLUE%&lt;sql&gt;%ENDCOLOR%
      %BLUE%&lt;filler %PURPLE%name=%ENDCOLOR%%GREEN%"group"%ENDCOLOR%&gt;%ENDCOLOR%COALESCE(R.CommonName, VO.VOName)%BLUE%&lt;filler&gt;%ENDCOLOR%
      %BLUE%&lt;filler %PURPLE%name=%ENDCOLOR%%GREEN%"column"%ENDCOLOR%&gt;%ENDCOLOR%sum(Cores*WallDuration)/sum(Njobs)/60%BLUE%&lt;filler&gt;%ENDCOLOR%
      %BLUE%&lt;filler %PURPLE%name=%ENDCOLOR%%GREEN%"having"%ENDCOLOR%&gt;%ENDCOLOR%HAVING sum(Njobs) &gt; :min_jobs and sum(Cores*WallDuration)/sum(Njobs)/60 &lt; :max_avg%BLUE%&lt;filler&gt;%ENDCOLOR%
    %BLUE%&lt;sql&gt;%ENDCOLOR%
    %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"pivot_name"%ENDCOLOR%&gt;%ENDCOLOR%User Name%BLUE%&lt;attribute&gt;%ENDCOLOR%
    %BLUE%&lt;results&gt;%ENDCOLOR%
      %BLUE%&lt;inputs&gt;%ENDCOLOR%
        %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"pivot_transform"%ENDCOLOR%&gt;%ENDCOLOR%displayName%BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;inputs&gt;%ENDCOLOR%
    %BLUE%&lt;results&gt;%ENDCOLOR%
    %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"title"%ENDCOLOR%&gt;%ENDCOLOR%Average Job Runtimes%BLUE%&lt;attribute&gt;%ENDCOLOR%
    %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"column_names"%ENDCOLOR%&gt;%ENDCOLOR%Avg Runtime%BLUE%&lt;attribute&gt;%ENDCOLOR%
    %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"column_units"%ENDCOLOR%&gt;%ENDCOLOR%Mins%BLUE%&lt;attribute&gt;%ENDCOLOR%
    %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"graph_type"%ENDCOLOR%&gt;%ENDCOLOR%GratiaHorizontalBar%BLUE%&lt;attribute&gt;%ENDCOLOR%
  %BLUE%&lt;query&gt;%ENDCOLOR%
     </pre>
     %ENDTWISTY%
%ENDTWISTY%

%TWISTY{%TWISTY_OPTS_OUTPUT% showlink="Show !GratiaStackedBar Example" hidelink="Hide !GratiaStackedBar example"}%
<img src="%ATTACHURLPATH%/GratiaStackedBar.png" alt="GratiaStackedBar.png" width='800' height='500' />  
   * %TWISTY{%TWISTY_OPTS_OUTPUT% showlink="Show Parent XML" hidelink="Hide Parent XML"}%
     <pre class="file">
%BLUE%&lt;query %PURPLE%name=%ENDCOLOR%%GREEN%"master_summary"%ENDCOLOR%&gt;%ENDCOLOR%
  %BLUE%&lt;inputs&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"span"%ENDCOLOR% %PURPLE%type=%ENDCOLOR%%GREEN%"int"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%86400%BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"starttime"%ENDCOLOR% %PURPLE%partial=%ENDCOLOR%%GREEN%"down"%ENDCOLOR% %PURPLE%type=%ENDCOLOR%%GREEN%"datetime"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%time.time()-13*86400%BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"endtime"%ENDCOLOR% %PURPLE%partial=%ENDCOLOR%%GREEN%"up"%ENDCOLOR% %PURPLE%type=%ENDCOLOR%%GREEN%"datetime"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%time.time()%BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"includeFailed"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% true %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"includeSuccess"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% true %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"facility"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% .* %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"probe"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% .* %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"user"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% .* %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"vo"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% .* %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"role"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% .* %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"exclude-role"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% NONE %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"exclude-vo"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% Unknown|unknown|other %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"exclude-user"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% NONE %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"exclude-facility"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% NONE|Generic|Obsolete %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"resource-type"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% ^Batch$ %BLUE%&lt;input&gt;%ENDCOLOR%
  %BLUE%&lt;inputs&gt;%ENDCOLOR%
  %BLUE%&lt;sql&gt;%ENDCOLOR%
    SELECT
      %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"group"%ENDCOLOR%&gt;%ENDCOLOR%,
      truncate( unix_timestamp(EndTime) / :span, 0 ) * :span as time,
      %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"column"%ENDCOLOR%&gt;%ENDCOLOR%
    FROM
      MasterSummaryData R
    JOIN
      Probe P on R.ProbeName = P.probename
    JOIN
      Site S on S.siteid = P.siteid
    JOIN
      VONameCorrection VC ON (VC.corrid=R.VOcorrid)
    JOIN
      VO on (VC.void = VO.void)
      %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"join"%ENDCOLOR%&gt;%ENDCOLOR% 
    WHERE
      R.EndTime &amp;gt;= :starttime AND
      R.EndTime &amp;lt; :endtime AND
      S.SiteName regexp :facility AND
      VO.VOName regexp :vo AND
      VC.VOName regexp :role AND
      (NOT (VC.VOName regexp :exclude-role)) AND
      (R.ResourceType regexp :resource-type or R.ResourceType = '') AND
      R.CommonName regexp :user AND
      (:includeFailed='true' OR ApplicationExitCode=0) AND
      (:includeSuccess ='true' OR ApplicationExitCode!=0) AND
      (NOT (S.SiteName regexp :exclude-facility)) AND
      (NOT (R.CommonName regexp :exclude-user)) AND
      (NOT (VO.VOName regexp :exclude-vo)) AND
      R.WallDuration &amp;lt; 1100000000 AND
      R.ProbeName regexp :probe
      %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"where"%ENDCOLOR%&gt;%ENDCOLOR%
    GROUP BY 
      %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"group"%ENDCOLOR%&gt;%ENDCOLOR%,
      time
      %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"having"%ENDCOLOR%&gt;%ENDCOLOR%
  %BLUE%&lt;sql&gt;%ENDCOLOR%
  %BLUE%&lt;results %PURPLE%module=%ENDCOLOR%%GREEN%"graphtool.database.query_handler"%ENDCOLOR% %PURPLE%function=%ENDCOLOR%%GREEN%"results_parser"%ENDCOLOR%&gt;%ENDCOLOR%
    %BLUE%&lt;inputs&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"pivots"%ENDCOLOR%&gt;%ENDCOLOR% 0 %BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"grouping"%ENDCOLOR%&gt;%ENDCOLOR% 1 %BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"results"%ENDCOLOR%&gt;%ENDCOLOR% 2 %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;inputs&gt;%ENDCOLOR%
  %BLUE%&lt;results&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"graph_type"%ENDCOLOR%&gt;%ENDCOLOR%GratiaStackedBar%BLUE%&lt;attribute&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"pivot_name"%ENDCOLOR%&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"title"%ENDCOLOR%&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"column_names"%ENDCOLOR%&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"column_units"%ENDCOLOR%&gt;%ENDCOLOR%
%BLUE%&lt;query&gt;%ENDCOLOR%
     </pre>
     %ENDTWISTY%
   * %TWISTY{%TWISTY_OPTS_OUTPUT% showlink="Show Child XML" hidelink="Hide Child XML"}%
     <pre class="file">
%BLUE%&lt;query %PURPLE%name=%ENDCOLOR%%GREEN%"vo_facility_hours_bar_smry"%ENDCOLOR% %PURPLE%base=%ENDCOLOR%%GREEN%"GratiaGenericQuery.master_summary"%ENDCOLOR%&gt;%ENDCOLOR%
  %BLUE%&lt;sql&gt;%ENDCOLOR%
    %BLUE%&lt;filler %PURPLE%name=%ENDCOLOR%%GREEN%"group"%ENDCOLOR%&gt;%ENDCOLOR% S.SiteName %BLUE%&lt;filler&gt;%ENDCOLOR%
    %BLUE%&lt;filler %PURPLE%name=%ENDCOLOR%%GREEN%"column"%ENDCOLOR%&gt;%ENDCOLOR% sum(Cores*WallDuration)/3600 %BLUE%&lt;filler&gt;%ENDCOLOR%
    %BLUE%&lt;filler %PURPLE%name=%ENDCOLOR%%GREEN%"where"%ENDCOLOR%&gt;%ENDCOLOR% AND WallDuration &gt; 0 %BLUE%&lt;filler&gt;%ENDCOLOR%
  %BLUE%&lt;sql&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"pivot_name"%ENDCOLOR%&gt;%ENDCOLOR%Facility%BLUE%&lt;attribute&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"title"%ENDCOLOR%&gt;%ENDCOLOR%$vo CPU Hours By Facility%BLUE%&lt;attribute&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"graph_type"%ENDCOLOR%&gt;%ENDCOLOR%GratiaStackedBar%BLUE%&lt;attribute&gt;%ENDCOLOR%
  %BLUE%&lt;results&gt;%ENDCOLOR%
    %BLUE%&lt;inputs&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"pivot_transform"%ENDCOLOR%&gt;%ENDCOLOR%oim_resource_filter%BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"grouping_transform"%ENDCOLOR%&gt;%ENDCOLOR%make_int%BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;inputs&gt;%ENDCOLOR%
  %BLUE%&lt;results&gt;%ENDCOLOR%
%BLUE%&lt;query&gt;%ENDCOLOR%
     </pre>
     %ENDTWISTY%
%ENDTWISTY%

%TWISTY{%TWISTY_OPTS_OUTPUT% showlink="Show !GratiaStackedLine Example" hidelink="Hide !GratiaStackedLine example"}%
<img src="%ATTACHURLPATH%/GratiaStackedLine.png" alt="GratiaStackedLine.png" width='800' height='500' />    
   * %TWISTY{%TWISTY_OPTS_OUTPUT% showlink="Show Parent XML" hidelink="Hide Parent XML"}%
     <pre class="file">
%BLUE%&lt;query %PURPLE%name=%ENDCOLOR%%GREEN%"ts_hourly"%ENDCOLOR%&gt;%ENDCOLOR%
  %BLUE%&lt;inputs&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"starttime"%ENDCOLOR% %PURPLE%type=%ENDCOLOR%%GREEN%"datetime"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%time.time()-2*86400%BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"endtime"%ENDCOLOR% %PURPLE%type=%ENDCOLOR%%GREEN%"datetime"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%time.time()%BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"vo"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%.*%BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"span"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%3600%BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"host"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%.*%BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"facility"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%.*%BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"excludefacility"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%ITB%BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"excludehost"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%NONE%BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"excludevo"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%NONE%BLUE%&lt;input&gt;%ENDCOLOR%
  %BLUE%&lt;inputs&gt;%ENDCOLOR%
  %BLUE%&lt;sql&gt;%ENDCOLOR%
    SELECT
      %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"group"%ENDCOLOR%&gt;%ENDCOLOR%,
      unix_timestamp(Timestamp),
      sum(MyColumn)
    FROM
      ( SELECT
          MSS.SiteName,
          VO.VOName,
          MSS.CEName,
          Cluster.Name,
          Timestamp,
          (CASE CNC.type WHEN 1 THEN SUM(%BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"column"%ENDCOLOR%&gt;%ENDCOLOR%) WHEN 2 THEN MAX(%BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"column"%ENDCOLOR%&gt;%ENDCOLOR%) WHEN 3 THEN SUM(%BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"column"%ENDCOLOR%&gt;%ENDCOLOR%) END) AS MyColumn
        FROM
          MasterServiceSummaryHourly MSS
          JOIN VONameCorrection VNC on VNC.corrid=MSS.VOcorrid
          JOIN VO on VO.void=VNC.void
          JOIN ClusterNameCorrection CNC on CNC.corrid=MSS.Clustercorrid
          JOIN Cluster on Cluster.clusterid=CNC.clusterid
        WHERE
          Timestamp &gt;= :starttime
          AND Timestamp &amp;lt; :endtime
          AND (MSS.SiteName regexp :facility)
          AND NOT (MSS.SiteName regexp :excludefacility)
          AND (MSS.HostName regexp :host)
          AND NOT (MSS.HostName regexp :excludehost)
          AND (VO.VOName regexp :vo)
          AND NOT (VO.VOName regexp :excludevo)
          %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"where"%ENDCOLOR%&gt;%ENDCOLOR%
        GROUP BY
          VO.VOName,
          Cluster.Name,
          MSS.CEName,
          Timestamp
      ) as foo
    GROUP BY
      %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"group"%ENDCOLOR%&gt;%ENDCOLOR%,
      Timestamp
    %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"having"%ENDCOLOR%&gt;%ENDCOLOR%
  %BLUE%&lt;sql&gt;%ENDCOLOR%
  %BLUE%&lt;results %PURPLE%module=%ENDCOLOR%%GREEN%"gratia.database.query_handler"%ENDCOLOR% %PURPLE%function=%ENDCOLOR%%GREEN%"results_parser_fillin"%ENDCOLOR%&gt;%ENDCOLOR%
    %BLUE%&lt;inputs&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"pivots"%ENDCOLOR%&gt;%ENDCOLOR% 0 %BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"grouping"%ENDCOLOR%&gt;%ENDCOLOR% 1 %BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"results"%ENDCOLOR%&gt;%ENDCOLOR% 2 %BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"grouping_transform"%ENDCOLOR%&gt;%ENDCOLOR% make_int %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;inputs&gt;%ENDCOLOR%
  %BLUE%&lt;results&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"graph_type"%ENDCOLOR%&gt;%ENDCOLOR% GratiaStackedLine %BLUE%&lt;attribute&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"pivot_name"%ENDCOLOR%&gt;%ENDCOLOR%VO.VOName%BLUE%&lt;attribute&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"grouping_name"%ENDCOLOR%&gt;%ENDCOLOR%Time%BLUE%&lt;attribute&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"column_units"%ENDCOLOR%&gt;%ENDCOLOR%
%BLUE%&lt;query&gt;%ENDCOLOR%
     </pre>
     %ENDTWISTY%
   * %TWISTY{%TWISTY_OPTS_OUTPUT% showlink="Show Child XML" hidelink="Hide Child XML"}%
     <pre class="file">
%BLUE%&lt;query %PURPLE%name=%ENDCOLOR%%GREEN%"status_queue"%ENDCOLOR% %PURPLE%base=%ENDCOLOR%%GREEN%"GratiaStatusGeneric.ts_hourly"%ENDCOLOR%&gt;%ENDCOLOR%
  %BLUE%&lt;sql&gt;%ENDCOLOR%
    %BLUE%&lt;filler %PURPLE%name=%ENDCOLOR%%GREEN%"column"%ENDCOLOR%&gt;%ENDCOLOR%RunningJobs%BLUE%&lt;filler&gt;%ENDCOLOR%
    %BLUE%&lt;filler %PURPLE%name=%ENDCOLOR%%GREEN%"group"%ENDCOLOR%&gt;%ENDCOLOR%CEName%BLUE%&lt;filler&gt;%ENDCOLOR%
  %BLUE%&lt;sql&gt;%ENDCOLOR%
  %BLUE%&lt;results&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"pivot_name"%ENDCOLOR%&gt;%ENDCOLOR%Queue%BLUE%&lt;attribute&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"title"%ENDCOLOR%&gt;%ENDCOLOR%Count of Running Jobs by Queue%BLUE%&lt;attribute&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"column_names"%ENDCOLOR%&gt;%ENDCOLOR%Running Jobs%BLUE%&lt;attribute&gt;%ENDCOLOR%
%BLUE%&lt;query&gt;%ENDCOLOR%
     </pre>
     %ENDTWISTY%
%ENDTWISTY%

%TWISTY{%TWISTY_OPTS_OUTPUT% showlink="Show !GratiaCumulative Example" hidelink="Hide !GratiaCumulative example"}%
<img src="%ATTACHURLPATH%/GratiaCumulative.png" alt="GratiaCumulative.png" width='800' height='500' />    
   * %TWISTY{%TWISTY_OPTS_OUTPUT% showlink="Show Parent XML" hidelink="Hide Parent XML"}%
     <pre class="file">
%BLUE%&lt;query %PURPLE%name=%ENDCOLOR%%GREEN%"jobs_summary_query"%ENDCOLOR%&gt;%ENDCOLOR%
  %BLUE%&lt;inputs&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"span"%ENDCOLOR% %PURPLE%type=%ENDCOLOR%%GREEN%"int"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%86400%BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"starttime"%ENDCOLOR% %PURPLE%partial=%ENDCOLOR%%GREEN%"down"%ENDCOLOR% %PURPLE%type=%ENDCOLOR%%GREEN%"datetime"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%time.time()-13*86400%BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"endtime"%ENDCOLOR% %PURPLE%partial=%ENDCOLOR%%GREEN%"up"%ENDCOLOR% %PURPLE%type=%ENDCOLOR%%GREEN%"datetime"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%time.time()%BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"facility"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% .* %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"vo"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% .* %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"user"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% .* %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"exclude-vo"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% Unknown|unknown|other %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"exclude-facility"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% NONE|Generic|Obsolete %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"exclude-user"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% NONE %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"probe"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% .* %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"resource-type"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% ^Batch$ %BLUE%&lt;input&gt;%ENDCOLOR%
  %BLUE%&lt;inputs&gt;%ENDCOLOR%
  %BLUE%&lt;sql&gt;%ENDCOLOR%
   SELECT
      %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"group"%ENDCOLOR%&gt;%ENDCOLOR%,
      truncate( unix_timestamp(EndTime) / :span, 0 ) * :span as time,
      %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"column"%ENDCOLOR%&gt;%ENDCOLOR%
    FROM
      MasterSummaryData R
    JOIN
      Probe P on R.ProbeName = P.probename
    JOIN
      Site S on S.siteid = P.siteid
    JOIN
      VONameCorrection VC ON (VC.corrid=R.VOcorrid)
    JOIN
      VO on (VC.void = VO.void)
    %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"JOIN"%ENDCOLOR%&gt;%ENDCOLOR%
    WHERE
      (R.ResourceType regexp :resource-type or R.ResourceType = '') AND
      EndTime &amp;gt;= :starttime AND
      EndTime &amp;lt; :endtime AND
      S.SiteName regexp :facility AND
      VO.VOName regexp :vo AND
      R.CommonName regexp :user AND
      (NOT (S.SiteName regexp :exclude-facility)) AND
      (NOT (R.CommonName regexp :exclude-user)) AND
      (NOT (VO.VOName regexp :exclude-vo)) AND
      R.ProbeName regexp :probe AND
      WallDuration &amp;lt; 1100000000
      %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"where"%ENDCOLOR%&gt;%ENDCOLOR%
    GROUP BY
      %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"group"%ENDCOLOR%&gt;%ENDCOLOR%,
      time
  %BLUE%&lt;sql&gt;%ENDCOLOR%
  %BLUE%&lt;results %PURPLE%module=%ENDCOLOR%%GREEN%"graphtool.database.query_handler"%ENDCOLOR% %PURPLE%function=%ENDCOLOR%%GREEN%"results_parser"%ENDCOLOR%&gt;%ENDCOLOR%
    %BLUE%&lt;inputs&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"pivots"%ENDCOLOR%&gt;%ENDCOLOR% 0 %BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"grouping"%ENDCOLOR%&gt;%ENDCOLOR% 1 %BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"results"%ENDCOLOR%&gt;%ENDCOLOR% 2 %BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"grouping_transform"%ENDCOLOR%&gt;%ENDCOLOR%make_int%BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;inputs&gt;%ENDCOLOR%
  %BLUE%&lt;results&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"graph_type"%ENDCOLOR%&gt;%ENDCOLOR%GratiaStackedBar%BLUE%&lt;attribute&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"pivot_name"%ENDCOLOR%&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"grouping_name"%ENDCOLOR%&gt;%ENDCOLOR%Time%BLUE%&lt;attribute&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"title"%ENDCOLOR%&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"column_names"%ENDCOLOR%&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"column_units"%ENDCOLOR%&gt;%ENDCOLOR%
%BLUE%&lt;query&gt;%ENDCOLOR%
     </pre>
     %ENDTWISTY%
   * %TWISTY{%TWISTY_OPTS_OUTPUT% showlink="Show Child XML" hidelink="Hide Child XML"}%
     <pre class="file">
%BLUE%&lt;query %PURPLE%name=%ENDCOLOR%%GREEN%"facility_count_cumulative_smry"%ENDCOLOR% %PURPLE%base=%ENDCOLOR%%GREEN%"GratiaGenericQuery.jobs_summary_query"%ENDCOLOR%&gt;%ENDCOLOR%
  %BLUE%&lt;sql&gt;%ENDCOLOR%
    %BLUE%&lt;filler %PURPLE%name=%ENDCOLOR%%GREEN%"group"%ENDCOLOR%&gt;%ENDCOLOR% S.SiteName %BLUE%&lt;filler&gt;%ENDCOLOR%
    %BLUE%&lt;filler %PURPLE%name=%ENDCOLOR%%GREEN%"column"%ENDCOLOR%&gt;%ENDCOLOR% sum(Njobs) %BLUE%&lt;filler&gt;%ENDCOLOR%
    %BLUE%&lt;filler %PURPLE%name=%ENDCOLOR%%GREEN%"where"%ENDCOLOR%&gt;%ENDCOLOR% AND Njobs &gt; 0 %BLUE%&lt;filler&gt;%ENDCOLOR%
  %BLUE%&lt;sql&gt;%ENDCOLOR%
  %BLUE%&lt;results %PURPLE%module=%ENDCOLOR%%GREEN%"graphtool.database.query_handler"%ENDCOLOR% %PURPLE%function=%ENDCOLOR%%GREEN%"cumulative_pivot_group_parser"%ENDCOLOR%&gt;%ENDCOLOR%
    %BLUE%&lt;inputs&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"pivot_transform"%ENDCOLOR%&gt;%ENDCOLOR%oim_resource_filter%BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"grouping_transform"%ENDCOLOR%&gt;%ENDCOLOR%make_int%BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;inputs&gt;%ENDCOLOR%
  %BLUE%&lt;results&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"pivot_name"%ENDCOLOR%&gt;%ENDCOLOR% Facility %BLUE%&lt;attribute&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"title"%ENDCOLOR%&gt;%ENDCOLOR% Cumulative Number of Jobs By Facility %BLUE%&lt;attribute&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"column_names"%ENDCOLOR%&gt;%ENDCOLOR% Job Count %BLUE%&lt;attribute&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"column_units"%ENDCOLOR%&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"graph_type"%ENDCOLOR%&gt;%ENDCOLOR% GratiaCumulative %BLUE%&lt;attribute&gt;%ENDCOLOR%
%BLUE%&lt;query&gt;%ENDCOLOR%
     </pre>
     %ENDTWISTY%
%ENDTWISTY%

%TWISTY{%TWISTY_OPTS_OUTPUT% showlink="Show !GratiaPie Example" hidelink="Hide !GratiaPie example"}%
<img src="%ATTACHURLPATH%/GratiaPie.png" alt="GratiaPie.png" width='800' height='500' />    
   * %TWISTY{%TWISTY_OPTS_OUTPUT% showlink="Show Parent XML" hidelink="Hide Parent XML"}%
     <pre class="file">
%BLUE%&lt;query %PURPLE%name=%ENDCOLOR%%GREEN%"simple_master_summary"%ENDCOLOR%&gt;%ENDCOLOR%
    %BLUE%&lt;inputs&gt;%ENDCOLOR%
        %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"starttime"%ENDCOLOR% %PURPLE%partial=%ENDCOLOR%%GREEN%"down"%ENDCOLOR% %PURPLE%type=%ENDCOLOR%%GREEN%"datetime"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%time.time()-13*86400%BLUE%&lt;input&gt;%ENDCOLOR%
        %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"endtime"%ENDCOLOR% %PURPLE%partial=%ENDCOLOR%%GREEN%"up"%ENDCOLOR% %PURPLE%type=%ENDCOLOR%%GREEN%"datetime"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%time.time()%BLUE%&lt;input&gt;%ENDCOLOR%
        %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"includeFailed"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% true %BLUE%&lt;input&gt;%ENDCOLOR%
        %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"includeSuccess"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% true %BLUE%&lt;input&gt;%ENDCOLOR%
        %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"facility"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% .* %BLUE%&lt;input&gt;%ENDCOLOR%
        %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"probe"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% .* %BLUE%&lt;input&gt;%ENDCOLOR%
        %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"user"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% .* %BLUE%&lt;input&gt;%ENDCOLOR%
        %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"vo"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% .* %BLUE%&lt;input&gt;%ENDCOLOR%
        %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"role"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% .* %BLUE%&lt;input&gt;%ENDCOLOR%
        %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"exclude-role"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% NONE %BLUE%&lt;input&gt;%ENDCOLOR%
        %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"exclude-vo"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% Unknown|unknown|other %BLUE%&lt;input&gt;%ENDCOLOR%
        %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"exclude-facility"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% NONE|Generic|Obsolete %BLUE%&lt;input&gt;%ENDCOLOR%
        %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"exclude-user"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% NONE %BLUE%&lt;input&gt;%ENDCOLOR%
        %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"resource-type"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% ^Batch$ %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;inputs&gt;%ENDCOLOR%
    %BLUE%&lt;sql&gt;%ENDCOLOR%
        SELECT
            %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"group"%ENDCOLOR%&gt;%ENDCOLOR%,
            %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"column"%ENDCOLOR%&gt;%ENDCOLOR%
        FROM
            MasterSummaryData R
        JOIN
            Probe P on R.ProbeName = P.probename
        JOIN
            Site S on S.siteid = P.siteid
        JOIN
            VONameCorrection VC ON (VC.corrid=R.VOcorrid)
        JOIN
            VO on (VC.void = VO.void)
        %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"join"%ENDCOLOR%&gt;%ENDCOLOR%
        WHERE
            R.EndTime &amp;gt;= :starttime AND
            R.EndTime &amp;lt; :endtime AND
            S.SiteName regexp :facility AND
            VO.VOName regexp :vo AND
            VC.VOName regexp :role AND
            (NOT (VC.VOName regexp :exclude-role)) AND
            (R.ResourceType regexp :resource-type or R.ResourceType = '') AND
            (:includeFailed='true' OR ApplicationExitCode=0) AND
            (:includeSuccess ='true' OR ApplicationExitCode!=0) AND
            (NOT (S.SiteName regexp :exclude-facility)) AND
            (NOT (VO.VOName regexp :exclude-vo)) AND
            R.WallDuration &amp;lt; 1100000000 AND
            R.ProbeName regexp :probe AND
            (NOT (R.CommonName regexp :exclude-user)) AND
            R.CommonName regexp :user
            %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"where"%ENDCOLOR%&gt;%ENDCOLOR%
        GROUP BY 
            %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"group"%ENDCOLOR%&gt;%ENDCOLOR%
        %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"having"%ENDCOLOR%&gt;%ENDCOLOR%
    %BLUE%&lt;sql&gt;%ENDCOLOR%
    %BLUE%&lt;results %PURPLE%module=%ENDCOLOR%%GREEN%"graphtool.database.query_handler"%ENDCOLOR% %PURPLE%function=%ENDCOLOR%%GREEN%"simple_results_parser"%ENDCOLOR%&gt;%ENDCOLOR%
        %BLUE%&lt;inputs&gt;%ENDCOLOR%
            %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"pivots"%ENDCOLOR%&gt;%ENDCOLOR% 0 %BLUE%&lt;input&gt;%ENDCOLOR%
            %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"results"%ENDCOLOR%&gt;%ENDCOLOR% 1 %BLUE%&lt;input&gt;%ENDCOLOR%
        %BLUE%&lt;inputs&gt;%ENDCOLOR%
    %BLUE%&lt;results&gt;%ENDCOLOR%
    %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"graph_type"%ENDCOLOR%&gt;%ENDCOLOR%GratiaPie%BLUE%&lt;attribute&gt;%ENDCOLOR%
    %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"pivot_name"%ENDCOLOR%&gt;%ENDCOLOR%
    %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"title"%ENDCOLOR%&gt;%ENDCOLOR%
    %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"column_names"%ENDCOLOR%&gt;%ENDCOLOR%
    %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"column_units"%ENDCOLOR%&gt;%ENDCOLOR%
%BLUE%&lt;query&gt;%ENDCOLOR%
     </pre>
     %ENDTWISTY%
   * %TWISTY{%TWISTY_OPTS_OUTPUT% showlink="Show Child XML" hidelink="Hide Child XML"}%
     <pre class="file">
%BLUE%&lt;query %PURPLE%name=%ENDCOLOR%%GREEN%"osg_vo_count"%ENDCOLOR% %PURPLE%base=%ENDCOLOR%%GREEN%"GratiaGenericQuery.simple_master_summary"%ENDCOLOR%&gt;%ENDCOLOR%
    %BLUE%&lt;inputs&gt;%ENDCOLOR%
        %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"starttime"%ENDCOLOR% %PURPLE%partial=%ENDCOLOR%%GREEN%"down"%ENDCOLOR% %PURPLE%type=%ENDCOLOR%%GREEN%"datetime"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%time.time()-14*86400%BLUE%&lt;input&gt;%ENDCOLOR%
     %BLUE%&lt;inputs&gt;%ENDCOLOR%
  %BLUE%&lt;sql&gt;%ENDCOLOR%
    %BLUE%&lt;filler %PURPLE%name=%ENDCOLOR%%GREEN%"group"%ENDCOLOR%&gt;%ENDCOLOR% VO.VOName %BLUE%&lt;filler&gt;%ENDCOLOR%
    %BLUE%&lt;filler %PURPLE%name=%ENDCOLOR%%GREEN%"column"%ENDCOLOR%&gt;%ENDCOLOR% sum(R.Njobs) %BLUE%&lt;filler&gt;%ENDCOLOR%
  %BLUE%&lt;sql&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"pivot_name"%ENDCOLOR%&gt;%ENDCOLOR% VO %BLUE%&lt;attribute&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"column_names"%ENDCOLOR%&gt;%ENDCOLOR% Jobs %BLUE%&lt;attribute&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"column_units"%ENDCOLOR%&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"title"%ENDCOLOR%&gt;%ENDCOLOR% Job Count by VO %BLUE%&lt;attribute&gt;%ENDCOLOR%
%BLUE%&lt;query&gt;%ENDCOLOR%
     </pre>
     %ENDTWISTY%
%ENDTWISTY%

%TWISTY{%TWISTY_OPTS_OUTPUT% showlink="Show !QualityMap Example" hidelink="Hide !QualityMap example"}%
<img src="%ATTACHURLPATH%/QualityMap.png" alt="QualityMap.png" width='800' height='620' />   
   * %TWISTY{%TWISTY_OPTS_OUTPUT% showlink="Show Parent XML" hidelink="Hide Parent XML"}%
     <pre class="file">
%BLUE%&lt;query %PURPLE%name=%ENDCOLOR%%GREEN%"summary"%ENDCOLOR%&gt;%ENDCOLOR%
  %BLUE%&lt;inputs&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"span"%ENDCOLOR% %PURPLE%type=%ENDCOLOR%%GREEN%"int"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%86400%BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"starttime"%ENDCOLOR% %PURPLE%partial=%ENDCOLOR%%GREEN%"down"%ENDCOLOR% %PURPLE%type=%ENDCOLOR%%GREEN%"datetime"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%time.time()-13*86400%BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"endtime"%ENDCOLOR% %PURPLE%partial=%ENDCOLOR%%GREEN%"up"%ENDCOLOR% %PURPLE%type=%ENDCOLOR%%GREEN%"datetime"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR%time.time()%BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"facility"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% .* %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"protocol"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% .* %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"vo"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% .* %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"exclude-vo"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% other %BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"exclude-facility"%ENDCOLOR% %PURPLE%kind=%ENDCOLOR%%GREEN%"sql"%ENDCOLOR%&gt;%ENDCOLOR% NONE|Generic|Obsolete %BLUE%&lt;input&gt;%ENDCOLOR%
  %BLUE%&lt;inputs&gt;%ENDCOLOR%
  %BLUE%&lt;sql&gt;%ENDCOLOR%
   SELECT
      %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"group"%ENDCOLOR%&gt;%ENDCOLOR%,
      truncate( unix_timestamp(StartTime) / :span, 0 ) * :span as time,
      %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"column"%ENDCOLOR%&gt;%ENDCOLOR%
    FROM
      MasterTransferSummary R FORCE INDEX (index01)
    JOIN
      Probe P on R.ProbeName = P.probename
    JOIN
      Site S on S.siteid = P.siteid
    JOIN
      VONameCorrection VC ON (VC.corrid=R.VOcorrid)
    JOIN
      VO on (VC.void = VO.void)
    %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"JOIN"%ENDCOLOR%&gt;%ENDCOLOR%
    WHERE
      StartTime &amp;gt;= :starttime AND
      StartTime &amp;lt; :endtime AND
      SiteName regexp :facility AND
      R.Protocol regexp :protocol AND
      VO.VOName regexp :vo AND
      (NOT (S.SiteName regexp :exclude-facility)) AND
      (NOT (VO.VOName regexp :exclude-vo))
      %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"where"%ENDCOLOR%&gt;%ENDCOLOR%
    GROUP BY
      %BLUE%&lt;slot %PURPLE%name=%ENDCOLOR%%GREEN%"group"%ENDCOLOR%&gt;%ENDCOLOR%,
      time
  %BLUE%&lt;sql&gt;%ENDCOLOR%
  %BLUE%&lt;results %PURPLE%module=%ENDCOLOR%%GREEN%"graphtool.database.query_handler"%ENDCOLOR% %PURPLE%function=%ENDCOLOR%%GREEN%"results_parser"%ENDCOLOR%&gt;%ENDCOLOR%
    %BLUE%&lt;inputs&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"pivots"%ENDCOLOR%&gt;%ENDCOLOR% 0 %BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"grouping"%ENDCOLOR%&gt;%ENDCOLOR% 1 %BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"results"%ENDCOLOR%&gt;%ENDCOLOR% 2 %BLUE%&lt;input&gt;%ENDCOLOR%
      %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"grouping_transform"%ENDCOLOR%&gt;%ENDCOLOR%make_int%BLUE%&lt;input&gt;%ENDCOLOR%
    %BLUE%&lt;inputs&gt;%ENDCOLOR%
  %BLUE%&lt;results&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"graph_type"%ENDCOLOR%&gt;%ENDCOLOR%GratiaStackedBar%BLUE%&lt;attribute&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"pivot_name"%ENDCOLOR%&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"grouping_name"%ENDCOLOR%&gt;%ENDCOLOR%Time%BLUE%&lt;attribute&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"title"%ENDCOLOR%&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"column_names"%ENDCOLOR%&gt;%ENDCOLOR%
  %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"column_units"%ENDCOLOR%&gt;%ENDCOLOR%
%BLUE%&lt;query&gt;%ENDCOLOR%
     </pre>
     %ENDTWISTY%
   * %TWISTY{%TWISTY_OPTS_OUTPUT% showlink="Show Child XML" hidelink="Hide Child XML"}%
     <pre class="file">
%BLUE%&lt;query %PURPLE%name=%ENDCOLOR%%GREEN%"user_quality"%ENDCOLOR% %PURPLE%base=%ENDCOLOR%%GREEN%"GratiaStorageQuery.summary"%ENDCOLOR%&gt;%ENDCOLOR%
    %BLUE%&lt;sql&gt;%ENDCOLOR%
        %BLUE%&lt;filler %PURPLE%name=%ENDCOLOR%%GREEN%"group"%ENDCOLOR%&gt;%ENDCOLOR% CommonName %BLUE%&lt;filler&gt;%ENDCOLOR%
        %BLUE%&lt;filler %PURPLE%name=%ENDCOLOR%%GREEN%"column"%ENDCOLOR%&gt;%ENDCOLOR%
            sum(CASE R.Status WHEN 0 THEN 1.0 ELSE 0.0 END) as Successes,
            sum(CASE R.Status WHEN 0 THEN 0.0 ELSE 1.0 END) as Failures
        %BLUE%&lt;filler&gt;%ENDCOLOR%
    %BLUE%&lt;sql&gt;%ENDCOLOR%
    %BLUE%&lt;results&gt;%ENDCOLOR%
        %BLUE%&lt;inputs&gt;%ENDCOLOR%
            %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"pivot_transform"%ENDCOLOR%&gt;%ENDCOLOR%displayName%BLUE%&lt;input&gt;%ENDCOLOR%
            %BLUE%&lt;input %PURPLE%name=%ENDCOLOR%%GREEN%"results"%ENDCOLOR%&gt;%ENDCOLOR% 2, 3 %BLUE%&lt;input&gt;%ENDCOLOR%
        %BLUE%&lt;inputs&gt;%ENDCOLOR%
    %BLUE%&lt;results&gt;%ENDCOLOR%
    %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"graph_type"%ENDCOLOR%&gt;%ENDCOLOR% QualityMap %BLUE%&lt;attribute&gt;%ENDCOLOR%
    %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"fixed-height"%ENDCOLOR%&gt;%ENDCOLOR% False %BLUE%&lt;attribute&gt;%ENDCOLOR%
    %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"title"%ENDCOLOR%&gt;%ENDCOLOR% Transfer Quality by User %BLUE%&lt;attribute&gt;%ENDCOLOR%
    %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"column_names"%ENDCOLOR%&gt;%ENDCOLOR% Successful Transfers, Failed Transfers %BLUE%&lt;attribute&gt;%ENDCOLOR%
    %BLUE%&lt;attribute %PURPLE%name=%ENDCOLOR%%GREEN%"column_units"%ENDCOLOR%&gt;%ENDCOLOR% Files, Files %BLUE%&lt;attribute&gt;%ENDCOLOR%
%BLUE%&lt;query&gt;%ENDCOLOR%
     </pre>
     %ENDTWISTY%
%ENDTWISTY%

---+++ XML Formattig for the Twiki
To format XML files to be displayed on the Twiki without syntax checking, and line by line. The following python code could be used.
%TWISTY{%TWISTY_OPTS_OUTPUT% showlink="Show Code" hidelink="Hide Code"}%
<pre class="file">
import re

  # GROUPS                    1  2    3          4                      5    6
pattern_open  = re.compile(r&quot;(&lt;)(\s*)([\w\d_-]+)(\s+[\w\d_-]+=\&quot;.*?\&quot;)*(\s*)(\/&gt;|&gt;)&quot;)
  # GROUPS                    1   2              3
pattern_close = re.compile(r&quot;(&lt;/)(\s*[\w\d_-]+\s*)(&gt;)&quot;)

open_tag      = &quot;&#37;BLUE&#37;&amp;lt;&quot;
close_tag     = &quot;&amp;gt;&#37;ENDCOLOR&#37;&quot;
att_def_open  = &quot;&#37;PURPLE&#37;&quot;
att_text_open = &quot;&#37;GREEN&#37;&quot;
close_color   = &quot;&#37;ENDCOLOR&#37;&quot;

def format_xml_for_twiki(text,first_call=True):
  if first_call:
    text = text.replace(&quot;&amp;&quot;,&quot;&amp;amp;&quot;)
  # Search for the next open tag
  match_open  = pattern_open.search(text)
  if match_open is not None:
    pre_match = text[:match_open.start()]
    pos_match = text[match_open.end():]
    open = open_tag+match_open.group(3)
    close = (&quot;/&quot; if match_open.group(3) == &quot;/&gt;&quot; else &quot;&quot;)+close_tag
    attributes = &quot;&quot;
    attributes_txt =&quot;&quot;
    if match_open.group(4) is not None:
      attributes = text[match_open.end(3):match_open.end(4)].strip()
      for attribute_i in attributes.split():
        parts = attribute_i.split(&quot;=&quot;)
        attributes_txt += &quot; &quot;+att_def_open+parts[0]+&quot;=&quot;+close_color+att_text_open+parts[1]+close_color
    new_text = pre_match+open+attributes_txt+close+pos_match
    # Recursive call to keep searching for more tags
    return format_xml_for_twiki(new_text,False)
  # Search for the next close tag
  match_close = pattern_close.search(text)
  if match_close is not None:
    pre_match = text[:match_close.start()]
    pos_match = text[match_close.end():]
    new_text = pre_match+open_tag+match_close.group(2).strip()+close_tag+pos_match
    # Recursive call to keep searching for more tags
    return format_xml_for_twiki(new_text,False)
  return text.replace(&quot;&lt;&quot;, &quot;&amp;lt;&quot;).replace(&quot;&gt;&quot;, &quot;&amp;gt;&quot;).replace(&quot;\t&quot;,&quot;  &quot;)

if __name__ == &quot;__main__&quot;:
  with open('./in.xml','r') as f:
    lines = f.readlines()
  if lines is not None:
    with open(&quot;./out.txt&quot;, 'w+') as f:
      for line in lines:
        f.write(format_xml_for_twiki(line))
  else:
    print &quot;No lines read from ./in.xml&quot;
</pre>
%ENDTWISTY%

-- Main.JuanFelipeMosqueraMorales - 25 Feb 2015

%META:FILEATTACHMENT{name="QualityMap.png" attachment="QualityMap.png" attr="" comment="!QualityMap Example" date="1424851462" path="QualityMap.png" size="46019" stream="QualityMap.png" tmpFilename="/usr/tmp/CGItemp9053" user="JuanFelipeMosqueraMorales" version="1"}%
%META:FILEATTACHMENT{name="GratiaCumulative.png" attachment="GratiaCumulative.png" attr="" comment="!GratiaCumulative Example" date="1424851517" path="GratiaCumulative.png" size="140349" stream="GratiaCumulative.png" tmpFilename="/usr/tmp/CGItemp8978" user="JuanFelipeMosqueraMorales" version="1"}%
%META:FILEATTACHMENT{name="GratiaHorizontalBar.png" attachment="GratiaHorizontalBar.png" attr="" comment="!GratiaHorizontalBar Example" date="1424851570" path="GratiaHorizontalBar.png" size="19551" stream="GratiaHorizontalBar.png" tmpFilename="/usr/tmp/CGItemp8905" user="JuanFelipeMosqueraMorales" version="1"}%
%META:FILEATTACHMENT{name="GratiaPie.png" attachment="GratiaPie.png" attr="" comment="!GratiaPie Example" date="1424851650" path="GratiaPie.png" size="101168" stream="GratiaPie.png" tmpFilename="/usr/tmp/CGItemp12904" user="JuanFelipeMosqueraMorales" version="1"}%
%META:FILEATTACHMENT{name="GratiaStackedBar.png" attachment="GratiaStackedBar.png" attr="" comment="!GratiaStackedBar Example" date="1424851706" path="GratiaStackedBar.png" size="62149" stream="GratiaStackedBar.png" tmpFilename="/usr/tmp/CGItemp13007" user="JuanFelipeMosqueraMorales" version="1"}%
%META:FILEATTACHMENT{name="GratiaStackedLine.png" attachment="GratiaStackedLine.png" attr="" comment="!GratiaStackedLine Example" date="1424851740" path="GratiaStackedLine.png" size="141647" stream="GratiaStackedLine.png" tmpFilename="/usr/tmp/CGItemp12932" user="JuanFelipeMosqueraMorales" version="1"}%
