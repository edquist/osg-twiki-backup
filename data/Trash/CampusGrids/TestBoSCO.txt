%META:TOPICINFO{author="MarcoMambelli" date="1354742973" format="1.1" version="1.9"}%
<!-- conventions used in this document
   * Local UCL_HOST = %URLPARAM{"INPUT_HOST" encode="quote" default="bosco"}%
   * Local UCL_USER = %URLPARAM{"INPUT_USER" encode="quote" default="user"}%
   * Local UCL_DOMAIN = %URLPARAM{"INPUT_DOMAIN" encode="quote" default="opensciencegrid.org"}%
   * Set TWISTY_OPTS_DETAILED = mode="div" showlink="Show Detailed Output" hidelink="Hide" showimgleft="/twiki/pub/TWiki/TWikiDocGraphics/toggleopen-small.gif" hideimgleft="/twiki/pub/TWiki/TWikiDocGraphics/toggleclose-small.gif" remember="on" start="hide" 
   * Set TOC2 =<div style="float:right; margin-right:-1.015em; padding:0.5em; background-color:white;">%TOC%<p class="twikiClear" /></div>
-->

---+!! Testing BOSCO
%DOC_STATUS_TABLE%
%TOC{depth="3"}%



---# Introduction 
This document describes a standard test of BOSCO. It is for BOSCO developers and testers. It requires some knowledge of BOSCO and Condor.

The BOSCO submit node is the host where BOSCO is installed and where user/s login to submit jobs via BOSCO.
The multiple clusters added to BOSCO (i.e. where the user/s can submit jobs via BOSCO) are referred as BOSCO resources.
If you are not familiar with these terms or would like more information about the BOSCO architecture, please check BoSCOv1p1.

---## Known Issues
 
   * [[https://jira.opensciencegrid.org/browse/CAMPUS-57][57]] Depreciation warning on cluster add.  


---# Performing basic tests

Always:
   * Note the BOSCO/Condor version, output of =condor_version=
   * Note the platform of the BOSCO submit node (OS, version, 32/64 bit)
   * Note the platform of each BOSCO resource and its queue manager (if you have any resource added)

---## Install test
Perform the installation as described in BoscoInstall or BoscoMultiUser 
then start BOSCO with =bosco_start=.
Verify that condor_q is working.

Report which platform was installed and if there is any error.

Verify that =bosco_cluster --list= and =findplatform= work correctly.

---## Add clusters
Add the BOSCO resource as described in BoscoInstall or BoscoMultiUser
then test the resource with =bosco_cluster --test NAME=.

Report the output of =bosco_cluster --list=, the NAME of the resource, jobmanager type, if the job completed successfully, the stdout of the test, the username used, if it was single pr multi user condor and important notes.

---## Run BOSCO (Grid) Jobs
Run jobs as the =bosco= user. Submit using the Condor "grid" universe for the specific cluster you added (PBS, Condor, SGE, ...). For an example check the [[BoSCOv1p1#6_2_1_Direct_Job_submission_exam][BOSCO documentation]].

Report if it ran correctly and on which resource it ran.

If you have multiple resources, verify that the jobs run on all of them, one at the time.


---# BOSCO Advanced (or Multi) user tests
These tests verify BOSCO with more than one cluster when the Campus Factory is in use.


---## Run BOSCO Vanilla Jobs
Run Condor "vanilla" jobs as the =bosco= user for single user BOSCO, as a user different from =bosco= or =root= for multi user bosco. For an example check the [[BoSCOv1p1#6_2_2_Glidein_Job_submission_exa][BOSCO documentation]].

Report if it ran correctly and on which resource it ran.

If you have multiple resources, verify that the jobs run on all of them.


---# BOSCO multi user tests
On top of the basic tests in the multi user environment, there are some tests specific for the multi user environment (not as important for BOSCO single user)

---## Flocking to BOSCO
Verify that other submit hosts can flock to the BOSCO submit host by following the instructions in BoscoMultiUser

---## Querying BOSCO from a monitoring host
Check that a monitoring hosts can run commands like =condor_q= or =condor_status= against the BOSCO submit host


---# Test policies
Before a release we should test all the functionalities above for all the supported queue managers, possibly on all the platforms (at least both Mac and Linux).

---# Test results

Each person performing a test can copy the template. Then update the summary for the version
---## BOSCO 1.1 alpha
Summary:
| *Test* | *Result* | *Date* | *Notes* |
| *Install* | %Y% | 11/8 | Marco |
| *Condor add/test* | %Y% | 11/8 | Marco |
| *LSF add/test* |  |  |  |
| *PBS add/test* | %Y%  | 11/30 | Derek |
| *SGE add/test* |  |  |  |
| *SLURM add/test* |  |  |  |
| *Jobs* | %Y% | 11/30 | Derek |
| *Flocking* |  |  |  |
| *Querying* |  |  |  |


---### Individual tests

Test by Marco Mambelli:
   * BOSCO version: $CondorVersion: 7.9.2 Nov 06 2012 BuildID: 76336 PRE-RELEASE-UWCS $, $CondorPlatform: x86_64_RedHat5 $
   * Single/Multi user: multi
   * Platform: RH5
   * Hosts: uc3-bosco
| *Test* | *Result* | *Date* | *Notes* |
| *Install* | %Y% |  |  |
| *Condor add/test* | %Y% |  |  |
| *LSF add/test* |  |  |  |
| *PBS add/test* | %X% |  | Jobs go on hold |
| *SGE add/test* | %X% |  | Jobs go on hold |
| *SLURM add/test* |  |  |  |
| *Jobs* |  |  |  |
| *Flocking* | %X% |  | CF crashing [[https://jira.opensciencegrid.org/browse/CAMPUS-39][39]] |
| *Querying* |  |  |  |

Notes:
   * Have still to test Derek's 11/9 patch

Test by Derek:
   * BOSCO version:$CondorVersion: 7.9.2 Nov 30 2012 BuildID: 82024 BOSCO $, $CondorPlatform: x86_64_RedHat6 $
   * Single/Multi user: Single
   * Platform: RH6
   * Hosts: hcc-cloud instance
| *Test* | *Result* | *Date* | *Notes* |
| *Version* | %Y% | 11/30 |  |
| *Single/Multi* | Single | 11/30 |  |
| *Target Platform* | RH5, SL6 | 11/30 |  |
| *Tester* | Derek | 11/30 |  |
| *Install* | %Y% | 11/30 |  |
| *Condor add/test* | %Y% | 11/30 | Worked, but inconvenience: [[http://jira.opensciencegrid.org/browse/CAMPUS-57][57]] |
| *LSF add/test* |  |  |  |
| *PBS add/test* | %Y% | 11/30 | Worked, but inconvenience: [[http://jira.opensciencegrid.org/browse/CAMPUS-57][57]] |
| *SGE add/test* | %Y% | 11/30 |  Worked, but inconvenience: [[http://jira.opensciencegrid.org/browse/CAMPUS-57][57]]  |
| *SLURM add/test* |  |  |  |
| *Grid Jobs* | %Y% | 11/30 | Test is a grid job |
| *Vanilla Jobs* | %Y% | 11/30 | Glideins started and ran test job |
| *Flocking* |  |  |  |
| *Querying* |  |  |  |




Test by Marco:
   * BOSCO version: (BOSCO 1.1 alpha3) $CondorVersion: 7.9.2 Nov 30 2012 BuildID: 82024 BOSCO $ $CondorPlatform: x86_64_RedHat5 $
   * Single/Multi user: multi
   * Platform: SL5
   * Hosts: uc3-bosco
   * Tester: Marco
| *Test* | *Result* | *Date* | *Notes* |
| *Install* | %Y% | 12/3 |  |
| *Condor add/test* | %Y% | 12/4 |  |
| *LSF add/test* |  |  |  |
| *PBS add/test* | %Y% | 12/3 | Test job is OK |
| *SGE add/test* | %X% | 12/4 | uc3@siraf-login.bsd.uchicago.edu Some jobs go on hold. BLAH_JOB_STATUS timed out |
| *SLURM add/test* |  |  |  |
| *Grid Jobs* |  |  |  |
| *Vanilla Jobs* |  |  |  |
| *Flocking* |  |  |  |
| *Querying* |  |  |  |

Notes:
   * Example of job going on hold on SGE (=/opt/bosco/local.uc3-bosco/bosco-test/tmp.fJeWQ16622/=): <pre class="file">000 (002.000.000) 12/04 17:28:49 Job submitted from host: <128.135.158.154:11000?sock=15493_1853_3>
...
027 (002.000.000) 12/04 17:28:57 Job submitted to grid resource
    GridResource: batch sge uc3@siraf-login.bsd.uchicago.edu
    GridJobId: batch sge uc3-bosco.uchicago.edu_11000_uc3-bosco.uchicago.edu#2.0#1354663729 sge/20121204173819/868604
...
012 (002.000.000) 12/04 17:35:03 Job was held.
	BLAH_JOB_STATUS timed out
	Code 0 Subcode 0
...
</pre> and job completing OK: <pre class="screen">-bash-3.2$ cat /opt/bosco/local.uc3-bosco/bosco-test/tmp.OklFU17319/logfile 
000 (003.000.000) 12/04 17:41:55 Job submitted from host: <128.135.158.154:11000?sock=15493_1853_3>
...
027 (003.000.000) 12/04 17:42:05 Job submitted to grid resource
    GridResource: batch sge uc3@siraf-login.bsd.uchicago.edu
    GridJobId: batch sge uc3-bosco.uchicago.edu_11000_uc3-bosco.uchicago.edu#3.0#1354664515 sge/20121204175125/868605
...
005 (003.000.000) 12/04 17:43:40 Job terminated.
	(1) Normal termination (return value 0)
		Usr 0 00:00:00, Sys 0 00:00:00  -  Run Remote Usage
		Usr 0 00:00:00, Sys 0 00:00:00  -  Run Local Usage
		Usr 0 00:00:00, Sys 0 00:00:00  -  Total Remote Usage
		Usr 0 00:00:00, Sys 0 00:00:00  -  Total Local Usage
	0  -  Run Bytes Sent By Job
	0  -  Run Bytes Received By Job
	0  -  Total Bytes Sent By Job
	0  -  Total Bytes Received By Job
...
</pre>

<!-- ####################### START TEMPLATE ##################### 
-->

---## Template

Test by NAME:
   * BOSCO version:
   * Single/Multi user:
   * Platform: 
   * Hosts: 
| *Test* | *Result* | *Date* | *Notes* |
| *Version* |  |  |  |
| *Single/Multi* |  |  |  |
| *Platform* |  |  |  |
| *Tester* |  |  |  |
| *Install* |  |  |  |
| *Condor add/test* |  |  |  |
| *LSF add/test* |  |  |  |
| *PBS add/test* |  |  |  |
| *SGE add/test* |  |  |  |
| *SLURM add/test* |  |  |  |
| *Grid Jobs* |  |  |  |
| *Vanilla Jobs* |  |  |  |
| *Flocking* |  |  |  |
| *Querying* |  |  |  |

Notes:
   *
<!-- ####################### END TEMPLATE ##################### 
-->

%INCLUDE{"BoscoInstall" section="BoscoReferences"}%

---+ Comments
%COMMENT{type="tableappend"}%

<!-- CONTENT MANAGEMENT PROJECT
############################################################################################################
 DEAR DOCUMENT OWNER
 ===================

 Thank you for claiming ownership for this document! Please fill in your FirstLast name here:
   * Local OWNER = MarcoMambelli

 Please define the document area, choose one of the defined areas from the next line
 DOC_AREA = (ComputeElement|General|Integration|Monitoring|Operations|Security|Storage|Tier3|User|VO)
   * Local DOC_AREA       = General

 define the primary role the document serves, choose one of the defined roles from the next line
 DOC_ROLE = (Developer|Documenter|Scientist|Student|SysAdmin|VOManager)
   * Local DOC_ROLE       = SysAdmin

 Please define the document type, choose one of the defined types from the next line
 DOC_TYPE = (HowTo|Installation|Knowledge|Navigation|Planning|Training|Troubleshooting)
   * Local DOC_TYPE       = Installation
  Please define if this document in general needs to be reviewed before release ( %YES% | %NO% )
   * Local INCLUDE_REVIEW = %YES%

 Please define if this document in general needs to be tested before release ( %YES% | %NO% )
   * Local INCLUDE_TEST   = %YES%

 change to %YES% once the document is ready to be reviewed and back to %NO% if that is not the case
   * Local REVIEW_READY   = %YES%

 change to %YES% once the document is ready to be tested and back to %NO% if that is not the case
   * Local TEST_READY     = %YES%

 change to %YES% only if the document has passed the review and the test (if applicable) and is ready for release
   * Local RELEASE_READY  = %NO%


 DEAR DOCUMENT REVIEWER
 ======================

 Thank for reviewing this document! Please fill in your FirstLast name here:
   * Local REVIEWER       = 
 Please define the review status for this document to be in progress ( %IN_PROGRESS% ), failed ( %NO% ) or passed ( %YES% )
   * Local REVIEW_PASSED  = %YES%


 DEAR DOCUMENT TESTER
 ====================

 Thank for testing this document! Please fill in your FirstLast name here:
   * Local TESTER         = 
 Please define the test status for this document to be in progress ( %IN_PROGRESS% ), failed ( %NO% ) or passed ( %YES% )
   * Local TEST_PASSED    = %YES%
############################################################################################################
-->
