%META:TOPICINFO{author="DerekWeitzel" date="1286937977" format="1.1" reprev="1.4" version="1.4"}%
%META:TOPICPARENT{name="CampusGridTechnology"}%
---+ Campus Grid Technology
%TOC%

---++ Pre-Requisites
The campus grid requires [[http://www.cs.wisc.edu/condor/downloads-v2/download.pl?state=select_from_mirror_page&version=7.5.3&mirror=UW%20Madison&optional_organization_url=http://][Condor-7.5.3]].  

#InstallingCondor
---+++  Installing Condor 

You do not have to install condor as root.  This guide will assume installing as non-root.  The user that runs condor will be the same user which the pilots will be submitted as to PBS.
   1. [[http://www.cs.wisc.edu/condor/downloads-v2/download.pl?state=select_from_mirror_page&version=7.5.3&mirror=UW%20Madison&optional_organization_url=http://][Download]]
   1. Uncompress condor.  For example if you are running on RHEL5, SL5, or !CentOS5:
   <pre class="screen">tar xzf condor-7.5.3-linux-x86_64-rhel5-dynamic.tar.gz</pre>
   1. Create the file =condor.sh= with the following, replacing =CONDOR_LOCATION= with the location of condor.
   <pre class="file">#!/bin/sh
CONDOR_DIR=CONDOR_LOCATION
export CONDOR_CONFIG=$CONDOR_DIR/etc/condor_config
export PATH=$CONDOR_DIR/bin:$CONDOR_DIR/sbin:$PATH
</pre>


---++ Preparing Condor
   1. Copy the file =condor_config.generic= from =CONDOR_LOCATION/etc/examples/condor_config.generic=:
   <pre class="screen">cd condor-7.5.3
cp etc/examples/condor_config.generic etc/condor_config </pre>
   1. Download the factory release.
   1. Edit the required condor lines in the local condor configuration file (condor_config.local):
      * =CONDOR_HOST= to the full hostname of the machine that will run condor
      * =RELEASE_DIR= to the full path of the condor location.  It should be the same as =CONDOR_LOCATION= mentioned in [[#InstallingCondor][Installing Condor]]
      * =LOCAL_DIR= to a directory where condor will place host dependent files (logs...).  A common value is =$(RELEASE_DIR)/local.$(HOSTNAME)=
      * =LOCAL_CONFIG_FILE= set to =$(RELEASE_DIR)/etc/condor_config.local=
      * =CONDOR_ADMIN= set to the email address that will receive emails about malfunctioning condor.
      * =UID_DOMAIN= set to a unique name for this resource.  For example, for a cluster named Firefly at Nebraska, we would set =UID_DOMAIN= to =firefly.unl.edu=
      * =FILESYSTEM_DOMAIN= set to your domain.  This can be the same as =UID_DOMAIN=
      * =COLLECTOR_NAME= Name of the resource.
      
   A sample configuration with the variables changes is shown below.   
   %TWISTY{
mode="div"
showlink="Sample condor config"
hidelink="Sample condor config"
showimgleft="%ICONURLPATH{toggleopen-small}%"
hideimgleft="%ICONURLPATH{toggleclose-small}%"
}%

   <pre class="file">

##  What machine is your central manager?
CONDOR_HOST = ff-grid.unl.edu

##  Where have you installed the bin, sbin and lib condor directories?
RELEASE_DIR     = /home/swanson/dweitzel/condor-7.5.3

##  Where is the local condor directory for each host?
##  This is where the local config file(s), logs and
##  spool/execute directories are located
LOCAL_DIR       = $(RELEASE_DIR)/local.ff

##  Where is the machine-specific local config file for each host?
LOCAL_CONFIG_FILE   = $(RELEASE_DIR)/etc/condor_config.local

##  When something goes wrong with condor at your site, who should get
##  the email?
CONDOR_ADMIN        = dweitzel@cse.unl.edu

##  Full path to a mail delivery program that understands that "-s"
##  means you want to specify a subject:
MAIL            = /usr/bin/mail

##  Internet domain of machines sharing a common UID space.  
UID_DOMAIN      = ff.unl.edu

##  Internet domain of machines sharing a common file system.
FILESYSTEM_DOMAIN   = ff.unl.edu

##  This macro is used to specify a short description of your pool.
COLLECTOR_NAME      = Firefly

   </pre>
   %ENDTWISTY%

   1. The next section of the =condor_config.local= prepares condor for the factory.

---++ Installing the factory

-- Main.DerekWeitzel - 12 Oct 2010
