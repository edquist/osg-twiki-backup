%META:TOPICINFO{author="DerekWeitzel" date="1348168504" format="1.1" version="1.6"}%
%META:TOPICPARENT{name="WebHome"}%
---+!! Installing a Condor Flock Submit Host
%TOC%

<!--
   * Local SUPPORTED_OS = Red Hat Enterprise Linux 5, 32 and 64 bit and variants (Scientific Linux 5 and CentOS) 
-->


---++ About this document
This document is intended for system administrators or users with root access to a submit host.  It will guide you through installation of a submit host that can execute jobs on the OSG by communicating with one of many well known OSG submit hosts.

---++ Installing Pre-Requisites
The OSG Condor Flocking configuration is distributed in a RPM.  We distribute the RPM with the official OSG Release.

%INCLUDE{"Documentation/Release3.YumRepositories" section="OSGRepoBrief" TOC_SHIFT="++"}%

%INCLUDE{"Documentation/Release3.InstallCertAuth" section="OSGBriefCaCerts" TOC_SHIFT="++"}%

---++ Installation of the OSG Condor Flock RPM
To install, you must enable the osg development repo and install from there.
<pre class="rootscreen">
%UCL_PROMPT_ROOT% yum --enablerepo=osg-development install osg-condor-flock </pre>

---++ Configuration of the Submit Machine
The primary configuration is in =/etc/condor/config.d/99_osg_flock.conf=.  You will need to edit this.

The =FLOCK_TO= specifies the hosts that you want to send jobs.  The currently supported OSG submit hosts are =ENGAGE_RENCI= (default) and =HCC=.  The hosts are listed in =/etc/condor/config.d/98_flock_hosts.conf=.

---++ Configuration of the Usage Probe (Gratia)
A usage probe is installed as part of the process of installing osg-condor-flock.  Condor is configured (by the osg-condor-flock rpm) to write a job history file into a special directory.  The usage probe wakes up every few minutes, checks the special history directory, and sends usage up to a database at Fermilab.  

A small amount of configuration is needed for the usage probe.

In the gratia-condor configuration file, =/etc/gratia/condor/ProbeConfig=, check the line:
<pre class="file">
ProbeName="condor:&lt;hostname>"
SiteName="Generic Site"
</pre>

The value should include your hostname in the format =condor:&lt;hostname>=.  If the hostname is inaccurate, or you would like to change it to something more descriptive, please do.  This is an arbitrary name that will be stored in the database, and be associated with your recorded usage.  The site name should be a short title of the site this probe belongs to.  There can be multiple probes in a site.

The only other line that you should edit is the =EnableProbe= line.  Set it to "1".