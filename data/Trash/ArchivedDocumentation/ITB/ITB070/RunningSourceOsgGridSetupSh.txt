%META:TOPICINFO{author="KyleGross" date="1225985925" format="1.1" version="1.3"}%
---+!! *<nop>%SPACEOUT{ "%TOPIC%" }%*
%TOC%

---++ Heading 2

---++ Known issues

---++ More information

--+!! Sourcing =$OSG_GRID/setup.sh=: The First Job of Any Job
%TOC%

%STARTINCLUDE%

---+++Running =source $OSG_GRID/setup.sh= : The First Job of Any Job
%EDITTHIS%

The first command any job should execute after it is started in a batch slot at an OSG site is:

<pre class="screen">
$ <b>source $OSG_GRID/setup.sh</b>
</pre>

=setup.sh= sets up several environment variables and configures certain client tools, such as srmcp, and adds them to the job's path. 

Most of the environment variables are already set before you source this. However, at some sites there are inconsistencies between paths on the headnode and the worker node. The environment settings prior to sourcing is consistent with the headnode, while after the sourcing it should be consistent with the worker node. If (or when) you arrive at a site where this is not the case you should feel free to complain by opening a trouble ticket.

See the [[CEInstallGuide][CE Install Guide]] and [[LocalStorageConfiguration][Local Storage Configuration]] for more information. 

---++ Sample 
An excerpt of these environment variables is provided below from FNAL_GPFARM_TEST.  S<!-- Note that the SE used in the example, fndca.fnal.gov, doesn't support all VirtualOrganizations/VOInfo's at the moment. -->

<pre class="programlisting">
 OSG_SITE_NAME="FNAL_TEST_033"
 OSG_LOCATION="/export/osg/grid"
 OSG_GRID="/usr/local/osg"
 OSG_APP="/app"
 OSG_DATA="/data"
 OSG_SITE_READ="dcap://fndca.fnal.gov:24525//pnfs/fnal.gov/usr"
 OSG_SITE_WRITE="srmcp://fndca.fnal.gov:8443/"
 OSG_WN_TMP="$_CONDOR_SCRATCH_DIR"
 OSG_DEFAULT_SE="UNAVAILABLE"
 OSG_SITE_INFO="http://fermigrid.fnal.gov/gpfarm/FNAL_GPFARM_POLICY.html"
</pre>

---++ Sample Output
The following is output from a test run of a job with the scripts configured correctly:
<pre class="screen">
$ <b>globus-job-run fnpcg/jobmanager-fork /usr/bin/printenv</b>
 OSG_DATA=/data
 hostname=fnpcg.fnal.gov
 GRID3_TMP_WN_DIR=/local/stage1
 OSG_LOCATION=/export/osg/grid
 OSG_JOB_CONTACT=fnpcg.fnal.gov/jobmanager-condor
 GRID3_SITE_NAME=FNAL_GPFARM_TEST
 OSG_SITE_INFO=http://fermigrid.fnal.gov/gpfarm/FNAL_GPFARM_POLICY.html
 GRID3_DATA_DIR=/data
 OSG_DEFAULT_SE=UNAVAILABLE
 OSG_GRID=/usr/local/grid
 LOGNAME=fnalgrid
 OSG_SITE_NAME=FNAL_GPFARM_TEST
 GRID3_JOB_CONTACT=fnpcg.fnal.gov/jobmanager-condor
 GRID3_USER_VO_MAP=/export/osg/grid/monitoring/grid3-user-vo-map.txt
 OSG_USER_VO_MAP=/export/osg/grid/monitoring/grid3-user-vo-map.txt
 OSG_WN_TMP=/local/stage1
 GRID3_GRIDFTP_LOG=/export/osg/grid/globus/var/gridftp.log
 OSG_UTIL_CONTACT=fnpcg.fnal.gov/jobmanager
 OSG_SITE_READ=dcap://fndca.fnal.gov:24525//pnfs/usr
 GRID3_SITE_INFO=http://fermigrid.fnal.gov/gpfarm/FNAL_GPFARM_POLICY.html
 HOME=/home/fnalgrid
 LD_LIBRARY_PATH=/export/osg/grid/MonaLisa/Service/VDTFarm/pgsql/lib:
 /export/osg/grid/voms/lib:/export/osg/grid/prima/lib:
 /export/osg/grid/expat/lib:/export/osg/grid/globus/lib:
 /export/osg/grid/expat/lib:
 /export/osg/grid/MonaLisa/Service/VDTFarm/pgsql/lib:
 /export/osg/grid/voms/lib:/export/osg/grid/prima/lib:
 /export/osg/grid/expat/lib:
 /export/osg/grid/MonaLisa/Service/VDTFarm/pgsql/lib:
 /export/osg/grid/voms/lib:/export/osg/grid/prima/lib:
 /export/osg/grid/expat/lib:
 GRID3_TMP_DIR=/data
 OSG_GRIDFTP_LOG=/export/osg/grid/globus/var/gridftp.log
 OSG_APP=/app
 GRID3_BASE_DIR=/export/osg/grid
 GLOBUS_GRAM_JOB_CONTACT=https://fnpcg.fnal.gov:51487/10121/1134169575/
 GLOBUS_LOCATION=/export/osg/grid/globus
 OSG_SPONSOR=fermilab
 GLOBUS_GRAM_MYJOB_CONTACT=URLx-nexus://fnpcg.fnal.gov:51488/
 OSG_SITE_WRITE=srm://fndca.fnal.gov:8443/
 GRID3_APP_DIR=/app
 GRID3_SPONSOR=fermilab
 GRID3_UTIL_CONTACT=fnpcg.fnal.gov/jobmanager
 X509_USER_PROXY=/home/fnalgrid/.globus/job/fnpcg.fnal.gov/10121.1134169575/x509_up
</pre>

%STOPINCLUDE%
%BR%
%COMPLETE1% %BR%
%RESPONSIBLE% Main.StevenTimm - 19 Oct 2007 %BR%
%REVIEW%
