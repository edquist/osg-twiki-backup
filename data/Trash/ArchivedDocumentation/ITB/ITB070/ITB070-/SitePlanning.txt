%META:TOPICINFO{author="RobGardner" date="1193313756" format="1.1" version="1.5"}%
%META:TOPICPARENT{name="WebHome"}%
---+!! *<nop>%SPACEOUT{ "%TOPIC%" }%*
%TOC%

---+ Introduction

Installing a large OSG site can be daunting for a couple of reasons. First of all, you will almost certainly need to install software on multiple computers. Second, you will need to have a clear plan before you proceed. 

There are different kinds of installations you might perform. They include:

   * *A computing element (CE)* The computing element is the front-end to your computer cluster. Users submit jobs to the CE, which submits the jobs to your local batch system. The OSG software assumes that you can install your local batch system yourself and provides no help with that. 

   * *A worker node (WN)* A worker node is a single computer (perhaps with multiple CPUs or cores) in your computer cluster.

   * *A user mapping service* When a user arrives at your site, they are identified by a certificate containing their name, not by their local user id. There are two ways to map a user to the local user id and one of them is a service called _GUMS_. It is a good idea to run this on a separate computer from your CE. 

   * *A virtual organization management service (VOMS)* If you are running a virtual organization (VO), you need to control who is a member of your VO. You do this with VOMS. It is a very good idea to run this on a separate computer from your CE. 

   * *A storage element (SE)* A storage element manages and controls access to storage at your site. Storage management can be one of the more complicated systems to set up at your site. OSG provides two different SEs: one based on dCache and one based on Bestman. dCache is often installed on multiple computers, and it should not be installed on your CE. Bestman is more appropriate for smaller sites, but it is still a good idea not to run it on your CE.

   * *A web proxy* Some users submit jobs that download their executables or data files from a web site. In order to conserve bandwidth and to help applications run faster, you might wish to install a web proxy. OSG provides Squid for your use. It is a good idea to run this on a separate computer from your CE.

   * *A shared file system* OSG recommends the use of a shared file system so that some files are accessible on all worker nodes. We do not provide instructions on how to set up a shared fileystem, but will tell you want needs to be shared.

If you install all of these services at your site, you could easily have at several computers (and possibly many more) running OSG software. 

---++ What should you install? 

If you want to allow users to run jobs on your computing cluster, you need to install the computing element (CE) and worker node (WN) at a minimum. If your users are likely to access large amounts of data, you need an SE. Depending on how you want to control access to your site, you might want to install GUMS. 

If you run a virtual organization (VO), you should install VOMS.  

---++ The simplest possible OSG compute cluster

     <img src="%ATTACHURLPATH%/BasicCE.gif" alt="BasicCE.gif" width='616' height='407' />

There are a lot of possible variations here: this is just one example of how it might be set up. Two major notes:

   1. The worker node client software must be installed on all worker nodes. Most sites install this using a shared file system for simplicity, but you are not required to use a shared file system. 
   1. At a minimum, the shared file system must include =$OSG_APP=, which is the location that users put applications shared between jobs. It may also include other directories, [[#SharedFS][See below for more information]].

---++ What a small site might look like

<img src="%ATTACHURLPATH%/SmallSite.gif" alt="SmallSite.gif" width='616' height='443' />

This site might be okay if your compute cluster is not too large, but it is starting to push its limits. The problem is the number of services running on a single node. We recommend breaking things up so that not so many things are on the same computer. It would be more scalable to add two computers to this site:

<img src="%ATTACHURLPATH%/SmallSite-Modified.gif" alt="SmallSite-Modified.gif" width='616' height='672' />

But now there is a problem: you have two different computers doing authorization/user mapping independently. We can add a service so that all of your computers are synchronized. 

---++ What a medium size site might look like

((Picture of a CE, with separate computers for Bestman, Squid, NFS, GUMS, and small cluster)

---++ What a large site might look like

((Picture of a CE, with separate computers for Squid, NFS, GUMS, a small cluster, and a moderate-sized dCache cluster)

---+ What you need to do

---++ Certificates

What certs are needed, pointers to getting them

GetHostCertificates

#SharedFS
---++ Shared file system directories

You need to run a shared file system if you support job submission to your site. There are four common directories that are shared: not all of them are required. 

| *Name* | *Required?* | *Purpose* |
| OSG_APP | Yes| Store applications used by multiple jobs |
| OSG_DATA | No, but highly recommended | Store data used by jobs |
| OSG_GRID | No | Location of worker node client |
| HOME | Usually | User's home directories. Required unless you are using Condor NFS-Lite job manager |

More details can be found in [[LocalStorageConfiguration][Local Storage Configuration]]

---++ Mapping users

Choosing edg-mkgridmap or GUMS

---++ Advanced notes

   * glexec

<span style="font-size:xx-large; color:purple">OLD TEXT FOLLOWS:</span>

%INCLUDE{"SiteFabricBestPractices"}%
%INCLUDE{"OperatingSystems"}%
%INCLUDE{"AboutAuthorizationForCE"}%

%STOPINCLUDE%
%BR%
%COMPLETE1% %BR%
%RESPONSIBLE% Main.AlainRoy - 18 Oct 2007 %BR%
%REVIEW%


%META:FILEATTACHMENT{name="BasicCE.gif" attr="" autoattached="1" comment="" date="1192823893" path="BasicCE.gif" size="19744" user="Main.AlainRoy" version="4"}%
%META:FILEATTACHMENT{name="SmallSite.gif" attr="" autoattached="1" comment="" date="1192826662" path="SmallSite.gif" size="23134" user="Main.AlainRoy" version="2"}%
%META:FILEATTACHMENT{name="SmallSite-Modified.gif" attr="" autoattached="1" comment="" date="1192827601" path="SmallSite-Modified.gif" size="28453" user="Main.AlainRoy" version="1"}%
