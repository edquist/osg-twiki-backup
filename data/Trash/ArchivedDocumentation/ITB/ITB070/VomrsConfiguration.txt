%META:TOPICINFO{author="KyleGross" date="1225985926" format="1.1" version="1.6"}%
%META:TOPICPARENT{name="VomrsInstallGuide"}%
---+!! *<nop>%SPACEOUT{ "%TOPIC%" }%*
%TOC%

%STARTINCLUDE%
%BR%
---+ _%INCLUDEHEADING%  %SPACEOUT{ "%TOPIC%" }%_
%EDITTHIS%
%BR%


The <i>$VDT_LOCATION/vdt/setup/configure_vomrs</i> script has been provided for creating VOs from VirtualOrganizations/VOInfoMRS.

You may be wondering why you are being told about this script before describing the installation process.  During the VirtualOrganizations/VOInfoMRS installation process, this script is executed and creates a 'test' VirtualOrganizations/VOInfo called <i>VDT</i>.  After the installation completes, the verification process  uses this <i>VDT</i> test VirtualOrganizations/VOInfo to determine the success of the installation.  By reviewing this section of the documentation now, you will be more aware of what to look for when you create your own VirtualOrganizations/VOInfo(s).

---++ Creating a VO
All VOs should be created using the <i>configure_vomrs</i> script.

Syntax:
<pre>
configure_voms --server &lt y,n &gt
               --vo &lt vo_name &gt
               --mail-from &lt from address on vomrs mail &gt
               --smtp-host &lt outgoing smtp host &gt
               --vdt-install &lt VDT installation root &gt
</pre>

%NOTE% The =$VDT_LOCATION/vdt-install.log= contains all messages from its execution not visible in stdout/err on the command line.


The <i>configure_vomrs</i> script does the following (note: the examples that follow show the files for the <i>VDT</i> test VirtualOrganizations/VOInfo that is created):
<ol>
  <li>Creates a <nop>MySql database called <i>vomrs<VOMRS_VERSION>_vdt</i>.
<pre class="screen">
&gt; <b>mysql -uroot</b>
mysql&gt; <b>show databases;</b>
+----------------+
| Database       |
+----------------+
| mysql          |
| test           |
| vomrs13_vdt    |
+----------------+
</pre>
  </li>
  <li>Creates all the necessary VirtualOrganizations/VOInfoMRS configuration files for your VirtualOrganizations/VOInfo in  $VDT_LOCATION/vomrs/var/etc/vomrs_<em>vo_name</em> .
<pre>
> ls <b>$VDT_LOCATION/vomrs/var/etc/vomrs_vdt</b>
-rw-r--r--  1 root   root    802 Jul 31 11:10 initial.conf
-rw-r--r--  1 root   root    607 Jul 31 11:10 log4j.properties
-rw-r--r--  1 root   root    608 Jul 31 11:10 log4j_webui.properties
drwxr-xr-x  2 root   root   4096 Jul 31 11:12 logs
-rw-------  1 root   root   1014  Jul 31 11:10 member.data
-rw-r--r--  1 root   root    258 Jul 31 11:10 vomrs_vdt.xml
lrwxrwxrwx  1 root   root     42 Jul 31 11:10 vomrs.xsd -> /usr/local/osg-vomrs/vomrs/etc/cfg/vomrs.xsd
</pre>
  </li>
  <li>Updates the apache, tomcat and glite configuration files for the new VirtualOrganizations/VOInfoMS VO.</li>
  <li>Restarts all the necessary services.</li>
</ol>

Many default values were applied during this process.  The values applied can  be viewed in the 
<i>$VDT_LOCATION/vdt-install.log</i> and searching for 'This is vomrs-configure'.

%IMPORTANT% You have to restart tomcat-55 and start relevant VirtualOrganizations/VOInfoMRS server after you have configure a new VO. In order to that you have to issue the following commands:

<pre class="screen">
vdt-control --off tomcat-55
vdt-control --on tomcat-55
service vomrs start <em>vo_name</em>
</pre> 

Please check how to create a VirtualOrganizations/VOInfoMS instance for your new VirtualOrganizations/VOInfo in [[VomsInstalGuide#Configuring_VOMS_the_configure_v][VirtualOrganizations/VOInfoMS Installation Guide (Configuring VirtualOrganizations/VOInfoMS section)]]
---++ Removing a VO 
There no script that allows you to remove a VirtualOrganizations/VOInfoMS instance. You have to perform the following steps manually.
   * stop the VirtualOrganizations/VOInfoMRS  server
   * remove the associated !MySql database
   * remove $VDT_LOCATION/var/etc/vomrs_<em>vo_name></em> directory
   * remove context file from $VDT_LOCATION/tomcat/v55/config/Catalina/localhost/vomrs#<vo_name.xml
   * remove $VDT_LOCATION/tomcat/v55/webapps/vomrs/<em>vo_name</em> directory
   * restart tomcat-55

The <i>configure_voms</i> script can be  used to remove a VirtualOrganizations/VOInfo from the VirtualOrganizations/VOInfoMS installation. See [[VomsInstallGuide#Removing_a_VO][VirtualOrganizations/VOInfoMS Installation Guide (Removing a VirtualOrganizations/VOInfo section) ]] for instructions.

%STOPINCLUDE%
%BR%
%COMPLETE1% %BR%
%RESPONSIBLE% Main.RobGardner - 18 Oct 2007 %BR%
%REVIEW%