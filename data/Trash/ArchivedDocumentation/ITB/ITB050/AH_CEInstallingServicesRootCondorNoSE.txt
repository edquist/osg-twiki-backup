%META:TOPICINFO{author="AnneHeavey" date="1178045464" format="1.1" reprev="1.1" version="1.1"}%
%LINKCSS%

---+!!<nop>OSG CE - Installing the Services
%TOC%
%STARTINCLUDE%


---++ Installing OSG CE Services
%EDITTHIS%

Make sure you're logged on as root. Now you're ready to start installing the Compute Element (CE) services to install on the server/gatekeeper, as separate from software which must be executable from the worker nodes.

---+++ Shutdown previous installations
If you have a previously installed version, you *must* do a complete shutdown and confirm that all processes associated with it have been stopped.  Refer to the [[CEInstallGuide#CE_Shutdown_Guide][CE Shutdown Guide section of the CE Install Guide]] for details.

%IMPORTANT% Choose the correct link in that section for the specific version you are replacing.  Be sure all services and crons are disabled; see [[StartingServices]]. (It covers stopping them, too.)

---+++ Choose an installation directory 
This is typically something like =/usr/local/grid=, but whatever suits the local resource structure is fine. This directory does not need to be shared by the worker nodes.  Any software which needs to be seen from the worker nodes may be provided by the worker node client package.

For example:
<pre class="screen">
# mkdir -p /usr/local/grid
# cd /usr/local/grid
</pre>

---+++Installing the OSG CE software package
%NOTE% If you have PBS as your existing batch system, make sure your binaries are in the path prior to installation.  The install will fail silently with error reported to =vdt-install.log= and jobmanager-pbs will not be created. 

The installation described here is done as root.  Services will not necessarily run as root (e.g., <nop>MonALISA, <nop>Globus-ws and <nop>MySql a will run as the user "daemon" by default, if installed and activated; see ?? someplace it says about the other users..).
d35 1
   * *%BLUE%Verify that the umask is set to "0022" prior to installation.  Failure to do so may render the installation unusable. %ENDCOLOR%* Run =umask 0022=.
   * A few questions regarding trust of the caches from which the software is downloaded will be displayed.   %BR%  Please answer *y* (yes) so that the software can be retrieved.
   * Finally, make sure there are no non-standard versions of perl, tcsh, or bash in your $PATH variable.
A few questions regarding trust of the caches from which the software is downloaded will be displayed.   Please answer *y* (yes) so that the software can be retrieved.
Finally, make sure there are no non-standard versions of perl, tcsh, or bash in your $PATH variable.
The following pacman commands will install the OSG software packages.
Install the OSG software packages:
<pre class="screen">
OR
 # <b>pacman -get OSG:ce</b>    <i>... for the OSG production version</i>
</pre>

See the [[PacmanInfo][Pacman page]] if you encounter an 'unsupported' platform message.

%NOTE% This will take between 10 and 60 minutes to complete, depending upon the system and network connection. During this time you may open a second terminal and watch the progress by monitoring the =vdt-install.log= file under your installation directory.

You should not be asked any other questions during the installation process.
The installation should complete with the following message (version will change). 
The installation should complete with the following message (software versions will change). 

<pre class="screen">
Downloading [site-verify-1.0-9.tar.gz] from [http://vdt.cs.wisc.edu/software///site-verify/1.0]...
Pacman Installation of OSG-0.5.2 Complete
Pacman Installation of OSG-0.6.0 Complete
</pre>

---+++ Setup the OSG environment
 Assuming the Pacman install completed without fatal errors, you should now be able to source the OSG setup environment. From your installation directory, source the setup script:

<pre class="screen">
$ <b>source setup.sh</b>
      <em>OR</em>
% <b>source setup.csh</b>
</pre> 
This sets the variable <i>$VDT_LOCATION</i> to your installation directory.  

In order to interface your Condor installation to the OSG CE software, run:
&gt; <b>pacman -get OSG:Globus-Condor-Setup</b>
# <b>pacman -get OSG:Globus-Condor-Setup</b>
</pre>

Or for OSG-ITB substitute <i>ITB</i> for <i>OSG</i>.
Globus-XXX-Setup will include web-services (Globus-WS-XXX-Setup) and Gratia probes. This guide will not go into the detail on the installation of any of these packages.
It asks you if you want to run the Condor batch system automatically.  Answer *y*.
---+++ Post install README
You can look at the =$VDT_LOCATION/post-install/README= file. It is not OSG-specific. We suggest that you read the file *for information only*, do not follow any instructions in it. Rather, follow the instructions in this guide.  
Globus-Condor-Setup will include web-services (Globus-WS-Condor-Setup) and Gratia probes. This guide will not go into the detail on the installation of any of these packages.
%NOTE% Do not be concerned with any error messages you may see in this README file.  They are usually not a problem.
 It is not OSG-specific. If you read it, do so *for information only*, do not follow any instructions in it or worry about error messages in it. Rather, follow the instructions in this guide.  

%STOPINCLUDE%

%WHU%
<!-- MAJOR UPDATES
For significant updates to the topic, consider adding your 'signature' (beneath this editing box) !-->
-- Main.RobQ - 01 May 2006<br>
-- Main.JohnWeigand - 07 Sep 2006 - updated for OSG 0.5.0<br>
-- Main.AnneHeavey - 01 May 2007
