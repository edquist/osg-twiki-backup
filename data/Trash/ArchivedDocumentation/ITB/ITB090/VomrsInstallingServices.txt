%META:TOPICINFO{author="KyleGross" date="1225985928" format="1.1" version="1.12"}%
%META:TOPICPARENT{name="VomrsInstallGuide"}%
---+!! *<nop>%SPACEOUT{ "%TOPIC%" }%*
%TOC%

%STARTINCLUDE%
%BR%
---+ _%INCLUDEHEADING%  %SPACEOUT{ "%TOPIC%" }%_
%EDITTHIS%
%BR%

---++ hosts file considerations
The /etc/hosts file should be set up to list the external FQAN of the vom(r)s server separately from the localhost line, for example:
<pre class="screen">
&gt; <b>127.0.0.1 localhost.localdomain localhost</b>
&gt; <b>123.45.67.89 myvoms.example.edu myvoms</b>
</pre>
Placing the FQAN in the localhost line will cause the installation to fail.

---++ Installation user
Must be done as _root_ user.

---++ Installation package
After installing pacman:

<pre class="screen">
# <b>cd <i>PACMAN_DIR</i></b>
# <b>source setup.sh</b>
</pre>

---++ Installation location
Wherever you like.  Shown below as as the VDT_LOCATION variable.

<pre class="screen">
# <b>VDT_LOCATION=/usr/local/osg</b>
# <b>mkdir $VDT_LOCATION</b>
</pre>


---++ Installation Cache
<pre class="screen">
# cd $VDT_LOCATION
# pacman -get  %CACHE%:vomrs  
</pre>

---++ Installation output/questions
%NOTE% Some of the questions related to 'trusted caches' and 'unrecognized platforms' may not appear depending on your host and any _pacman_ variables already set in your environment.

<pre class="screen">
VDT 1.8.1 installs a variety of software, each with its own license.
In order to continue, you must agree to the licenses.
You can view the licenses online at:

     http://vdt.cs.wisc.edu/licenses/1.8.1

After the installation has completed, you will also be able to
view the licenses in the "licenses" directory.

Do you agree to the licenses? [y/n] <b>y</b>
-------------------------------------------------

Several services provided by the VDT create unbounded log files.  If you wish, we can rotate those file on a daily basis.

Would you like to setup daily rotation of VDT log files?

Possible answers:
    y: Yes, I want the service to run automatically (once enabled)
    n: No, I do NOT want the service to run automatically

Note: Services are enabled with vdt-control; see 'post-install/README'.

<b>y</b>
-------------------------------------------------


If you would like, we can configure VOMRS to start automatically 
at boot time.

Enabling the VOMRS daemon requires 
  - changes to /etc/init.d (or /etc/rc.d/init.d)
  - starting up a MySQL server
  - starting up an Apache and Tomcat server

Would you like to enable the VOMRS server to run automatically?

Possible answers:
    y: Yes, I want the service to run automatically (once enabled)
    n: No, I do NOT want the service to run automatically

Note: Services are enabled with vdt-control; see 'post-install/README'.

<b>y</b>
-------------------------------------------------


If you would like, we can configure VOMS to start automatically 
at boot time.

Configuring the VOMS daemon requires 
  - changes to /etc/init.d (or /etc/rc.d/init.d)
  - starting up a MySQL server
  - starting up an Apache and Tomcat server

Would you like to enable the VOMS server to run automatically?

Possible answers:
    y: Yes, I want the service to run automatically (once enabled)
    n: No, I do NOT want the service to run automatically

Note: Services are enabled with vdt-control; see 'post-install/README'.
<b>y</b>
-------------------------------------------------


The VDT typically installs public certificates and signing policy files 
for the well-known public CA's. This is necessary in order for you to 
perform GSI authentication with any remote Grid services (that have 
service/host certificates signed by these CA's).

For more information please refer to the VDT documentation:
http://vdt.cs.wisc.edu/setup_ca.html

Where would you like to install CA files?

Choices:
        r (root)  - install into /etc/grid-security/certificates
                   (existing CA files will be preserved)
        l (local) - install into $VDT_LOCATION/globus/share/certificates
        n (no)    - do not install
<b>r</b>
-------------------------------------------------


Do you want to run a cron job that will update the CA certificate
revocation lists automatically? This will use the fetch-crl program
that comes with the VDT. The cron job will run at a random time
between midnight and 6:00am. We select a random time to avoid having
all VDT installations fetching CRLs at the same time.

Do you want to update the CA certification revocation lists (CRLs) automatically? [y/n] 
<b>y</b>
-------------------------------------------------

Do you want to add [http://osg-vtb.uchicago.edu/vtb/] to [trusted.caches]? (y or n): <b>y</b>

Package [vomrs-181] found in [VTB]...
Do you want to add [http://vdt.cs.wisc.edu/vdt_181_cache] to [trusted.caches]? (y or n): <b>y</b>
-------------------------------------------------
</pre>

---++ Verify the  installation completed successfully
To verify  the pacman installation was successful, there should be a setup.(c)sh in the VDT_LOCATION.   If present, source it.

<pre class="screen">
# <b>cd $VDT_LOCATION</b>
# <b>source setup.sh</b>
</pre>

%IMPORTANT% This does not necessarily indicated that everything was installed and configured successfully.  It just verifies that the pacman installation completed successfully.  There is a lot of other magic that occurs during the process that should be validated.

%STOPINCLUDE%
%BR%
%COMPLETE3% %BR%
%RESPONSIBLE% Main.TanyaLevshina - 25 Oct 2007 %BR%
%REVIEW%