%META:TOPICINFO{author="MichaelThomas" date="1171588030" format="1.1" reprev="1.11" version="1.11"}%
<!-- This is the default OSG Integration template. 
Please modify it in the sections indicated to create your topic!
If you have any comments/complaints about this template, then please email me:
rwg@hep.uchicago.edu.  (Adapted from Atlas wiki template, Ed Moyse)
--> 

<!-- By default the title is the WikiWord used to create this topic !-->
<!-- if you want to modify it to something more meaningful, just replace %TOPIC% below with i.e "My Topic"!-->
d11 1
---+!!<nop>OSG CE Shutdown Guide
%TOC%
%STARTINCLUDE%

---++CE Shutdown Guide
%EDITTHIS%

In VDT 1.6.1 and later, all services (=/etc/init.d=, =/etc/xinetd.d=, =cron=) should be turned on/off using the =$VDT_LOCATION/vdt/sbin/vdt-control= script.  This section will provide just a general overview. There is a <i>man</i> page available for the script, just type =man vdt-control=. You can also [[http://vdt.cs.wisc.edu/releases/1.6.1/man/vdt-control.html read the man page online]]
In VDT 1.6.1 and later, all services (<i>/etc/init.d, /etc/xinetd.d, cron</i>) should be turned on/off using the <i>$VDT_LOCATION/vdt/sbin/vdt-control</i> script.  This section will provide just a general overview. There is a <i>man</i> page available for the script, just type "man vdt-control". You can also [[http://vdt.cs.wisc.edu/releases/1.6.1/man/vdt-control.html read the man page online]]
d40 1
To view all services controlled by <i>vdt-control</i>:
<pre>
&gt; source $VDT_LOCATION/setup.sh
&gt; vdt-control --list
<b>.... output from a fully enabled installation ... </b>
Service            | Type   | Desired State
-------------------+--------+--------------
fetch-crl          | cron   | enable
vdt-rotate-logs    | cron   | enable
gris               | init   | do not enable
globus-gatekeeper  | inetd  | enable
gsiftp             | inetd  | enable
mysql              | init   | enable
globus-ws          | init   | enable
edg-mkgridmap      | cron   | do not enable
gums-host-cron     | cron   | enable
MLD                | init   | enable
apache             | init   | enable
tomcat-5           | init   | enable
condor             | init   | enable
gratia-condor      | cron   | enable
</pre>

To shutdown <b>all</b> services:
<pre>
&gt; source $VDT_LOCATION/setup.sh
&gt; vdt-control --off
&gt; <b>vdt-control --off </b>
</pre>
---++ Shutdown other services
<pre>
&gt; source $VDT_LOCATION/setup.sh
&gt; vdt-control --off  Service
&gt; <b>source $VDT_LOCATION/setup.sh </b>
&gt; <b>vdt-control --off  Service </b>
</pre>
For <i>/etc/xinetd.d</i> services, the script will be removed from the directory.  The <i>xinetd.d</i> daemon will be restarted.
---+++ / etc/xinetd.d services
---+++/etc/xinetd.d services
For <i>/etc/init.d</i> services, the script will be removed from the directory and the service will be stopped.

---+++/etc/init.d services
For <i>root</i> cron entries, the entry will be removed from the crontab.

---+++crontabs
For =root= cron entries, the entry will be removed from the crontab.

---+++ VDT 1.6.0 and earlier
<verbatim>
# service tomcat-5 stop
# service apache stop
# service MLD stop
# service mysql stop
# service edg-crl-upgraded stop
# service gris stop
# service bdii stop
# service globus-ws stop
</verbatim>
> <b>service bdii stop </b>
==/etc/xinetd.d== services can be disabled by either removing the service configuration from the ==/etc/xinetd.d== direcotry, or setting ==disable=yes== in the service's ==/etc/xinetd.d== configuration file and restarting xinetd.
an OSG 0.4.1 Installation please note also the old [[ReleaseDocumentation.OSGShutdownGuide][OSG 0.4.1 Shutdown Guide]]



---+++Additional considerations

---++++<nop>MySql / <nop>Integration.MonALISA / Globus web services
<pre>
&gt;  ps -efwww | grep -i monalisa

&gt;  <b>ps -efwww | grep -i monalisa </b>
<pre>
&gt;  ps -efwww | grep -i mysql
       or
&gt;  ps -efwww  | grep -i post[master,gres]

<pre class="screen">
If you are running a Rocks cluster, be sure to kill only the OSG-related mysql processes and avoid inadvertently stopping any cluster-related ones.  In general, pay attention if you need to kill any database-related processes explicitly; for example, look to make sure they are related to !Integration.MonALISA or Globus web services,  and/or are running out of your VDT installation area before stopping them.
&gt;  <b>ps -efwww | grep -i mysql </b>
If you are shutting down in order to prepare for a new OSG install *in a different directory*, you shouldr emove the <i>/etc/init.d/MLD</i> link if it exists, as this will link to the <i>ML_SER</i> in your old <i>$VDT_LOCATION</i>.


If you are shutting down in order to prepare for a new OSG install *in a different directory*, you shouldr emove the =/etc/init.d/MLD= link if it exists, as this will link to the <i>ML_SER</i> in your old <i>$VDT_LOCATION</i>.

<pre>
 &gt;  /etc/init.d/tomcat-5 stop
 &gt;  /etc/init.d/apache stop
 &gt;  /etc/init.d/mysql stop
&gt;  <b>/etc/init.d/tomcat-5 stop </b>
&gt;  <b>/etc/init.d/apache stop </b>
&gt;  <b>/etc/init.d/mysql stop </b>
</pre>
%WHU%


<!-- MAJOR UPDATES
For significant updates to the topic, consider adding your 'signature' (beneath this editing box) !-->

---++!! Major updates
-- Main.BurtHolzman - 30 Dec 2005
<!--Future editors should add their signatures beneath yours!-->
-- Main.NateMueller - 14 Apr 2005<br>
-- Main.AlanSill - 14 Apr 2005<br>
-- Main.JohnWeigand - 18 Jul 2005 - added gsiftp2 to procedures<br>
-- Main.AlanSill - 12 Dec 2005 - added web services shutdown and check<br>
-- Main.ChristopherBaumbauer - 08 Mar 2006 - Added steps to disable globus, shutdown globus-ws, web services running under tomcat, and redid the Integration.MonALISA shutdown instructions to go down cleaner<br>
-- Main.AlanSill - 22 Mar 2006 - Slight tweaks to above.<br>
%INCLUDE{ "Integration.WhuReferences" }%
-- Main.RobQ - 01 May 2006<br>
-- -- Main.JohnWeigand - 24 Jan 2007 - for OSG 0.5.2    %BR%


%META:TOPICMOVED{by="ForrestChristian" date="1166054759" from="Integration.OSGShutdownGuide050" to="Integration/ITB_0_5.OSGShutdownGuide"}%
