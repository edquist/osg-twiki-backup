%META:TOPICINFO{author="JeffPorter" date="1215043702" format="1.1" reprev="1.13" version="1.13"}%
%META:TOPICPARENT{name="WebHome"}%
---+!! *<nop>Berkeley Storage Manager (!BeStMan)*
%TOC%

%STARTINCLUDE%

*Purpose*:   The purpose of this document is to provide [[Storage.BeStMan][BeStMan]] based SE administrators the information on how to prepare, install and validate the SE. 

---++ Preparation
---+++ Introduction
Berkeley Storage Manager ([[Storage.BeStMan][BeStMan]]) is a full implementation of SRM v2.2, developed by Lawrence Berkeley National Laboratory, for a small disk based storage and mass storage systems such as HPSS. End users may have their own personal [[Storage.BeStMan][BeStMan]] that manages and gives an SRM interface to their local disks. It works on top of existing disk-based unix file systems, and has been reported so far to work on file systems such as NFS, PVFS, AFS, GFS, and Lustre. It also works with any existing file transfer service, such as gsiftp, http, https, bbftp and ftp. It requires minimal administrative efforts on the deployment and updates. If storage is hierarchical and/or spans multiple file system types and storage systems, [[ReleaseDocumentation.DCache][SRM/dCache]] should be considered.

---+++ VDT Installation Procedures

While it is possible to deploy Bestman as a personal diskmanager, the following descriptions target a more general use installation.  Bestman is distributed by the VDT and, like other services deployed in the OSG, installs with Pacman and assumes PacmanInstall steps have been taken. In a suitable directory (e.g. /opt/osg-1.0/) install the software by running:

<pre class="screen">
<b> pacman -get http://vdt.cs.wisc.edu/vdt_1101_cache:Bestman </b>
</pre>

The install process will ask to accept the vdt-cache, check for prequisites and ask to accept licenses. It will then ask several questions about deploying and enabling services for normal GRID access. Specifically (though edited to only show the questions and suggested answers) :
<pre class="screen">
Do you want to update the CA certification revocation lists (CRLs) automatically? [y/n] <userinput> y </userinput>
Would you like to setup daily rotation of VDT log files?<userinput> y </userinput>
Where would you like to install CA files? <userinput> l </userinput> (lower case L for "local")
Do you want to automatically update your CA Certificates? [y/n] <userinput> y </userinput>
Would you like to enable Globus GridFTP daemon to run automatically?<userinput> y </userinput>
Would you like to enable the Bestman server to run automatically?<userinput> y </userinput>

</pre>


%NOTE% If you are doing a fresh install on a host that has a previous installation, setting =export OLD_VDT_LOCATION = /path-to-old-vdt/= will pre-answer these questions.  

The installation should finish quietly.  You can review what has been in stalled by the following commands:

<pre class="screen">

<b> source setup.sh
 vdt-version </b>
You have installed a subset of VDT version 1.10.1d:
    Berkeley Storage Manager (BeStMan) 2.2.0.10
    CA Certificates v37 (includes IGTF 1.22 CAs)
    Fetch CRL 2.6.6
    GPT 3.2autotools2004-NMI-9.0
    Java 5 SDK 1.5.0_14
    Logrotate 3.7
</pre>

And check which services are ready to deploy with:

<pre class="screen">
<b> vdt-control --list </b>
Service            | Type   | Desired State
-------------------+--------+--------------
fetch-crl          | cron   | enable
vdt-rotate-logs    | cron   | enable
vdt-update-certs   | cron   | enable
gsiftp             | inetd  | enable
bestman            | init   | enable
</pre>


---+++ Configuration

The full review of Bestman configuration options are provided in the [[http://datagrid.lbl.gov/bestman/docs/bestman-guide.html][Bestman Administration Guide]].  The process is controlled by a Bestman-specific configuration script ( =$VDT_LOCATION/bestman/setup/configure= ) with command line arguments to define such items as cache directories, CA cert and CRL locations, service ports, logging information ...  During the VDT installation, some defaults are used to do an initial configuration and can be reviewed from the =vdt-install.log= file.  For example:

<pre class="screen">
<b> grep /bestman vdt-install.log | grep configure </b>
### 2008-07-02 16:01:20 (failsafe_system) cd /opt/osg/itb-1.10.1/bestman/setup; ./configure     --with-replica-storage-path=/opt/osg/itb-1.10.1/vdt-app-data/bestman/cache 
 --with-replica-storage-size=12459     --with-srm-home=/opt/osg/itb-1.10.1/bestman    --with-srm-owner=daemon   
 --with-cacert-path=/opt/osg/itb-1.10.1/globus/TRUSTED_CA    --with-certfile-path=/etc/grid-security/http/httpcert.pem   
 --with-keyfile-path=/etc/grid-security/http/httpkey.pem    --with-eventlog-path=/opt/osg/itb-1.10.1/vdt-app-data/bestman/logs 
 --with-cachelog-path=/opt/osg/itb-1.10.1/vdt-app-data/bestman/logs    --with-http-port=10080    --with-https-port=10443    
</pre>


---+++ Integration with the information system
Integration of the SE with the central information systems takes place during the Compute Element installation/configuration. See the topic [[ReleaseDocumentation/GenericInformationProviders][Generic Information Providers]]. The SE does not collect or publish information independently.

---+++ More information
In order to learn more about [[Storage.BeStMan][BeStMan]], please visit the [[http://datagrid.lbl.gov/bestman][BeStMan official website]] and [[Storage.BeStMan][OSG BeStMan Status page]].

%STOPINCLUDE%
%BR%
%COMPLETE2% %BR% 
%RESPONSIBLE% Main.AlexSim - 4 Dec 2007 %BR%
%REVIEW% Main.RobGardner - 23 May 2008 %BR%
%REVCOM% Where are the installation instructions?
