%META:TOPICINFO{author="AnthonyTiradani" date="1222269895" format="1.1" reprev="1.21" version="1.21"}%
---+!! *<noop>%SPACEOUT{ "%TOPIC%" }%*
%TOC%

---++ Introduction
 The Open Science Grid (OSG) Generic Information Provider (OSG-GIP) are a core part of the OSG Information Infrastructure. They should be configured carefully by the resource administrator to correctly publish the information about the site. Information collected by the GIPs is sent through CEMON to a central LDAP (BDII) server. Information selected by request to the GOC is then transferred from the OSG BDII to the EGEE BDII to support interoperability between the grids.

The GIP is a grid information service that aggregates static and dynamic resource information for use with LDAP-based information systems. The GIP produces information based on the [[http://glueschema.forge.cnaf.infn.it/SpecV13/LDAP][GLUE Schema]].

---+++ Major Updates for OSG 1.0.0
   1 New d-cache SE provider 
   1 New dynamic PBS provider 
   1 New Timestamp provider 
   1 VO-to-queue mapping for PBS 
   1 Improved local gip testing tools 
   1 Support for preset GIP_LOCATION 
   1 Support for Glue 1.3 
   1 Relaxed Timeout Values 

---++ Installation
 The Generic Information Provider is installed with the standard OSG installation. To activate it, you must complete the configuration section of this document.

---++ Configuration
 When you run configure-osg.py it will create an gip-attributes.conf file that will record all the information needed to run configure_gip. The details of the information collected can be found in the [[http://osg.ivdgl.org/bin/view/Main/OSGConfigurationParameters#GIP][OSG Configuration Parameter]] twiki. The configure_gip script runs transparently without need for user input.

---+++ Configuring to publish GUMS information
 GIP is now automatically configured to to publish GUMS service status information. For more details, please look at [[http://vdt.cs.wisc.edu/releases/1.10.1/notes/GUMS.html]]

If you want to overwride the default behavior (i.e. you do not want GIP to publish status of your GUMS system), then set
<verbatim>
OSG_GIP_GUMS=0;
</verbatim> in $VDT_LOCATION/monitoring/gip-attributes.conf.

---+++ Counting VMs in "Owner" State in Condor Batch system
 By default owner VMs are counted for the total CPU numbers published by GIP. According to Condor defn an Owner state implies "The machine is being used by the machine owner, and/or is not available to run Condor jobs". But technically it could be available in the future, for this purpose, GIP counts this field to determine total CPUs on the system, but it does not count this for the available CPUs or available slots. But some sites have been using this "Owner" state to create shadow pools which will be never available and should not be counted as a part of total CPUs.

In order to tell the GIP not to count the CPUs in "Owner" state for the total CPU count a site administrator should add the following line
<verbatim>
OSG_GIP_SUBTRACT_OWNER=1
</verbatim> to the $VDT_LOCATION/monitoring/gip-attributes.conf

This is available beyond ITB 0.7.0

---++ Post Install
 Follow the the instructions at [[https://twiki.grid.iu.edu/twiki/bin/view/InformationServices/DcacheGip][GIP setup for the dcache provider]] to setup GIP to advertise your dcache SE. PBS sites may want to refer to [[https://twiki.grid.iu.edu/twiki/bin/view/InformationServices/GipConf][GIP Configuration File]] to setup whitelisting and blacklisting for queues.

---++ Validation Webpage
 A Validator for GIP can be found at [[http://gip-validate.grid.iu.edu/]].

One can execute:
<pre>ldapsearch -x -LLL -p 2170 -h is-itb.grid.iu.edu -b mds-vo-name=YOUR_SITE_NAME_HERE,mds-vo-name=local,o=grid </pre>

For a complete set of instructions to validate information published to BDII, see the ValidateBDII page.

For instructions to validate information published to !ReSS, see the [[ResourceSelection.WebHome#ValidationLinks][ReSS validation links]].

---++ Troubleshooting
   * Error comparing subject names.: Desired subject and actual subject of certificate do not match. %BR% Desired subject: =/CN=ldap/cmssrv09.fnal.gov= %BR% Actual subject: =/DC=org/DC=doegrids/OU=Services/CN=cmssrv09.fnal.gov= %BR% *Cause:* You are probably using your host certificate for your LDAP certificate. A common shortcut. 

   * Information is NOT sent to BDII or CEMon. Follow [[ResourceSelection.CEMonTroubleshootingGuide][CEMon troubleshooting guide]]. 

*In Progress*

---++ Additional Functionality

   * [[GipOverrides#Overwriting_attributes_published][Administrator Overrides]] 
      * [[GipOverrides#Case_1_Altering_values_published][Altering published values]]: E.g. Changing default values for !GlueHostNetworkAdapterInboundIP, !GlueHostNetworkAdapterOutboundIP, !GlueHostOperatingSystemName, and others. 
      * [[GipOverrides#Case_2_Adding_new_DNs][Adding New DNs]]: E.g. GIP published one !SubCluster entry by default, but if you have an heterogeneous cluster with multiple sub-clusters. 
   * [[GipOverrides#Adding_site_defined_constraints][Adding site defined constraints to custom configure condor status commands]] 

---++ Miscellaneous Info
   * [[GipAttributeExplanation][Explanation of GIP / Glue Attributes]]
   * [[http://glueschema.forge.cnaf.infn.it/SpecV13/LDAP][GLUE 1.3 LDAP schema]] 
   * [[http://glueschema.forge.cnaf.infn.it/][Documents about GLUE]] 
   * Links from Laurence Field: 
      * [[http://lfield.home.cern.ch/lfield/cgi-bin/wiki.cgi?area=bdii&page=documentation][BDII]] 
      * [[http://lfield.home.cern.ch/lfield/cgi-bin/wiki.cgi?area=gip&page=documentation][GIP]] 
      * [[http://lfield.home.cern.ch/lfield/cgi-bin/wiki.cgi?area=glue&page=information][GLUE]] 
   * [[http://griddev.uchicago.edu/download/grid3/doc.pkg/GIIS-configuration/][Grid3 era]] 

---+++ Useful LDAP Tool

If you run an un-authenticated GRIS / GIP and want to check your results a helpful tool is the [[http://www-unix.mcs.anl.gov/~gawor/ldap/][LDAP browser]].
   1 Download the zip/tar file and unpack it. 
   1 Start it by running the lbe.sh script. A graphical user interface will appear. 
   1 Create a new connection and enter the following properties for the new connection: 

<pre>    Host: is.grid.iu.edu     Port: 2170     Base DN: mds-vo-name=local,o=grid </pre>

This will pull in information from the entire BDII. If you would prefer to see your site only, then create a new connection and enter the following properties for the new connection:

<pre>    Host: is.grid.iu.edu     Port: 2170     Base DN: mds-vo-name=your-site-name,mds-vo-name=local,o=grid </pre>

---+++ Explanation of BDii
 BDii is the Berkeley Database Information Index. It consists of two or more standard LDAP databases that are populated by an update process. The OSG BDii service collects GIP information from OSG hosts which are running the CEMon service.

The connect to the BDii service standard LDAP querying command can be used.

<pre>> *ldapsearch -LLL -x -h is.grid.iu.edu -p 2170 -b "o=grid"* </pre>

The BDii server name is "is.grid.iu.edu" the BDii port to query is 2170.

Other useful query examples follow:

This query returns site information for !FermiGrid. Piping the output of ldapsearch into perl prevents ldapsearch from cutting the output at column 80.

<pre> > ldapsearch -x -l 60 -b mds-vo-name=local,o=grid  -h is.grid.iu.edu -p 2170  "(GlueSiteName=FNAL_FERMIGRID)"  | perl -00pe 's/\r*\n //g' </pre>

This query returns information about all Authorization services.
<pre>> ldapsearch -x -l 60 -b mds-vo-name=local,o=grid  -h is-itb.grid.iu.edu -p 2170  "(&(objectClass=GlueTop)(objectClass=GlueService)(objectClass=GlueKey)(objectClass=GlueSchemaVersion)(GlueServiceName=Authorization))"  | perl -00pe 's/\r*\n //g' </pre>

%BR% 
%COMPLETE3% %BR% 
%RESPONSIBLE% Main.AnandPadmanabhan - 19 Nov 2007 %BR% 
%REVIEW% Main.AnthonyTiradani - 2 Sep 2008 %BR% 
%REVCOM% Added information to the Post Install section for the dcache provider and additional configuration options for PBS sites%BR% 
%REVFLAG% %Y% %BR%

%META:TOPICMOVED{by="AnneHeavey" date="1192821927" from="Integration/ITB_0_7.CENodeGIP" to="Integration/ITB_0_7.GenericInformationProvider"}%
