%META:TOPICINFO{author="JohnWeigand" date="1261582558" format="1.1" reprev="1.25" version="1.25"}%
%META:TOPICPARENT{name="SiteValidationTable"}%
---+!! *<nop>%SPACEOUT{ "%TOPIC%" }%*

<!--
   * Set SUPPORTED_VOS = [[OsgSupportedVos][Supported VOs and Undefined UNIX Accounts document]]
   * Set CE_PREINSTALL_CHECKLIST = [[PreInstallationChecklistCE#Creation_and_setup_of_local_user][CE Pre-installation Checklist document]]
-->

%TOC%

---++ Background for validating VO access

The purpose of this section is to provide the information necessary to determine if you are configured to support all VOs and users that you intend to support.  

%IF{ "$CACHE = 'ITB'" then="__For the ITB, your CE node is expected to support all OSG VOs.  All OSG VO members, should be capable of running a job on your CE node.__" else="" }%

Note that this is __not__ an automated or scripted process.

So that all OSG VO members can access your site, you need to verify that:
   1  all UNIX accounts that can be assigned using your authorization mode have been created.
   1 the OSG VOs are supported (the ones you have agreed to support). 
   1 all the local storage areas defined for your CE node are accessible by the VO members' UNIX accounts.

The following sections will describe in a little more detail how to go about this verification. There are several files in the _$VDT_LOCATION/osg/etc_ directory that can aid you in this process. It is suggested you read  the  %SUPPORTED_VOS%  to familiarize yourself with these files. 

When you are satisfied that you have met the 3 criteria above, you can be reasonably confident that all VO members you intend to support will be able to access the services provided by your CE node.

<!--   when to perform this validation -->
---++ When to perform this validation
This validation should be performed after:
   1 you have fully installed your OSG CE node 
   1 configured it using the _configure-osg_ script
   1 verified that your authorization service is up-to-date
      * for [[AboutAuthorizationForCE#Local_grid_mapfile][local grid-mapfile]], verify your _edg-mkgridmap.conf_ file and _/etc/grid-security/grid-mapfile_ are up-to-date.
      * for [[AboutAuthorizationForCE#Compatibility][Compatibility]]  and [[AboutAuthorizationForCE#Full_Privilege][Full Privilege]] authorization mode, verify your GUMS service is up-to-date
   1 run _edg-mkgridmap_ or _gums-host-cron_ scripts (depending on your authorization mode)

__This verification/validation procedure is not necessarily a one-time event.  Whenever changes are made to your authorization services or configuration, you should perform this validation.__


<!--   UNIX ACCOUNTS -->
---++ Verifying that all UNIX accounts are created and accessible
The _$VDT_LOCATION/osg/etc/osg-undefined-accounts.txt_ file shows any UNIX accounts that do not exist.  Refer to the %SUPPORTED_VOS%  for details on how this is done.  

The creation of UNIX accounts and user home areas was one of the OSG CE pre-installation items that should have been completed as described in the %CE_PREINSTALL_CHECKLIST%.

Since this file is created by either the  _edg-mkgridmap_ or _gums-host-cron_ script (depending on your authorization mode), be sure you have run the appropriate script before looking here.

__If all UNIX accounts exist, there should be NO UNIX accounts in this file. It should be empty.__ If so, then you are assured that all OSG VO members that are authorized and assigned a UNIX account will be able to at least submit a job to your batch queue manager.

__Next__, you need to verify that the _$HOME_ directories for __all__ the UNIX accounts are read/write accessible. They should have permissions 755.


<!--   VO SUPPORT -->
---++ Verifying that the appropriate VOs are supported

%IF{ "$CACHE = 'ITB'" then="__Remember, all participants in the ITB are required to support all OSG VOs.__" else="" }%

The _$VDT_LOCATION/osg/etc/osg-supported vo-list.txt_ file shows the list of OSG VOs to which your site will allow access.  Refer to the  %SUPPORTED_VOS%  for details on how this is done.   

Since this file is created by either the  _edg-mkgridmap_ or _gums-host-cron_ scripts (depending on your authorization mode), be sure you have run the appropriate script before looking here.

If the _$VDT_LOCATION/osg/etc/osg-supported vo-list.txt_ file on your CE node matches the output from the command shown below,  then you are assured that at least one member of every OSG VO will be able to run a job on your CE node.
   * wget -q -O - 'http://oim.grid.iu.edu/pub/vo/show.php?format=plain-text' | cut -f1 -d ','



If the VO names vary (or are missing), you may not have properly configured your authorization configuration files:
   * for [[AboutAuthorizationForCE#Local_grid_mapfile][local grid-mapfile]]: this is the _$VDT_LOCATION/edg/etc/edg-mkgridmap.conf_ file on your CE node.
   * for [[AboutAuthorizationForCE#Compatibility][Compatibility]]  and [[AboutAuthorizationForCE#Full_Privilege][Full Privilege]] mode: this is the _$VDT_LOCATION/vdt-app-data/gums/config/gums.config_ file on your GUMS server.

If you are unfamiliar with the authorization mode terms used above, see [[AboutAuthorizationForCE][About OSG CE Authorization]] to get a better understanding.

__If you make any changes to the _edg-mkgridmap.conf_ or _gums.config_ configuration files, you need to do the following to effect the changes:__
   1 edg-mkgridmap.conf:  
      * re-run the _edg-mkgridmap_ script
   1 gums.config: 
      * have your GUMS administrator perform the _Update VO members_ action on the GUMS server GUI.
      * then rerun the _gums-host-cron_ script<p>
When this is complete, you must re-verify the _osg-undefined-accounts.txt_ and _osg-supported-vo-list.txt_ files.


<!-- DIRECTORY  PERMISSIONS -->
---++ Verifying OSG local storage access
The other factor that will affect a VO member's ability to run successfully on your site is the accessibility to the OSG defined local storage.

You answered several questions related to these storage areas when you ran the _configure_osg.sh_ script during the installation process as described in the [[ConfigureOSGAttributes][Configuring OSG Attributes document]] of the CE Installation Guide.

You should review the [[LocalStorageConfiguration][Local Storage Configuration document]] again to verify that you are configured correctly with specific emphasis on the directory permissions for these areas.


%BR%
%COMPLETE3% %BR%
%RESPONSIBLE% Main.JohnWeigand - 23 Dec 2009 %BR%
%REVIEW% Main.MichaelThomas - 20 Jul 2009 %BR%
%REVFLAG% %S% %BR%
-- Main.JohnWeigand - 23 Dec 2009 - updated for OSG 1.2.5

---++ *Comments*

%COMMENT{type="tableappend"}%

%META:FILEATTACHMENT{name="osg-supported-vo-list.txt" attachment="osg-supported-vo-list.txt" attr="" comment="osg-supported-vo-list.txt" date="1188567181" path="osg-supported-vo-list.txt" size="231" stream="osg-supported-vo-list.txt" user="Main.JohnWeigand" version="1"}%
%META:TOPICMOVED{by="AnneHeavey" date="1192739081" from="Integration/ITB_0_7.ValVoAccess" to="Integration/ITB_0_7.ValidateVoAccess"}%
