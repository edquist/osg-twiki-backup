%META:TOPICINFO{author="ScotKronenfeld" date="1240593340" format="1.1" reprev="1.7" version="1.7"}%
%META:TOPICPARENT{name="WebHome"}%
---+!! *<nop>%SPACEOUT{ "%TOPIC%" }%*
%TOC%

%STARTINCLUDE%
%BR%
---+ _%INCLUDEHEADING%  %SPACEOUT{ "%TOPIC%" }%_
Instructions for upgrading to OSG 1.0.1 from OSG 1.0.0

%EDITTHIS%
%BR%

---++ Upgrade Instructions
There are two methods for updating from OSG 1.0.0. (Please note that these instructions are not for upgrading from OSG 0.8.)

---+++ Pre-installation
Before upgrading, you'll need to do the following:
   * Change into your VDT_LOCATION directory and source the setup file (setup.sh or setup.csh)
   * run =vdt-control --off= in order to turn off your services
   * make a backup of your osg installation directory, using =cp -pr= or =rsync= to copy the directory.

---+++ Upgrading OSG components
The changes for the OSG portion of the cache involve an update of configure-osg in order to get a version that works with the updated components and adding a new version script. 

---++++ Updating configure-osg
On an existing osg installation, you'll need to update the osg-config package.
   * =pacman -update osg-config=
In the monitoring directory, you'll find a =config.ini.new=.  This file has a new version of the config.ini file with updated and simpler syntax especially in regards to configuring SEs and Subclusters.  You may want to use this as your new starting point for your configuration.  
%BR%
%RED%Important:%ENDCOLOR%  The new configure-osg.py script requires the config file to be named config.ini.  There is no longer an option to allow a differently named file.  If you are currently using a file named something other than config.ini, rename it to config.ini now.
%BR%
%RED%Important:%ENDCOLOR% if you are using custom settings in your =osg-local-job-environment.conf=, you will need to migrate those settings to the =Local Settings= section of the config.ini.  The =osg-local-job-environment.conf= will get overwritten with the settings from config.ini with this release.
%BR%
Now validate your config.ini file before running further steps:
   * =./monitoring/configure-osg.py -v= 
There are now extra ini files that are not needed.  You can delete the following in the monitoring directory if they are present:
   * =rm monitoring/simple-config.ini monitoring/full-config.ini monitoring/extract-config.ini= 

---++++ Installing osg-version
There is a new package in this update that provides a script named osg-version that allows you to determine the osg and vdt version of your installation.  Running osg-version will give you the osg version (1.0.1 in this case).  This version should increment as new vdt updates come out.  In addition, osg-version --verbose will give you the osg version and the vdt version for your system.  Run:
   * =cd $VDT_LOCATION=
   * =pacman -get OSG:osg-version=

---++++ Updating VDT Packages
In order to update the VDT packages, you'll need to use one of the following methods.

---+++++ Using VDT updater script (Recommended)
The VDT team has created a new script that allows you to update an existing OSG 1.0.0 installation on a semi-automated fashion. (This is not for upgrading from OSG 0.8 or earlier.)  We recommend using this script since it will make the process much easier.  First, fetch the script
   * =pacman -get OSG:VDT-Updater= 

To ensure that you have that latest version of the VDT-Updater (even if you just ran the previous 'pacman -get' command), run:
   * =pacman -update VDT-Updater=

Then make a complete back using one of the following commands:
   * =cp -pr $VDT_LOCATION BACKUP-LOCATION= 
or 
   * =rsync -a $VDT_LOCATION/ BACKUP-LOCATION=
The updater script is going to verify the contents of your backup, so you should have a backup that is a file-level copy of the VDT installation. Do not use tar, for example, to make the backup or else the updater script will not be able to verify the backup for you.
Finally, run the updater script:
   * =vdt/update/vdt-updater=
The update script may ask you some questions, including if you want to run =configure-osg.py=.  If you choose to run that, make sure that you have setup your config.ini file (instructions above).  

If the update completes successfully:
   * If you did not let the updater run =configure-osg.py= for you, run it manually now to finish configuration:
      * =./monitoring/configure-osg.py -v= 
      * =./monitoring/configure-osg.py -c=
   * Verify that the list of services you want to run are enabled:
      * =vdt-control --list=
   * Then turn the services on:
      * =vdt-control --on=


---+++++ Updating manually (Not recommended)
In order to update manually, you'll need to follow the [[http://vdt.cs.wisc.edu/releases/1.10.1/release-v-manual.html][instructions]] provided by the VDT team.  Due to the complexity and the opportunity for error, we don't recommend using this method. Again, this is a process for updating from OSG 1.0.0 not from OSG 0.8.

Run the following commands to finish the configuration.  The first command will validate your configuration in the config.ini file, the second command will apply the configuration.
   * =./monitoring/configure-osg.py -v= 
   * =./monitoring/configure-osg.py -c=

Once the update procedure has been completed, turn the services back on:
   * Verify that the list of services you want to run are enabled:
      * =vdt-control --list=
   * Then turn the services on:
      * =vdt-control --on=

---++ Known issues

---++ More information
   * [[http://vdt.cs.wisc.edu/releases/1.10.1/release-v.html][VDT update instructions]]

%STOPINCLUDE%
%BR%
%COMPLETE2% %BR%
%RESPONSIBLE% Main.SuchandraThapa - 22 Apr 2009 %BR%
%REVIEW%

%META:TOPICMOVED{by="KyleGross" date="1240497198" from="ReleaseDocumentation.AprUpgradeInstructions" to="ReleaseDocumentation.UpgradeInstructions"}%
