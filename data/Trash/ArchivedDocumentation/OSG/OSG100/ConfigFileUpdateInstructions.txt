%META:TOPICINFO{author="BrianBockelman" date="1486490145" format="1.1" version="1.7"}%
%META:TOPICPARENT{name="UpdateInstructions"}%
---+!! *<nop>%SPACEOUT{ "%TOPIC%" }%*
%TOC%



---++ Introduction
Instructions on moving from the config.ini distributed from the osg 1.0.0 release to the new syntax supported by the configure-osg and GIP in the osg 1.0.1 release.


%NOTE%  =Configure-osg.py= supports the config.ini syntax and options that were present in the osg 1.0.0 release.  You should be able continue to use that file without any changes. 

---++ Changes
The changes between the two ini files are primarily in the removal of the FBS configuration section and the restructuring of the GIP options.  The subcluster and storage information in the GIP section has been removed and move to separate sections.  

In addition, support for the syslog_ng option in the =Misc Services= section has been removed since the central syslog-ng collector is no longer present.  Finally, the =Local Settings= section is now parsed and used to generate the =osg-local-job-environment.conf= file correctly so you will need to move your settings from the =osg-local-job-environment.conf= to your =config.ini= if you've made changes in that file.

---++ Migrating Settings
The vast majority of the options and sections remain the same between the different versions of the file so you'll be able to just cut and paste those sections.  In order to migrate between the two formats you'll need to do the following:
   * Make a backup of your =config.ini= file
   * Copy your =config.ini= to =config-working.ini=
   * Delete the =FBS= section from =config-working.ini= 
   * Remove the the =use_syslog_ng= option from =Misc Services= section
   * If you have any paths in your configuration file, change them to point to the location of the current installation

---+++ Setting up the Local Settings section
If your site defines environment variables in the =osg-local-job-environment.conf= file, you will need to copy them to the =Local Settings= section.  In order to do this, you'll need to follow the steps below:
   * create a =Local Settings= section if one does not exist in your =config-working.ini=
   * for each entry ( variable="value" ) in =osg-local-job-environment.conf=, create the corresponding entry in this section (e.g. variable = value)

---+++ Setting up the GIP Section
In order configure the =GIP= section, you should:
   * Copy the =GIP= section from the =config.ini.new= file to =config-working.ini= 

Then, you'll need to fill in the values for the following four options in the =GIP= section:
   * batch 
   * advertise_gsiftp
   * gsiftp_host
   * advertise_gums
You can put in the same values for these settings that you have in your old =config.ini= file.

---+++ Configuring Subclusters
First, you'll need to:
   * Copy the =Subcluster CHANGEME= section from the =config.ini.new= file to =config-working.ini= 
Then
   * Using the =config.ini= as a reference:    
      * Convert the =sc_*_n= (here n is an integer) references to =Subcluster= sections 
      * For example, for the =sc_*_1= options given below:
<pre class="screen">
sc_name_1 = Main
sc_vendor_1 = AMD
sc_model_1 = Dual Core AMD Opteron(tm) Processor 285
sc_clock_1 = 2592
sc_numlcpus_1 = 1
sc_numpcpus_1 = 2
sc_ramsize_1 = 2048
sc_inbound_1 = False
sc_outbound_1 = True
sc_nodes_1 = 10
</pre>
The corresponding =Subcluster= section would be
<pre class="screen">
[Subcluster MySubCluster]
name = MySubCluster
node_count = 10
ram_mb = 2048
cpu_model = Dual Core AMD Opteron(tm) Processor 285
cpu_vendor = AMD
cpu_speed_mhz = 2592
cpus_per_node = 2  # the number of sockets in the node
cores_per_node = 8 # the total number of cores in a node
inbound_network = FALSE
outbound_network = TRUE
</pre>

%NOTE% The subcluster names must be globally unique.  
For more information about subclusters see: [[https://twiki.grid.iu.edu/bin/view/Trash/ReleaseDocumentationComputeElementInstall#GIP_Subcluster_Configuration][GIP Subclusters]]
---+++ Configuring Storage Elements
If you don't have any SEs or don't wish to set them up, you can skip this section, otherwise
   * Copy the =SE CHANGEME= section from the =config.ini.new= file to =config-working.ini=
Then 
   * Change the CHANGEME to the name of the SE (this name must be globally unique)
   * Set =name= to the same name as above
   * Set =srm_endpoint= to the endpoint of your srm node (e.g. httpg://srm.unl.edu:8443/srm/managerv2)
   * Set =provider_implementation= to static
   * Set the =implementation= to either bestman, dcache, or dcache19 depending on whether the se is using bestman, dcache, or dcache 1.9.x
   * Set the =version= to the version of the software that the SE is running
   * Set =default_path= directories that VOs should use for storage. The string =VONAME= in this path is replaced with the VO's name (e.g. =/pnfs/unl.edu/data4/VONAME= means that cdf would have a path of =/pnfs/unl.edu/data4/cdf=)
 
For more information on configuring Storage Elements, specifically Bestman and dCache, see [[https://twiki.grid.iu.edu/bin/view/Trash/ReleaseDocumentationComputeElementInstall#GIP_SE_Configuration][GIP Storage Elements]]
---++ Finishing up
Once you've completed the following, you should move =config-working.ini= to =config.ini= and then run:
   * =configure-osg.py -v= 
to make sure that there isn't anything wrong.  If no errors are given, you can then run
   * =configure-osg.py -c=
to configure your system and use the new configuration.

---++ Known issues
   * None

---++ More information
   * None


%BR%
%COMPLETE2% %BR%
%RESPONSIBLE% Main.SuchandraThapa - 27 Apr 2009 %BR%
%REVIEW% Main.KeithJackson - 21 Jul 2009 %BR%
%REVFLAG% %X% %BR%

---++ *Comments*
%COMMENT{type="tableappend"}%