%META:TOPICINFO{author="BrianBockelman" date="1486500432" format="1.1" version="1.24"}%
%META:TOPICPARENT{name="Trash.ReleaseDocumentationComputeElementInstall"}%
<!-- REVIEW PROCESS

   <!-- OWNER: please define the Document Role -->
   * Local DOC_ROLE		  = SysAdmin
   
   <!-- OWNER: please define the Document Type -->
   * Local DOC_TYPE		  = Knowledge
   
   <!-- OWNER: please define the Document Area -->
   * Local DOC_AREA               = ComputeElement

   <!-- OWNER: please edit! -->
   * Local OWNER                    = MineAltunay
   * Local INCLUDE_REVIEW  = %TRUE%
   * Local INCLUDE_TEST   = %FALSE%
   * Local REVIEW_READY   = %TRUE%
   * Local TEST_READY     = %FALSE%
   * Local RELEASE_READY  = %FALSE%

   <!-- REVIEWER: please edit the section below (%UNDEF% = 'in progress', %TRUE% = 'passed', %FALSE% = 'failed') -->
   * Local REVIEWER       = RobertEngel
   * Local REVIEW_PASSED  = %UNDEF%
 
   <!-- TESTER  : please edit the section below (%UNDEF% = 'in progress', %TRUE% = 'passed', %FALSE% = 'failed') -->
   * Local TESTER         = JamesWeichel
   * Local TEST_PASSED    = %UNDEF%
      
-->

---+!! *<nop>%SPACEOUT{ "%TOPIC%" }%*
%TOC%

---++ Authorization overview
You'll need to determine the authorization mode you wish to implement.  The authorization mode determines who can access your resources and how.  OSG supports three scenarios: 
   * [[#Local_grid_mapfile][Grid3/Local]] (does not use GUMS)
   * [[#Compatibility][Compatibility]]
   * [[#Full_Privilege][Full Privilege]].  

The flowchart and brief sections below will help you decide the appropriate configuration for your CE.
%NOTE% In order to run in Compatibility or Full Privilege mode, a GUMS server must be installed at your site.  Installation and configuration instructions are available in the [[Trash.ReleaseDocumentationInstallConfigureAndManageGUMS][Install Configure and Manage GUMS topic]].  For additional background information, see [[Documentation/UserAuthAndPrivilege][An Introduction to User Authorization and Privilege in OSG]].


<pre class="programlisting">            
  ---------------------------------                    
  | Is your site going to support |    YES  
  |  role-based authorization?    |------------> Full privilege configuration
  ---------------------------------                   
                 |                                           
              NO |
                 |
  ---------------------------------               
  | Do you want to use account    |     YES    
  |    pools at your site?        |------------> Compatibility configuration
  ---------------------------------  
                 |                                           
              NO |
                 |
  ---------------------------------   
  |   Would you like to use one   |     YES 
  |    gridmap file to control    |------------> Compatibility configuration
  |      all your gatekeepers?    |               
  ---------------------------------               
                 |
              NO |
                 |
                 V
     Local grid-mapfile configuration
</pre>


---++ Local grid-mapfile 
Authorization is performed only via the grid-mapfile on the CE host.  The grid-mapfile is either created manually or by using the =edg-mkgridmap= root cron entry.  This cron uses a configuration file =edg-mkgridmap.conf=, located in =$VDT_LOCATION/edg/etc=.  The =edg-mkgridmap.conf= file is installed by a VO package and can be used to add or update VO information.  The OSG Operations sends announcements regarding this package VO support centers and to the =osg-sites@opensciencegrid.org= mailing list.    A GUMS server is not used in this mode.

If a site operates multiple CE's, then manual synchronization of the grid-mapfiles is required.  You may prefer this configuration if:
   * You operate a small site (one gatekeeper) 
   * You deal with a small set of semi-static VOs
   * You are *not* supporting  *role-based* authorization (VOMS proxies with extended attributes)

See [[Trash.ReleaseDocumentationLocalAuthPreConfig][local grid-mapsfile web page]] for more details.

---++ Compatibility
Authorization is performed via the grid-mapfile on the gatekeeper, but the grid-mapfile is created using a GUMS server for the site.    A GUMS server will poll various VOMS servers periodically and will create and/or update the grid-mapfile.  If the site has only one GUMS server (one communication point to a set of one or more VOMS servers), centralized mapping is enabled.  Given the GUMS configuration options, account pools (many accounts, one-to-one DN-to-account mapping) can be implemented as well as group accounts (many-to-one DN-to-account mapping).  You should consider this configuration if:
   * Your gatekeeper(s) or service must be configured using a grid-mapfile (i.e., you have tools or services that manipulate this file directly, without passing through Globus)
   * You want the update features a GUMS service brings, but don't necessarily want to depend on 24x7 availability of this service (required for Full Priviledge mode, below).
   * You are *not* supporting  *role-based* authorization (VOMS proxies with extended attributes)

See [[Trash.ReleaseDocumentationCompatibilityAuthPreConfig][compatibility mode web page]] for more details.

---++ Full Privilege  
This scenario uses (an always available) GUMS service and *does not* use a grid-mapfile.   The Gram or !GridFTP gatekeepers  callout to the PRIMA module upon receipt of each request, PRIMA forwards the request to the GUMS service which performs the dynamic mapping.  PRIMA can process _Fully Qualified Attribute Names_ (FQAN), thus enabling DN to Unix account mapping based on VO groups and roles as defined in a VOMS server by a VO administrator.  Note:
   * In Full Privilege mode, the GUMS service must always be available.
   * A single GUMS service providing identity mapping services for a number of CEs at a site becomes a single point of authentication failure, therefore care must be taken to monitor the health of the host and availability of the service.   In this case a fail over server may be desirable, but there are additionally monitoring services provided. 

See [[Trash.ReleaseDocumentationFullPrivPreConfig][Full Privilege web page]] for more details.

%STOPINCLUDE%
%BR%
<!--
Main.JohnWeigand - 06 Nov 2007 - changed parentage%BR%
-->

%COMPLETE2% %BR%
%RESPONSIBLE% Main.MineAltunay  %BR%
%REVIEW% Main.JohnWeigand - 20 Jul 2009 %BR%
%REVFLAG% %X%  %BR%

%META:TOPICMOVED{by="AnneHeavey" date="1192833710" from="Integration/ITB_0_7.AboutOsgAuthorizationForCE" to="Integration/ITB_0_7.AboutAuthorizationForCE"}%
