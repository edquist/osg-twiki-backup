%META:TOPICINFO{author="KyleGross" date="1225985930" format="1.1" version="1.11"}%
%META:TOPICPARENT{name="DocumentationTable"}%
%LINKCSS%

---+!! %SPACEOUT{ "%TOPIC%" }%

%TOC{depth="2"}%

---++ Introduction
This section provides recommendations for the definitions and environment variables for the Local Storage accessible to Compute Elements on OSG. It covers the definition of these spaces and correspondences to external schemas (e.g. GLUE, Grid3/OSG).

The paths defined with the names below are sometimes also called _CE storages_. They are disk spaces or SEs accessible from within the CE. <!-- (the same from each jobmanager of that CE: jobs on the headnode using _fork_, jobs on the worker nodes usong _pbs/condor/lsf/..._, multiple gatekeeper added to the same CE for reliability or scalability reasons will have to have the same values). -->

The keyword <i>UNAVAILABLE</i> will be provided instead of the path when the CE is not supporting a particular CE storage, distinguishing an unconfigured site from one which provides support for only certain CE storages.
The values provided do not refer to any disk space as viewed from outside (SE, !GridFTP server, ...).

<!-- In this document there are some suggestions on how to encourage proper use and deployment (how to make this information available), but in general this is the responsibility of other groups in OSG.
-->
Possible technologies to deploy CE storage include (but are not limited to):
   1. Variables defined in the environment that resolve to the correct path or URL
   2. Path or URLs consistent across the CE (headnodes and WN), published using information provider (e.g. GIP/BDII)
   3. *%RED%DEPRECATED%ENDCOLOR%* !GridCat

Solutions 2 and 3 may involve a lookup to the information system that can be done before submitting the job (in that case the job will carry along the information to be able to use the CE).

<!-- This page has a sister page, LocalStorageRequirementsDiscussion, that includes the discussion that led to this document. Please read it and feel free to add your ideas to that page if you are interested in proposing changes.
-->

LocalStorageConfiguration provides installation/configuration notes and examples. UsingLocalStorage contains best practices, notes and examples for _end users_.

In the following table there is a name matrix:
   * CE Storage corresponds to the names in this document and the variables in =osg-attributes.conf=
   * GLUE is the attribute name as in GLUE Schema 1.2 (The same attribute may appear in more than one place in the Schema)
   * Grid3/OSG is the LDAP attribute name as in Grid3 Schema
%EDITTABLE{ format="| text, 25, | text, 50, | text, 30, | textarea, 2x50 |" header="| *CE Storage* |*GLUE*|*Grid3/OSG*|*Description*|" }% 
| *CE Storage* |*GLUE*|*Grid3/OSG*|*Description*| 
| [[#About_OSG_GRID][OSG_GRID]]  | Location.Path <sup>[[#Foot2Table1][(2)]]</sup> | Gri3Dir | Read-only area for OSG worker node's client software |
| [[#About_OSG_APP][OSG_APP]] | <nop>CE.Info.ApplicationDir (!CE.Info.ApplicationDir) <sup>[[#Foot1Table1][(1)]]</sup>  | Gri3AppDir | VirtualOrganizations/VOInfo-wide software installations |
| [[#About_OSG_DATA][OSG_DATA]] | <nop>CE.Info.DataDir (!CE.VirtualOrganizations/VOInfoView.DataDir) <sup>[[#Foot1Table1][(1)]]</sup> | Gri3DataDir | Transient storage shared between jobs executing on the worker nodes |
| [[#About_OSG_SITE_READ][OSG_SITE_READ]]  | Location.Path <sup>[[#Foot2Table1][(2)]]</sup> | | Transient storage visible from all worker nodes and optimized for high-performance read operations |
| [[#About_OSG_SITE_WRITE][OSG_SITE_WRITE]] | Location.Path <sup>[[#Foot2Table1][(2)]]</sup> |   | Transient storage visible from all worker nodes and optimized for high-performance write operations |
| [[#About_OSG_WN_TMP][OSG_WN_TMP]] | CE.Cluster.<nop>WNTmpDir (!CE.SubCluster.WNTmpDir) | | Temporary work area that may be purged when the job completes |
| [[#About_OSG_DEFAULT_SE][OSG_DEFAULT_SE]] | CE.Info.<nop>DefaultSE (!CE.VirtualOrganizations/VOInfoView.DefaultSE) |  | Storage Element closely related to the CE, only accessible using SE access methods |

   1. <a name="Foot1Table1"></a>As visible from the table above, GLUE provides the possibility to have multiple values for some of the CE storage, depending on the VirtualOrganizations/VOInfo and the Role (VirtualOrganizations/VOInfoMS FQAN). In OSG these are currently sitewide information.<br>
   1. <a name="Foot2Table1"></a>The GLUE Schema does not have an specific attribute for SITE_WRITE or SITE_READ, but it provides the location entity (Name/Version/Path sets) to accommodate additional CE local storage. In order to accommodate that, two locations will have to be defined through the GIP:
      1. !LocalID: GRID+OSG, Name:GRID, Version: OSG, Path: <value of GRID>
      1. !LocalID: SITE_WRITE+OSG, Name:SITE_WRITE, Version: OSG, Path: <value of SITE_WRITE>
      1. !LocalID: SITE_READ+OSG, Name:SITE_READ, Version: OSG, Path: <value of SITE_READ>

Each CE administrator will provide for the correct functioning of the client software (Globus and SRM: access to the users proxy, gass_cache mechanism) for all the jobs running on the CE.  Common practice is to use a shared $HOME directory, but the administrator is free to use other mechanisms transparent to the users. Users should have no other assumption about the CE different from what is stated in this document. It is unsafe to make assumptions about the existence and characteristics (size, being shared, ...) of the $HOME directory. In particular, site admins are free to deploy configurations that do not include any NFS exports from the CE, e.g. as described in [[http://osg-docdb.opensciencegrid.org/cgi-bin/ShowDocument?docid=382][OSG document 382]].

The following sections describe the different storage areas that may be declared local to a CE. Each section includes:
   * brief description
   * detailed description
   * use cases (informal)
   * notes

---++ Known Problems
None.


---++ OSG_GRID
%INCLUDE{ "AboutStorageAreaOsgGrid" }%


---++ OSG_APP
%INCLUDE{ "AboutStorageAreaOsgApp" }%


---++ OSG_DATA
%INCLUDE{ "AboutStorageAreaOsgData" }%


---++ OSG_SITE_READ
%INCLUDE{ "AboutStorageAreaOsgSiteRead" }%


---++ OSG_SITE_WRITE
%INCLUDE{ "AboutStorageAreaOsgSiteWrite" }%


---++ TMP *%RED%[OBSOLETE!]%ENDCOLOR%*
%INCLUDE{ "AboutStorageAreaTmp" }%


---++ OSG_WN_TMP
%INCLUDE{ "AboutStorageAreaOsgWnTmp" }%


---++ OSG_DEFAULT_SE
%INCLUDE{ "AboutStorageAreaOsgDefaultSe" }%


#MandatorySetOptions
---++ Mandatory Set Options
An OSG site is not required to provide all of the areas described above. However, the site must implement at least one of the options below. Providing a wider selection of CE storages would allow the jobs to select the most proper for their needs, but may also allow the jobs to adopt inefficient execution models that could reduce the performance of the whole cluster.

See LocalStorageConfiguration for installation/configuration notes and examples.

Areas that are not provided should be labelled as "UNAVAILABLE".


<a name="Grid3Model"></a>
---+++ OSG_GRID, OSG_APP, OSG_DATA, OSG_WN_TMP  (Grid3 model)
%INCLUDE{ "GridThreeModel" }%


<a name="Grid3ModelWithReadWriteInsteadOfData"></a>
---+++ OSG_GRID, OSG_APP, OSG_SITE_READ, OSG_SITE_WRITE, OSG_WN_TMP
%INCLUDE{ "GridThreeModelWithOsgSiteRead" }%


#LcgModel
---+++ OSG_GRID, OSG_APP, OSG_DEFAULT_SE, OSG_WN_TMP  (LCG model)
%INCLUDE{ "LcgModel" }%


#SrmDcacheModel
---+++ OSG_GRID, OSG_APP, OSG_SITE_READ, OSG_DEFAULT_SE, OSG_WN_TMP  (SRM/dCache model)
%INCLUDE{ "SrmDcacheModel" }%


%STOPINCLUDE%

%INCLUDE{ "Documentation.ToolsBottomMatter" }%
<!-- For significant updates to the topic, consider adding your 'signature' (beneath this editing box) -->

<!--Future editors should add their signatures beneath yours -->
-- Main.BurtHolzman - 04 Aug 2005 %BR%
-- Main.MarcoMambelli - 23 Sep 2005 %BR%
-- Main.FkW - 25 Apr 2006 %BR%
-- Main.RobQ - 01 May 2006 %BR%
-- Main.ForrestChristian 13 Nov 2006  %BR%

%META:TOPICMOVED{by="ForrestChristian" date="1164649645" from="Integration/ITB_0_5.RequirementsForLocalStorage" to="Integration/ITB_0_5.LocalStorageRequirements"}%
