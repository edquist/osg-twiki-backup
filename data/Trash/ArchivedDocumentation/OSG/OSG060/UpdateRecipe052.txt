%META:TOPICINFO{author="AlainRoy" date="1171667876" format="1.1" version="1.6"}%
%META:TOPICPARENT{name="WebHome"}%
---++Updating an ITB 0.5.2 Installation to use VDT 1.6.1a

These instruction assume you did the original installation as root and will be preforming the update as root.

We tried very hard to have the update procedure "just work" with pacman -update. We can't just do a pacman -update because of some bugs in the VDT, so we have a script to run before and after the update procedure. In at least one case, the update still failed in hard to detect ways. We're frustrated, but also want to get the update out to you. 

So here is the deal: we would like you to try the update procedure and see if it works. If it does, let us know (email to the osg-int mailing list is good). If it doesn't work, then you'll have to install from scratch. We're sorry for the complex procedure, but we would like to try this out. The ITB is like the wild west!

---+++ Procedure 1: The Pacman update

   * Back Up the Previous Install

=# cp -p -r $VDT_LOCATION /some/backup/directory=

=# cd $VDT_LOCATION=

=# source setup.sh=

   * Shutdown VDT Services

=# vdt-control --off=

   * Prepare and Install the Update

=# wget= http://vdt.cs.wisc.edu/releases/1.6.1/vdt-update-helper.sh

=# chmod 0755 vdt-update-helper.sh=

=# ./vdt-update-helper.sh pre=

=# pacman -update -v download pac=

=# ./vdt-update-helper.sh post=

   * Look at the shell output from the previous commands. Do you see "failed" anywhere? If so, it failed, skip to Procedure 2. 

   * Look at your setup.sh. Is MonaLisa_HOME defined? Is GLITE_LOCATION defined? If either of these is missing, it failed. Skip to Procedure 2.

   * Rerun configuration

=# cp monitoring/osg-attributes.conf.old monitoring/osg-attributes.conf=

=# $VDT_LOCATION/monitoring/configure-osg.sh=

   * Restart VDT Services

=# vdt-control --on=

*NOTE:* If you have made any unique changes to /etc/xinetd.d/globus-gatekeeper and /etc/xinetd.d/gsiftp these will need to be redone. 

   * Run site_verify.pl to make sure your site looks good. 
d53 1
---+++ Procedure 2: The Fresh install

%NOTE% Only do Procedure 2 if Procedure 1 failed. If it failed for any reason, do Procedure 2. 
Only do Procedure 2 if Procedure 1 failed. If it failed for any reason, do Procedure 2. 

   * Define OLD_VDT_LOCATION to point at the backup you made earlier. For instance, if you're using bash and you backed up to /usr/local/grid.backup, then:

=# export OLD_VDT_LOCATION=/usr/local/grid.backup=

   * Switch into the location you want the vdt (pretend it's /usr/local/grid), and blow everything away

=# cd /usr/local/grid=

=# rm -rf *=
   * Install the OSG according the CE install guide. The difference here is that you defined OLD_VDT_LOCATION, so it will preserve some of your configuration.
   * Install the OSG according to the CEInstallGuide. The difference here is that you defined OLD_VDT_LOCATION, so it will preserve some of your configuration.

d75 1
-- Main.RobQ - 14 Feb 2007 %BR%
-- Main.RobQ - 14 Feb 2007
