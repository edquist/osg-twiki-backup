%META:TOPICINFO{author="JoseCaballero" date="1248809594" format="1.1" reprev="1.54" version="1.54"}%
%META:TOPICPARENT{name="OSGIndividualEffortReports"}%
-- Main.JoseCaballero - Started in October 2008
---+ Effort Reports from Jose Caballero
%TOC%
---++ 2008   
---++ 2009
---+++ 1st quarter
---++++ January 2009
   * First week on vacations.

   * Panda Data Movement:
      * Check if LFC python API is imported in script pdm_file_register.py, avoiding using it to register checksum and filesize in LFC catalog when the library is not available. New error code to raise an exception when users try to register checksum and filesize but the API cannot be imported.
      * Allowing specify several pilot DNs at a time to delegate end users proxies to a myproxy server from pathena.
      * Studying to configure the myproxy-server to allow retrieval based on FQAN, instead of using option -Z with myproxy-init.
   
   * gLExec and !MyProxy integration into Panda:
      * Studying how to split runJob.py into three scripts (one for stage-in, one to run athena, one for stage-out) so each part can be run under gLExec or not separately, as a site policy.

   * Outreach Activities:
      * Preparation for the workshop in Chile, as member of the outreach and education team. Learning the lessons, testing the exercises, testing the software and tools installed on the workshop machine....
      * Trip to Chile. 
      * Writing to Ruth and people from the Outreach team my feedback and feelings after the trip to Chile. Translation into English the comments from the students (written in Spanish).
      * Starting with the translation into Spanish of the documentation for training courses.

   

---++++ February 2009

   * Panda Data Movement:
      * Edition of the Panda Data Movement wiki page.
      * pdmUtils.py created containing common classes and function for the pdm scripts. The content of errors.py has been moved also into pdmUtils.py
        Twiki updated acordingly
      * Refactorization of the code to make it more readable, easier to maintain, more scalable, and more consistent with the operations performed.
      * Started the development of a script pdm_get.py to recover information registered in the LFC catalog.
  
   * gLExec and !MyProxy integration into Panda: 
      * Preparing poster for CHEP'09.
      * Studing how to split runJob in three processes (stagein, payload, stageout). 
      * Studing what people in EGEE are doing with gLExec and its integration with SCAS. 
      * Phone meetings (19 Feb, 26 Feb)
      * Testing gLExec/SCAS installation at Gridka.

   * Outreach activities: 
      * Translation from English into Spanish of the material for training courses (work in progress).

   * Clound Computing:
      * Reading some documentation.

---++++ March 2009
   * First week on the OSG All Hands Meeting at LIGO: attending talks and arranging private meetings (Alina, Igor, Mine, and Alan Roy)

   * gLExec and !MyProxy integration into Panda:
      * Finishing the testing of the gLExec/SCAS installation at !Gridka, to check if problems with expired voms attributes have been already fixed. 
      * Implementing comments from authors in the poster for CHEP.        

   * Outreach Activities:
      * Phone meeting with Alina Bejan and people from Colombia to start the organization of a workshop in Colombia in August/September. 
      * Reading the document the Outreach Team has about how to organize a workshop. Looks like Ruth wants I am in charge of the whole organization of an event in Brazil and a following up event in Chile, with Alina helping me, instead the opposite.

   * ATLAS Software and Computing Workshop at CERN.
      * Attending presentations.
      * Meeting with Charles Waldman on Tuesday to discuss about his HTTPS LFC interface. We found a few weak points in his design. We discusses about several improvements. He agrees I include his interface in my generic catalog interface, and I have offered him my web based read-only interface (the one I made with django). He liked it and probably will include my code in his project.
      * Meeting with Paul Nilsson on Tuesday to teach me about the structure of pilot code, and to give me some tasks to do. 
      * Meeting with SCAS people on Tuesday (Massimo, Antonio Retico, and Gianni Pucciani), requested by me and scheduled by Massimo. Attending, this time in person, on Friday, the regular SCAS/gLExec meeting. 
      * Report of my tests of th gLExec installation at GridKa during the distributed analysis session.

   * CHEP at Prague

   * !PanDA/pilot:
      * Started cleaning up the pilot wrappers code (suggested by Paul Nilsson): deleting orphan variables and orphan functions, deleting commented out lines, removing global variables when not needed, splitting long functions in several short functions, sorting lists, etc...

---+++ 2nd quarter
---++++ April 2009
   * gLExec and !MyProxy integration into Panda:
      * Writing the proceedings for the CHEP
      * Phone meetings with EGEE people (about SCAS/gLExec installation): still problems with installation in !IN2P3, UK sites are going to collaborate.
      * Changes in the myproxyUtils.py interface: 
         * bugs fixing
         * allowing DN with parentheses to avoid the !MyProxy servers reads them as regexp syntax
         * allowing a list of DNs instead of a single DN as authorized retrievers.

   * !PanDA/pilot:
      * More cleaning up the wrappers pilot code [thinPilotWrapper.sh, !ProdPilotThin.py, trans-atlasprod-thin.sh] 
      * Implementing the code to pick up randomly (99%-1%) one package from libcode [trans-atlasprod-thin.sh]
      * Merge of !ProdPilotThin.py and trans-atlasprod-thin.sh in one single script

   * !Panda/USATLAS:
      * Attending some sessions of the US workshop at BNL on Apr 14th and 15th

   * !Panda/monitoring:
      * Phone meeting to discuss about the Alexei's students ideas. 

   * Outreach Activities:
      * Communication with Julio Ibarra and Heidi Alvarez, from the University of Chicago, to find out how to get funding for the workshop in Colombia. They propose to use the program NSF/PASI, but the deadline is 15th January. 
      * Trying to clarify my responsibilities, with no success. 

---++++ May 2009
   * gLExec and !MyProxy integration into Panda:
      * Finishing the refactorization of the code.
      * Enhancing the documentation.
      * Periodical retrieval implemented as a thread. That solution is the safer one: if the parent process dies the child dies also; that avoid having a process working forever on the WN retrieving proxies which can be stolen by bad guys.
      * Phone meetings with EGEE people about SCAS/gLExec installation.
      * Proceedings submitted to Journal of Physics.
      * Testing the installation at Lancaster. Complicate. A lot of problems. Many emails between Peter Love, Oscar Koeroo, Maarten and myself. Problems also to delegate proxies from BNL when environment variable !GT_PROXY_MODE is setup with value "old".
      * Contacting Jim Basney and Alain Roy to find out when the new version of !MyProxy client will be released officially (new versions fix problems during delegation when !GT_PROXY_MODE is set up to old). 
      * Working with Paul Nilsson to split runJob.py into three different modules (for stage-in, run the payload, stage-out)

   * Outreach Activities:
      * Trying to find out how to fund longing for students in a possible workshop in Colombia.
      * Contact with Chilean people to see if there is interest in a follow-up workshop. They say "yes".
      * Commenting with Jim Shank the option of supporting partially a workshop in Colombia by ATLAS. 

   * !PanDA/monitoring:
      * Phone meeting to discuss about the Alexei's students work
      * Re-creating the structure in /panda-monitor/ directory within the svn repository to allocate the new code developed by Dmitry.
      * Directory branches/ created in svn.

   * !PanDA/pilot:
      * Removed warning messages when command `which python32` and `which voms-proxy-info` fail. Users have complained a lot about these messages.
      * Removed old not needed files from svn. 

   * !PanDA Data Movement:
      * Subdirectory for pdm scripts created in the repository. 
      * A new project (including the whole structure: current/ and tags/ directories, (empty) config files for guidance, etc.) created in the svn repository. 
      * Testing the data-host project. 
      * Directory branches/ created in svn

---++++ June 2009
   * !PanDA:
      * cleaning up the svn repository: 
         * old not used projects tags/ and branches/ removed
         * non standard config files removed from some projects
         * new project panda-pilot/ created,  and whole content from pilot3/  migrated. 
         * old project osgddm/ removed; we are already using panda-osgddm/.
         * content of panda-osgddm/ split into two subprojects:  osgddm-client/ and osgddm-server/. Also osgddm-common/ created, just in case we need it in the future. Two sets of setup files (for packaging and distribution) created, so far empty (they have to be filled).
      * Some improvements in the autopilot wiki page. 

   * !PanDA Data Movement:
      * Testing the data-host project. Proposing improvements. 
      * I have repeated the installation, but using sqlite3 instead of mysql as backend database. It works fine. 

   * Outreach activities:
      * A lot of emails with the Colombian people. 
      * I have contacted Marta Losada (coordinator of ATLAS-Colombia), and put her in contact with Jim Shank. 
      * We have started to discuss about calendar and schedule for the workshop in Colombia.

   * gLExec and !MyProxy integration into !PanDA:
      * More tests at Lancaster and !GridKa, trying to understand why they fail (again problems with expired VOMS attributes). Discussion with Oscar Koeroo and Maarten Litmaath about this. 
      * Trying to find out ways to bypass this problem in the meanwhile (regenerating the voms attributes on the WN in a safe way). Testing the Tadashi's proposal, with no success. 
      * Setting !GT_PROXY_MODE='old' on the WN (if needed) before the retrieval, and unsetting it after the retrieval.  
      * Testing the scripts that Nikhef guys have written to pack and unpack the environment. They don't work since they need a non-standard PERL library. Anyway, I don't like them due their lack of flexibility. 
      * Testing the new pilot code, and trying to split it into two processes (stagein+payload and stageout).

---+++ 3rd quarter
---++++ July 2009
 
   * !PanDA:
      * Testing recipe http://code.activestate.com/recipes/576704/ to reduce the size of the pilotcode tarball.
      * Fixed bug in pilot wrapper throwing a harmless error message when g++32 is not on the WN. 
      * new project in svn created, with the whole structure and (empty to be filled asap) packaging and distribution files:
          <verbatim>
              /svn/panda/common-utils/
                                 |
                                 |----  tags/
                                 |
                                 |----  branches/
                                 |
                                 |----  current/
                                          |
                                          |---- commonutils/
                                          |
                                          |---- INSTALL.txt
                                          |---- MANIFEST.in
                                          |---- README.txt
                                          |---- setup.cfg
                                          |---- setup.py
         </verbatim>
      * Some modules added to common-utils:
         * Patterns.py: with a class to handle threads (so far just for periodical tasks), a class to perform command line operations. 
         * pyminifier.py: copied from recipe http://code.activestate.com/recipes/576704/

   * gLExec and !MyProxy integration into !PanDA:
      * Regular phone meetings with EGEE people.
      * More tests at Lancaster. Finally they work. Problems with expired VOMS attributes fixed.    
      * Still trying to split runJob.py into two modules. Problem: forking implementation in the pilot framework. Replacing execvpe() by os.system() + sys.exit() does not work. 
      * Script multipleTestJobs.py created to perform a loop over /home/sm/nilsson/subversion/offline/Production/panda/testJob.py in order to submit more than one single job to a given queue/cloud. 

  * Other activities:
      * CHEP09: 
         * reviewing the article I am referee of. 
      * Software development:
         * modifying argparse to raise my own exceptions and to split options between several namespaces
