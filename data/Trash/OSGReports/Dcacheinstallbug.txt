%META:TOPICINFO{author="GregorySharp" date="1185388380" format="1.1" reprev="1.2" version="1.2"}%
%META:TOPICPARENT{name="GregSharp"}%
In install_postgres.sh of the vdt dcache release 1.1.8 and 1.1.9, in the function post_install_postgres() there are two problems.

1. At line 130 it says
     /usr/bin/createuser postgres
This is supposed to be creating a unix user id. Createuser attempts to create a postgres database role, not a unix user id. The required command is /usr/sbin/useradd.

2. cat /etc/passwd | grep postgres >> $logfile will not reliably detect the existence of the postgres unix user id, since most folks use something like yellow pages or nis+.
To detect if the unix id "postgres" exists something like

<code>
user_uid=`id -u postgres 2>/dev/null`<br>
if [ x"$user_uid" = x ] ; then<br>
&nbsp;&nbsp;&nbsp;&nbsp;echo "Creating unix user id postgres..." >> $logfile<br>
&nbsp;&nbsp;&nbsp;&nbsp;/usr/sbin/useradd ...<br>
fi<br>
</code>

is needed. However, you have to ask some questions in advance about the group id and uid to use for postgres. It might be better to ask people to create the postgres unix id in advance, since the choice of home directory, password, etc., requires some consideration.

-- Main.GregorySharp - 27 Jun 2007
