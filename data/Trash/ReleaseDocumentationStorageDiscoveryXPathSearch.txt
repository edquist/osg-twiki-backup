%META:TOPICINFO{author="TedHesselroth" date="1255472323" format="1.1" reprev="1.3" version="1.3"}%
%META:TOPICPARENT{name="OSGStorageDiscoveryTool"}%
---+!! *<noop>%SPACEOUT{ "%TOPIC%" }%*
%TOC%

This utility performs a search on the Open Science Grid BDII using XPath expressions. The command line format of the utility is as follows.

<verbatim>
xpathsearch [-H <PROTOCOL://HOST:PORT>] [-b <BASE>] [options] "xpathexpression"
</verbatim>

Available options:

<verbatim>
 -a,--output_all_ldap_attributes   Output all queried attributes of each
                                   LDAP objectclass
 -action <ACTION>                  action to perform. Choose from-action
                                   evaluate (Evaluate xpath expression.
                                   Default.)-action not_evaluate (Do not
                                   evaluate xpath expression)-action
                                   search (Perform a search over element
                                   and attribute names)
-b <BASE>                          base for LDAP search, e.g.  -b o=grid 
                                   Optional if the environment variable  
                                   LDAP_BASE is set.                     
 -d,--output_ldap_dn               Output the dn of each LDAP objectclass
-H <PROTOCOL://HOST:PORT>          host_uri for search. Example: -H      
                                   ldap://iu.grid.ui.edu:2710            
                                   Optional if the environment variable  
                                   LDAP_URI is set.                      
 -h,--help
 -i,--interactive                  Process the expressions interactively
 -output <OUTPUT>                  output format. Choose from-output list
                                   (Write search results as a line-feed
                                   separated list. Default.)-output xml
                                   (Write search results in xml
                                   format)-output source_xml (Write
                                   intermediate xml from datasource)
 -t,--test                         Run the unit tests
 -u,--use_ldap_aux                 Use auxilary LDAP classes
 -v,--version
</verbatim>

For example

<verbatim>
[xquery]$ xpathsearch -H ldap://is.grid.iu.edu -b o=grid -output_ldap_dn "//GlueSE[@GlueSEUniqueID=\'cit-se2.ultralight.org\']/GlueSA/GlueVOInfo[@GlueVOInfoAccessControlBaseRule=\'engage\']/@GlueVOInfoPath" 2>/dev/null
GlueVOInfoLocalID=engage:default,GlueSALocalID=default,GlueSEUniqueID=cit-se2.ultralight.org,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
/mnt/hadoop/osg
</verbatim>

Note that for the bash shell, single quote marks must be escaped and the whole xpath expression must be in quotes. In this case the "output_ldap_dn" option is used, so that the dn of the parent structural element is printed along with the specified attribute value.

-- Main.TedHesselroth - 30 Jul 2009
