%META:TOPICINFO{author="TanyaLevshina" date="1249305587" format="1.1" reprev="1.1" version="1.1"}%
%META:TOPICPARENT{name="SiteAdminsWorkshopTutorialsAug09"}%
---+!! *<nop>%SPACEOUT{ "%TOPIC%" }%*
%TOC%

%STARTINCLUDE%
%BR%
---+ _%INCLUDEHEADING%  %SPACEOUT{ "%TOPIC%" }%_
The following document is a hands on tutorial on !BeStMan-gateway and Xrootd installation. It is written specifically for [[SiteAdminsWorkshopTutorialsAug09][OSG Site Administrator's Workshop]] (@ the GOC/Indianapolis, Aug 6-7, 2009). The detailed installation guide could be found [[https://twiki.grid.iu.edu/bin/view/ReleaseDocumentation/BestmanGatewayXrootd][here]]. 

%EDITTHIS%
%BR%
---++ Initial assumptions
The following requirements should be met In order to install !BeStMan-gateway and Xrootd:
   1. You will need at least two nodes. You will installed FUSE, !XrootdFS, !BeStMan, !GridFTP-Xrootd and Xrootd redirector on one node (node A)  and !Xrootd data server on another node (node B). 
   1. At least one node should have a host certificate.
   1. You have installed FUSE on one of the node.  FUSE is a kernel module that intercepts and services user requests to the XrootdFS. FUSE can be installed via “yum install” or rpms. You will need three packages:
    * fuse
    * fuse-libs
    * kernel-module-fuse 

You will need to have root access to install it. It is essential that FUSE version ( > 2.7.3) and flavor match your kernel. Contact your sys admin if you have any questions. 
    1. All the software will be installed in /opt directory, storage and cache directory will be located in /data directory.

---++ Pacman installation

On each node do the following:

<pre class="screen"> 
cd /opt
wget http://physics.bu.edu/pacman/sample_cache/tarballs/pacman-3.28.tar.gz
tar xvfz pacman-3.28.tar.gz
</pre>  

---++ !XrootdFS installation
XrootdFS is a Posix filesystem  that allows !GridFTP, !BeStMan and other grid applications to work with Xrootd storage system. !XrootdFS works on top of !FUSE. !XrootdFS can be installed from %CACHE% cache. The installation described here is done as root even though services does not  run as root. On node A do the following
<pre class="screen"> 
cd /opt
mkdir osg_bestman
. pacman-3.28/setup.sh
cd osg_bestman 
pacman -get %CACHE%:XrootdFS 
</pre>

You will be asked the following question:
<pre class="screen"> 
Do you want to add [http://software.grid.iu.edu/osg-1.2] to [trusted.caches]? (y/n/yall): 
</pre>
Answer "yall" and the following output should appear on your screen:

<pre class="screen"> 
Beginning VDT prerequisite checking script vdt-common/vdt-prereq-check...

All prerequisite checks are satisfied.
</pre>
 
 
In order to configure !XrootdFS you will need to do the following: 
<pre class="screen">
cd /opt/osg_bestman
. setup.sh
$VDT_LOCATION/vdt/setup/configure_xrootdfs \
 --user daemon \
 --cache /data/cache \ 
 --xrdr-host nodeA \ 
 --xrdr-storage-path /data/storage;
</pre>
 
Where _$VDT_LOCATION_  is a directory where the package is installed,<br/> 
"daemon" is the user name of the non-privileged user that runs xrootdfs daemon and  is an owner of <br/>
node! is a FQDN of Xrootd redirector host <br/> 
/data/cache is  a !XrootdFS mount point that will be created for you  <br/>
/data/storage is a storage area on redirector node  <br/> 



%STOPINCLUDE%
%BR%
%COMPLETE1% %BR%
%RESPONSIBLE% Main.TanyaLevshina - 03 Aug 2009 %BR%
%REVIEW%
