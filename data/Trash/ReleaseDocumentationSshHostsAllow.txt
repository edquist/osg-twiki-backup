%META:TOPICINFO{author="JimBasney" date="1232120148" format="1.1" reprev="1.1" version="1.1"}%
%META:TOPICPARENT{name="BestPractices"}%
---+ Restricting access to the SSH service

The =/etc/hosts.allow= and =/etc/hosts.deny= files provide simple access control for system services such as SSH.
Allowing access to the SSH service only from trusted hosts is a simple method of protection against SSH-based attacks.

In =/etc/hosts.allow=, add a list of trusted hosts for the =sshd= service:

<verbatim>
#
# hosts.allow	This file describes the names of the hosts which are
#		allowed to use the local INET services, as decided
#		by the '/usr/sbin/tcpd' server.
#
sshd: LOCAL, host1.example.com, host2.example.com
</verbatim>

Then in =/etc/hosts.deny=, configure the =sshd= service to deny connections from all other hosts:

<verbatim>
#
# hosts.deny	This file describes the names of the hosts which are
#		*not* allowed to use the local INET services, as decided
#		by the '/usr/sbin/tcpd' server.
#
sshd: ALL
</verbatim>

Be sure to test your configuration before you close your current terminal session!
