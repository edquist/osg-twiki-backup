%META:TOPICINFO{author="TedHesselroth" date="1248905435" format="1.1" reprev="1.1" version="1.1"}%
%META:TOPICPARENT{name="OpportunisticStorage"}%
---+!! *<noop>%SPACEOUT{ "%TOPIC%" }%*
%TOC%

---++++ Search Scripts

These tools compose command lines for SRM operations based on searches in the OSG BDII.

This is the command line component of the OSG Storage Discovery tool. Links to the project development pages can be found at [[http://cd-97177.fnal.gov:8088/wiki/xpathsearch][XPathSearch Development Site]].

Usage and examples of the tools is as follows.

---+++++ srm_reserve_space

For a given VO, prints a space reservation command line for each supporting site. The space reservation client is the FNAL implmentation.

*Script Name*

srm_reserve_space

*Parameters*
%TABLE{ headerbg="#eeeeee" headercolor="#000000" databg="#ffffff" tableborder="1" columnwidths="120," cellpadding="2" cellspacing="1" dataalign="left" valign="top" sort="off"}%
| *name* | *definition* | *required* |
|  vo | VO Name | yes |
| description | user-supplied description | no |
| requested_size | Size of reservation in bytes | yes |
| guaranteed_size | Size to be guaranteed in bytes | no |
| lifetime | Time to expiration | no |
| storage_element_id | <nop>GlueSEUniqueID | no |
Non-required parameters should be supplied with a value of "".

*Usage*

<verbatim>
srm_reserve_space vo=<VO name> [requested_size=<Size requested>] [description=<Space token description>] [guaranteed_size=<Size to be guaranteed>] [lifetime=<Time to expiration>] [storage_element_id=<GlueSEUniqueID>]
</verbatim>

*Example Output*
<verbatim>
[xquery]$ srm_reserve_space vo=engage description=mydesc requested_size=3000 guaranteed_size=2000 lifetime=1000
srm-reserve-space -space_description=mydesc -desired_size=3000 -guaranteed_size=2000 -lifetime=1000 srm://abitibi.sbgrid.org:8443/srm/managerv2
srm-reserve-space -space_description=mydesc -desired_size=3000 -guaranteed_size=2000 -lifetime=1000 srm://sigmorgh.hpcc.ttu.edu:49443/srm/v2/server.
srm-reserve-space -space_description=mydesc -desired_size=3000 -guaranteed_size=2000 -lifetime=1000 srm://se01.cmsaf.mit.edu:8443/srm/managerv2
srm-reserve-space -space_description=mydesc -desired_size=3000 -guaranteed_size=2000 -lifetime=1000 srm://cit-se.ultralight.org:8443/srm/managerv2
srm-reserve-space -space_description=mydesc -desired_size=3000 -guaranteed_size=2000 -lifetime=1000 srm://cit-se.ultralight.org:8443/srm/managerv2
srm-reserve-space -space_description=mydesc -desired_size=3000 -guaranteed_size=2000 -lifetime=1000 srm://cit-se2.ultralight.org:8443/srm/v2/server
srm-reserve-space -space_description=mydesc -desired_size=3000 -guaranteed_size=2000 -lifetime=1000 srm://ff-se.unl.edu:8443/srm/v2/server
srm-reserve-space -space_description=mydesc -desired_size=3000 -guaranteed_size=2000 -lifetime=1000 srm://fndca1.fnal.gov:8443/srm/managerv2
srm-reserve-space -space_description=mydesc -desired_size=3000 -guaranteed_size=2000 -lifetime=1000 srm://srm.unl.edu:8443/srm/managerv2
srm-reserve-space -space_description=mydesc -desired_size=3000 -guaranteed_size=2000 -lifetime=1000 srm://srm.ihepa.ufl.edu:8443/srm/managerv2
srm-reserve-space -space_description=mydesc -desired_size=3000 -guaranteed_size=2000 -lifetime=1000 srm://osg-east.hms.harvard.edu:10443/srm/v2/server
srm-reserve-space -space_description=mydesc -desired_size=3000 -guaranteed_size=2000 -lifetime=1000 srm://osg.hpcc.nd.edu:8443/srm/managerv2
srm-reserve-space -space_description=mydesc -desired_size=3000 -guaranteed_size=2000 -lifetime=1000 srm://dcache07.unl.edu:8443/srm/v2/server
</verbatim>

---+++++ srm_sp_reserve

For a given VO, prints a space reservation command line for each supporting site. The space reservation client is the LBL implmentation.

*Script Name*

srm_sp_reserve

*Parameters*
%TABLE{ headerbg="#eeeeee" headercolor="#000000" databg="#ffffff" tableborder="1" columnwidths="120," cellpadding="2" cellspacing="1" dataalign="left" valign="top" sort="off"}%
| *name* | *definition* | *required* |
|  vo | VO Name | yes |
| description | user-supplied description | no |
| requested_size | Size of reservation in bytes | yes |
| guaranteed_size | Size to be guaranteed in bytes | no |
| lifetime | Time to expiration | no |
| storage_element_id | <nop>GlueSEUniqueID | no |
Non-required parameters should be supplied with a value of "".

*Usage*

<verbatim>
srm_sp_reserve vo=<VO name> [requested_size=<Size requested>] [description=<Space token description>] [guaranteed_size=<Size to be guaranteed>] [lifetime=<Time to expiration>] [storage_element_id=<GlueSEUniqueID>]
</verbatim>

*Example Output*
<verbatim>
[xquery]$ srm_sp_reserve vo=engage description=mydesc requested_size=3000 guaranteed_size=2000 lifetime=1000
srm-sp-reserve -serviceurl srm://abitibi.sbgrid.org:8443/srm/managerv2 -size 3000 -gsize 2000 -lifetime 1000 -userdesc mydesc
srm-sp-reserve -serviceurl srm://sigmorgh.hpcc.ttu.edu:49443/srm/v2/server. -size 3000 -gsize 2000 -lifetime 1000 -userdesc mydesc
srm-sp-reserve -serviceurl srm://se01.cmsaf.mit.edu:8443/srm/managerv2 -size 3000 -gsize 2000 -lifetime 1000 -userdesc mydesc
srm-sp-reserve -serviceurl srm://cit-se.ultralight.org:8443/srm/managerv2 -size 3000 -gsize 2000 -lifetime 1000 -userdesc mydesc
srm-sp-reserve -serviceurl srm://cit-se.ultralight.org:8443/srm/managerv2 -size 3000 -gsize 2000 -lifetime 1000 -userdesc mydesc
srm-sp-reserve -serviceurl srm://cit-se2.ultralight.org:8443/srm/v2/server -size 3000 -gsize 2000 -lifetime 1000 -userdesc mydesc
srm-sp-reserve -serviceurl srm://ff-se.unl.edu:8443/srm/v2/server -size 3000 -gsize 2000 -lifetime 1000 -userdesc mydesc
srm-sp-reserve -serviceurl srm://fndca1.fnal.gov:8443/srm/managerv2 -size 3000 -gsize 2000 -lifetime 1000 -userdesc mydesc
srm-sp-reserve -serviceurl srm://srm.unl.edu:8443/srm/managerv2 -size 3000 -gsize 2000 -lifetime 1000 -userdesc mydesc
srm-sp-reserve -serviceurl srm://srm.ihepa.ufl.edu:8443/srm/managerv2 -size 3000 -gsize 2000 -lifetime 1000 -userdesc mydesc
srm-sp-reserve -serviceurl srm://osg.hpcc.nd.edu:8443/srm/managerv2 -size 3000 -gsize 2000 -lifetime 1000 -userdesc mydesc
srm-sp-reserve -serviceurl srm://dcache07.unl.edu:8443/srm/v2/server -size 3000 -gsize 2000 -lifetime 1000 -userdesc mydesc
</verbatim>

---+++++ SURL

For a given VO, constructs a SURL for each supporting site.

*Script Name*

find_surls_for_vo

*Parameters*
%TABLE{ headerbg="#eeeeee" headercolor="#000000" databg="#ffffff" tableborder="1" columnwidths="120," cellpadding="2" cellspacing="1" dataalign="left" valign="top" sort="off"}%
| *name* | *definition* | *required* |
| vo | VO name | yes |

*Usage*

<verbatim>
find_surls_for_vo vo=<VO name>
</verbatim>

*Example Output*
<verbatim>
[xquery]$ find_surls_for_vo engage
srm://abitibi.sbgrid.org:8443/srm/managerv2?SFN=/opt/osg-shared/se/data/vo/vo/engage/TESTFILE
srm://sigmorgh.hpcc.ttu.edu:49443/srm/v2/server.?SFN=/mnt/hep/TESTFILE
srm://cit-se2.ultralight.org:8443/srm/v2/server?SFN=/mnt/hadoop/osg/TESTFILE
srm://ff-se.unl.edu:8443/srm/v2/server?SFN=/panfs/panasas/CMS/data/engage/TESTFILE
srm://fndca1.fnal.gov:8443/srm/managerv2?SFN=/pnfs/fnal.gov/usr/fermigrid/volatile/engage/TESTFILE
srm://osg-east.hms.harvard.edu:10443/srm/v2/server?SFN=/osg/storage/data/engage/TESTFILE
srm://dcache07.unl.edu:8443/srm/v2/server?SFN=/mnt/hadoop/user/engage/TESTFILE
</verbatim>

---+++++ srmcp

For a given VO, prints a ssrm copy command line for each supporting site. The copy command client is the FNAL implmentation.

*Script Name*

find_srmcp

*Parameters*
%TABLE{ headerbg="#eeeeee" headercolor="#000000" databg="#ffffff" tableborder="1" columnwidths="120," cellpadding="2" cellspacing="1" dataalign="left" valign="top" sort="off"}%
| *name* | *definition* | *required* |
| vo | VO name | yes |
| space_token | Token from space reservation | no |

*Usage*

<verbatim>
find_srmcp vo=<VO name> [space_token=<Token from space reservation>]
</verbatim>

*Example Output*
<verbatim>
[xquery]$ find_srmcp vo=engage space_token=12345
srmcp -srm_protocol_version=2 -space_token=12345 file:////path/to/file srm://abitibi.sbgrid.org:8443/srm/managerv2?SFN=/opt/osg-shared/se/data/vo/vo/engage/TESTFILE
srmcp -srm_protocol_version=2 -space_token=12345 file:////path/to/file srm://sigmorgh.hpcc.ttu.edu:49443/srm/v2/server.?SFN=/mnt/hep/TESTFILE
srmcp -srm_protocol_version=2 -space_token=12345 file:////path/to/file srm://cit-se2.ultralight.org:8443/srm/v2/server?SFN=/mnt/hadoop/osg/TESTFILE
srmcp -srm_protocol_version=2 -space_token=12345 file:////path/to/file srm://ff-se.unl.edu:8443/srm/v2/server?SFN=/panfs/panasas/CMS/data/engage/TESTFILE
srmcp -srm_protocol_version=2 -space_token=12345 file:////path/to/file srm://fndca1.fnal.gov:8443/srm/managerv2?SFN=/pnfs/fnal.gov/usr/fermigrid/volatile/engage/TESTFILE
srmcp -srm_protocol_version=2 -space_token=12345 file:////path/to/file srm://osg-east.hms.harvard.edu:10443/srm/v2/server?SFN=/osg/storage/data/engage/TESTFILE
srmcp -srm_protocol_version=2 -space_token=12345 file:////path/to/file srm://dcache07.unl.edu:8443/srm/v2/server?SFN=/mnt/hadoop/user/engage/TESTFILE
</verbatim>

---+++++ srm-copy

For a given VO, prints a ssrm copy command line for each supporting site. The copy command client is the LBL implmentation.

*Script Name*

find_srm_copy

*Parameters*
%TABLE{ headerbg="#eeeeee" headercolor="#000000" databg="#ffffff" tableborder="1" columnwidths="120," cellpadding="2" cellspacing="1" dataalign="left" valign="top" sort="off"}%
| *name* | *definition* | *required* |
| vo | VO name | yes |
| space_token | Token from space reservation | no |

*Usage*

<verbatim>
find_srm_copy vo=<VO name> [space_token=<Token from space reservation>]
</verbatim>


*Example Output*
<verbatim>
[xquery]$ find_srm_copy vo=engage space_token=12345
srm-copy file:////path/to/file srm://abitibi.sbgrid.org:8443/srm/managerv2?SFN=/opt/osg-shared/se/data/vo/vo/engage/TESTFILE -spacetoken 12345
srm-copy file:////path/to/file srm://sigmorgh.hpcc.ttu.edu:49443/srm/v2/server.?SFN=/mnt/hep/TESTFILE -spacetoken 12345
srm-copy file:////path/to/file srm://cit-se2.ultralight.org:8443/srm/v2/server?SFN=/mnt/hadoop/osg/TESTFILE -spacetoken 12345
srm-copy file:////path/to/file srm://ff-se.unl.edu:8443/srm/v2/server?SFN=/panfs/panasas/CMS/data/engage/TESTFILE -spacetoken 12345
srm-copy file:////path/to/file srm://fndca1.fnal.gov:8443/srm/managerv2?SFN=/pnfs/fnal.gov/usr/fermigrid/volatile/engage/TESTFILE -spacetoken 12345
srm-copy file:////path/to/file srm://dcache07.unl.edu:8443/srm/v2/server?SFN=/mnt/hadoop/user/engage/TESTFILE -spacetoken 12345
</verbatim>

-- Main.TedHesselroth - 29 Jul 2009
