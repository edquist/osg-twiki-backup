%META:TOPICINFO{author="MarcoMambelli" date="1273607669" format="1.1" version="1.1"}%
%META:TOPICPARENT{name="XrootdInstallAlt"}%
%TOC%

---++ Feature evaluation
Here a list of feature request and comments:
   * non root installation - OK
   * security - part
      * allows to restrict hosts (currently *.yourdomain.org) - OK
      * allows user directories and admin user (xrootd) - part
         * by hand editing and directory creation, in the future a script to add/remove users will be provided
   * startup script for reboot and for watchdog - discussion
   * optional CNS - OK

---+++ Startup script 
Discussion:<pre>Date: Tue, 11 May 2010 12:40:04 -0500
From: Alain Roy <roy@cs.wisc.edu>
To: Doug Benjamin <benjamin@phy.duke.edu>
Cc: Tanya Levshina <tlevshin@fnal.gov>, 'Scot Kronenfeld' <kronenfe@cs.wisc.edu>, 'Andrew Hanushevsky' <abh@stanford.edu>,
    "'Yang, Wei'" <yangw@slac.stanford.edu>, 'Rob Gardner' <rwg@hep.uchicago.edu>, "'Kroeger, Wilko'" <wilko@slac.stanford.edu>,
    'Fabrizio Furano' <furano@cern.ch>, 'Dan Fraser' <fraser@anl.gov>, 'Rik Yoshida' <rik.yoshida@anl.gov>,
    'Marco Mambelli' <marco@hep.uchicago.edu>, 'Sarah Williams' <saewill@iupui.edu>
Subject: Re: xrootd in VDT


On May 10, 2010, at 10:47 PM, Doug Benjamin wrote:
> Hello,
>
>  How is the system started after a reboot or crash when run in not root mode.  Is there a watch dog process?

Right now, there isn't. Understanding the right thing to do makes me realize that I don't understand the full scope of your goals.

In the case where we've installed as root, I think we're fine--xrootd will restart upon reboot.

In the non-root case, we don't have an easy handle on what to do upon restart, because we can't hook into the boot process. So there
are at least two solutions.

1) Are we not allowed to install *anything* as root? If we can install something as root, we can install an init script. But I don't
understand the constraints on our non-root installation.

2) We could install a cron job as the user, and it could restart xrootd. Once the cron job is triggered, it would restart xrootd.

Unless #2 already exists, it's a bit of development. It's not hard, but there are things I don't know how to do. I don't know how to
reliably tell if xrootd is running. We also need to be careful of common pitfalls in running cron jobs. (What if the script hangs a
bit, and cron invokes it again?) These aren't hard problems, but it takes a bit of time to get the details correct.

In my ideal world, if we want to do #2, the script that does it would be provided by the Xrootd folks because they understand Xrootd
more deeply: how to start it up, how to verify it's running, how to track the processes, etc. However, if they can't provide it, we can
take on that task.

Thoughts?
-alain
</pre>



-- Main.MarcoMambelli - 11 May 2010