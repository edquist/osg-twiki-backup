%META:TOPICINFO{author="KyleGross" date="1328026271" format="1.1" version="1.10"}%
%META:TOPICPARENT{name="XrootdInstallAlt"}%
%DOC_STATUS_TABLE%


%RED%
WARNING! This page is for an older version of Xrootd.
For newer versions, please visit [[Documentation/Release3.InstallXrootd][Xrootd Install]]
%ENDCOLOR%

---+!! <nop>%SPACEOUT{%TOPIC%}%
%TOC%

---++ Introduction
Xrootd is a high performance network storage system widely used in high energy physics experiments such as ATLAS and ALICE. The underlying Xroot data transfer protocol provides highly efficient access to ROOT based data files.  

This page provides instructions for using a Xrootd storage system consisting of one redirector node and one or more data server nodes.  

For the installation instructions check instead XrootdInstall.

---++ Getting Started
As a user you have three different ways to interact with Xrootd: a file system mounted with !XrootdFS, the application =xrdcp=, LD_PRELOAD.

To use a Xrootd file system mounted with !XrootdFS you don't need any special setup. It should be completely transparent to you.

To use =xrdcp= you need to have it in your path (e.g. =source $INSTALL_DIR/setup.sh=, where =$INSTALL_DIR= is the Xrootd installation directory)

The use of LD_PRELOAD is not recommended if you have any alternative available. Anyway you will have to add the Xrootd libraries to your library path and add the POSIX preload library to your environment, e.g. <pre class="screen">source $INSTALL_DIR/setup.sh
export LD_PRELOAD=$VDT_LOCATION/xrootd/lib/libXrdPosixPreload.so 
</pre>

---++ Testing and Using the System 

---+++ Simple copy tests
Login on the redirector node (e.g. =redirector.yourdomain.org=) and:
<pre class="screen">source $INSTALL_DIR/setup.sh 
echo &ldquo;This is a test&rdquo; &gt;/tmp/test 
xrdcp /tmp/test xroot://redirector.yourdomain.org:1094//storage/path/test 
xrdcp xroot://redirector.yourdomain.org:1094//storage/path/test /tmp/test1 
diff /tmp/test1 /tmp/test 
</pre>
Users can write in their own space. E.g. a user with Unix account name  =myuser= (the account must exist, eg. in =/etc/passwd=, etc,  on the redirector and on all the data servers) could save a file in Xrootd: <pre class="screen">source $INSTALL_DIR/setup.sh 
echo &ldquo;This is a user test&rdquo; &gt;/tmp/test 
xrdcp /tmp/test xroot://redirector.yourdomain.org:1094//storage/path/myuser/test 
</pre>
Note that =xrdcp= creates missing directories.

---+++ Tests using the !libXrdPosixPreload library
Using Xrootd with the POSIX preload library
<pre class="screen">source $INSTALL_DIR/setup.sh
export LD_PRELOAD=$VDT_LOCATION/xrootd/lib/libXrdPosixPreload.so 
echo &ldquo;This is a new test&rdquo; &gt;/tmp/test 
mkdir xroot://redirector.yourdomain.org:1094//storage/path/subdir
cp /tmp/test xroot://redirector.yourdomain.org:1094//storage/path/subdir/test 
cp xroot://redirector.yourdomain.org:1094//storage/path/subdir/test /tmp/test1 
diff /tmp/test1 /tmp/test 
rm xroot://redirector.yourdomain.org:1094//storage/path/subdir/test 
rmdir xroot://redirector.yourdomain.org:1094//storage/path/subdir
</pre>

---+++ Tests using !XrootdFS
The directory mounted using !XrootdFS can be used as any other directory mounted on your file system.
All the normal Unix commands should work. You don't need any special setup or library.
Try using =cp=, =rm=, =mv=, =mkdir=, =rmdir=.
<pre class="screen">
echo &ldquo;This is a new test&rdquo; &gt;/tmp/test 
mkdir -p /xrootd/subdir/sub2
cp /tmp/test /xrootd/subdir/sub2/test 
cp /xrootd/subdir/sub2/test /xrootd/subdir/sub2/test1 
cp /xrootd/subdir/sub2/test1 /tmp/test1 
diff /tmp/test1 /tmp/test 
rm -r /xrootd/subdir
</pre>

---++ References
*Scalla Xrootd:*
   * [[http://xrootd.slac.stanford.edu/][Scalla home]] and [[http://xrootd.slac.stanford.edu/papers/Scalla-Intro.htm][Scalla introduction]]
   * http://xrootd.slac.stanford.edu/doc/dev/ - references from the development release
   * [[http://xrootd.slac.stanford.edu/doc/dev/xrd_config.pdf][Configuration reference]] (PDF), [[http://xrootd.slac.stanford.edu/doc/dev/xrd_config.htm][html]]
   * Update notes to CVS, http://xrootd.slac.stanford.edu/doc/cvshead/updates.html
   * [[http://project-arda-dev.web.cern.ch/project-arda-dev/xrootd/site/index.html][Xrootd/Scalla @ CERN (ARDA)]]

*OSG releated:*
   * A. Baranovski, [[http://osg-docdb.opensciencegrid.org/cgi-bin/ShowDocument?docid=744&version=2][OSG Document 744-v2: Xrootd evaluation and feature review]]
   * Using Xrootd with SRM: ReleaseDocumentation.BestmanGatewayXrootd or with just !GridFTP, ReleaseDocumentation.GridFTPXrootd


%BR%

---++ *Comments*
%COMMENT{type="tableappend"}%


<!-- CONTENT MANAGEMENT PROJECT
############################################################################################################ 
   DEAR DOCUMENT OWNER
   ===================

   Thank you for claiming ownership for this document! Please fill in your FirstLast name here:
   * Local OWNER          = MarcoMambelli

   Please define the document area, choose one of the defined areas from the next line
   DOC_AREA = (ComputeElement|Storage|VO|Security|User|Monitoring|General|Integration|Operations|Tier3)
   * Local DOC_AREA       =  Tier3

   define the primary role the document serves, choose one of the defined roles from the next line
   DOC_ROLE = (EndUser|Student|Developer|SysAdmin|VOManager|Documenter)
   * Local DOC_ROLE       = Scientist

   Please define the document type, choose one of the defined types from the next line
   DOC_TYPE = (Trash/Troubleshooting|Training|Installation|HowTo|Planning|Navigation|Knowledge)
   * Local DOC_TYPE       = Training
   
   Please define if this document in general needs to be reviewed before release ( %YES% | %NO% )
   * Local INCLUDE_REVIEW = %YES%

   Please define if this document in general needs to be tested before release ( %YES% | %NO% )
   * Local INCLUDE_TEST   = %YES%

   change to %YES% once the document is ready to be reviewed and back to %NO% if that is not the case
   * Local REVIEW_READY   = %YES%

   change to %YES% once the document is ready to be tested and back to %NO% if that is not the case
   * Local TEST_READY     = %YES%

   change to %YES% only if the document has passed the review and the test (if applicable) and is ready for release
   * Local RELEASE_READY  = %NO%


   DEAR DOCUMENT REVIEWER
   ======================

   Thank for reviewing this document! Please fill in your FirstLast name here:
   * Local REVIEWER       = DouglasStrain
  
   Please define the review status for this document to be in progress ( %IN_PROGRESS% ), failed ( %NO% ) or passed ( %YES% )
   * Local REVIEW_PASSED  = %IN_PROGRESS%


   DEAR DOCUMENT TESTER
   ====================

   Thank for testing this document! Please fill in your FirstLast name here:
   * Local TESTER         = SuchandraThapa
  
   Please define the test status for this document to be in progress ( %IN_PROGRESS% ), failed ( %NO% ) or passed ( %YES% )
   * Local TEST_PASSED    = %IN_PROGRESS%
############################################################################################################ 
-->


-- Main.MarcoMambelli - 19 May 2010