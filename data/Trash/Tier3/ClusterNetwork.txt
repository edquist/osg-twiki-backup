%META:TOPICINFO{author="MarcoMambelli" date="1259096030" format="1.1" reprev="1.1" version="1.1"}%
%META:TOPICPARENT{name="Tier3DocDev"}%
---+!! *<nop>%SPACEOUT{ "%TOPIC%" }%*
%TOC%

Your campus or your department will provide you a network connection that in these documents we refer as _extranet_, i.e. the network that connects also to the world outside of your Tier 3 cluster.

Depending on geographical and hardware constraints or on your choices, the nodes of a Tier 3 can be connected using the different topologies described in the following sections.
A default configuration, including subnet IP address, is described as well.

---++ Topology with intranet and extranet
The recommended configuration for a T3 includes a second network, _intranet_ (internal LAN or VLAN), connecting only nodes of the T3. In this topology, visible in Fig. 1, the intranet is normally a "private" network, connected to the extranet using a NAT and proxy server (a Firewall). This provides better security, because several nodes have limited network access, and limits the number of IP addresses used by the T3, specially for clusters with many nodes(>30). Worker nodes do not require a public IP and this way they can work without it.

   * Fig. 1 - Topology with intranet and extranet: <br />
     <img src="%ATTACHURLPATH%/network1.png" alt="network1.png" width='568' height='191' />    

Most of the time all nodes require outbound network connectivity and this can be provided by a proxy server (e.g. Squid) and/or a NAT (network address translation) server.
Some nodes will require also inbound network connectivity and this can be provided using port forwarding on the NAT server or connecting those nodes also to the extranet. We will choose the latter.
Nodes that can benefit from being on the extranet are:
   * NAT/Squid
   * SE
   * CE
   * NFS server
   * UI

To simplify the documentation we are choosing here a default configuration for the intranet.

The default address for the intranet (T3 subnet) is 192.168.192.0/18. This defines a subnet with 18 bits fixed for the network addresses and 14 bits available for the hosts. This means that you can have up to 16,191 private IP addresses from 192.168.192.1 to 192.168.255.254.


---++ Simplified network topology
If the previous topology is not possible, either because the nodes of the Tier 3 are scattered across campus, or because the hardware does not allow it, or by choice, then all the nodes of the T3 can reside on the same network (extranet and intranet are the same), like shown in Fig. 2.

   * Fig. 2 - Network topology with a single network: <br />
     <img src="%ATTACHURLPATH%/network2.png" alt="network2.png" width='568' height='158' />    

All the T3 nodes will connect directly to your "public" network. Therefore, you will need to obtain an IP address from your local network administrator for each of the hosts you will include in your T3 cluster. 
In this case the subnet and the IP addresses will be whichever you'll be provided with.

---++ Campus/department network
The extranet is the network provided to you for your T3 by the campus or the department. 
The extranet may be a "public" network, directly connected to the Internet or bridged to it. It may also be that you are provided with an 
extranet which is a private network provided internally to your campus or department (intranet for the campus or department), which is is separated from the Internet by a firewall that limits the access. The two examples are shown in Fig. 3.

   * Fig. 3 - Network connection to the outside: <br />
     <img src="%ATTACHURLPATH%/network-connection.png" alt="network-connection.png" width='336' height='246' />    

If your configuration is the latter you have to make sure (talking to your network administrators) that at least the Storage Element and the Compute Element are visible on the "public" Internet so that they can be available on the Grid.
It is also convenient for interactive nodes to be "public" so that users may log in directly to them and a Web proxy could also be on the "public" network for performance reasons.

Furthermore if the extranet is a subnet in the range 192.168.x.y, and x &gt;= 192, then the default configuration will not work (there may be conflicts in the assigned IP). In this case the subnet used for the intranet has to be different from the default, read further the [[IntranetNotes][intranet notes]] to find out which documents are affected.


%BR%
%COMPLETE2% %BR%
%RESPONSIBLE% Main.MarcoMambelli - 24 Nov 2009 %BR%
%REVIEW%

---++ *Comments*
%COMMENT{type="tableappend"}%

%META:FILEATTACHMENT{name="network1.png" attachment="network1.png" attr="" comment="Fig. 1 - Topology with intranet and extranet" date="1259091137" path="network1.png" size="24060" stream="network1.png" tmpFilename="/usr/tmp/CGItemp14894" user="MarcoMambelli" version="1"}%
%META:FILEATTACHMENT{name="network2.png" attachment="network2.png" attr="" comment="Fig. 2 - Network topology with a single network" date="1259091190" path="network2.png" size="22776" stream="network2.png" tmpFilename="/usr/tmp/CGItemp14992" user="MarcoMambelli" version="1"}%
%META:FILEATTACHMENT{name="network-connection.png" attachment="network-connection.png" attr="" comment="Fig. 3 - Network connection to the outside" date="1259091242" path="network-connection.png" size="16505" stream="network-connection.png" tmpFilename="/usr/tmp/CGItemp15098" user="MarcoMambelli" version="1"}%
