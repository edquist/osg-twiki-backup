%META:TOPICINFO{author="MarcoMambelli" date="1274463028" format="1.1" version="1.9"}%
%META:TOPICPARENT{name="CondorRPMInstall"}%
---+!! *<nop>%SPACEOUT{ "%TOPIC%" }%*
%DOC_STATUS_TABLE%
%TOC%

---++ Setup
If you used the RPM install in CondorRPMInstall or if you copied the =condor.sh= and =condor.csh= files in =/etc/profile.d/= as described in CondorSharedInstall, Condor will be in the environment of every user automatically, no need to source any file.
Executing <pre class="screen">source /opt/condor/condor.sh</pre> will add the Condor commands to your path and set the =CONDOR_LOCATION= variable if they are not already.

---++ Testing the installation
You can see the resources in your Condor cluster using =condor_status=. Here is the output on =gc1-ce.mwt2.org= (the Condor headnode in gc1):
<pre class="screen">
> condor_status

Name               OpSys      Arch   State     Activity LoadAv Mem   ActvtyTime

gc1-c001.mwt2.org  LINUX      INTEL  Owner     Idle     0.000   503  0+00:10:10
gc1-c002.mwt2.org  LINUX      INTEL  Owner     Idle     0.000   503  0+00:05:10

                     Total Owner Claimed Unclaimed Matched Preempting Backfill

         INTEL/LINUX     2     2       0         0       0          0        0

               Total     2     2       0         0       0          0        0
</pre>
If there are no resources advertising their presence, =condor_status= will quit without printing any message. This does not mean that Condor is not installed correctly. Try =condor_status -negotiator= if you are on the headnode. If Condor collector and negotiator are running on the headnode Condor starter is running on worker nodes but they are not reporting to the headnode, there may be a network problem (check the firewall) or they may be part of a different domain (check the =DOMAIN_NAME= in the configuration file).


To test condor you have to create  a submit file (=mytest.submit=) and submit a job.
   * submit file:<pre class="file">
#  A test Condor submission file - mytest.submit
executable = /bin/hostname
universe = vanilla
log = test.log
output = test.out
error = test.err
queue
</pre>
   * Submit with:<pre class="screen">
condor_submit mytest.submit
</pre>
   * Check the jobs:<pre class="screen">
condor_q
</pre>
   * Inspect the files test.log/out/err. You can submit more than one test job. A different test can have =transfer_executable=true=.

---+++ A CPU intensive test
Here is a condor test to submit 20 CPU intensive jobs.
   * submit file (save it as =mytestcpu.sub=):<pre class="file">
########################
# Submit description file for CPU test program
########################
Executable     = /home/gsadmin/use-processor.pl
# should_transfer_files  can be YES NO IF_NEEDED
should_transfer_files = YES
# when_to_transfer_output  can be ON_EXIT ON_EXIT_OR_EVICT 
when_to_transfer_output = ON_EXIT
Universe       = vanilla 
Output         = cputest.$(Process).out
Error          = cputest.$(Process).err
Log            = cputest.$(Process).log 
Queue 20
</pre>
   * Download the attached file [[%ATTACHURL%/use-processor.pl.txt][use-processor.pl]] and save it in =/home/gsadmin/= and make it executable, e.g. if you have wget: <pre>
wget --no-check-certificate https://twiki.grid.iu.edu/twiki/pub/ReleaseDocumentation/ClusterCondorInstall/use-processor.pl.txt
cp use-processor.pl.txt /home/gsadmin/use-processor.pl
chmod a+x /home/gsadmin/use-processor.pl
</pre>
   * Submit with:<pre class="screen">
condor_submit mytestcpu.sub
</pre>
   * Check the jobs:<pre class="screen">
condor_q
</pre>
   * Inspect the files =cputest.XX.log/out/err=, where XX is a number from 1 to 20. 

---++ More information
   * Examples running Condor jobs: http://www.cs.wisc.edu/condor/quick-start.html


%BR%
%COMPLETE2% %BR%
%RESPONSIBLE% Main.MarcoMambelli - 24 Nov 2009 %BR%
%REVIEW%

---++ *Comments*
%COMMENT{type="tableappend"}%


<!-- CONTENT MANAGEMENT PROJECT
############################################################################################################ 
   DEAR DOCUMENT OWNER
   ===================

   Thank you for claiming ownership for this document! Please fill in your FirstLast name here:
   * Local OWNER          = MarcoMambelli

   Please define the document area, choose one of the defined areas from the next line
   DOC_AREA = (ComputeElement|Storage|VO|Security|User|Monitoring|General|Integration|Operations|Tier3)
   * Local DOC_AREA       =  Tier3

   define the primary role the document serves, choose one of the defined roles from the next line
   DOC_ROLE = (EndUser|Student|Developer|SysAdmin|VOManager|Documenter)
   * Local DOC_ROLE       = SysAdmin

   Please define the document type, choose one of the defined types from the next line
   DOC_TYPE = (Troubleshooting|Training|Installation|HowTo|Planning|Navigation|Knowledge)
   * Local DOC_TYPE       = HowTo
   
   Please define if this document in general needs to be reviewed before release ( %YES% | %NO% )
   * Local INCLUDE_REVIEW = %NO%

   Please define if this document in general needs to be tested before release ( %YES% | %NO% )
   * Local INCLUDE_TEST   = %NO%

   change to %YES% once the document is ready to be reviewed and back to %NO% if that is not the case
   * Local REVIEW_READY   = %YES%

   change to %YES% once the document is ready to be tested and back to %NO% if that is not the case
   * Local TEST_READY     = %NO%

   change to %YES% only if the document has passed the review and the test (if applicable) and is ready for release
   reviewed during DOC workshop
   * Local RELEASE_READY  = %YES%


   DEAR DOCUMENT REVIEWER
   ======================

   Thank for reviewing this document! Please fill in your FirstLast name here:
   * Local REVIEWER       = 
  
   Please define the review status for this document to be in progress ( %IN_PROGRESS% ), failed ( %NO% ) or passed ( %YES% )
   * Local REVIEW_PASSED  = %IN_PROGRESS%


   DEAR DOCUMENT TESTER
   ====================

   Thank for testing this document! Please fill in your FirstLast name here:
   * Local TESTER         = 
  
   Please define the test status for this document to be in progress ( %IN_PROGRESS% ), failed ( %NO% ) or passed ( %YES% )
   * Local TEST_PASSED    = %IN_PROGRESS%
############################################################################################################ 
-->


%META:FILEATTACHMENT{name="use-processor.pl.txt" attachment="use-processor.pl.txt" attr="" comment="perl script to stress CPU" date="1259090903" path="use-processor.pl" size="508" stream="use-processor.pl" tmpFilename="/usr/tmp/CGItemp13124" user="MarcoMambelli" version="1"}%
