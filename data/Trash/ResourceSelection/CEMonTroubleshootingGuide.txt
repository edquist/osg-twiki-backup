%META:TOPICINFO{author="IanStokesRees" date="1208440404" format="1.1" reprev="1.9" version="1.9"}%
%META:TOPICPARENT{name="WebHome"}%
---+ CEMon Troubleshooting Guide for OSG Site Administrators

In case of user problems reported to the OSG GOC, site administrators should use the following troubleshooting guide before asking expert help.
<p>
CEMON_Troubleshooting_Guide v5 - VDT 1.10.0 (OSG 1.0)
([[%ATTACHURL%/CEMON_Troubleshooting_Guide_5.doc][doc]] | [[%ATTACHURL%/CEMON_Troubleshooting_Guide_5.pdf][pdf]]) by Tanya Levshina, April 11 2008
<p>
CEMON_Troubleshooting_Guide v4 - OSG 0.8
([[%ATTACHURL%/CEMON_Troubleshooting_Guide_4.doc][doc]] | [[%ATTACHURL%/CEMON_Troubleshooting_Guide_4.pdf][pdf]]) by Tanya Levshina, Nov 01 2007


-- Main.GabrieleGarzoglio - 02 Nov 2007

---++ Guide v4 (OSG 0.8) TEXT DUMP

CEMON Troubleshooting Guide 
    T.Levshina 
 
VERY QUICK CHECKLIST: 
 
1. To verify that your CEMon is successfully reporting to ReSS issue the following 
command:
<verbatim>
condor_status -pool osg-ress-1.fnal.gov -l -constraint 'GlueCEInfoHostName == "YOUR_FQDN_HOST_NAME" '
</verbatim>
(e.g. abitibi.sbgrid.org) 

it should report back something like the following: 

<verbatim>
MyType = "Machine" 
TargetType = "Job" 
Name = "tier2-02.uchicago.edu:2119/jobmanager-condor-atlas.1231388458" 
GlueCEInfoContactString = "tier2-02.uchicago.edu:2119/jobmanager-condor" 
....
</verbatim>

with one such block per VO you support.  If this works, then CEMon should be working fine.  Otherwise, go to 2.

2. Check permission on the service certificate and key. Verify that service certificate 
in apache =$VDT_LOCATION/apache/conf/extra/httpd-ssl.conf=  exists and is 
owned by &#8220;daemon&#8221; (or whatever daemon is running apache and tomcat)
 
=SSLCertificateFile /etc/grid-security/http/httpcert.pem=

=SSLCertificateKeyFile /etc/grid-security/http/httpkey.pem=

After changing permissions restart apache and tomcat. 
 
Check the permission of a gridmap file (It should be set to readable to world 0644). The file location is defined in =$VDT_LOCATION/glite/etc/glite-ce-monitor/authconfig.xml=. After changing permissions restart apache and tomcat. 
 
3. Check that apache  and tomcat are running (use ps command) and if you have a 
certificate uploaded to your browser check if you can access CEMon by this link:

=https://<YOUR_HOST_NAME>:8443/ce-monitor/services/CEMonitor?method=getInfo=

If you have your DN listed in /etc/grid-security/grid-mapfile you will get back some XML which will include =CE-Monitor_web_application=, otherwise you'll have XML which contains =Server.GeneralException= and it should show the cert DN which has been rejected.
 
4. Verify that your GIP configuration is correct. 
   a. Run GIP wrapper script manually:

=$VDT_LOCATION/lcg/libexec/osg-info-wrapper >/tmp/out 2>/tmp/err=

   b. Check that you do not have any errors in =/tmp/err=.
   c. Check that you have all essential Glue Schema attributes in =/tmp/out= (such as GlueCEUniqueID , GlueClusterUniqueID, GlueSubClusterUniqueID).
If installed version of VDT is 1.8.1 and higher you can test your GIP  configuration by running =verify-gip-for-cemon-wrapper= script. In order to do so you have to: 

<verbatim>
cd $VDT_LOCATION 
. setup.sh 
cd verify-gip-for-cemon 
run the script 
./verify-gip-for-cemon-wrapper 
</verbatim>

The script will either print out the valid gip configuration formatted for CEMon or generate an error that would help you with  
diagnostic of GIP configuration problems.  For help: =./verify-gip-for-cemon-wrapper -h=

=Usage: java -DVDT_LOCATION=$VDT_LOCATION [OPTION...] [FILE]=
 
If FILE is specified checks Glue Schema format  of that file else checks output of =$VDT_LOCATION/glite/etc/glite-ce-ce-plugin/glite-ce-info=.  The format should be complaint to OSG_CE topic/OLD_CLASSAD dialect 

5. If everything mentioned above is working, contact export support and provide the 
following information: 
   * catalina log (=$VDT_LOCATION/tomcat/v4/logs/catalina.out=)
   * cemonitor log (=$VDT_LOCATION/tomcat/v4/logs/glite-ce-monitor.log=) 
   * output of the wrapper script (=$VDT_LOCATION/lcg/libexec/osg-info-wrapper=) 

%META:FILEATTACHMENT{name="CEMON_Troubleshooting_Guide_4.doc" attr="" autoattached="1" comment="" date="1193935325" path="CEMON_Troubleshooting_Guide_4.doc" size="54272" user="Main.TanyaLevshina" version="1"}%
%META:FILEATTACHMENT{name="CEMON_Troubleshooting_Guide_2.doc" attr="" autoattached="1" comment="" date="1187189192" path="CEMON_Troubleshooting_Guide_2.doc" size="46080" user="Main.GabrieleGarzoglio" version="1"}%
%META:FILEATTACHMENT{name="CEMON_Troubleshooting_Guide_5.doc" attr="" autoattached="1" comment="" date="1207932053" path="CEMON_Troubleshooting_Guide_5.doc" size="347136" user="Main.TanyaLevshina" version="1"}%
%META:FILEATTACHMENT{name="CEMON_Troubleshooting_Guide_3.doc" attr="" autoattached="1" comment="" date="1191254083" path="CEMON_Troubleshooting_Guide_3.doc" size="45568" user="Main.GabrieleGarzoglio" version="1"}%
%META:FILEATTACHMENT{name="CEMON_Troubleshooting_Guide_5.pdf" attr="" autoattached="1" comment="" date="1207932352" path="CEMON_Troubleshooting_Guide_5.pdf" size="392933" user="Main.TanyaLevshina" version="1"}%
%META:FILEATTACHMENT{name="CEMON_Troubleshooting_Guide_4.pdf" attr="" autoattached="1" comment="" date="1194031694" path="CEMON_Troubleshooting_Guide_4.pdf" size="40173" user="Main.GabrieleGarzoglio" version="1"}%
