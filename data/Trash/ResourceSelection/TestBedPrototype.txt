%META:TOPICINFO{author="KyleGross" date="1225985963" format="1.1" version="1.4"}%
%META:TOPICPARENT{name="WebHome"}%
<p>
The test bed follows the <a href="ReSSArchitecture">architecture diagram</a>.
<p>
CEMon uses GIP to advertise information in the old classad mapping of the GLUE schema v1.1. See  <a href=CEMonCollaboration>discussion</a> on the mapping and the LDIF to old classad translation.<br>
CEMon is configured to advertise two resources to the Information Gatherer (IG), which forwards them to the condor match making service.<br>
Jobs are submitted to a condor scheduler (Condor-G) and submitted via the GRAM protocol to the resource, as recommended by the Resource Selector. The condor scheduler is configured to interact with the Resource Selector (click [[SystemDeployment][here]] for instructions)<br>
<p>
These are the two resource classads
<menu>
<li>
<pre>
MyType = "Machine"
TargetType = "Job"
Name = "jra1_low.samgfarm1.fnal.gov.samgfarm1.fnal.gov"
GlueClusterUniqueID = "samgfarm1.fnal.gov"
GlueCEUniqueID = "samgfarm1.fnal.gov:2119/jobmanager-condor"
GlueClusterName = "samgfarm1.fnal.gov"
GlueSubClusterUniqueID = "samgfarm1.fnal.gov"
GlueClusterService = "samgfarm1.fnal.gov"
GlueCEHostingCluster = "samgfarm1.fnal.gov"
GlueCEAccessControlBaseRule = "VO:DZero"
GlueHostProcessorModel = "PIII"
GlueCEInfoHostName = "samgfarm1.fnal.gov"
GlueHostProcessorClockSpeed = 1000
GlueCEStateFreeCPUs = 105
GlueCEStateWaitingJobs = 45
GlueHostApplicationSoftwareRunTimeEnvironment = "DZero-Application_v1_1,DZero-Application_v1_2"
GlueCEStateTotalJobs = 71
GlueHostProcessorVendor = "intel"
GlueSchemaVersionMajor = 1
GlueCEInfoLRMSVersion = "6.7.12"
GlueCEStateRunningJobs = 26
GlueInformationServiceURL = "undefined,undefined,undefined"
GlueSubClusterName = "samgfarm1.fnal.gov"
GlueCEInfoLRMSType = condor
GlueCEInfoGatekeeperPort = 2119
GlueCEName = jra1_low
GlueSchemaVersionMinor = 2
GlueCEInfoTotalCPUs = 132
TTLCEInfo = 0
MyAddress = "<131.225.167.48:0>"
LastHeardFrom = 1133299814
UpdatesTotal = 289
UpdatesSequenced = 0
UpdatesLost = 0
UpdatesHistory = "0x00000000000000000000000000000000"
</pre>
<li> 
<pre>
MyType = "Machine"
TargetType = "Job"
Name = "samgfarm.samgfarm2.fnal.gov.samgfarm2.fnal.gov"
GlueClusterUniqueID = "samgfarm2.fnal.gov"
GlueCEUniqueID = "samgfarm2.fnal.gov:2119/jobmanager-condor"
GlueClusterName = "samgfarm2.fnal.gov"
GlueSubClusterUniqueID = "samgfarm2.fnal.gov"
GlueClusterService = "samgfarm2.fnal.gov"
GlueCEHostingCluster = "samgfarm2.fnal.gov"
GlueCEAccessControlBaseRule = "VO:CDF,VO:CMS"
GlueHostProcessorModel = "PIV"
GlueCEInfoHostName = "samgfarm2.fnal.gov"
GlueHostProcessorClockSpeed = 3000
GlueCEStateFreeCPUs = 105
GlueCEStateWaitingJobs = 45
GlueHostApplicationSoftwareRunTimeEnvironment = "CDF-Application_v1_1,CMS-Application_v2_0"
GlueCEStateTotalJobs = 71
GlueHostProcessorVendor = "intel"
GlueSchemaVersionMajor = 1
GlueCEInfoLRMSVersion = "6.7.12"
GlueCEStateRunningJobs = 26
GlueInformationServiceURL = "undefined,undefined,undefined"
GlueSubClusterName = "samgfarm2.fnal.gov"
GlueCEInfoLRMSType = condor
GlueCEInfoGatekeeperPort = 2119
GlueCEName = samgfarm
GlueSchemaVersionMinor = 2
GlueCEInfoTotalCPUs = 132
TTLCEInfo = 0
MyAddress = "<131.225.167.48:0>"
LastHeardFrom = 1133299814
UpdatesTotal = 289
UpdatesSequenced = 0
UpdatesLost = 0
UpdatesHistory = "0x00000000000000000000000000000000"
</pre>
</menu>
<p>
For testing the ReSS capabilities, we have submitted jobs that require resources that
<menu> 
<li>accept a certain VO (resource classad attribute GlueCEAccessControlBaseRule) OR
<li>have a certain VirtualOrganizations/VOInfo-specific application pre-installed (resource classad attribute GlueHostApplicationSoftwareRunTimeEnvironment)
</menu>

<p>
These are the test Condor Job Description File:

<menu>
<li>This job is matched to resource GlueCEUniqueID = "samgfarm1.fnal.gov:2119/jobmanager-condor", since there GlueCEAccessControlBaseRule is "VirtualOrganizations/VOInfo:DZero"
<pre>
universe = globus
globusscheduler = $$(GlueCEUniqueID) 
requirements = TARGET.GlueCEAccessControlBaseRule == "VO:DZero"
executable = /bin/hostname
arguments = -f
log = gg.log
output = /tmp/garzogli/stdout.$(cluster)
error = /tmp/garzogli/stderr.$(cluster)
queue
</pre>

<li>This job does not match any resource, as VirtualOrganizations/VOInfo NONE is not accepted anywhere:
<pre>
universe = globus
globusscheduler = $$(GlueCEUniqueID) 
requirements = TARGET.GlueCEAccessControlBaseRule == "VO:NONE"
executable = /bin/hostname
arguments = -f
log = gg.log
output = /tmp/garzogli/stdout.$(cluster)
error = /tmp/garzogli/stderr.$(cluster)
queue
</pre>
The two examples above express their requirements in a simplified form. The VOs accepted by a resource are advertised with the GlueCEAccessControlBaseRule attribute as a list. The more appropriate way of requesting resources accepting a certain VirtualOrganizations/VOInfo consists in using the match_string() function. The use of this function is explained in the example below.

<li> This job is matched to resource GlueCEUniqueID = "samgfarm1.fnal.gov:2119/jobmanager-condor", since one of the pre-installed applications listed in GlueHostApplicationSoftwareRunTimeEnvironment is Application_v1_2.
<pre>
universe = globus
globusscheduler = $$(GlueCEUniqueID) 
requirements = match_string("DZero-Application_v1_2";TARGET.GlueHostApplicationSoftwareRunTimeEnvironment) == TRUE 
executable = /bin/hostname
arguments = -f
log = gg.log
output = /tmp/garzogli/stdout.$(cluster)
error = /tmp/garzogli/stderr.$(cluster)
queue
</pre>

<li>This job is not matched to any resource, since the application required is not in any pre-installed application lists
<pre>
universe = globus
globusscheduler = $$(GlueCEUniqueID) 
requirements = match_string("DZero-Application_vFUTURE";TARGET.GlueHostApplicationSoftwareRunTimeEnvironment) == TRUE 
executable = /bin/hostname
arguments = -f
log = gg.log
output = /tmp/garzogli/stdout.$(cluster)
error = /tmp/garzogli/stderr.$(cluster)
queue
</pre>

</menu>

<p>
Short-term directions for the project include

<menu>
<li>finalizing the mapping of the GLUE LDIF representation to old classad (<a href="QuotingOldClassad">polish classad syntax)</a>
<li>integrating OSG GIP with CEMon
<li>evaluating efficiency and user-friendlyness of <a href="MatchingListElementsWithCondor">list matching techniques</a>
</menu>

-- Main.GabrieleGarzoglio - 01 Dec 2005