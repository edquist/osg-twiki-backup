%META:TOPICINFO{author="KyleGross" date="1190902716" format="1.1" version="1.1"}%
<H2>Requesting a Host/Service Certificate
</H2>
<p>NOTE: If you have not requested to be added to the GridAdmin privileged list, please send mail to the OSG RA requesting addition to this list. You will not be able to retrieve your Host/Service Certification without being added.
<OL>
<LI>
Read and agree to the Subscriber Obligations specified insection 2.1.2 of the DOEGrids Certificate Policy and Certificate Practice Statement (CP/CPS).


<P>
      The CP/CPS can be found <A HREF="http://www.doegrids.org/Docs/CP-CPS.pdf">here</A>.
</P>
</LI>
<LI>
Obtain a valid personal certificate from the DOEGrids CA.


<P>

      Administrators must first obtain a valid personal certificate from the DOEGrids CA before submitting a request for a host or service certificate. To request a personal certificate see the Personal Requests link on the left.
</P>
</LI>
<LI>
Configure your Globus installation if necessary


<P>
      The subject of host/service certificates issued by the DOEGrids CA must take a particular form. Specifically a host certificate must be of the form
</P>

<CODE>/DC=org/DC=doegrids/OU=Services/CN=FQDN
</CODE>
      <P>
or
</P>


<CODE>/DC=org/DC=doegrids/OU=Services/CN=host/FQDN
</CODE>
<P>
      where FQDN is the fully qualified domain name of the host. Here is an example:
</P>

<CODE> /DC=org/DC=doegrids/OU=Services/CN=host/basil.phys.uwm.edu
</CODE>
<P>
      The subject of a service certificate must be of the form
</P>

<CODE> /DC=org/DC=doegrids/OU=Services/CN=SERVICE/FQDN 
</CODE>
<P>
      where SERVICE is the name of the service. Here is an example
</P>

<CODE> /DC=org/DC=doegrids/OU=Services/CN=ldap/basil.phys.uwm.edu 
</CODE>
<P>
      If you have installed from the VDT this will be set up with installation.
</P>

<P>

      Otherwise the easiest way to generate host or service certificate requests with the proper form for the subject field is to download and install a set of auxiliary files provided by the DOEGrids CA.
</P>

<P>
      Please follow these instructions as user root to download theauxiliary files (if you do not wish to configure yourGlobus installation as user root refer to the Globus web pages for assistance):
</P>
          <UL TYPE="circle">
	<LI>Make sure the GLOBUS_LOCATION environmentvariable is properly set.</LI>
	<LI>Download the file doegrids.tar and place it in the directory /etc/grid-security</LI>
	<LI>Change directories to /etc/grid-security and untar the file:</LI>

<p>
<CODE> cd /etc/grid-security tar -xf doegrids.tar
</CODE>
</UL>
<P>
      If you do not choose to download and install the auxiliary files you may overide your installation defaults during the actual certificate request generation using grid-cert-request. Please refer to the Globus web pages for assistance.
</P>
</LI>

<LI>
Generate a certificate request for your host or service.


<P>
      Most administrators will want to follow these instructions as user root.

</P>
<UL TYPE="circle">
	<LI>Make sure the GLOBUS_LOCATION environment variable is properly set.</LI>
	<LI>In what follows substitute the fully-qualified domain name of your host for FQDN.</LI>
	<LI>For a host certificate run the following in your shell:</LI>


<P>
<CODE> /etc/grid-security/doegrids/doegrids-cert-request -host FQDN
</CODE>

</P>

         <LI>For a service sertificate run the following in your shell and substitute the name of your service for SERVICE:</LI>

<P>
<CODE> /etc/grid-security/doegrids/doegrids-cert-request -host FQDN  -service SERVICE 
</CODE>
</P>

          <LI>erify that the subject name of the certificate request, which is output to your terminal, has the proper form as detailed above.</LI>

</UL>

<P>
      At this point you have generated a certificate request. For a host certificate the request is contained in the file
</P>

<CODE>/etc/grid-security/hostcert_request.pem
</CODE>
<P>
      For a service certificate the request is contained in the file
</P>

<CODE>/etc/grid-security/SERVICE/SERVICEcert_request.pem
</CODE>
<P>
      where SERVICE is the name of your service.

</P>

<P>
      To see the certificate request use cat to view the file. The end of the file should look similar to this:
</P>

<CODE>-----BEGIN CERTIFICATE REQUEST-----<br>
MIIBkTCB+wIBADBSMRswGQYDVQQKExJkb2VzY2llbmNlZ3JpZC5vcmcxETAPBgNV<br>
BAsTCFNlcnZpY2VzMSAwHgYDVQQDExdob3N0L2Jhc2lsLnBoeXMudXdtLmVkdTCB<br>
nzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEA08yU+hyK1laSRV5MjnQcNSdPUMjN<br>
CLkjSxKF8stAU8LFHgxlFxEO0r6fPo4FvJ7BI1WsgyUORxXir1OaDgdRS6/VsXLT<br>

PO9YvWRqYozxVR5XRXWgZGMh8mMptLqq0VyKrk6CyGd6oVsJM7uej7YaaExLbd3Z<br>
ap18WqXaXT1A1hECAwEAAaAAMA0GCSqGiIb3DQEBBAUAA4GBAHcoqSJFkiNSuBAL<br>
xkksLzB7gXC4dxMPy31ZBDGoBt7Icd9ywz9IVjRilV4KAnP5rYq9FH8I8CHNNf1T<br>
7We3YyGyFe8gCz2D8zr3BqlJXeyiPHrZ7JMe+zh9seBgY70743fOe5U67xuUsiBi<br>
nq8E+z4NdBra9ihZhkTVXXVofKkW<br>
-----END CERTIFICATE REQUEST-----</CODE>

<P>
      The request still needs to be sent to the DOEGrids CA.
</P>

</LI>

<LI>
<a href="https://pki1.doegrids.org/" target="_new3">Click here to use GridAdmin</a> to submit your Certificate to the DOEGrids CA


<P>
      NOTE: Your web browser will need to be loaded with your PKS12 (.p12) certificate file.
</P>

<OL TYPE="1">
	<LI>Click on GridAdmin Interface in the left panel.</LI>

	<LI>Paste your SSL/Grid Server Certificate request in the text box labeled PKS10 Request</LI>

	<LI>Enter your email address</LI>

	<LI>Select your Virtual Organization</LI>

	<LI>Click Submit</LI>

	<LI>You will be asked to provide your DOEGrids CA Certificate, apon sucessful authenticate you will be provided your Host/Service certificate.</LI>

	<LI>You can ignore or cancel any pop ups</LI>

	<LI>Your certificate will be displayed below the Enrollment Success message.</LI>
</OL>

</LI>
</OL>




-- Main.KyleGross - 27 Sep 2007
