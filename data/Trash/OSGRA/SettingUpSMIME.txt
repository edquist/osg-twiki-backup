%META:TOPICINFO{author="KyleGross" date="1190903087" format="1.1" version="1.1"}%

<H2>Setting UP S/MIME Email
</H2>
<p>
<H3>Using Microsoft Outlook
</H3>
<OL TYPE="1">
	<LI>Click Options inside the message window.</LI>

	<LI>Click Security Settings.</LI>

	<LI>Select Add digital signature to this message.</LI>

	<LI>To select a specific certificate or change to another certificate, click Change Settings.</LI>

	<LI>Click OK.</LI>

	<LI>Compose and send your message.</LI>
</OL>

<H3>Using Thunderbird</H3>

<OL>

<LI>From the Tools menu, select <B>Account Settings...</B> .</LI>

<LI>In the panel on the left, click <B>Security</B> for the account you want to set up for sending signed email.</LI>

<LI>Under the <I>Digital Signing</I> area you need to select your certificate. Click the <B>Select...</B> button to do so. Browse your hard drive for the .p12 file. You can also use the same certificate for encryption.</LI>

<LI>Now you'll need to allow Thunderbird to use the certificate for signing messages. Under the <I>Certificates</I> section click the <B>View Certificates</B> button and on the next panel select the <B>Authorities</B> tab. Scroll through the list of certificates until you get to the ESnet certificates. If the arrow to the left is not expanded (pointing down) click on it and you'll see two certificates:

<UL>
<LI>DOEGrids CA 1</LI>
<LI>ESnet Root CA 1</LI>
</UL>

For each certificate, you'll want to click the <B>Edit</B> button and check all three boxes for the <I>Edit trust settings:</I> to trust the certificate for identifying web sites, mail users, and software makers. Click <B>OK</B>.</LI>

<LI>Click <B>OK</B> until you're out of the <I>Preferences</I>.</LI>

<LI>Compose a new mail message. From the Toolbar click the down-arrow to the left of the <i>Security</I> (lock) icon. To sign the message you'll want to click the <B>Digitally Sign This Message</B> option. If it is selected you'll see a checkmark next to it. You should send a test message to someone you know who can validate that your message.</LI>

</OL>

<H3>Using Mozilla Mail
</H3>
<p>
Open the Tasks menu and choose Mail & Newsgroups


<OL TYPE="1">
	<LI>Open the Edit ment and choose Mail & Newesgroups Account Settings</LI>

	<LI>Find the account you would like to configure in the left panel and click Security under that account.</LI>

	<LI>In the Signing box select Select Certificate</LI>

	<LI>A dialog box will appear, select the certificate you would like to use and click OK.</LI>

	<LI>In the Signing box select Digitally sign messages</LI>
</OL>

<H3>Mac OS X Mail</H3>

<P>
These instructions are based on Sam Finn's original instructions provided as is, without warranty implied or explicit with one minor change to allow the Mail.app to access the users private key.
</P>

<OL>
<LI>
This works only with Mac OS 10.3 and above. You must have already obtained your certificate using, e.g., Netscape: you can't request and retrieve a cert using either Safari or Internet Explorer on the Mac. The following only works if the e-mail address that you send e-mail with is the same as the e-mail address associated with your cert. Capitalization is important.
</LI>

<LI>
Save your cert to disk
</LI>
<OL TYPE="1">
	<LI>         From Netscape preferences, go to Privacy & Security</LI>
	<LI>         Select Certificates</LI>
	<LI>         Click on Manage Certificates</LI>

	<LI>         Highlight your Certificate</LI>
	<LI>         Click on Backup, follow prompts and save to the desktop</LI>
	<LI>         Quit netscape: you won't need it anymore</LI>
</OL>

<LI>
Add your cert to your keychain by double-clicking on the cert you just saved to disk. Keychain should open and you will be asked Do you want to add certificate(s) from the file .... If offered a drop-down menu, select the Keychain whose name is your (mac) username or select login. You will need to enter the password you used to encode the certificates when you saved them to disk in the last step.
</LI>

<LI>
Allow the Mail.app access to your private key. Click on the private key you just added in Keychain and select the Access Control tab. Under Always allow access by these applications click Add and the browse to the Mail application. Add it to the list.
</LI>

<LI>
Get the DOEGrids CA and ESNet CA certs. Using Safari go to http://www.doegrids.org/pages/Fingerprints.htm and download the PEM encoded ESnet Root CA 1 Certificate by option-clicking on the link. You should get a file named d1b603c3.0. Move it to the desktop if it is not already there. Download the PEM encoded DOEGrids Root CA 1 Certificate by option-clicking on the link. You should get a file named 1c3f2ca8.0. Move it to the desktop if it is not already there.
</LI>

<LI>
Modify your system X509Anchors. In this step you will inform your system that it should trust the CA that signed your certs. Make a copy of your system X509Anchors:<br>


<CODE>sudo cp /System/Library/Keychains/X509Anchors /System/Library/Keychains/X509Anchors.orig
</CODE><p>
      Add the ESNet cert to X509Anchors:<br>

<CODE>sudo certtool i ~/Desktop/d1b603c3.0 v k=/System/Library/Keychains/X509Anchors
</CODE><p>
<CODE>sudo certtool i ~/Desktop/1c3f2ca8.0 v k=/System/Library/Keychains/X509Anchors
</CODE><br><br>
      You should get, in both cases, the message ...certificate successfully imported.
<P>
You're done! (Re)Start mail. Open a compose window. You should see, in thearea on the far right just below the subject text box, an icon that looks like a 10 pointed star. It is clickable. If depressed then your message will besigned with your cert; if not, it will not be signed.
</P>

<P>
When you receive a signed e-mail, the mac mail app should recognize the signature as valid because it knows to trust the DOEGrids CA.
</P>

When you are sending mail to someone whose cert is in your keychain, you will have a second clickable box next to the signature star. That box will looklike a padlock. If you click on it, then the message you send will be encrypted to them. 
</LI>

</OL>


-- Main.KyleGross - 27 Sep 2007
