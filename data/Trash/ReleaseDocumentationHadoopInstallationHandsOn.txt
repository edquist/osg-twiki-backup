%META:TOPICINFO{author="MichaelThomas" date="1280941657" format="1.1" version="1.2"}%
%META:TOPICPARENT{name="WebHome"}%
---+!! *<nop>%SPACEOUT{ "%TOPIC%" }%*
%TOC%

---++Introduction
This tutorial covers the installation of a SE based on !Hadoop and !Bestman Gateway.  At the end of this tutorial you will be able to use srm to copy files into and out of the SE, access files through a local filesystem mount, and know how to add more storage space to Hadoop.

---++Requirements

The participants will need to have a minimum of three servers and root access on both servers, but four or more is ideal.  All servers should have a single public IP address. All servers must have the fuse kernel module and fuse userspace packages installed. All servers must have Sun Java 1.6 installed. A working gums service is required for user mappings on the !GridFTP server; grid-mapfile mappings are not currently supported. One server will run the Hadoop NameNode, Bestman, and Gridftp processes. The NameNode server must have at least 4GB of memory.  The !Bestman+GridFTP server must have a valid host or service certificate installed in /etc/grid-security/{hostcert.pem,hostkey.pem} (for gridftp) and /etc/grid-security/http/{httpcert.pem,httpkey.pem} (for !BestMan). 

If you have only three servers, then one will run the !Hadoop !Datanode, one will run the !NameNode, and the other will run the Secondary !NameNode + !BestMan + !GridFTP

If you have four servers then one will run the !Hadoop !Datanode, one will run the !NameNode, one will run the Secondary !Namenode, and the third will run !BestMan + !GridFTP

It is possible, though highly discouraged, to use only two servers by omitting the Secondary Namenode.

---++More Information

---++Commands

Install Hadoop on both the Namenode and datanode with the same commands as the root user:

<pre class="screen">
rpm -ivh http://vdt.cs.wisc.edu/hadoop/osg-hadoop-1-2.el5.noarch.rpm
yum install hadoop
</pre>

Configure Hadoop on the Namenode by editting =/etc/sysconfig/hadoop=.  Configure Hadoop on the Datanode by editting =/etc/sysconfig/hadoop=.  Configure Hadoop on the Secondary Namenode by editting =/etc/sysconfig/hadoop=.  Start Hadoop on the namenode first, then on the datanode second, and finally on the Secondary Namenode using the same set of commands on each:

<pre class="screen">
service hadoop-firstboot start
chkconfig hadoop on
service hadoop start
</pre>

At this point you should be able to point your web browser at =http://namenode:9000/= and see your namenode status page and a single datanode.  You can also copy files into and out of HDFS using the native hadoop commands, such as:

<pre class="screen">
hadoop fs -copyFromLocal /etc/hosts /hosts.txt
</pre>

Verify that the file was copied with:

<pre class="screen">
hadoop fs -ls /
</pre>

Now you can try mounting the POSIX fuse mount for hadoop by adding the following to =/etc/fstab=

<pre class="screen">
hdfs# /mnt/hadoop fuse server=namenode.host,port=9000,rdbuffer=32768,allow_other 0 0
</pre>

Now mount the filesystem with:

<pre class="screen">
mkdir -p /mnt/hadoop
mount /mnt/hadoop
</pre>

At this point you should be able to ls, cat, cp, and rm files in =/mnt/hadoop=.  Verify that the file you copied earlier with the native hadoop commands appears in the POSIX fuse mount. 

Install !GridFTP on the !Namenode (TBD)

Install !BestMan SRM on the !Namenode (TBD)

---++Presentation
Can include attached PDF presentation. Until you attach the presentation you'll see a Not Found error.

<embed src="%ATTACHURL%/presentation2.pdf" width="792" height="612">

---++References

   1 https://twiki.grid.iu.edu/bin/view/Storage/Hadoop
   1 https://twiki.grid.iu.edu/bin/view/Storage/HadoopInstallation
   1 https://twiki.grid.iu.edu/bin/view/Storage/HadoopGridFTP
   1 https://twiki.grid.iu.edu/bin/view/Storage/HadoopSRM

%BR%

---++ *Comments*
%COMMENT{type="tableappend"}%

<!--
   * Set USERSTYLEURL = https://twiki.grid.iu.edu/twiki/pub/ReleaseDocumentation/HandsOn/centerpageborder.css
-->

%BR%
%COMPLETE1% %BR%
%RESPONSIBLE% you %BR%
%REVIEW%