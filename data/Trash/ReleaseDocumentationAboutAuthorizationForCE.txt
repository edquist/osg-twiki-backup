%META:TOPICINFO{author="IwonaSakrejda" date="1285890939" format="1.1" version="1.29"}%
%META:TOPICPARENT{name="ComputeElementInstall"}%
---+!! *<nop>%SPACEOUT{ "%TOPIC%" }%*
%DOC_STATUS_TABLE%
%TOC%

---++ About this Document

%TWISTY{%TWISTY_OPTS_REVIEW%}%
Explain what this document is about, who the target audience is and what will be explained.
%ENDTWISTY%

---++ Introduction

You'll need to determine the authorization mode you wish to implement.  The authorization mode determines who can access your resources and how.  OSG supports three scenarios: 

   * [[#Local_grid_mapfile][Grid3/Local]] (does not use GUMS)
   * [[#Compatibility][Compatibility]]
   * [[#Full_Privilege][Full Privilege]].  

The flowchart and brief sections below will help you decide the appropriate configuration for your CE.
%NOTE% In order to run in Compatibility or Full Privilege mode, a GUMS server must be installed at your site.  Installation and configuration instructions are available in the [[InstallConfigureAndManageGUMS][Install Configure and Manage GUMS topic]].  For additional background information, see [[Documentation/UserAuthAndPrivilege][An Introduction to User Authorization and Privilege in OSG]].

     <img src="%ATTACHURLPATH%/auth-flowchart.png" alt="auth-flowchart.png" width='544' height='658' />    

%TWISTY{%TWISTY_OPTS_REVIEW%}%
* wrong order in first two sentences.
* link to Glossary for GUMS
* the image needs a caption that explains it. It could be slightly smaller to be displayed inside the page and slightly bigger when clicked on.
%ENDTWISTY%

---++ Local grid-mapfile 

Authorization is performed only via the grid-mapfile on the CE host.  The grid-mapfile is either created manually or by using the =edg-mkgridmap= root cron entry.  This cron uses a configuration file =edg-mkgridmap.conf=, located in =$VDT_LOCATION/edg/etc=.  The =edg-mkgridmap.conf= file is installed by a VO package and can be used to add or update VO information.  The OSG Operations sends announcements regarding this package VO support centers and to the =osg-sites@opensciencegrid.org= mailing list.    A GUMS server is not used in this mode.

If a site operates multiple CE's, then manual synchronization of the grid-mapfiles is required.  You may prefer this configuration if:
   * You operate a small site (one gatekeeper) 
   * You deal with a small set of semi-static VOs
   * You are *not* supporting  *role-based* authorization (VOMS proxies with extended attributes)

See [[LocalAuthPreConfig][local grid-mapsfile web page]] for more details.

%TWISTY{%TWISTY_OPTS_REVIEW%}%
* be more expressive, think of a reader that has no clue what you are talking about.
* if you first mention tools, link to them or their description in the Glossary
* who should subscribe to the mailing list you mentioned? How do I subsribe?
* small is a relative term - explain what you mean by small VO
* don't use () in lists, avoid all together in general. Explain what you want to say in own sentence
%ENDTWISTY%

---++ Compatibility 
Authorization is performed via the grid-mapfile on the gatekeeper, but the grid-mapfile is created using a GUMS server for the site.    A GUMS server will poll various VOMS servers periodically and will create and/or update the grid-mapfile.  If the site has only one GUMS server (one communication point to a set of one or more VOMS servers), centralized mapping is enabled.  Given the GUMS configuration options, account pools (many accounts, one-to-one DN-to-account mapping) can be implemented as well as group accounts (many-to-one DN-to-account mapping).  You should consider this configuration if:
   * Your gatekeeper(s) or service must be configured using a grid-mapfile (i.e., you have tools or services that manipulate this file directly, without passing through Globus)
   * You want the update features a GUMS service brings, but don't necessarily want to depend on 24x7 availability of this service (required for Full Priviledge mode, below).
   * You are *not* supporting  *role-based* authorization (VOMS proxies with extended attributes)

See [[Trash.ReleaseDocumentationCompatibilityAuthPreConfig][compatibility mode web page]] for more details.

%TWISTY{%TWISTY_OPTS_REVIEW%}%
* If I were a first time reader I were lost in terms that all have no been linked to the Glossary to be explained or explained on the page.
* avoid the inline () in sentences
* why visiting the last link? More details is fairly general, though often used.
* I thought we had agreed to drop all references to Compatibility mode. If so, this entire section should be struck from the twiki.  As mentioned elsewhere, configure-osg gives you no possible way to configure Compatibility mode anymore, it is either gridmap, prima, or xacml.
%ENDTWISTY%

---++ Full Privilege  
This scenario uses (an always available) GUMS service and *does not* use a grid-mapfile.   The Gram or !GridFTP gatekeepers  callout to the PRIMA module upon receipt of each request, PRIMA forwards the request to the GUMS service which performs the dynamic mapping.  PRIMA can process _Fully Qualified Attribute Names_ (FQAN), thus enabling DN to Unix account mapping based on VO groups and roles as defined in a VOMS server by a VO administrator.  Note:
   * In Full Privilege mode, the GUMS service must always be available.
   * A single GUMS service providing identity mapping services for a number of CEs at a site becomes a single point of authentication failure, therefore care must be taken to monitor the health of the host and availability of the service.   In this case a fail over server may be desirable, but there are additionally monitoring services provided. 

See [[FullPrivPreConfig][Full Privilege web page]] for more details.

%TWISTY{%TWISTY_OPTS_REVIEW%}%
same comments as in previous paragraphs
%ENDTWISTY%

%STOPINCLUDE%
%BR%

<!-- REVIEW PROCESS

   <!-- OWNER: please define the Document Role -->
   * Local DOC_ROLE		  = SysAdmin
   
   <!-- OWNER: please define the Document Type -->
   * Local DOC_TYPE		  = Knowledge
   
   <!-- OWNER: please define the Document Area -->
   * Local DOC_AREA               = ComputeElement

   <!-- OWNER: please edit! -->
   * Local OWNER                    = MineAltunay
   * Local INCLUDE_REVIEW  = %YES%
   * Local INCLUDE_TEST   = %NO%
   * Local REVIEW_READY   = %YES%
   * Local TEST_READY     = %NO%
   * Local RELEASE_READY  = %NO%

   <!-- REVIEWER: please edit the section below (%UNDEF% = 'in progress', %TRUE% = 'passed', %FALSE% = 'failed') -->
   * Local REVIEWER       = RobertEngel
   * Local REVIEW_PASSED  = %NO%
 
      
-->

%META:FILEATTACHMENT{name="auth-flowchart.png" attachment="auth-flowchart.png" attr="" comment="" date="1274380900" path="auth-flowchart.png" size="91338" stream="auth-flowchart.png" tmpFilename="/usr/tmp/CGItemp4637" user="SuchandraThapa" version="1"}%
%META:FILEATTACHMENT{name="auth-flowchart.graffle" attachment="auth-flowchart.graffle" attr="" comment="" date="1274380997" path="auth-flowchart.graffle" size="174797" stream="auth-flowchart.graffle" tmpFilename="/usr/tmp/CGItemp4868" user="SuchandraThapa" version="1"}%
%META:TOPICMOVED{by="AnneHeavey" date="1192833710" from="Integration/ITB_0_7.AboutOsgAuthorizationForCE" to="Integration/ITB_0_7.AboutAuthorizationForCE"}%
