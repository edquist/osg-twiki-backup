%META:TOPICINFO{author="BrianLin" date="1410551272" format="1.1" version="1.2"}%
%META:TOPICPARENT{name="WebHome"}%
---+ Writing Routes for HTCondor CE

---++ HTCondor batch systems

---+++ Accounting Groups

Accounting groups are an HTCondor construct that allows for sharing compute time amongst groups of users rather splitting time based on Unix user name ([[http://research.cs.wisc.edu/htcondor/manual/v8.0/3_4User_Priorities.html#SECTION00447000000000000000][documented here]]). These groupings are HTCondor-specific and are not related to Unix user groups. In the past, admins used UID and extattr table files with their GRAM CE's to assign jobs to certain accounting groups based on username or proxy info ([[https://twiki.grid.iu.edu/bin/view/Documentation/Release3/InstallComputeElement#7_2_Configuring_your_CE_to_use_C][documented here]]). This option still works but can be overriden in your own routes if you so choose.

---++++ Using HTCondor !ClassAds

Assigning an accounting group to a job is very flexible when using the !ClassAd language. Here's a basic example that takes all jobs and assigns them to the =osg_group.= group with the job's owner appended e.g. a job owned by =bob= would end up with the group =osg_group.bob=:

<pre class="file">
JOB_ROUTER_ENTRIES = \
   [ \
     GridResource = "condor localhost localhost"; \
     eval_set_GridResource = strcat("condor ", "$(FULL_HOSTNAME)", "$(FULL_HOSTNAME)"); \
     TargetUniverse = 5; \
     name = "OSG Accounting"; \
     %RED%eval_set_AccountingGroup = strcat("osg_group.", Owner);\%ENDCOLOR%
   ] 
</pre>

---++ Other batch systems

---++ Quirks and Pitfalls

   * If a value is set in JOB_ROUTER_DEFAULTS with =eval_set_&lt;variable&gt;= and you want to override it, you will need to use =eval_set_&lt;variable&gt;= in the JOB_ROUTER_ENTRIES.
   * Before the last square bracket (]), make sure all lines end in a line continuation character (backslash (\)).

-- Main.BrianLin - 11 Sep 2014