%META:TOPICINFO{author="KyleGross" date="1225985965" format="1.1" version="1.5"}%
%META:TOPICPARENT{name="TimSilversSandbox"}%
---+ How do I update the VirtualOrganizations/VOInfo package?

---+++ Login to funafuti.uits.indiana.edu. 

   <verbatim>$ cd /home/wwws/OSG/pacman/tarballs/vo-version</verbatim>

---+++ Copy current files to previous version files.

   <verbatim>$ cp edg-mkgridmap.osg edg-mkgridmap.osg.prev</verbatim>
   <verbatim>$ cp gums.template gums.template.prev</verbatim>

---+++ Update the three files that will require updates/additions (*How? Are there 'gotchas'?*)

   * edg-mkgridmap.osg
   * gums.template
   * vomses

Make sure the *install-vo.sh* file is set to permissions of 775.

---+++ Create diff files for review

<verbatim>$ diff edg-mkgridmap.osg edg-mkgridmap.osg.prev > edg-mkgridmap.osg.diff</verbatim>
<verbatim>$ diff gums.template gums.template.prev > gums.template.diff</verbatim>

---+++ Communicate with the VirtualOrganizations/VOInfo-Admins 

Make sure they have seen and agree to the new package. The mail should include a link to the new VirtualOrganizations/VOInfo package directory and provide a time line for feedback. Here is an example from the SBGrid VirtualOrganizations/VOInfo Addition.

<pre>
VO Admins,

There is a new VO Package to be release on Wednesday that includes
the new SBGrid VO. Please review the files at http://software.grid.iu.edu/
pacman/tarballs/vo-version/ for comment.

Thanks,
Rob
</pre>

---+++ Copy the vomses file to the client VirtualOrganizations/VOInfo package

<verbatim>$ cd home/wwws/OSG/pacman/tarballs</verbatim>

<verbatim>$ cp vo-version/vomses vo-client/vomses</verbatim> 

---+++ Create the new tarballs

The # in the below commands can be determined by looking at the previous version of the tarballs being used in /home/wwws/OSG/pacman/vo-package and /home/wwws/OSG/pacman/vo-client.

<verbatim>$ tar czvf vo-package-<#>.tar.gz vo-versions/</verbatim> 
<verbatim>$ tar czvf vo-client-0.6-<#>.tar.gz vo-client-0.6/</verbatim> 

---+++ Update the pacman files to point at the new tarballs.

<verbatim>$ cd /home/wwws/OSG/pacman</verbatim>

---+++ Edit _vo-package.pacman_ and _vo-client.pacman_ to refer to the new tarball version number. 

   1. In _vo-package.pacman_ you will update this line:

<verbatim>download    = { 'unix': 'vo-package-7.tar.gz' }</verbatim>  (In this case 7 is the version number that will be updated.)

   2. In _vo-client_ you will update the following lines. (In this case 11 is the version number that will be updated.) (*Again, change the version number to the next in the sequence.*)

<verbatim>description ('OSG VirtualOrganizations/VOInfo Client v0.6.0-11')
downloadUntar ('http://software.grid.iu.edu/pacman/tarballs/vo-client-0.6-11.tar.gz'
, 'VO')</verbatim>

---+++ Test the package

Install the package on your ITB node:

<verbatim>pacman -update OSG:vo-package</verbatim>

---+++ Send announcement

<pre>
Support Centers,

There is a new VO package which includes removals of the VOMS instances of iVDGL, GROW, and GADU.

All OSG resources and GUMS administrators are encouraged to upgrade as soon as possible to remove these no longer used VOMS.

For resources OSG Version 0.8.0 and higher:

pacman -update OSG:vo-package

For OSG Client users please use (Note: This works for both 0.8 and 1.0 releases.):

pacman -update OSG:vo-client-0.6

Please contact the GOC with any questions.
</pre>


-- Main.TimSilvers - 17 Oct 2008