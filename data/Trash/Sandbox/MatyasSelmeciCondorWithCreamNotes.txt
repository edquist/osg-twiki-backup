%META:TOPICINFO{author="MatyasSelmeci" date="1340151980" format="1.1" version="1.9"}%
%META:TOPICPARENT{name="Main.MatyasSelmeci"}%
%TOC%

---+ Top
Source website:

http://emisoft.web.cern.ch/emisoft/dist/EMI/2/sl5/SRPMS/base/
http://emisoft.web.cern.ch/emisoft/dist/EMI/2/sl6/SRPMS/base/

Common problems:

<pre>BuildArch: %{_arch}</pre> line prevents the package from building on all architectures.

---+ The List

Key:
 I - imported
 F - failed
 x - built
 X - built, see note

| *Status* | *Filename* | *Notes* |
| Client |||
| x | glite-jobid-api-c-2.1.2-2.src.rpm | pass-through |
| x | glite-jobid-api-cpp-1.2.0-5.src.rpm | pass-through, needs glite-jobid-api-c |
| X | glite-wms-utils-classad-3.3.0-2.sl{5,6}.src.rpm | |
| X | glite-wms-utils-exception-3.3.0-2.sl{5,6}.src.rpm | |
| X | glite-jdl-api-cpp-3.3.0-3.sl{5,6}.src.rpm | needs glite-jobid-api-c-devel, glite-jobid-api-cpp-devel, glite-wms-utils-classad-devel, glite-wms-utils-exception-devel |
| x | glite-lbjp-common-gss-3.1.3-2.src.rpm | pass-through |
| x | glite-lbjp-common-gsoap-plugin-3.1.2-2.src.rpm | pass-through; needs glite-lbjp-common-gss-devel |
| I | glite-ce-cream-cli-1.14.0-4.sl5.src.rpm | needs glite-jdl-api-cpp, glite-ce-cream-client-devel, glite-jobid-api-c-devel, glite-lbjp-common-gsoap-plugin-devel |
|   | glite-ce-cream-client-api-c-1.14.0-4.sl5.src.rpm | |
|   | glite-ce-cream-utils-1.2.0-4.sl5.src.rpm | |
| Service |||
| x | glite-ce-common-java-1.14.0-4.sl5.src.rpm | |
| X | argus-parent-1.5.0-3.sl5.src.rpm | |
| X | argus-pep-common-2.2.0-1.sl5.src.rpm | needs argus-parent |
| x | argus-pep-api-java-2.1.0-1.sl5.src.rpm | needs argus-pep-common |
| x | emi-delegation-interface-2.0.3-1.sl5.src.rpm | |
| X | emi-delegation-java-2.2.0-2.sl5.src.rpm | needs emi-delegation-interface, voms-api-java |
| x | glite-ce-wsdl-1.14.0-4.sl5.src.rpm | |
| x | glite-jdl-api-java-3.2.0-3.sl5.src.rpm | |
| F | glite-ce-cream-api-java-1.14.0-4.sl5.src.rpm | needs glite-jdl-api-java, emi-delegation-java, glite-ce-common-java, glite-ce-wsdl, argus-pep-api-java |
| F | glite-ce-cream-1.14.0-4.sl5.src.rpm | needs glite-ce-cream-api-java |

---+ Notes

---++ argus-parent

Needed to conditionalize the maven builddep. On el6, I use =maven=, on el5 I use =maven2=

---++ argus-pep-common

Still need our fixed maven-surefire-plugin files from the older version of this build.

---++ glite-ce-cream

*TODO* I don't like the way it starts tomcat on install. Fix that.

---++ emi-delegation-java

Needs =voms-api-java=. This is the same thing as =vomsjapi=.

=voms-api-java= was split out from voms after 2.0.6.


---++ glite-ce-cream-api-java

I was getting =java.lang.NoClassDefFoundError: javax/wsdl/WSDLException= in several places.
Turned out to be having classpath problems. I wrote a patch for the =build.xml= file.

Many errors caused by having outdated versions of =glite-ce-wsdl= and =glite-ce-common-java= so I versioned the dependencies in the spec file.

Right now I'm also having problems with "org.glite.ce.creamapi.ws.es.adl.Target_type0" possibly being outdated.
Target_type0 appears to be a product of the build so I'm not sure what's going on here.

Looks like it builds just fine if I have the EMI third-party repo enabled.
This repo contains a newer version of ant (1.7.1 vs 1.8.2) and axis2 (1.4.1 vs 1.6.1).
Looks like it's axis that's causing it.
We don't get axis from EPEL, we get it from jpackage.


---++ glite-wms-utils-classad

This failed on el6 because of autoconf/libtool differences.
EMI actually has a different SRPM for el6 so I'm taking both, using the spec file from one and using macros to pick which tarball to use.
This only works if =%rhel= is actually defined when rpmbuild is run, both to make the srpm, and to do the build.
osg-build does it right for scratch builds and our buildsys-macros are correct too.
Also had to remove <pre>BuildArch: %{_arch}</pre> since it was making the rpm only build for one arch.

---++ glite-wms-utils-exception

See glite-wms-utils-classad above.

---++ glite-jdl-api-cpp

This one also needs 2 SRPMs, also have to remove =BuildArch=.
Also had to set a few environment variables for configure to succeed because classads and glite-jobid don't have pkgconfig files.



<!-- vim:ft=twiki:tw=0
-->