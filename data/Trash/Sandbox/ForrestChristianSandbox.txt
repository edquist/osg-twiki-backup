%META:TOPICINFO{author="ForrestChristian" date="1179425904" format="1.1" reprev="1.85" version="1.85"}%
%META:TOPICPARENT{name="Main.ForrestChristian"}%
%LINKCSS%

<div class="topnotch">

%WIKIVERSION% 
d24 1
%ACTIVATEDPLUGINS%
USING %BLUE% user *%LOGINNAME%* on host *%LOGINHOST%* %ENDCOLOR%
%PLUGINVERSION%.
<!--                                                                            
   * Set INDIGODIR = %URLPARAM{"indigodir" default="D:\indigoperl"}%
   * Set TWIKIDIR = %URLPARAM{"twikidir" default="D:\twiki"}%
   * Set LOGINHOST = %URLPARAM{"loginhost" default="workshop1.lac.uic.edu" }%
      * Set LOGINIP = %URLPARAM{"loginip" default="131.193.181.56" }%
      * Set GRIDHOST = %URLPARAM{"gridhost" default="tg-login.sdsc.teragrid.org" }%
      * Set OTHERHOST = %URLPARAM{"otherhost" default="workshop2.lac.uic.edu" }%
      * Set CERTSUBJECT = /O=Grid/OU=OSG/CN=Training User 99
      * Set LOGINNAME = %URLPARAM{"loginname" default="train99" }%
      * Set HOMEDIR = /home/%LOGINNAME%
-->
<div style="background-color: #FFFF66">
onLoad="setPref('LOGINNAME', 'Timmy'); setPref('LOGINHOST', 'this.is.my.host.be'); 
d28 1
USING %BLUE% user *%LOGINNAME%* on host *%LOGINHOST%* %ENDCOLOR%

<form name="setPageDefaults" action="%SCRIPTURL%/view/%WEB%/%TOPIC%" onLoad="var doShow = getPref('LOGINNAME'); var doShow = getPref('LOGINHOST');">
<form name="rewrite" action="%SCRIPTURL%/view/%WEB%/%TOPIC%">

*This topic is a !TWikiApplication*. Enter your required paths, and hit "Rewrite the instructions using these paths" to tailor the instructions for your system.
<noautolink>

Login host is: <input name="loginhost" type="text" size="60" value="%LOGINHOST%" /><br />

<input type="submit" value="Rewrite the instructions using these paths" />

<input type="submit" value="Rewrite the instructions using these paths" onClick="setPref('loginname', loginname);"/>
</form>
</div>

---+!! Using Certificates
---+++ Default Credential Location

By default the user certificate and user key are installed in =~/.globus=. Unless overriden explicitly on command line, the clients use these credentials.

<pre class="screen">
[%LOGINNAME% ~]$ <userinput>ls -lt ~/.globus/</userinput>
total 12
-rw-------  1 %LOGINNAME% %LOGINNAME% 1743 Jun 22 16:45 userkey.pem
-rw-------  1 %LOGINNAME% %LOGINNAME% 5011 Jun 22 16:37 usercert.pem
[%LOGINNAME% ~]$ 
</pre>

---++++ Notes

The userkey.pem is the file containing encrypted private key. The permissions on that file are restrictive, such that only the owner can read or write to that file.

The usercert.pem is the certificate, containting the public key. This file is not encrypted and can be distributed freely.




---+ Topics I Edited in the last Two Weeks
Here they are below

<span id="twid_%CALC{$SETM(twisty_id, + 1)$GET(twisty_id)}%show" class="twistyMakeVisible"><a href="#" class="twistyTrigger">more...</a></span>
<span id="twid_%CALC{$GET(twisty_id)}%hide" class="twistyHidden"><a href="#" class="twistyTrigger">close</a></span>
<div id="twid_%CALC{$GET(twisty_id)}%toggle" class="twistyMakeHidden">

%SEARCH{ search="[T]opicInfo.*author\=.*[F]orrest" web="Education, Integration, Integration.ITB_0_5, Documentation, Main" type="regex" scope="all" date="P1w/$today" order="modified" format="$web.$topic" separator=", " }%

</div>


---+ dCache Services
%STARTMore%

| *Location Manager* | Supplies IP address and port of dCache domain |
| *dCache* | Routes messages between dCache services |
| *admin* | Allows login to running services |
| *pnfsManager* | Queries the pnfs service |
| *pinManager* | Prevents modification of files during transfer |
| *replicaManager* | Maintains replica count of files on pools |
| *Billing* | Maintains records and statistics of all transactions |
| *http* | Provides information on state of dCache |
| *gPlazma* | Authorizes users |

%ENDMore%

---++ Fermilab SRM clients
<pre class="screen">
srmcp srm://ligodata.uwm.edu:8443/pnfs/uwm.edu/data/testfile file:////tmp/test.tmp
srmcp srm://storage.ligo.lsu.edu.:8443/pnfs/uwm.edu/data/file.01 srm://ligodata.uwm.edu:8443/pnfs/uwm.edu/data/testfile.01 
</pre>

srmcp uses a GSI X.509 proxy, which can contain attributes for both group and role memberships. 
srmcp can specify for gridftp transfers
Port range
Number of streams
Buffer size, ...
srmls, srmrm

---++ Private Networks and Firewalls
Many dCache installations will have portions on private networks or exist behind firewalls. dCache supports both.

---++ dCache Authorization
dCache supports authorization through put GSI and kerberos. 

Host certificates on SRM, gridftp, gsidcap, gPlazma

Client proxies are delegated within dCache. This allows SRM to act as a client.

Gridftp doors must be on public network

Pools may be on private network. This requires gridFTP adapter for local to SRM transfers, although SRM to SRM transfers may be possible.

Additionally, dCache allows you to specify certain ports or port ranges for use when behind firewalls.


---+++ gPLAZMA
Our prefered authorization is through gPlazma, which allows choice of authorization methods. It support role-based authorization.

Additionally, gPLAZMA can use the GUMS server for centralized administration. This requires that storage obligations be added to GUMS permit decision. 


---+ Generic USCMS Tier2 SRM/dCache Installation Example
<table><tr><td>
Admin node:
   * lmDomain
   * poolManager
   * adminDoor
   * httpDomain 
   * utilityDomain 
   * gplazmaService
   * infoProvider
</td><td>
pnfs node 
   * pnfsManager
   * dirDomain
</td><td>
SRM node
   * Three door nodes running dcap + grid doors
   * Pools on worker nodes or RAID
</td></tr></table>

This should be around 30 terabytes with a throughput of ~20 MB/sec.


---++ Inputs Required for Installation of SRM/dCache
   * Number of storage nodes in your site
      * The installation script suggests service distribution
   * Hostnames
   * Paths to and sizes of your pools
   * Doors: types, number


%BR%

ForrestChristianSandboxDocScientists

------------
%INCLUDE{ "Documentation.ToolsBottomMatter" }%
-- Main.ForrestChristian - 12 Sep 200
   * [[%ATTACHURL%/dcb.css][Stylesheet for HTML file]]
   * [[%ATTACHURL%/InstallingDcacheForOSG.html][Installing dCache for the Open Science Grid]]
   * [[%ATTACHURL%/efc_css_test.css][Tasty css]] 
   * [[%ATTACHURL%/forrestSideBar.css][forrestSideBar.css]]: 
   * [[%ATTACHURL%/forrestSideBar.css][forrestSideBar.css]]: Tasty sidebar css
   * [[%ATTACHURL%/PacmanInfo.html][PacmanInfo.html]]: Printable version of pacmaninfo for testing
  

%META:FILEATTACHMENT{name="natskintest_patternskin_low.gif" attr="" autoattached="1" comment="GIF for JS test" date="1179934676" path="natskintest_patternskin_low.gif" size="80644" user="Main.ForrestChristian" version="1"}%
%META:FILEATTACHMENT{name="dcb.css" attr="" autoattached="1" comment="Stylesheet for HTML file" date="1168467137" path="dcb.css" size="3057" user="Main.ForrestChristian" version="1"}%
%META:FILEATTACHMENT{name="InstallingDcacheForOSG.html" attr="" autoattached="1" comment="Installing dCache for the Open Science Grid" date="1168468793" path="InstallingDcacheForOSG.html" size="59512" user="Main.ForrestChristian" version="2"}%
%META:FILEATTACHMENT{name="javascript_cookies.js" attr="" autoattached="1" comment="Javascript cookies js file" date="1179437627" path="javascript_cookies.js" size="2513" user="Main.ForrestChristian" version="1"}%
%META:FILEATTACHMENT{name="PacmanInfo.html" attr="" autoattached="1" comment="Printable version of pacmaninfo for testing" date="1171647730" path="PacmanInfo.html" size="17888" user="Main.ForrestChristian" version="1"}%
%META:FILEATTACHMENT{name="efc_css_test.css" attr="" autoattached="1" comment="Tasty css" date="1170432403" path="efc_css_test.css" size="2638" user="Main.ForrestChristian" version="8"}%
%META:FILEATTACHMENT{name="forrestSideBar.css" attr="" autoattached="1" comment="Tasty sidebar css" date="1175543808" path="forrestSideBar.css" size="2802" user="Main.ForrestChristian" version="28"}%
