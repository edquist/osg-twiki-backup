%META:TOPICINFO{author="EdgarMauricioFajardoHernandez2" date="1425490011" format="1.1" version="1.2"}%
---+ IPv6 Testing Log: !VOMS

This testing log is part of [[Sandbox.OperationsServicesIPv6CompatibilityTable][OSG IPv6 tests]]. This page captures the specific IPv6 compatibility testing process used for one software component, VOMS. The more general IPv6 template for testing is [[https://twiki.grid.iu.edu/bin/view/SoftwareTeam/IPV6Testing][here]].


---++ Initial Setup

This test used two hosts:

| *Host* | *OS* | *OSG Release* |
| cabinet-10-10-4.t2.ucsd.edu | CentOS release 5.9 (Final) | 3.2 |
| ipv6vm006.fnal.gov | Scientific Linux Fermi release 6.6(Ramsey) | 3.2 |

---+++ Installing software

Next, OSG software was installed on each system. The UCSD host was the client and the FNAL host was the server. And VOMS software was installed following the instructions here [[https://twiki.grid.iu.edu/bin/view/Documentation/Release3/InstallVoms][VOMSInstallation]]

| *Host* | *Package* | *Version* |
| cabinet-10-10-4.t2.ucsd.edu | voms-client |2.0.12-1.osg32.el5 |
| ipv6vm006.fnal.gov | VOMS/ osg-voms| 2.0.12-2.el6 (EPEL)  |


---++ Testing

---+++ Testing the dual-dual configuration: OK

<pre class="screen">
<strong> wget http://ipv6vm006.fnal.gov:9090/ipv6testing/sample.txt</strong>
--2015-03-03 12:48:37--  http://ipv6vm006.fnal.gov:9090/ipv6testing/sample.txt
Resolving ipv6vm006.fnal.gov... 131.225.41.138, 2001:400:2410:29::138
Connecting to ipv6vm006.fnal.gov|131.225.41.138|:9090... connected.
HTTP request sent, awaiting response... 200 OK
Length: 2097152 (2.0M) [text/plain]
Saving to: `sample.txt'

100%[====================================================================================================================>] 2,097,152   2.32M/s   in 0.9s    

2015-03-03 12:48:38 (2.32 MB/s) - `sample.txt' saved [2097152/2097152]

[1248] root@cabinet-10-10-4 ~# md5sum sample.txt 
6bde1331337cd953809ac2c8c09b999c  sample.txt

[root@ipv6vm006 ipv6testing]# md5sum sample.txt
6bde1331337cd953809ac2c8c09b999c  sample.txt
</pre>


---+++ Testing that dual-dual communication defaults to IPv6: Yes with caveats

The option <verbatim>--prefer-family=IPv6</verbatim> needs to be added to the wget in order for it to prefer IPv6

<pre class="screen">
<strong> root@cabinet-10-10-4 ~# wget http://ipv6vm006.fnal.gov:9090/ipv6testing/sample.txt</strong>
--2015-03-03 12:54:33--  http://ipv6vm006.fnal.gov:9090/ipv6testing/sample.txt
Resolving ipv6vm006.fnal.gov... 131.225.41.138, 2001:400:2410:29::138
Connecting to ipv6vm006.fnal.gov|131.225.41.138|:9090... connected.
HTTP request sent, awaiting response... 200 OK
Length: 2097152 (2.0M) [text/plain]
Saving to: `sample.txt.1'

100%[====================================================================================================================>] 2,097,152   2.28M/s   in 0.9s    

2015-03-03 12:54:34 (2.28 MB/s) - `sample.txt.1' saved [2097152/2097152]

[root@ipv6vm006 ipv6testing]# tcpdump -i eth0 -vv ip6 host cabinet-10-10-4.t2.ucsd.edu
tcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size 65535 bytes
0 packets captured
5 packets received by filter
0 packets dropped by kernel
</pre>

<pre class="screen">
<strong>wget http://ipv6vm006.fnal.gov:9090/ipv6testing/sample.txt --prefer-family=IPv6</strong>
--2015-03-03 14:24:27--  http://ipv6vm006.fnal.gov:9090/ipv6testing/sample.txt
Resolving ipv6vm006.fnal.gov... 2001:400:2410:29::138, 131.225.41.138
Connecting to ipv6vm006.fnal.gov|2001:400:2410:29::138|:9090... connected.
HTTP request sent, awaiting response... 200 OK
Length: 2097152 (2.0M) [text/plain]
Saving to: `sample.txt.6'

100%[====================================================================================================================>] 2,097,152   2.46M/s   in 0.8s    

2015-03-03 14:24:28 (2.46 MB/s) - `sample.txt.6' saved [2097152/2097152]

[root@ipv6vm006 ipv6testing]#tcpdump -i eth0 -vv ip host cabinet-10-10-4.t2.ucsd.edu
tcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size 65535 bytes
0 packets captured
5 packets received by filter
0 packets dropped by kernel


[root@ipv6vm006 ipv6testing]# tcpdump -i eth0 -vv ip6 host cabinet-10-10-4.t2.ucsd.edu
825 packets captured
963 packets received by filter
133 packets dropped by kernel

</pre>
---+++ Testing the dual server / IPv4 client configuration: OK
<pre>
<strong>root@cabinet-10-10-4 ~# wget http://ipv6vm006.fnal.gov:9090/ipv6testing/sample.txt</strong>
--2015-03-03 15:02:21--  http://ipv6vm006.fnal.gov:9090/ipv6testing/sample.txt
Resolving ipv6vm006.fnal.gov... 131.225.41.138, 2001:400:2410:29::138
Connecting to ipv6vm006.fnal.gov|131.225.41.138|:9090... connected.
HTTP request sent, awaiting response... 200 OK
Length: 2097152 (2.0M) [text/plain]
Saving to: `sample.txt.23'

100%[====================================================================================================================>] 2,097,152   2.89M/s   in 0.7s    

2015-03-03 15:02:21 (2.89 MB/s) - `sample.txt.23' saved [2097152/2097152]

<strong> root@cabinet-10-10-4 ~# wget http://ipv6vm006.fnal.gov:9090/ipv6testing/sample.txt --prefer-family=IPv6</strong>
--2015-03-03 15:01:13--  http://ipv6vm006.fnal.gov:9090/ipv6testing/sample.txt
Resolving ipv6vm006.fnal.gov... 2001:400:2410:29::138, 131.225.41.138
Connecting to ipv6vm006.fnal.gov|2001:400:2410:29::138|:9090... failed: Network is unreachable.
Connecting to ipv6vm006.fnal.gov|131.225.41.138|:9090... connected.
HTTP request sent, awaiting response... 200 OK
Length: 2097152 (2.0M) [text/plain]
Saving to: `sample.txt.22'

100%[====================================================================================================================>] 2,097,152   3.14M/s   in 0.6s    

2015-03-03 15:01:14 (3.14 MB/s) - `sample.txt.22' saved [2097152/2097152]
</pre>

-- Main.EdgarMauricioFajardoHernandez2 - 03 Mar 2015
