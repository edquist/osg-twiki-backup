%META:TOPICINFO{author="ArvindGopu" date="1234379423" format="1.1" reprev="1.11" version="1.11"}%
%META:TOPICPARENT{name="WebHome"}%
---++ Installation

This page provides instructions geared towards GOC staff for installing the [[https://twiki.grid.iu.edu/bin/view/MeasurementsAndMetrics/RsvReportsOverview][RSV reporting system]]. This service is installed currently on the machine that runs =rsv.grid.iu.edu=.
---+++ Install the Nebraska YUM repository

Install the following RPM on SL5 / i686:
<verbatim>
rpm -i http://t2.unl.edu/store/rpms/SL5/i686/Nebraska-repo-0.1-1.noarch.rpm
</verbatim>

For other platforms, the correct RPM is documented here:

http://t2.unl.edu/documentation/dcache/dcachenebraska-install

---+++ Install the RSV Reports RPM

Note, the RPM might require other RPMs/packages -- I will add more information on the yum commands needed, etc. soon. -agopu
<verbatim>
yum install RSV-Reports
</verbatim>

---++ Configuration

---+++ Update the reports config file (and the logging config file)
   * Edit =/etc/rsv_logging.conf=, as shown below: <pre> . . . args: ['/var/log/rsvreports/main.log', 'a', 2097152, 5] . . . [logger_root] level: INFO handlers: console,file . . . </pre> 

   * Copy the file =/etc/rsvreports.conf.template= to =/etc/rsvreports.conf=. 
   * Edit the file; add the necessary passwords to connect to the RSV database; 
   * Also edit fromName, fromEmail, toName, and toEmail as applicable (for each report); See [[#recipients][Who gets these reports section below]]. 
   * If you want to run in debug mode (the v13 report takes an exceptionally long amount of time to generate, sometimes more than an hour), set debug=true in the rsv section of the config file.  This will run the report much faster, but use bogus data.
   * If you want to archive the reports to disk, in the rsv section set report_archive_directory to a directory that the reports user can write into.  The files will be saved under the naming convention: =YEAR/MONTH/DAY/Report_name.html=.

---+++ Additional Reports: WLCG comparison Report; and ATLAS/CMS Reports

   * Create a separate config file for ATLAS and CMS VO's reports plus one for the RSV vs. WLCG comparison report; I call them =rsv_reports_cms.conf=, =rsv_reports_atlas.conf=, =rsv_reports_wlcg_compare.conf=, all in /etc. 
      * Use the exact same config as the primary config file in =/etc/rsvreports.conf=, with the exception(s) noted below. 

   * Update the destination email addresses as appropriate. See [[#recipients][Who gets these reports section below]]. Make sure you are able to send emails to the mail lists. 

---+++ Cron Setup
   * Comment out =/etc/cron.daily/rsvreports.cron=; At the GOC, we're just going to use root's crontab ( =crontab -e= as =root=) to schedule these reports. 
   * Create /var/log/rsvreports/ if need be. 
   * Here's what we have as of 2008-09-12. 

<verbatim>
## Added for additional rsvreports; times in UTC; by agopu 2008-09-10 
01 7 * * * rsvreport -d production -r yesterday -v7 -c /etc/rsvreports_wlcg_compare.conf 1>> /var/log/rsvreports/v7.out 2>> /var/log/rsvreports/v7.err
06 7 * * * rsvreport -d production -r yesterday -v9 -c /etc/rsvreports_atlas.conf 1>> /var/log/rsvreports/v9.out 2>> /var/log/rsvreports/v9.err
11 7 * * * rsvreport -d production -r yesterday -v11 -c /etc/rsvreports_atlas.conf 1>> /var/log/rsvreports/v11.out 2>> /var/log/rsvreports/v11.err
16 7 * * * rsvreport -d production -r yesterday -v10 -c /etc/rsvreports_cms.conf 1>> /var/log/rsvreports/v10.out 2>> /var/log/rsvreports/v10.err
21 7 * * * rsvreport -d production -r yesterday -v12 -c /etc/rsvreports_cms.conf 1>> /var/log/rsvreports/v12.out 2>> /var/log/rsvreports/v12.err
## Have v13 as the last entry since it takes about 20 mins to complete! -agopu 2008-09-11
# 30 7 * * * rsvreport -d production -r yesterday -v13 /etc/rsvreports.conf 1>> /var/log/rsvreports/v13.out 2>> /var/log/rsvreports/v13.err
</verbatim>

V7, V11, and V12 are the RSV vs WLCG comparison reports; V9 and V10 are the VO-specific reports. By default, V13 should also be run and sent to the osg-sites list every day.

<a name="recipients"></a>
---+++ Who gets these reports?

   1 RSV report for all OSG resources/services that are being monitored by RSV clients. 
      * Sent to GOC, osg-sites, osg-accounting-info, and Arvind Gopu 
   1 RSV vs. WLCG comparison report 
      * Sent to a select group of people; currently: GOC, 'Rob Gardner', 'Michael Ernst', 'Frederick Luehring', 'Ruth Pordes' ,RSV SAM mailing list -- includes Brian Bockelman, Rob Quick, Arvind Gopu, and SAM/GridView team members.
   1 ATLAS VO specific reports
      1 RSV report for only ATLAS resources
      1 RSV vs. WLCG comparison report only for ATLAS resources 
         * Sent to GOC, USAtlas mailing list (usatlas-grid-l lists.bnl.gov - replace space with @), and Arvind Gopu
   1 CMS VO specific reports 
      1 RSV report for only CMS resources 
      1 RSV vs. WLCG comparison report only for CMS resources 
         * Sent to GOC, CMS-T2 mailing list (cms-t2 fnal.gov - replace space with @), and Arvind Gopu

-- Main.BrianBockelman - 05 Jun 2008

-- Main.ArvindGopu - 06 Nov 2008
