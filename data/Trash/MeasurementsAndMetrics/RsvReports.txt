%META:TOPICINFO{author="ArvindGopu" date="1221224581" format="1.1" reprev="1.6" version="1.6"}%
%META:TOPICPARENT{name="WebHome"}%
---++ Installation

---+++ Install the Nebraska YUM repository

Install the following RPM on SL5 / i686:
<verbatim>
rpm -i http://t2.unl.edu/store/rpms/SL5/i686/Nebraska-repo-0.1-1.noarch.rpm
</verbatim>

For other platforms, the correct RPM is documented here:

http://t2.unl.edu/documentation/dcache/dcachenebraska-install

---+++ Install the RSV Reports RPM

Note, the RPM might require other RPMs/packages -- I will add more information on the yum commands needed, etc. soon. -agopu
<verbatim>
yum install RSV-Reports
</verbatim>

---++++ Extra dependencies for the RSV vs WLCG Comparison report

The RSV vs WLCG comparison report requires an additional perl module which is not available in RPM form. However, it is installable via CPAN [note: doing perl -MCPAN -e 'install Spreadsheet::ParseExcel' did not work for me .. it said, it did not know what that module was...]

<verbatim>
  $ cpan
  cpan> i /SpreadSheet::ParseExcel/
  cpan> install S/SZ/SZABGAB/Spreadsheet-ParseExcel-0.32.tar.gz
</verbatim>

---++ Configuration

---+++ Update the reports config file (and the logging config file)
   * Edit =/etc/rsv_logging.conf=, as shown below: <pre> . . . args: ['/var/log/rsvreports/main.log', 'a', 2097152, 5] . . . [logger_root] level: INFO handlers: console,file . . . </pre> 

   * Copy the file =/etc/rsvreports.conf.template= to =/etc/rsvreports.conf=. 
   * Edit the file; add the necessary passwords to connect to the RSV database; 
   * Also edit fromName, fromEmail, toName, and toEmail as applicable (for each report); See [[#recipients][Who gets these reports section below]]. 

---+++ Additional Reports: WLCG comparison Report; and ATLAS/CMS Reports

   * Create a separate config file for ATLAS and CMS VO's reports plus one for the RSV vs. WLCG comparison report; I call them =rsv_reports_cms.conf=, =rsv_reports_atlas.conf=, =rsv_reports_wlcg_compare.conf=, all in /etc. 
      * Use the exact same config as the primary config file in =/etc/rsvreports.conf=, with the two exceptions noted below. 

   * Update the destination email addresses as appropriate. See [[#recipients][Who gets these reports section below]]. Make sure you are able to send emails to the mail lists. 

   * Update the [wlcg] section to include the T3s and non-MoU sites: 
      * Include both of the following lines in =rsv_reports_wlcg_compare.conf= 
      * Include only the =ATLAS= line in =rsv_reports_atlas.conf= 
      * Include only the =CMS= line in =rsv_reports_cms.conf= 

<verbatim>
[wlcg]
ATLAS=['UTA', 'MWT2', 'BU', 'OU', 'BNL_ATLAS', 'AGLT2', 'IU_OSG', 'SLAC',      'GLOW-ATLAS', 'WT2']
CMS=['Nebraska', 'CIT', 'MIT_CMS', 'Purdue', 'GLOW', 'UCSD', 'UFlorida',      'SPRACE', 'USCMS-FNAL', 'UERJ', 'UCSandiegoOSG']
</verbatim>

---+++ Cron Setup
   * Comment out =/etc/cron.daily/rsvreports.cron=; At the GOC, we're just going to use root's crontab ( =crontab -e= as =root=) to schedule these reports. 
   * Create /var/log/rsvreports/ if need be. 
   * Here's what we have as of 2008-09-12. 

<verbatim>
## Added for additional rsvreports; times in UTC; by agopu 2008-09-10 
01 7 * * * rsvreport -d production -r yesterday -v7 -c /etc/rsvreports_wlcg_compare.conf 1>> /var/log/rsvreports/v7.out 2>> /var/log/rsvreports/v7.err
06 7 * * * rsvreport -d production -r yesterday -v9 -c /etc/rsvreports_atlas.conf 1>> /var/log/rsvreports/v9.out 2>> /var/log/rsvreports/v9.err
11 7 * * * rsvreport -d production -r yesterday -v11 -c /etc/rsvreports_atlas.conf 1>> /var/log/rsvreports/v11.out 2>> /var/log/rsvreports/v11.err
16 7 * * * rsvreport -d production -r yesterday -v10 -c /etc/rsvreports_cms.conf 1>> /var/log/rsvreports/v10.out 2>> /var/log/rsvreports/v10.err
21 7 * * * rsvreport -d production -r yesterday -v12 -c /etc/rsvreports_cms.conf 1>> /var/log/rsvreports/v12.out 2>> /var/log/rsvreports/v12.err
## Have v13 as the last entry since it takes about 20 mins to complete! -agopu 2008-09-11
# 30 7 * * * rsvreport -d production -r yesterday -v13 /etc/rsvreports.conf 1>> /var/log/rsvreports/v13.out 2>> /var/log/rsvreports/v13.err
</verbatim>

V7, V11, and V12 are the RSV vs WLCG comparison reports; V9 and V10 are the VO-specific reports. By default, V13 should also be run and sent to the osg-sites list every day.

<a name="recipients"></a>
---+++ Who gets these reports?

   1 RSV report for all OSG resources/services that are being monitored by RSV clients. 
      * Sent to GOC, osg-sites, and myself 
      * Brian is going to continue sending these till the next version of RPM he expects to release in a day or two. 
   1 RSV vs. WLCG comparison report 
      * Sent to a select group of people; currently: GOC, 'Brian Bockelman', 'Rob Gardner', 'Rob Quick', 'Arvind Gopu', 'Michael Ernst', 'Frederick Luehring', 'Ruth Pordes' 
   1 ATLAS VO specific reports
      1 RSV report for only ATLAS resources
      1 RSV vs. WLCG comparison report only for ATLAS resources 
         * Sent to GOC, USAtlas mailing list (usatlas-grid-l lists.bnl.gov - replace space with @), and myself 
   1 CMS VO specific reports 
      1 RSV report for only CMS resources 
      1 RSV vs. WLCG comparison report only for CMS resources 
         * Sent to GOC, CMS-T2 mailing list (cms-t2 fnal.gov - replace space with @), and myself 

-- Main.BrianBockelman - 05 Jun 2008

-- Main.ArvindGopu - 12 Sep 2008
