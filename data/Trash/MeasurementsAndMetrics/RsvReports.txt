%META:TOPICINFO{author="BrianBockelman" date="1220637434" format="1.1" version="1.5"}%
%META:TOPICPARENT{name="WebHome"}%
---+++ Install the Nebraska YUM repository

Install the following RPM on SL5 / i686:
<verbatim>
rpm -i http://t2.unl.edu/store/rpms/SL5/i686/Nebraska-repo-0.1-1.noarch.rpm
</verbatim>

For other platforms, the correct RPM is documented here:

http://t2.unl.edu/documentation/dcache/dcachenebraska-install

---+++ Install the RSV Reports RPM

<verbatim>
yum install RSV-Reports
</verbatim>

---++++ Extra dependencies for the RSV vs WLCG Comparison report

The RSV vs WLCG comparison report requires an additional perl module which is not available in RPM form. However, it is installable via CPAN [note: doing perl -MCPAN -e 'install Spreadsheet::ParseExcel' did not work for me .. it said, it did not know what that module was...]

<verbatim>
  $ cpan
  cpan> i /SpreadSheet::ParseExcel/
  cpan> install S/SZ/SZABGAB/Spreadsheet-ParseExcel-0.32.tar.gz
</verbatim>

---+++ Update the config file and the cron file

   * Copy the file =/etc/rsvreports.conf.template= to =/etc/rsvreports.conf=. 
   * Edit the file; add the necessary passwords to connect to the RSV database. 
   * Edit =/etc/cron.daily/rsvreports.cron= to reflect any special setup your site might need to get a valid MySQL client. 

---+++ ATLAS and CMS Reports

   * Create a separate config file for each VO; I call them rsv_cms.conf and rsv_atlas.conf.
      * Use the exact same config as the primary config file in /etc/rsvreports.conf, with the two exceptions noted below.
   * Update the destination email addresses as appropriate. Make sure you are able to send emails to the mail lists 
   * Update the CMS and ATLAS lines in the [wlcg] section to include the T3s and non-MoU sites: 

<verbatim>
[wlcg]
ATLAS=['UTA', 'MWT2', 'BU', 'OU', 'BNL_ATLAS', 'AGLT2', 'IU_OSG', 'SLAC',      'GLOW-ATLAS', 'WT2']
CMS=['Nebraska', 'CIT', 'MIT_CMS', 'Purdue', 'GLOW', 'UCSD', 'UFlorida',      'SPRACE', 'USCMS-FNAL', 'UERJ', 'UCSandiegoOSG']
</verbatim>

---+++ WLCG comparison reports

To run the comparison reports (v7), you will want a separate config file if the set of destination email addresses is different from the primary ones.

Create a second copy of /etc/rsvreports.conf (At Nebraska, this is named rsv_v7.conf) and adjust the destination email addresses as necessary.  No other change is needed.

---+++ Sample Crontab
 Currently, additional reports are sent out beyond the standard one with the RPM install. The Nebraska server has the following installed:

<verbatim>
35 1 * * * rsvreport -d production -r yesterday -v7 -c /home/brian/dbinfo/rsv_v7.conf
30 1 * * * rsvreport -d production -r yesterday -v9 -c /home/brian/dbinfo/rsv_atlas.conf
25 1 * * * rsvreport -d production -r yesterday -v11 -c /home/brian/dbinfo/rsv_atlas.conf
20 1 * * * rsvreport -d production -r yesterday -v10 -c /home/brian/dbinfo/rsv_cms.conf
15 1 * * * rsvreport -d production -r yesterday -v12 -c /home/brian/dbinfo/rsv_cms.conf
</verbatim>

V7, V11, and V12 are the RSV vs WLCG comparison reports; V9 and V10 are the VO-specific reports. By default, V13 should also be run and sent to the osg-info-accounting list every day.

-- Main.BrianBockelman - 05 Jun 2008