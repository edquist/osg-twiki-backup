%META:TOPICINFO{author="AshuGuru" date="1357431369" format="1.1" reprev="1.9" version="1.9"}%
%META:TOPICPARENT{name="WebHome"}%
---+ Measurements and Metrics Graphing

Metrics and Measurements provides a web graphing system designed for experts to pull data out of the Gratia system and other data sources.  It is based upon !GraphTool.

---+++ Install Directions
   * Start on a working RHEL-5 compatible system with a functional yum setup with IUGRID repo configured.
   * A newer version of python-cherrypy is required, you may have to add rpmforge repo to host for that.

   * Install the EPEL repository.
      * This is covered here: https://fedoraproject.org/wiki/EPEL/FAQ#howtouse
   * Do =yum install OSG-Measurements-Metrics-Web=
      * This will pull in OSG-Measurements-Metrics-Db, python-matplotlib and python-setuptools
      * If you forget to install the EPEL repository, the python-matplotlib dependency won't correctly resolve.
   * Copy =/etc/DBParam.xml.rpmnew= to =/etc/DBParam.xml=.
   * Fill out the templates in =/etc/DBParam.xml=.  You can set things up so all three connections point to the same Gratia database if you'd like (in fact, this is the usual setup for local collectors).  
      1 For each 'connection' element configuration configure the 'AuthDBUsername' and 'AuthDBPassword' appropriately. 
      1 Open /etc/osg_graphs.conf and configure the following, explanations follow: <pre class="file">
Source = http://localhost:8100/gratia
Enabled = true
Dest = /var/www/html/gratia/
Suffix = .png
UTCOffset = -6
StartDate = 2010-11-01
Replace = true
GenerateHistoricalGraphs = false
</pre>

   * The =Source= variable is the base href for the application depending upon if a proxy server (if used) please modify it appropriately.
   * =Dest= is the absolute path for the static graphic files that are generated by the cron
   * =GenerateHistoricalGraphs= should be set to false to disable building historic static graphs.
    
   * Start up the service with =service !GratiaWeb start=.
   * View the webpage at http://your_hostname.example.com:8100/gratia/xml/
   * The graphs utilize port 8100; it is common practice to use mod_proxy in Apache to put the graphs behind a production webpage.

   *Default log location is /var/log/GratiaWeb-* files

---+++ Development Directions

 The source code for =OSG-Measurements-Metrics= is kept here:

<verbatim>
https://github.com/ashuguru/OSG-Measurements-Metrics
</verbatim>

To rebuild the RPM run the following from the base folder:
<verbatim>
buildrpm.sh
</verbatim>


This will put the new copy of the RPM in =dist/=.  If you want to bump the version number, edit setup/setup_[Web/Db].py; if you want to bump the release number, edit setup/setup_[Web/Db].cfg.  
