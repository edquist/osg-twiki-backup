%META:TOPICINFO{author="ThomasWang" date="1200344751" format="1.1" reprev="1.6" version="1.6"}%
%META:TOPICPARENT{name="RSV"}%
---+ How To Create Your Own RSV Probes

%TOC%


---++ Introduction
The objective of this page is to allow OSG users to create their own RSV probes using the provided RSV infrastructure.  These probes can be tailored to the user's needs, but should always output data in the standard RSV Metric Data Format.  This will allow data collection within the RSV Gratia infrastructure, as well as provide uniformity and seamless interoperability with the WLCG.  The probes are designed to conform to the WLCG standard as described [[https://twiki.cern.ch/twiki/bin/view/LCG/GridMonitoringProbeSpecification][here]].


---++ Getting Started
There are two key parts to writing your own probe.  The probe script itself and the perl module that stores all the subroutines.
Your probe script will provide an interface for the user, accept arguments if specified, and pass input data to the perl module for processing.
The perl module receives the data, performs its tests, and returns the metric results to the probe script for output.
The existing perl module and probes are written in the Perl programming language, so a basic understanding of Perl is needed. 
Worker scripts can be written in another language (ex. shell script) and be called by the probe (acting as a wrapper to handle the data).

To test your probe, you will need a unix account, and a valid proxy, and a service uri (FQDN of resource to test).  Other arguments are optional but may be included such as timeout, etc.   Probes can be tested by hand for functionality (metrics in standard out) and automated into a monitoring host as needed (see Adding a New Probe below).

Local probes have the word "local" in their filename, and run on the
local host; where as all the other probes are run against a remote site.
The local probes are provided mainly to enable site admins to debug their
own "monitoring" hosts, especially during times when they are unable to
run the other probes on remote machines (possibly within their own site) 
because of an expired hostcert or some such. 


---++ The Basics
To write your own probe, you will need to create your own probe script (or use the template below), as well as append additional subroutines to the perl module.  The RSV infrastructure has been throughly developed, so you will have subroutines available to perform basic preliminary checks, pass data to the perl module, print metric results, etc.    You can also call other subroutines that are used in other probes to enhance the exception handling in your new probe.  



---++ A "Hello World" Probe Template
A simple probe template can be found here: hello-world-probe.pl
This probe will 


---++ Adding Your Probe to the RSV Infrastructure
So now you have written a new probe, and want to have it automatically run in the RSV infrastructure (with Gratia reporting, etc).
There is a helpful script that will take care of this for you.  But first we have a few steps to go through:

//discuss add_new_probe script


---++ Contact and Links
<li>To get in touch with the !RSV team, please refer to the [[http://rsv.grid.iu.edu/documentation/rsv-contact-info.html][contact page]]. 
<li>Complete RSV Documentation can be found at the [[http://rsv.grid.iu.edu/documentation][RSV Documentation Pages]]. 
<li>Release documentation for RSV Installation and Configuration is located here: ReleaseDocumentation.InstallAndConfigureRSV


--Main.ThomasWang - 14 Jan 2008 %BR%

%META:TOPICMOVED{by="ThomasWang" date="1193841454" from="MonitoringInformation.WriteYourOwnProbe" to="MonitoringInformation.WriteYourOwnRSVProbe"}%
