%META:TOPICINFO{author="KyleGross" date="1210176454" format="1.1" version="1.7"}%
%META:TOPICPARENT{name="RSV"}%
%TOC%
%LINKCSS%
%BR%

---+ Configure !RSV to use a service cert on your CE or SE.
<p> This document explains how you can configure the authorization system on your CE/SE (!GUMS/Edg-mkgridmap/simple grid-mapfile) to accept !RSV probe jobs.

---++ Resources that use GUMS

---+++ Add !RSV service cert DN manually by editing !GUMS server config file
<p> If you're want to manually add configuration to a !GUMS 1.2 format, to allow an !RSV service cert into your GUMS server config, add the following to the userGroups section in =$VDT_LOCATION/vdt-app-data/gums/config/gums.config= on your !GUMS server:</p>

<pre class="screen">
    &lt;manualUserGroup
        name='rsv'
        access='read all'
        description=''
        persistenceFactory='mysql'/&gt;
</pre>

<p> and add the following to the accountMappers section: </p>

<pre class="programlisting">
    &lt;groupAccountMapper
        name='rsv'
        description=''
         accountName='rsvuser'/&gt;
</pre>

<p> and add the following to the groupToAccountMappings section: </p>

<pre class="programlisting">
    &lt;groupToAccountMapping
            name='rsv'
            description=''
            accountingVoSubgroup=''
            accountingVo=''
            userGroups='rsv'
            accountMappers='rsv'/&gt;
</pre>

<p>and add the rsv reference to your hostToGroupMapping element(s) such as:</p>

<pre class="programlisting">
    &lt;hostToGroupMapping
        groupToAccountMappings='rsv, cdf, fermilab, grase, mis, fmri, sdss, star'
        description=''
        cn='*/?*.bnl.gov'/&gt;
</pre>


---+++ Add !RSV service cert DN using !GUMS server web interface
<p> If you are want to use the web interface, add the same elements above using the web interface by:</p>

<p> 
   1 Click "User Groups" -> Click "Add" -> Select "manual" for the type, type "=rsv=" for the name, and select "read all" for the permissions -> Click "Save"
   2 Click "Account Mappers" -> Click "Add" -> Select "group" for the type and type "=rsv=" for the name -> Cick "Save"
   3 Click "Group To Account Mappings" -> Click "Add" -> Select "rsv" for the the User Group and "rsv" for the Account Mapper -> Click "Save"
   4 Click "Host To Group Mappings" -> Click "edit" on all relevant host to group mappings -> Select "rsv" in the last "Group To Account Mapping(s)" slot -> Click "Save"
</p>

---+++ Note common to above two sub-sections: Each service cert DN needs to be added separately
<p> You must manually add each !RSV service DN to the =rsv= user group -- either do that in the config file as shown above OR:
   * Go to the !GUMS server web interface and click "Manual User Group Members"
   * Then click "Add", then enter the service cert DN and =rsv= as the usergroup
   * Click "Save". And repeat for each DN (if you're configuring multiple !RSV service cert DNs).

<p> <strong>IMPORTANT NOTE: </strong> If your GUMS server version is < 1.2.17, then when converting to the the 1.2 format, it will give the rsv usergroup "write" privilege by default, so the administrator should change this to "read all".  This has been changed to "read all" by default in GUMS 1.2.17 and above.

<p><br>
-------------
---++ Resources that use !GridMapfile

<p><font color="red"> This information needs to be verified by someone who actually uses grid-mapfiles</font>. 
<p> If you manually edit a grid-mapfile, then simply add something like this: 
 <pre class="programlisting">"/DC=org/DC=doegrids/OU=Services/CN=rsv/foo.bar.edu" rsvuser</pre>

-------------

---++ Resources that use !edg-mkgridmap

<p><font color="red"> This information needs to be filled in by someone who actually uses edg-gridmapf</font>. 
<p> If you use edg-mkgridmap, then . .. . . . . . 
 <pre class="programlisting">Fill info here</pre>