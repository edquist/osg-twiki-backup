%META:TOPICINFO{author="JayPackard" date="1209674111" format="1.1" reprev="1.3" version="1.3"}%
%META:TOPICPARENT{name="RSV"}%
---+ Configure !RSV to use a service cert on your CE or SE.

---++ Resources that use !GridMapfile

<p> Information needs to be filled in here by someone who uses gridmapfiles. I suspect this will be a lot simpler though, i.e it'll be as simple as adding: 
 <pre>rsvuser DN=/DC=org/DC=doegrids/OU=Services/CN=rsv/foo.bar.edu</pre>

---++ Resources that use GUMS

<p> If you're want to manually add configuration to a !GUMS 1.2 format, to allow an !RSV service cert to your GUMS server config, add the following to the userGroups section:</p>

<pre>
    &lt;manualUserGroup
        name='rsv'
        access='read all'
        description=''
        persistenceFactory='mysql'/&gt;
</pre>

<p> and add the following to the accountMappers section: </p>

<pre>
    &lt;groupAccountMapper
        name='rsv'
        description=''
         accountName='rsvuser'/&gt;
</pre>

<p> and add the following to the groupToAccountMappings section: </p>

<pre>
    &lt;groupToAccountMapping
            name='rsv'
            description=''
            accountingVoSubgroup=''
            accountingVo=''
            userGroups='rsv'
            accountMappers='rsv'/&gt;
</pre>

<p>and add the rsv reference to your hostToGroupMapping element(s) such as:</p>

<pre>
    &lt;hostToGroupMapping
        groupToAccountMappings='rsv, cdf, fermilab, grase, mis, fmri, sdss, star'
        description=''
        cn='*/?*.bnl.gov'/&gt;
</pre>

<p> If you are want to use the web interface, add the same elements above using the web interface by:</p>

<p> 
   1 Click "User Groups" -> Click "Add" -> Select "manual" for the type, type "rsv" for the name, and select "read all" for the permissions -> Click "Save"
   2 Click "Account Mappers" -> Click "Add" -> Select "group" for the type and type "rsv" for the name -> Cick "Save"
   3 Click "Group To Account Mappings" -> Click "Add" -> Select "rsv" for the the User Group and "rsv" for the Account Mapper -> Click "Save"
   4 Click "Host To Group Mappings" -> Click "edit" on all relevant host to group mappings -> Select "rsv" in the last "Group To Account Mapping(s)" slot -> Click "Save"
</p>

<p> You must manually add each !RSV service DN to the =rsv= user group:
   * Go to the web interface and click "Manual User Group Members"
   * Then click "Add", then enter the service cert DN and =rsv= as the usergroup
   * Click "Save". And repeat for each DN (if you're configuring multiple !RSV service cert DNs).

<p> <strong>NOTE: </strong> If your GUMS server version is < 1.2.17, then when converting to the the 1.2 format, it will give the rsv usergroup "write" privilege by default, so the administrator should change this to "read all".  This has been changed to "read all" by default in GUMS 1.2.17 and above.

<p><br>
-------------
-------------
<p><br>

---+++ Note from Gabriele about above !GUMS configuration of !RSV service certificate

<p> <font color="red">If the above instructions do not work, then you might benefit from reading this. Ultimately this document should include only one piece of information (and not both of these)</font>

<p> It seems to me that you want to do something very similar to what we do for the GUMS GIP probe. In fact, you run probes via the RSV framework, rather than as a generic information provider (... which is the way we should all converge to...). The difference is that in the GIP probe we access the GUMS mapping interface, while you want to access a GUMS administrative interface. In any case, if you run jobs, which access the GUMS administrative interface, via a gatekeeper, you'll need to give your jobs access to the site, configuring the mapping interface.

Please, give a look at the documentation to set up GUMS to accept the GIP probe

[[http://vdt.cs.wisc.edu/releases/1.8.1/notes/GUMS.html][http://vdt.cs.wisc.edu/releases/1.8.1/notes/GUMS.html]]

<p> When you read this document,
   1 replace the gums-test group with rsvgroup group;
   2 replace GumsTestUserMappingSuccessful (non-existent local user) with the rsvuser user;
   3 replace the ad-hoc probe identity "/GIP-GUMS-Probe-Identity" with the real identity '/DC=org/DC=doegrids/OU=Services/CN=rsv/foo.bar.edu' (using an ad-hoc identity for GIP is fine because we map to a non existent user)

<p> 
Please note again that adding a certificate to GUMS so that it can access administrative functions is different from adding a certificate to GUMS so that it can be mapped to a local user. Here you are describing (...and I'm talking about...) the latter, which will give your probes access to the gatekeeper; however, you need also the former, once your probe land on the node.

---------------

-- Main.ArvindGopu - 01 May 2008

