%META:TOPICINFO{author="X509_2fDC_3dorg_2fDC_3ddoegrids_2fOU_3dPeople_2fCN_3dScot_20Kronenfeld_20866253" date="1297128051" format="1.1" reprev="1.11" version="1.11"}%
%META:TOPICPARENT{name="RSV"}%
---+!! *<nop>%SPACEOUT{ "%TOPIC%" }%*
%LINKCSS%

%TOC%

%STARTINCLUDE%
%BR%


<a name="advanced_rsv_config"></a>

---+ Advanced !RSV Installations (Configurations)

---++ Condor-Cron 

<p> Starting with OSG 1.0 !RSV will always include a minimal Condor package called condor-cron that is used to schedule !RSV probes and consumers.

%NOTE% You can set =VDTSETUP_NO_CONDOR_CRON=1= in your environment to prevent Condor-Cron from installing.

%INCLUDE{"MonitoringInformation/MonitoringOsg10Ce"}%

---++ Pre-config check list
<p> Ensure you have gone through the [[https://twiki.grid.iu.edu/twiki/bin/view/ReleaseDocumentation/PreparingComputeElement#RSV_Prerequisites][<strong>RSV prerequisites section of the Preparing Compute Element</strong>]] document already. 


---++ Enabling non-default metrics or disabling default metrics

[[rsv-control][RsvControl]] can be used to enable and disable metrics.

---++ Adding custom specifications to your !RSV configuration
If you want to add custom specifications to a particular metric's invocation (for example: to specify a non-default SRM client to be used by the =srm-ping-probe=) on a service then follow this section. These steps are fairly complex but our hope is that a tool named =rsv-control= will soon allow admins to do tasks like this using a simpler interface--stay tuned.
   1 Determine what parameter/value needs to be provided; plus probe name, metric name (and optionally FQDN of service endpoint):
      * Determine parameter switch for appropriate probe using =--help= switch; Probes are located in =${VDT_LOCATION}/osg-rsv/bin/=
 <pre class="screen"> cd ${VDT_LOCATION}/osg-rsv/bin/
 ./<strong><em>&lt;probe&gt;</em></strong> --help</pre>
      * You probably already know which metric is in context that needs an additional parameter to be passed to it. If not, then you can find out metrics tested by a probe as follows: After sourcing VDT's =setup.sh=, do the following:
 <pre class="screen"> cd ${VDT_LOCATION}/osg-rsv/bin/
 ./<strong><em>&lt;probe&gt;</em></strong> -m all -l </pre>
 ... to discover appropriate metric name. For example, when executed with the =srm-ping-probe=, you will get metric name =org.osg.srm.srmping=. 
      * (Optional): You, as admin, know the FQDN of the service under question.
   1 Add appropriate parameter/value pair to appropriate global-specs file or service-endpoint specific specs file. For example:
      * To specify location of SRM client that must be used by the =srm-ping-probe= on all SRM service endpoints:
 <pre class="screen"> mkdir -p ${VDT_LOCATION}/osg-rsv/specs/global-specs/
 echo -n " --srm-client-loc <strong><em>&lt;/usr/local/srm_custom/&gt;</em></strong> " \
    >> ${VDT_LOCATION}/osg-rsv/specs/global-specs/srm-ping-probe@org.osg.srm.srmping.spec</pre>
      * To specify location of SRM client that must be used by the =srm-ping-probe= on one SRM service endpoints called foo.grid.iu.edu but not other SRM endpoints:
 <pre class="screen"> mkdir -p ${VDT_LOCATION}/osg-rsv/specs/foo.grid.iu.edu/
 echo -n " --srm-client-loc <strong><em>&lt;/usr/local/srm_custom/&gt;</em></strong> " \
    >> ${VDT_LOCATION}/osg-rsv/specs/foo.grid.iu.edu/srm-ping-probe@org.osg.srm.srmping.spec</pre>
      * Repeat setting of global or service level specification for all applicable metrics
   1 Run =configure_osg_rsv= or =configure-osg= as you would normally do, and restart osg-rsv (=vdt-control --off osg-rsv; vdt-control --on osg-rsv=).


%INCLUDE{"MonitoringInformation/StartRsvV2"}%

%INCLUDE{"MonitoringInformation/ValidateRsvV2Configuration"}%
