%META:TOPICINFO{author="ScotKronenfeld" date="1266028828" format="1.1" version="1.1"}%
%META:TOPICPARENT{name="RSV"}%

---++ !RSV version 2 (!VDT 1.10.1; !OSG 1.0)

---+++ Related to !RSV infrastructure - (!VDT 1.10.1 cache, !OSG 1.0)

---++++ !RSV probe jobs stop running because Condor-Cron's lock file is removed by tmpwatch 

In the initial VDT 1.10.1d release (!OSG 1.0), there's an issue on sites that run tmpwatch or similar tools to clean old files from /tmp. !RSV might stop running periodicallyuntil the condor-cron service is restarted because of the way condor-cron is configured to use a lock file in /tmp.

The Condor developers will fix the problem for a future release (as of 2008-07-10), but for now, there is a one-line fix that admins can make to avoid the problem. In =$VDT_LOCATION/condor-cron/local.*/condor_config.local=, there is a line that looks similar to this:
<pre class='programlisting'> LOCK = /tmp/condor-lock.$(HOSTNAME)0.505446661803038</pre>

Change that to this, and restart Condor-cron and osg-rsv: <pre class='programlisting'> LOCK = $(LOG)</pre>

<p> *Note:* The LOG directory should _ not _ be on NFS. It is configured to be in condor-cron/local.*/log. If that is NFS, then you will need to move the local.* directory elsewhere and symlink to it or change the references to it in the config files. 

---++++ Condor-Cron does not start because of IP address binding issue, and consequently osg-rsv service fails to start

Under certain setups, =osg-rsv= might not start because =condor-cron= has failed to start but =vdt-control= has not caught that problem.

If =osg-rsv= fails to start, then first, type =condor_cron_q=, you must see an empty queue. If you do not see an empty queue, then

   * Check =$VDT_LOCATION/condor-cron/local.*/log/MasterLog= for the following error: <pre> 6/24 21:44:20 Failed to bind to command ReliSock 6/24 21:44:20 (Make sure your IP address is correct in /etc/hosts.) 6/24 21:44:20 ERROR "BindAnyCommandPort() failed" at line 8390 in file daemon_core.C</pre> 
   * If you see the above error, then you need to add the following to your =$VDT_LOCATION/condor-cron/etc/condor_config file= <pre> NETWORK_INTERFACE <condor-master-ip-address> </pre> 

---+++ Related to !RSV probes (!VDT 1.10.1 cache, !OSG 1.0)



-- Main.ScotKronenfeld - 13 Feb 2010