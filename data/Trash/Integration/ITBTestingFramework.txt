%META:TOPICINFO{author="SuchandraThapa" date="1271349144" format="1.1" version="1.5"}%
%META:TOPICPARENT{name="WebHome"}%
---+!! %SPACEOUT{ "%TOPIC%" }%
%TOC%

---++ Introduction
In order to improve testing of ITB resources, a few members of the ITB team in conjunction with ATLAS developers are working on following validation of ITB resources using the PANDA framework.  Ideally ITB admins will be able to define a queue configuration for their ITB resources and then subsequently submit a variety of validation jobs to their resource using a simple to use script.  The results of the validation jobs will then be available through a web interface so that integration testing of new release can be easily documented and archived.

One of the goals is to allow admins to download a script after setting up their ITB site and run a group of jobs on their newly configured site to exercise and verify various components are properly configured.  In addition, a web accessible record of the the tests will then be available as a reference so that the admin and the ITB team will have a record of the testing process.

---++ Running Jobs
In order to run jobs:
   * Download the tarball at <tt>http://www.usatlas.bnl.gov/~caballer/panda/demo/sendjobs.tar</tt>
   * untar the tarball
   * source setup.sh
   * make sure you have a valid grid proxy, and then run <pre class="screen">
./sendJob.py -njobs 1 --computingSite SITE_NAME --transformation JOB_URL --prodSourceLabel user
</pre> Where SITE_NAME is the name of the site the jobs should run on and JOB_URL is the url of the script to run on the site.
   * You should get output similar to <pre class="screen">========================================================================
./sendJob.py ---njobs 1 --computingSite TEST2 --transformation http://www.usatlas.bnl.gov/~caballer/panda/transformations/trivial_test.sh --prodSourceLabel user
new job 0
curl --silent --insecure --compressed --cert /tmp/x509up_u12345 --key /tmp/x509up_u12345 --config /tmp/caballer_2e25012d-09e3-4cff-8ddc-a8cb2ff4d504 https://voatlas21.cern.ch:25443/server/panda/submitJobs
---------------------
0
PandaID=1234567890</pre>

---+++ Job types
Currently there are a limited number of job types.  The jobs are all hosted on a server at [[http://osg-vtb.uchicago.edu/jobs/][UChicago]].  The currently available jobs and urls for them are:
   * Hello world - http://osg-vtb.uchicago.edu/jobs/pilot_hello.py 
   * Cpu utilization task (matrix inversion) - http://osg-vtb.uchicago.edu/jobs/cpu_burn.py
   * Check accessibility and functionality of =OSG_DATA= = http://osg-vtb.uchicago.edu/jobs/check_osg_data.py
   * Check functionality of =OSG_WN_TMP= - http://osg-vtb.uchicago.edu/jobs/check_wn_tmp.py
---++ Automated testing and reports
The testing infrastructure is also being used to run 
---+++ Current tests and subtests

   * srm_test - Tests a variety of se related functions |
      * SE_TRANSFERS - Overall success or failure of SE related tests
         * SE_UPLOAD - Tests upload of a file to SE using srmcp 
         * SE_REMOVE - Tests deletion of file on SE using srm-rm 
         * UPLOAD_RATE - Reports transfer rate in MB/s when uploading to SE 
         * SE_DOWNLOAD - Tests download of file from SE using srmcp 
         * DOWNLOAD_RATE - Reports transfer rate in MB/s when downloading from SE 
      * INVERT_TIME - Time required to invert a random 500x500 matrix 

---++ Queue and Site Information
   * [[http://panda.cern.ch:25980/server/pandamon/query?job=*&processingType=ITB_Integration&detail=no][Current queue]]
---+++ UC_ITB 
The UC_ITB resource is a small persistent ITB resource providing resources for testing.  The resource also has a bestman and a dcache SE associated with it. 
   * [[http://panda.cern.ch:25880/server/pandamon/query?tp=queue&id=UCITB_EDGE7][Queue configuration]]
   * [[http://panda.cern.ch:25880/server/pandamon/query?tp=pilots&accepts=UCITB_EDGE7][Monitoring page]]
Further notes:
   * Site name: UC_ITB
   * Queue name: UCITB_EDGE7-pbs 
---+++ LBNL
The LBNL_DSD_ITB resource is located that LBNL and uses a SGE jobmanager.  
   * [[http://panda.cern.ch:25880/server/pandamon/query?tp=queue&id=LBNL_DSD_ITB][Queue configuration]]
   * [[http://panda.cern.ch:25880/server/pandamon/query?tp=pilots&accepts=LBNL_DSD_ITB][Monitoring page]]
Further notes:
   * Site name: LBNL_DSD_ITB
   * Queue name: 
---+++ BNL
The BNL_ITB_Test1 resource is located at BNL and uses a Condor jobmanger.  It has a !dCache SE associated with it.
   * [[http://panda.cern.ch:25880/server/pandamon/query?tp=queue&id=BNL_ITB_Test1][Queue configuration]]
   * [[http://panda.cern.ch:25880/server/pandamon/query?tp=pilots&accepts=BNL_ITB_Test1][Monitoring page]]
Further notes:
   * Site name: BNL_ITB_Test1
   * Queue name: BNL_ITB_Test1-condor 

---++ Additional Information
   * http://www.usatlas.bnl.gov/twiki/bin/view/AtlasSoftware/PandaITB

-- Main.SuchandraThapa - 08 Dec 2009