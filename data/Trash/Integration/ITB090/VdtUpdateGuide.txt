%META:TOPICINFO{author="AlainRoy" date="1213135236" format="1.1" reprev="1.7" version="1.7"}%
%META:TOPICPARENT{name="WebHome"}%
---+!! *<noop>%SPACEOUT{ "%TOPIC%" }%*
%TOC%

---++ Introduction
This guide provides information on updating an existing OSG install to a new vdt letter releases (such as 1.10.1c, 1.8.1a).

---++ Scope 

A given OSG release goes with a given VDT release, and only lettered updates to the VDT will work with a given OSG version.

This page is intended to cover letter releases within an existing OSG/VDT release.  E.g. an update from OSG 1.0/VDT 1.10.1c to OSG 1.0/VDT 1.10.1d .  These updates are made periodically to fix security issues, bugs, and update configuration information in an existing OSG release.

---++ Update Procedure
%NOTE% Do NOT run =pacman -update= since this may leave your install in a NON-FUNCTIONAL state.   

Before updating the VDT, run the following commands:
<verbatim>
cd $VDT_LOCATION=
. setup.sh=
vdt-control --off
</verbatim>
This turns off active services. 

Then pick a path  where the current installation can be backed up to and use that path in the following command in place of =BACKUP_LOCATION=.  
<verbatim>
cp -pr $VDT_LOCATION BACKUP_LOCATION
</verbatim>

Then use pacman to update each package in the update.  


You will need to read the update notice that was sent out to the osg-sites mailing list or at =http://vdt.cs.wisc.edu/releases/%VDT_VERSION%/release.html= to find out which packages in the update are applicable. Then issue:
<verbatim>
pacman -update PACKAGE
</verbatim>
for each applicable package (e.g. =pacman -update GUMS=) .  

%NOTE% You may need to take additional steps, as outlined in the update notice, to complete the update.


---++ Recovering from a failed update
If the update fails or the update causes problems, you can revert back to the pre-update state. First shut down the services: 
<verbatim>
cd $VDT_LOCATION
. setup.sh
vdt-control --off
</verbatim>
Then copy the files from =BACKUP_LOCATION= to =$VDT_LOCATION=:
<verbatim>
rm -rf $VDT_LOCATION
cp -pr $BACKUP_LOCATION $VDT_LOCATION
</verbatim>

 Then run:
<verbatim>
cd $VDT_LOCATION
. setup.sh
vdt-control --on
</verbatim>
       
---++ Known Problems
Due to a limitation in the way that pacman works, the current version returned by =vdt-version= after an update will be the latest update version (e.g. VDT 1.10.1c) regardless of whether packages from that version have been updated.  E.g. if VDT 1.10.1a only updated squid and VDT 1.10.1b only updated GUMS, then after running =pacman -update squid=, =vdt-version= will return VDT 1.10.1b.

%BR%
%COMPLETE3% %BR%
%RESPONSIBLE% Main.SuchandraThapa - 18 Oct 2007 %BR%
%REVIEW% Main.AlainRoy - 10 Jun 2008 %BR%
%REVCOM%  %BR%
%REVFLAG% 

