%META:TOPICINFO{author="SuchandraThapa" date="1252614080" format="1.1" reprev="1.5" version="1.5"}%
%META:TOPICPARENT{name="WebHome"}%
---+!! %SPACEOUT{ "%TOPIC%" }%
%TOC%

---+++ Introduction
This page has the update and testing instructions for the osg 1.2.2 update.

---+++ Schedule
The schedule is tentatively given below:

   * Sept 3-4: Testing started for gip/rsv/configure-osg testing
   * Sept 9: lcg-utils testing starts 
   * Sept 16: Testing completion

---+++ Installation 
Admins will need to install from the VTB cache.  The packages being tested are located in the CE so only the CE will need to be tested for this update.  You can install the software using =pacman -get VTB:ce= .  


---+++ Testing and Validation
---++++ Testing GIP changes
In order to test the GIP changes, you will need to add a hepspec option to your subcluster sections:
<verbatim>
hepspec = 30
</verbatim>
Then go to the [[http://myosg.grid.iu.edu/rggipstatus/index?datasource=gipstatus&gip_status_attrs_showtestresults=on&account_type=cumulative_hours&ce_account_type=gip_vo&se_account_type=vo_transfer_volume&start_type=7daysago&start_date=09%2F04%2F2009&end_type=now&end_date=09%2F04%2F2009&all_resources=on&rg_105=on&gridtype=on&gridtype_2=on&active_value=1&disable_value=1][myosg gip validation status page for your resource]] and verify that your resource is green.   The GIP team will check values and the GIP validation status as reported to the central collector.

---++++ Testing configure-osg changes
The changes in configure-osg are primarily bug fixes so verifying functionality will just consist of making sure that configuration of your gatekeeper is done correctly. Testing job manager functionality, gridftp functionality, and reporting should be sufficient.

For admins using sge, configuration has changed.  You will need to set fill in values for =sge_root= and =sge_cell= in the =[SGE]= section.  However, you can remove the =home= and =sge_location= options since those are no longer used.  Once these changes are made, you should be able to configure your system as normal and go through the verification as above.

---++++ RSV probe configuration / testing
Changes to rsv include probes for gratia and gums and a fix for the creation of zombie processes.

   * Turn off RSV 
<pre class="screen">
       vdt-control --off osg-rsv condor-cron
</pre>
   * Re-initialize rsv if this is a new installation
<pre class="screen">
     ./vdt/setup/configure_osg_rsv --init --user [user for rsv]
</pre>
   * Download (and overwrite existing) modified updater [allows cache to specified]
<pre class="screen">
wget -O ${VDT_LOCATION}/osg-rsv/setup/update_from_svn.sh \
http://osg-svn.rtinfo.indiana.edu/rsv/releases/latest-itb/osg-rsv/setup/update_from_svn.sh

chmod +x ${VDT_LOCATION}/osg-rsv/setup/update_from_svn.sh
</pre>


   * Update RSV -- specify latest-itb as argument!
<pre class="screen">

${VDT_LOCATION}/osg-rsv/setup/update_from_svn.sh latest-itb
</pre>


   * Edit GRATIAPROBES below to include only job-managers applicable to your CE, then run the following on the command line.
<pre class="screen">

 CEFQDN="foo.grid.iu.edu"
 GRATIAPROBES="condor gridftp-transfer hadoop-transfer lsf managedfork metric pbs sge"
 for  METRIC in ${GRATIAPROBES};
 do 
    echo "CE: ${CEFQDN} - probe: ${METRIC}";
    echo "on   gratia-config-probe@org.osg.gratia.${METRIC}  21 * * * *" >> \
     ${VDT_LOCATION}/osg-rsv/config/${CEFQDN}_metrics.conf ;
done
</pre>

   * Use configure-osg  or configure_osg_rsv to configure RSV probes
      * Ensure CE probes are enabled
      * Ensure GUMS probes are enabled in config.ini or switch --gums-probes is specified to configure_osg_rsv
      * Ensure GUMS URI is pointing to your CE  

   * Turn RSV back on
<pre class="screen">
 vdt-control --on condor-cron osg-rsv
</pre>



NOTE: The gratia probe will likely result WARNING status on its metrics for all testers because most everyone I know runs RSV as a normal user, and not as root but the logic of the probe was written assuming it will be run as root on the CE. Ideally, a future version of the probe would print instructions on how to run what script as root user (and where - the CE, for example), and perhaps even how to retrieve such a script. This is a non-availability metric, so we do not expect such a feature to be added in the immediate future.
---+++ Open bugs and workarounds

---+++ How to report a bug?
Bug reports for the installation and documentation should be filed with GOC at [[https://ticket.grid.iu.edu/itb/open]].  *Please don't use the vdt support center or any other support center as the receipient since that will cause a email loop*


-- Main.SuchandraThapa - 04 Sep 2009
