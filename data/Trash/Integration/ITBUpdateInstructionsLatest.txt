%META:TOPICINFO{author="ScotKronenfeld" date="1286573254" format="1.1" reprev="1.1" version="1.1"}%
%META:TOPICPARENT{name="WebPreferences"}%
---+++ Introduction
This page has the update and testing instructions for the current ITB %ITB_VERSION% (OSG %OSG_VERSION% candidate) update. 

*You can use this page if you are updating ITB version 1.1.26 or later.*  If you have a version before 1.1.26 you should [[ITBUpdateInstructionsPre26][see this page]].

---+++ Installation 
Admins can install from the new ITB cache or upgrade an ITB 1.1.26+ installation.   *The new ITB cache location is*  =http://software-itb.grid.iu.edu/osg-1.2/=.  When you install the ITB software, you will need to use this url when specifying the cache, e.g. 
<pre class="screen">
pacman -get http://software-itb.grid.iu.edu/osg-1.2:ce
</pre>

Also note that when running =vdt-ca-manage=, you should specify =ITB= as the url, e.g. 
<pre class="screen">
vdt-ca-manage setupca --url itb --location &lt;local|root|PATH&gt;
</pre> 

---+++ Updating from previous ITB release 

%NOTE% This only applies to upgrades from ITB 1.1.26 or later.

---++++ Preliminaries
Go to the directory where you installed your software (root directory of the Pacman installation, =VDT_LOCATION=) and source the setup script so that the following steps will work correctly.
<pre class="screen">
cd VDT_LOCATION
source setup.sh
</pre>

Make sure that your batch system binaries are in your PATH, especially if you are running SGE.

---++++ Stop VDT Services
Some packages (e.g. =client= or =wn-client=) may not be running any services, however, doing this step will not cause problems.  

<pre class="screen">
vdt-control --off
</pre>

---++++ Backup your software
<pre class="screen">
cp -a $VDT_LOCATION BACKUP_LOCATION
</pre>

---++++ Get VDT Updates
This will update VDT packages specifically.
<pre class="screen">
vdt/update/vdt-updater
</pre>

The vdt-updater will automatically update itself (if necessary) and restart itself.  There is no longer a need to take a second backup.

After updating, re-source the setup.sh file to load any changes in the environment:
<pre class="screen">
source setup.sh
</pre>

---++++ Get OSG Updates
The =osg-version= package must be updated on all OSG installations:
<pre class="screen">
pacman -update osg-version
</pre>


#PostInstallConfiguration
---++++  Post Install Configuration 
After you complete the updates of your packages, you will need to run the =vdt-post-install= script in order to complete any post-installation setups needed after your packages have been updated:

<pre class="screen">
vdt-post-install
</pre>

---++++ Reconfiguration
On a CE, you will need to reconfigure your system:
<pre class="screen">
configure-osg -v
configure-osg -c
</pre>

On an SE, you may need to rerun =configure_bestman= and/or =configure_xrootd= before you start your services again.  You should run these scripts using the same command as you first used to configure them.

---++++ Restart VDT Services
This step can be omitted if you are not running any services.  If you are not certain, you can run it since services are disabled by default so the only services that will be started are ones that you have explicitly enabled.
<pre class="screen">
vdt-control --on
</pre>
