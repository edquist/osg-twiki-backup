%META:TOPICINFO{author="GabrieleGarzoglio" date="1227112472" format="1.1" reprev="1.5" version="1.5"}%
%META:TOPICPARENT{name="ITBTestingInstructions"}%
---+!! *<nop>%SPACEOUT{ "PRIMA interface testing" }%*
%TOC%

%STARTINCLUDE%
%BR%
---+ _%INCLUDEHEADING%  %SPACEOUT{ "PRIMA interface testing" }%_
PRIMA interoprability interface tests.

%EDITTHIS%
%BR%

---++ Introduction

Starting with this version of VDT, GUMS and PRIMA can use two different ways to communicate with each other  
   * the old PRIMA legacy protocol, based on SAML v1
   * the new XACML2 protocol defined by the OSG-EGEE interoperability group

The old PRIMA legacy protocol works with all versions of GUMS, while the new XACML2 protocol works with GUMS v1.3.0 or later, and  with EGEE SCAS server.

These tests aim at verifying that both interfaces work as expected.

---++ Test PRIMA with the old GUMS

*IF* you are already running an old GUMS server ( < v1.3.0 ), perform the tests in this section to verify that  the new PRIMA module can talk to the old GUMS.
Else, skip to the next section.

---+++ Test the CE with the old GUMS

Set up a compute element by following the instructions in ComputeElementInstall.
In the [[ComputeElementInstall#Configure_Globus_to_use_the_PRIM][Configure Globus to use the PRIMA callout]] section, follow the instructions for the default PRIMA interface configuration (gsi-authz.conf and prima-authz.conf).

Perform the following tests:
   * Submit a job to the gt2 gatekeeper and check the results, as explained in the [[ValidatingComputeElement#CE_GUMS_client][CE GUMS-client]] section.
   * Transfer a file and check the results, as explained in the [[ValidatingComputeElement#Simple_Test_Of_GSIFTP_Services][Simple Test Of GSIFTP Services]] section.

---+++ Test gLExec with the old GUMS

To be written.

---++ Test PRIMA with the new GUMS

Install the new GUMS server ( >= v1.3.0 ) by following instructions at InstallConfigureAndManageGUMS. 

---+++ Test the CE using the old legacy PRIMA interface

If needed, set up a compute element by following instructions in ComputeElementInstall.
In the [[ComputeElementInstall#Configure_Globus_to_use_the_PRIM][Configure Globus to use the PRIMA callout]] section, follow the instructions for the the default PRIMA interface configuration (gsi-authz.conf and prima-authz.conf).

Perform the following tests:
   * Submit a job to the gt2 gatekeeper and check the results, as explained in the [[ValidatingComputeElement#CE_GUMS_client][CE GUMS-client]] section.
   * Transfer a file and check the results, as explained in the [[ValidatingComputeElement#Simple_Test_Of_GSIFTP_Services][Simple Test Of GSIFTP Services]] section.

---+++ Test the CE using the new XACML2 interface

Change the configuration on the Compute Element, as explained in the [[ComputeElementInstall#Using_the_new_XACML2_GUMS_interf][Using the new XACML2 GUMS interface ]] and repeat the tests:
   * Submit a job to the gt2 gatekeeper and check the results, as explained in the [[ValidatingComputeElement#CE_GUMS_client][CE GUMS-client]] section.
   * Transfer a file and check the results, as explained in the [[ValidatingComputeElement#Simple_Test_Of_GSIFTP_Services][Simple Test Of GSIFTP Services]] section.

PS: These tests should work only against the new GUMS (>= v1.3.0) server.

---+++ Test gLExec using the old legacy PRIMA interface

To be written.

---+++ Test the CE using the new XACML2 interface

To be written.

---++ Scalability tests of the new GUMS

The new XACML2 interface uses different libraries than the legacy interface based on SAML1, for network communication. Whilst XML is at the basis of both protocols, it is recommendable running a scalability test.

In the past, the !FermiGrid group has run scalability tests of the SAML1 interface, by pointing clients from different machines to the same GUMS server. This process has tested the limit of 4.8M calls/day on a single server, without reaching the scalability limit of the GUMS server.

In more detail, 25 clients (dual 1Ghz CPU, 1GB RAM, 1-1Ge port) performed each 21,600 gums calls in ~1.3 hours. The server set up consisted of one High-Availability (HA) server, redirecting the load to two back-end GUMS servers. At an extrapolated rate of 9.7M calls/day to the HA server, each GUMS server had a load of ~9.5 and a 15% CPU idle. The back end mysql servers had negligible load (0.1) and CPU idle (92%).

At !FermiGrid, the real-life rate of requests per day reached a peak of 1.3M calls/day at the end of 2007.

Scalability tests similar to these ones should be performed on the new GUMS, for the new XACML2 interface. The new PRIMA offers both a command line tool and the classic call-out module (to be integrated with e.g. a pre-WS globus gatekeeper) to format authorization requests in the new XACML2 protocol.

To be written, based on gLExec.


%STOPINCLUDE%
%BR%
%COMPLETE1% %BR%
%RESPONSIBLE% Main.IgorSfiligoi - 17 Nov 2008 %BR%
%REVIEW%
