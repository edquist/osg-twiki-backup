%META:TOPICINFO{author="StevenTimm" date="1165269593" format="1.1" version="1.1"}%
%META:TOPICPARENT{name="SiteFabricBestPractices050"}%
d8 1
-- Main.StevenTimm - 04 Dec 2006
---++Purpose
This Twiki page is for site admins to share the various tricks they have
learned in setting up Condor batch systems to work with the Open Science Grid
---++Hardware configuration
   *  It is strongly recommended that your condor master (i.e. the machine 
*  It is strongly recommended that your condor master (i.e. the machine 
that runs daemons condor_collector and condor_negotiator) be a different machine
than the machine which is your Open Science Grid gatekeeper.

*  It is also strongly recommended that the machine which runs condor_collector and condor_negotiator
not be a busy NFS file server.

*  The Fermi General Purpose Grid cluster has five machines as part of our condor servers
   * One machine--condor_collector, condor_negotiator, and postgres database
   * One machine, main Globus gatekeeper, condor_schedd plus condor_quill--handles all inbound grid jobs from OSG
   * One machine, condor_schedd to handle local condor_submits, plus condor_view server  (historically our big NFS server too).
   * One machine, test gatekeeper to test GIP configuration, OSG globus gatekeeper plus condor_schedd
   * One machine, SAMGRID gatekeeper plus condor_schedd
   * We hope to add 3 more:
         * One dedicated OSG gatekeeper to take jobs from inside of Fermigrid
         * One dedicated Postgres server, get it off the negotiator/collector machine
         * One dedicated submit host for outbound grid jobs, to fermigrid and the rest of the OSG

*  Any production globus-gatekeeper/condor_schedd should have at least 4GB of RAM, more is better.
*  Condor collector/negotiator is not so cpu intensive but needs a good and fast network connection
d28 1
---++Software configuration

   *  Although the OSG Compute Element install will give you a condor batch system 
*  Although the OSG Compute Element install will give you a condor batch system 
as part of the install, it is better to install it separately. This way you will be able to upgrade
the condor independently of the rest of the VDT.  Condor typically has new versions
a lot faster than the VDT does.

*  We have found it useful to use the RPM version of Condor for this reason.  A bit more post-configuration is needed with the RPM though, you have to put in your startup scripts manually.

*  By default condor ships with open HOSTALLOW_WRITE, which means anyone
in the world can join your condor pool.  This is a potential security hole and you need to 
close it as soon as possible.  There is no reason for OSG functionality to do this.
