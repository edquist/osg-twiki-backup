%META:TOPICINFO{author="SuchandraThapa" date="1383252612" format="1.1" version="1.4"}%
%META:TOPICPARENT{name="WebPreferences"}%
---+!! %SPACEOUT{ "%TOPIC%" }%
%TOC%

---++ Introduction
This guide outlines the steps needed to get an OSG CE installed and configured to use a Slurm backend.    This document assumes 

---++ Installation and configuration steps
---+++ Installing Slurm
   * Install Slurm as usual making sure that the Slurm PBS modules installed.  
   * Verify PBS emulation works:
      * Run =qstat -Q= and verify the queues listed match your Slurm queues
      * Submit a job using =qrun= and verify that it runs successfully
---+++ OSG CE install
   * Follow the instructions for [[Documentation.Release3.InstallComputeElement][installing a CE]] that uses PBS with the following changes:
      * Install empty-torque package
      * Install osg-configure-slurm rpm
      * Set =enabled= to False in =20-pbs.ini=
   
---+++ Slurm specific modifications
In addition, the following changes need to be made:
   * Patch =/usr/lib/perl5/vendor_perl/5.8.8/Globus/GRAM/JobManager/pbs.pm= as given in the  [[%ATTACHURL%/pbs.pm.patch][pbs.pm.patch]]  file
   * Copy  [[%ATTACHURL%/slurm.prolog.osg][slurm.prolog.osg]] to =/etc/slurm/= 
   * Edit  set =TaskProlog= to =/etc/slurm/slurm.prolog.osg= in =/etc/slurm/slurm.conf= to ensure that the osg environment variables are in the job environment

   
---+++ Verification
Submit jobs using condor-g or globus-job-run and verify that jobs run correctly.

-- Main.SuchandraThapa - 05 Feb 2013

%META:FILEATTACHMENT{name="pbs.pm.patch" attachment="pbs.pm.patch" attr="" comment="Patch to pbs.pm needed for Slurm" date="1360961611" path="pbs.pm.patch" size="768" stream="pbs.pm.patch" tmpFilename="/usr/tmp/CGItemp14202" user="SuchandraThapa" version="2"}%
%META:FILEATTACHMENT{name="slurm.prolog.osg" attachment="slurm.prolog.osg" attr="" comment="Task prolog for Slurm" date="1360114216" path="slurm.prolog.osg" size="320" stream="slurm.prolog.osg" tmpFilename="/usr/tmp/CGItemp62630" user="SuchandraThapa" version="1"}%
