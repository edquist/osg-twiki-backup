%META:TOPICINFO{author="JeffPorter" date="1194912369" format="1.1" version="1.5"}%
%META:TOPICPARENT{name="WebHome"}%
   * Since the release of OSG 0.6.0, a team on the VTB has been stress testing the ws-gram interface with workloads and workflows. For background information please see WSGramValidation060 . The major goal of the stress testing was to determine a configuration that provides the globus container with a capacity to handle heavy loads for  production use of the ws-gram interface.
   * The following procedure will increase the robustness of the ws-gram software stack as deployed in 0.6.0:
      * As root, shutdown the ws-gram stack for reconfiguration:  vdt-control --off globus-ws
      * Increase the Java container parameter containerThreadsMax from the default value="20" to value="100"
         * The containerThreadsMax parameter is located in the file: $GLOBUS_LOCATION/etc/globus_wsrf_core/server-config.wsdd
         * The containerThreadsMax parameter sets the maximum number of threads for the container. More details may be found in Table 2 at: http://www.globus.org/toolkit/docs/4.0/common/javawscore/admin-index.html#id2539200 
      * Increase the maximum heap size that the Java virtual machine can consume to 1024 MB. Set GLOBUS_OPTIONS="-Xmx1024M"
         * The GLOBUS_OPTIONS parameter is set in the file: $VDT_LOCATION/setup.sh
         * The default value -Xmx256M has proven inadequate when stress testing the ws-gram interface.  On an ITB  system with 2 GB of memory on the head node with 600 MB of free memory, setting the value to -Xmx1024M has prevented the Java container from crashing and requiring a restart.  Systems that have limited memory on the head node or have heavy memory usage by other services will need to balance the maximum heap size used by the Java virtual machine with other services.
      * Make sure that the persistance directory is on a local disk
         * Set the value of =org.globus.wsrf.container.persistence.dir= in =$VDT_LOCATION/vdt-app-data/globus/etc/globus-system-properties.in=  
      * Restart the ws-gram stack: vdt-control --on globus-ws
      * Increase the number of file handles available for user that the globus container runs under. Add the following line
<pre class="screen">
globus          hard     nofile           16384
</pre>
to =/etc/security/limits.conf=
         

-- Main.DavidMeyers - 01 May 2007