%META:TOPICINFO{author="SuchandraThapa" date="1275676524" format="1.1" reprev="1.91" version="1.91"}%
%META:TOPICPARENT{name="WebHome"}%
<!-- This is the default OSG Integration template. 
Please modify it in the sections indicated to create your topic!
If you have any comments/complaints about this template, then please email me:
rwg@hep.uchicago.edu.  (Adapted from Atlas wiki template, Ed Moyse)
--> 


<!-- By default the title is the WikiWord used to create this topic !-->
<!-- if you want to modify it to something more meaningful, just replace %TOPIC% below with i.e "My Topic"!-->
---+!!<nop>ITB Release 0.1.5
%TOC%
%STARTINCLUDE%


---++Summary of this Release
This page provides a general overview of the OSG release candidate 0.1.5, to be deployed on the OSG Integration Testbed (ITB) Compute Elements and Hosts of VO, Site and Grid Services. 
   * Guides for site and VO administrators are provided below. 
   * This release of the ITB will incorporate major changes in the [[http://www.cs.wisc.edu/vdt/releases/%OSG_ITB_VDT_VERSION%/index.html][VDT %OSG_ITB_VDT_VERSION%]]
   * VO services should be registered using the [[ItbVo][VO registration]] procedure.
   * A new MIS-CI release, version 0.2.5p1, is included

---+++!! Release version indicator

   We are tracking non-critical updates using a "-Number" release designation.
   On a resource the output of the command 
<verbatim> 
$ $VDT_LOCATION/osg-version 
</verbatim> 
   is used to indicate the specific version of OSG 0.1.5 which was installed.

    | *OSG Release* | *Date* | *Note* |
    | OSG-0.1.5          | 4/18/2005 | pre-release of VDT %OSG_ITB_VDT_VERSION% |
    | OSG-0.1.5-1        | 4/18/2005 | VDT %OSG_ITB_VDT_VERSION% Release |
    | OSG-0.1.5-2        | 4/19/2005 | updated VO information (VoAdmins table) |
   
---++ Validation
Validation of ITB release 0.1.5.  
   * ITB 0.1.5 validation coordination page,  RelCanItb015Val.
   * Validation page is located at the ValidationPageRel01.  

---++Known Problems
Please put your name and the date next to your item. %GREEN%Green%ENDCOLOR% items are thought to be corrected.

---+++PRIMA Authorization (PRIMA-GUMS-VOMS) Issues
   * VOMS server /etc/init.d/voms script not functioning correctly.   The  grep used in the 'ps' command to find the correct VOMS server pid  has '$EDG_LOCATION/voms/....'  instead of just '$EDG_LOCATION/... '. <br>
       The EDG_LOCATION variable already contains the ./voms directory in it thereby causing the script to not identify any running VOMS servers.<br>
           <b>Resolution:</b> %GREEN% Fixed in VDT 1.3.6 - per Nate Mueller%ENDCOLOR%<br>
           <b>Work Around:</b> Run the following perl script against the 2 instances of the voms server start script. <br>
           (Main.JohnWeigand - 5/9/2005)<br>
        <verbatim>
      perl -pi -e "s|EDG_LOCATION/voms|EDG_LOCATION|g" $VDT_LOCATION/post-install/voms
      perl -pi -e "s|EDG_LOCATION/voms|EDG_LOCATION|g" /etc/init.d/voms
         </verbatim>


   * Another service/host certificate problem in Privilege/GUMS: with a service certificate (i.e. service/host.site.com) will match only against "service" part.  ([[ServiceHostCertGumsProblem]] )<br>
     <b>Work Around:</b> In the wildcard, match also the service part by itself. <br>
     i.e. wildcard="*.fnal.gov,host", to match all CN=host/... <br>
     i.e. wildcard="*.fnal.gov,*" will match all service certificates<br>
     (Main.GabrieleCarcassi - 4/29/2005)<br>
      <b>Resolution:</b> %GREEN% Will be fixed in GUMS 1.1.0, which will be in VDT 1.3.7 - per Gabriele Carcassi%ENDCOLOR%

   * PRIMA seg faults on 20 byte usernames. (Main.LeighGrund 4/25/2005)<br>
       Originally, it was thought that this occured at 20 bytes, but have seen it occur on 10+ account names. (Main.JohnWeigand 5/31/05)<br>
      <b>Resolution:</b> %GREEN% Fixed in VDT 1.3.6 - per Markus Lorch%ENDCOLOR%

   * %GREEN%VOMS service for CMS (cmssrv17.fnal.gov) error connecting  (Main.LeighGrund 4/25/2005)
    <verbatim>
     I have started getting these errors in my apache log.
     My client is also not working anymore. I don't know what changed. It used to
     work before. I will ask Markus since he was doing something on this host.
       ==> error_log <==
    [Thu Apr 21 16:35:46 2005] [error] SSL Re-negotiation in conjunction with POST
     method not supported!\nhint: try SSLOptions +OptRenegotiate
     ==> access_log <==
    131.225.87.15 - - [21/Apr/2005:16:35:46 -0500]
    "POST /edg-voms-admin/uscms/services/VOMSAdmin HTTP/1.0" 405 417
    ==> ssl_request_log <==
    [21/Apr/2005:16:35:46 -0500] 131.225.87.15 TLSv1 RC4-MD5
    "POST /edg-voms-admin/uscms/services/VOMSAdmin HTTP/1.0" 417
     </verbatim>
   <b>Resolution:</b>VOMS ACL permissions were not allowing access to the cmssrv17 VOMS server.  Set global acl to 'allow list' for any valid certificate.%ENDCOLOR%


   * %GREEN%PRIMA configuration section in PrivilegeSiteWhatToDo points to off-twiki page <a href="https://plone3.fnal.gov/opensciencegrid/techgroups/tg-policy/vo-privilege"> https://plone3.fnal.gov/opensciencegrid/techgroups/tg-policy/vo-privilege</a> which dates from VDT 1.3.1, there are some steps in there that say to modify shell scripts that are no longer necessary.  Summary should be integrated into the twiki and updated.  (Steve Timm 4/20/05) (Actually the direct link is [[https://plone3.fnal.gov/opensciencegrid/techgroups/tg-policy/vo-privilege/prima-authz-module-setup-in-vdt][here]].) %BR%
*Resolution*: Anne Heavey fixed May 31, 2005 -- PrivilegeSiteWhatToDo superseded by VoAdmins and other pages, also plone page updated to remove info about modifying shell scripts.
%ENDCOLOR%  

   * %BLACK% Need policy instructions on minimal GUMS config (Steve Timm)--minimal GUMS config is included in gums-service package now and instructions are available Anne Heavey Working on this May 20,2005 Dan Yocum contacting VOs for policy.    Plan is also to have a minimal default configuration for folks who do not reply. %BR%
*Partial resolution*:Anne H provided instructions in GumsConfigStepByStep, but hasn't addressed policy issues 5/27/05.
%ENDCOLOR%

   * %GREEN%Provide clear directions on how to install GUMS.-PrivilegeSiteWhatToDo section does not mention that GUMS server isn't installed in default OSG install. (Steve Timm), %BR%
*Resolution*: now this documentation is in GumsAdmins; AH 5/27/05%ENDCOLOR%

   * %GREEN%Not clear when in the install sequence to do the GUMS installation (nate suggests before doing the core installation itself), or how to change from one GUMS source to another.  Core install guide does not mention GUMS at all...
      * Clarification:  We suggest for site administrators that they work from minimal functionality to most complex.    Install the CE, manually populate the grid mapfile, contact the VOMS server and automatically populate the grid mapfile, install the GUMS server and enable the PRIMA module.   
      * For VO administrators the VOMS server should be installed first.
      * The CE Install documentation is being updated. May 20, 2005%ENDCOLOR%

   * %GREEN%Configure GUMS section is light on details and heavy on redirection.  Too many links to other web sites - would be best to have on a single page in a recipe format. %BR%
*Resolution*: This has been improved in GumsAdmins by JW and AH May 27, 2005.%ENDCOLOR%

   * %BLACK%Gotta find some better, more descriptive names for sections.  What the heck is a PrivilegeSite  Eschew Obfuscation! Dan Yocum will review and clarify May 20, 2005 %ENDCOLOR%

   * %GREEN%Instructions on edg-mkgridmap are wrong in PrivilegeSiteWhatToDo guide, have to fix.  Steve Timm.  Says it's installed automatically but isn't anymore. Documentation now fixed to show that you have to copy the edg-gridmapfile-upgraded to /etc/init.d %ENDCOLOR%

   *  %GREEN%After installing VDT1.3.5, first I set a password for root in mysql, then tried to do the GUMS addAdmin. addAdmin failed because it assumed there was no password required for root account. (Doug O.)
      * (Nate again) The VDT has a couple places where people with access to the local box can do bad things.  By default anyone with a login can administer VOMS and muck with the !MySQL server (GUMS, VOMS, RLS).  I brought this up in the past and people weren't too worried.  If that's changed I can bump up the priority of a fix.  For now you can run "configure_apache --secure" and set a password for root@localhost's !MySQL account, but you need to add your first VOMS and GUMS admins first.%ENDCOLOR%
  
---------------------------
---+++Apache Issues
   * From Vijay:
       I have started getting these errors in my apache log.
       My client is also not working anymore. I don't know what changed. It used to
       work before. I will ask Markus since he was doing something on this host
    <verbatim>
==> error_log <==
[Thu Apr 21 16:35:46 2005] [error] SSL Re-negotiation in conjunction with POST
method not supported!\nhint: try SSLOptions +OptRenegotiate

==> access_log <==
131.225.87.15 - - [21/Apr/2005:16:35:46 -0500]
"POST /edg-voms-admin/uscms/services/VOMSAdmin HTTP/1.0" 405 417

==> ssl_request_log <==
[21/Apr/2005:16:35:46 -0500] 131.225.87.15 TLSv1 RC4-MD5
"POST /edg-voms-admin/uscms/services/VOMSAdmin HTTP/1.0" 417
    </verbatim>
     
     
------------------------------
---+++ <nop>MonALISA Issues
   * %GREEN% Under the section "Monalisa and its information providers" in the OSGCEInstallGuide-0.1.6 there's a broken reference to the !TabPan view of MonALISA which doesn't seem to exist anymore.  What's the equivalent?  (S. Timm, 4/20/05) (Feature request, not a problem - R. Gardner) %ENDCOLOR%

   * %GREEN% OSGShutdownGuide says that the shutdown of MonALISA daemon should be done as user monalisa but if you follow the default instructions, the daemon will be running as user daemon.  I see default instructions have been modified to reflect the choice of user for running MonALISA. I have changed the OSGShutdownGuide to alert the sysadmin that it could be either monalisa or daemon%ENDCOLOR%

   * %GREEN% MonALISA documentation is referenced by three different wikiwords, Monalisa, !MonaLisa, and MonALISA, need to fix,--Fixed (all now MonALISA) (S. Timm 4/20)%ENDCOLOR%

   * %GREEN% No obvious explanation of what orange, red, green mean in the MonALISA display (Steve Timm) orange vo_jobs, mean no jobs running, red means missing grid3 file--I have now added this to the VO Modules section of the MonALISA wiki.%ENDCOLOR%

   * %GREEN% problem $VDT_LOCATION/monitoring/grid3-user-vo-map.txt isn't made, in at least 2 different installs. (Steve Timm) I have verified that this fix was made in 0.1.5-2 release.%ENDCOLOR%


--------------------------------
---+++ Pacman Issues
   * Initial pacman-3.11 hardwired to use python binary 'python', which on RH7 is 1.5.2.  To fix, edit
     python/build_python_if_necessary.py and src/pacman to use the right python (Craig Prescott) --forward this to Saul?
      * (Nate) I don't think Saul can do anything about this.  There's no consistent name for python v2.2 between systems.  Somewhere it's "python", in other places "python2" or "python2.2".  We've run into this with the VDT and you can see our workaround at $VDT_LOCATION/vdt/bin/python2.  Is this causing any problems, or do you just not want to wait for python to be built?
         * (Craig) I understand.  Call me old-fashioned, though, but I don't want an "extra" python installed on my CE if I can avoid it.  I've already got a perfectly good python2.
         * (Saul) I'll see if I can improve this, but I'm afraid that Nate is correct.  I'd suggest either arranging that python is >2.2 yourself or letting Pacman install it's own copy.
      * If you've got a Rocks installation, Pacman 3.11 will not recognize your platform (Rocks removes the usual /etc files that Pacman uses to detect OS).  This is fixed in 3.12.  If you're in this situation in the mean time, I recommend begining each installation with [% pacman -pretend-platform:RHEL-3].(Saul)

--------------------------
---+++Condor Issues
   * %GREEN% If condor-from-the-VDT is requested, /etc/init.d/condor is not replaced (Fixed in VDT 1.3.6); for this release, you'll need to start by hand.  Not important (Alain) %ENDCOLOR%

---------------------------
---+++MDS Issues
   * %GREEN%LDAP service for MDS is mentioned but no mention of what is MDS or why will you ever run it. (Steve Timm) --- until GIP's are available, there is no hard requirement for a running GRIS. A service certificate is required. Translation--MDS for our purposes is the GRIS--correct?  I have noted the equivalence where the GRIS is started, noted that ldap certificate for authenticated MDS is optional where this is mentioned.%ENDCOLOR%

--------------------------------
---+++ <nop>GridCat Issues
   * Until !GridCAT interface issues are resolved by the community, provide direct acces to the !GridCAT mysql database in the same manner as is provided for !Grid3.  This should be done via a "safe" login that has only read-access priviledges. This will enable current users gridcat-mysql to test and debug more effectively on the ITB. (Mike Wilde)
      * (Craig)  The interface issues should be documented, if they aren't already.  For the record, CMS is just fine with the current XML-RPC interface.  I think all grid users would appreciate it if GridCat had the ability to change its underlying MySQL schema without affecting users.  Hiding the MySQL schema behind a web service interface is good and important, even if that interface isn't perfect (my 2 cents).

--------------------------------
---+++ <nop>GridFTP Issues
   * At U Buffalo mama.ccr.buffalo.edu and Fermilab fnpcg.fnal.gov, GT4 !GridFTP server hangs, when conecting via uberftp, with message on client side: "an end-of-file was reached". (Mike Wilde)  Now uberftp into fnpcg.fnal.gov works for me, have fixed tcp wrappers there, please try again.  (Steve Timm).

-------------------------------
---+++ Miscellaneous Issues
   * %GREEN% New prompt from monitoring/configure-grid3.sh, explanation is needed (S. Timm 4/19/05) %ENDCOLOR%

   * %GREEN% No instructions given to start Core MIS services in general instructions. (Steve Timm) %ENDCOLOR%

   * %GREEN% Core MIS release description is not specific.%ENDCOLOR%

   * There is no instructions for site admins for creating apps, tmp, data, tmp_wn directories and the correct permissions to apply, also I believe that there should also be a apps/etc directory (Mark Green) --- Leigh will bring old Grid3 instructions forward.

   *  %GREEN% ATLAS validators reported that if /app directory is a symlink on some nodes but not on others, Pacman will expand the symlink on those where it is and get confused on those where it is not....evidently ATLAS is using Pacman to install their validation application.  (Steve Timm 4/20) I fixed my nodes accordingly so /app and /data are straight directories but these instructions should still be noted above
      * (Craig) Why doesn pacman do this?  Naively, this sounds like a pacman bug.%ENDCOLOR%


   * %GREEN% Should the dzero VO be included? also who sets the policy for osg on what vo's are in and which ones are out?  (S. Timm) From the recent policy additions to the twiki it is clear that the answer for the ITB is no, it should not be included, that all of the accounts in the list should be made in the ITB setup but there will be a new list in provisioning/deployment which can differ by site both in how many accounts per VO and which VO's.%ENDCOLOR%

   * At TTU testwulf.hpcc.ttu.edu, authentication to both GT2 and GT4 server takes between 15 and 25 seconds. Authentication to GRAM (globus-job-run) takes less than 1 second.  All other sites do !GridFTP auth in around one second. (Mike Wilde)
      * (Craig) Confirmed - authenticating to TTU has always been slow; I'm not sure why (shrug).

   * Resolve procedures for sites to correctly set GLOBUS_TCP_PORT_RANGE and GLOBUS_TCP_SOURCE_RANGE for GT4 !GridFTP server. Discussed with Alain Roy, Alain to clarify procedures. (Mike Wilde)
      * (Craig) I believe site admins should put this in their "local" VDT setup script.

   * %GREEN% gris install error message: - 
         <verbatim>
        Installing /gris.
        Adding rc based service: gris
        Using init dir at /etc/rc.d/init.d
        Don't know how to install the service on this arch
        ERROR: Error setting up GRIS
        </verbatim>
     (Suresh Singh) %ENDCOLOR%

   * Transient authentication error (to gsiftp 2811 service) simultaneously at IU_iutalas and IUPUI_ITB:
%GREEN% 
         <verbatim>
        error: globus_ftp_client: the server responded with an error
        530-Login incorrect. : gridmap.c:globus_gss_assist_map_and_authorize:1483:
        530-Error invoking callout
        530-globus_callout.c:globus_callout_handle_call_type:714:
        530-The callout returned an error
        530-prima_module.c:Globus Gridmap Callout:359:
        530-Gridmap lookup failure: Identity Mapping Service could not be contacted
        530 End.
         </verbatim>
%ENDCOLOR%
   This was only occurring for a brief time around 2:20 CDT Apr 21, but I'm curious if this is something we need to watch out for in normal operation? It was odd to see an auth failure affect more than one site at a time.  Is this Identity Mapping a shared service between all sites? (Mike W)

   * %GREEN%(Craig) Fragility of host-based security (hosts.allow) should be remarked upon somewhere (a deployment issue?).  It is an issue that has come up for a long time, since Grid3.  My 2 cents - tcp-wrapper security won't scale when lots of VO users are turned loose on the OSG.%ENDCOLOR%
      * %GREEN%(Craig) This is addressed in the Firewalls section of the OSGCEInstallGuide-0.1.6.%ENDCOLOR%

---++Guides for Site Administrators

The SiteAdmins web describes how services listed below are installed, configured, and checked
by the site administrators.  To shut down services prior to the upgrade, see the OSGShutdownGuide.
For a detailed step-by-step guide to the core installation procedures, see the OSGCEInstallGuide-0.1.6.


---++Guides for GUMS Administrators

The GumsAdmins topic describes how and why to use the Privilege software, GUMS. 

* PrivilegeSiteWhatToDo

---++Guides for VO Administrators

The VoAdmins page provides information for VO administrators.  There are also some new pages specific to the authentication / authorization chain available:
   * PrivilegeVOWhatToDo 
   * PrivilegeSiteWhatToDo
   * GoldenChainDebugging for debugging the privilege components and their interaction.

The [[ItbVo][VO registration]] procedure should be used to communicate a VO level service to 
grid resources (sites/gatekeepers). 

---++ Pacman Recommendation
The installation instructions are based on PacmanInfo.  For this release, we recommend *Pacman 3.11*.

---++ OSG Compute Element (CE) Description
The OSG CE installation is done with the Pacman command <verbatim>pacman -get iVDGL:osg-0.1.5.</verbatim> This delivers the following components:

   * Root package: <a href="http://hep.uchicago.edu/ivdgl/osg-0.1.5.pacman">osg-0.1.5.pacman</a>
   * Depends on [[http://hep.uchicago.edu/ivdgl/osg-auto-0.1.5.pacman][osg-auto-0.1.5.pacman]] which sets some default answers to VDT configuration questions. It also distributes the OSG Release Notes. 
      * VDTSETUP_AGREE_TO_LICENSES=y
      * VDTSETUP_ENABLE_GATEKEEPER=y
      * VDTSETUP_ENABLE_GRIDFTP=y
      * VDTSETUP_ENABLE_GRIS=y
      * VDTSETUP_GRIS_AUTH=y  
      * VDTSETUP_EDG_CRL_UPDATE=y
      * VDTSETUP_ENABLE_GLOBUS_ROTATE=y
      * VDTSETUP_INSTALL_CERTS=r
      * VDTSETUP_EDG_MAKE_GRIDMAP=n
   * Depends on [[http://hep.uchicago.edu/ivdgl/VDT_135.pacman][VDT_135.pacman]]. Installed are three VDT packages:
      * [[http://www.cs.wisc.edu/vdt/vdt_135_cache/VDT-Gatekeeper.pacman][VDT-Gatekeeper]]
      * [[http://www.cs.wisc.edu/vdt/vdt_135_cache/Globus-Client.pacman][Globus-Client]]
      * [[http://www.cs.wisc.edu/vdt/vdt_135_cache/MyProxy.pacman][MyProxy]]
   * Depends on [[http://hep.uchicago.edu/ivdgl/grid3-schema.pacman][grid3-schema.pacman]] which installs the Globus MDS Grid3 schema.
   * Dependent package: [[http://hep.uchicago.edu/ivdgl/osg-grid3-info-prov.pacman][osg-grid3-info-prov.pacman]] which installs the Globus MDS Grid3 information providers.
   * Dependent package: [[http://hep.uchicago.edu/ivdgl/vo-0.1.5.pacman][vo-0.1.5.pacman]] which installs the configurtion script to retrieve VO information.
   * Dependent package: [[http://hep.uchicago.edu/ivdgl/MIS-CI.pacman][MIS-CI.pacman]] which installs the current Monitoring Core Infrastructure descibed below.

---++ VDT
We will use release %OSG_ITB_VDT_VERSION% of the VirtualDataToolkit %OSG_ITB_VDT_VERSION%, see <a href="http://www.cs.wisc.edu/vdt/releases/%OSG_ITB_VDT_VERSION%/release.html">release notes</a>. 

%ENDCOLOR%
The ITB expects applications and users to use the Client tools from VDT %OSG_ITB_VDT_VERSION%.  There are no OSG or ITB specific installation or configurations required for the clients. ?? Is this true??

---++ Globus 4 gridftp

Included with VDT.  The GridFTP page describes the service integration in detail.

---++ Core MIS
Description of the Trash.IntegrationCoreMIS infrastructure to be used.  MIS-CI Version 0.2.5p1  
The Core MIS will be configured by the configure_misci.sh script as a post installation
 step.

---++ Grid Cat
Description of the GridCat site monitoring catalog to be used.

---++ Grid Exerciser
Description of the GridEx service validation application.


---++ MonALISA
Any special configuration needed for MonALISA for this release, noted here.

---++ Privilege and VO services infrastructure
Description of PrivilegeOSG options for this release.
As of this release, the PRIMA interpretation of extended proxies has been fixed to match the VOMS usage.
Use of PRIMA for role-based authorization decisions is supported as of this release (0.1.5) but not in earlier releases.
The GUMS version should be 1.0.1 from VDT 1.3.5 and the VOMS Admin and VOMS Server should be installed from the VDT 1.3.5.
to ensure correct functioning.

---++ Discovery Service
Description of the 
[[http://ultralight.caltech.edu/gaeweb/wiki/index.php/ClarensDiscoveryService][ClarensDiscoveryService]]
deployed in this release.  Here are the DiscoveryServiceInstallation instructions.

The Discovery Service version 0.5.3 is deployed on a JClarens server version 0.5.3 for this OTB release.  Installation of the Discovery Service is optional for the ITB.

---++ Disk Resource Manager

   * We are not recommending installtion and use of the disk based storage resource manager, SRM-DRM.
   * Stay tuned to Trash.IntegrationDiskResourceManager for updates.


---++ Site Verify

The SiteVerify package has its own  
[[http://griddev.uchicago.edu/download/grid3/doc.pkg/WIP/site_verify_pl.html"]][[web page]] 
for release documentation, but has been included in the pacman cache as of this release.


---++ CMS Tier1 SE

The service is based on SRM-dCACHE and satisfies the SRM V1.1 interface, with additions for implicit 
space reservation.  Trash.IntegrationCMSSrmdCache provides the readiness plan. The service will be available to all registered OSG VO's.
To use the SE requires an SRM V1.1 compatible client.  This is available from VDT (as part of the DRM package) or from anonymous ftp 
to fnkits.fnal.gov://products/srmcp/v1_11/NULL (v1.12 almost available and should probably be the version deployed.)

[v1_15 has been announced by Timur on May 13. The recommended version may be the same, needs to be confirmed : Abhishek S R, 05/20/2005]



<!-- MAJOR UPDATES
For significant updates to the topic, consider adding your 'signature' (beneath this editing box) !-->

*Major updates*:%BR%
<!--Future editors should add their signatures beneath yours!-->

-- Main.LeighGrund - 19 Apr 2005

%STOPINCLUDE%
 
