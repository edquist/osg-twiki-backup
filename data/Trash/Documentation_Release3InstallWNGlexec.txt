%META:TOPICINFO{author="WillMaier" date="1317931951" format="1.1" version="1.7"}%
%META:TOPICPARENT{name="InstallBestPractices"}%
---+ Glexec for the OSG Worker Node

This page covers installing the optional glexec package on a worker node, and assumes.

In order to use the glexec RPM, you need to satisfy the following pre-requisites:
   1. Use a GUMS server version 1.3 or later.
   1. All worker nodes must have a host certificate in place.  They will not act as server, nor do they need to be recognized by the outside world.
      * If you do not want to generate unique host certificates for each node, you may reuse a self-signed certificate, as long as your GUMS server recognizes it.
      * Host certificate management is not covered here.

Please notice that it will create a *glexec* user, if you don't already have one in place.

---++ Install Instructions
   1. [[Documentation/Release3.InstallWNClient][Install the WN-Client]], if you have not already done so.
   1. Install the glexec meta-package: <pre class="screen">%UCL_PROMPT_ROOT% yum --enablerepo=osg-testing install osg-wn-client-glexec </pre>

---++ Configuration

Edit =/etc/lcmaps.db= :
   1. Change the endpoint of =gumsclient= to reflect the hostname of your GUMS server.
   1. Choose one of the three policies found at the bottom of the file and uncomment the relevant lines; if you choose policy 1, uncomment the glexectracking lines as well.
   1. If you use SAZ for additional authorization, uncomment the relevant lines.
   1. Glexec assigns a unique, ephemeral GID to each process it launches, providing better protection from runaway jobs.  By default, it uses the GID range 65000 to 65049; if this conflicts with local, in-use GIDs, change the possible GID range.

Invoking glexec will execute the process under the mapped user name (UID). So you must create all the users that GUMS may ever return.

---++ Testing

   1. Switch to a non-root user.
   1. Create yourself a valid proxy with =voms-proxy-init=.
   1. Invoke glexec as follows; you should get back the local ID your proxy was mapped to: <pre class="screen">%UCL_PROMPT% 
%UCL_PROMPT% GLEXEC_CLIENT_CERT=/tmp/x509up_u500 /usr/sbin/glexec /usr/bin/id
uid=7166(osgedu) gid=9803(osgedu) groups=65000(glexec00)</pre>

All parts of glexec use syslog (facility LOCAL1) by default; for failures, most systems will record the logging information into =/var/log/messages=.

%META:TOPICMOVED{by="JamesWeichel" date="1317238715" from="Documentation.InstallWNGlexecRPM" to="Documentation/Release3.InstallWNGlexec"}%
