%META:TOPICINFO{author="ArvindGopu" date="1191611998" format="1.1" reprev="1.1" version="1.1"}%
---+Install and Configure Resource and Service Validation (RSV) Service

<p> The OSG-RSV package, by default, is installed along with the OSG CE but not fully configured. Additional configuration steps are necessary as documented below. If you are looking to install !RSV on a monitoring host independent of your CE then please [[http://peart.ucs.indiana.edu/docs/osg/vdt-package.html#install_on_monitoring_host][look here]]. Configuration steps are outlined below:

   * Configure Metrics to run and how often: If this is the first time you're configuring !RSV, then copy the sample metrics file =$VDT_LOCATION/osg-rsv/config/sample_metrics.conf-1.4= to =$VDT_LOCATION/osg-rsv/config/&#60;host_FQDN&#62_metrics.conf=, and make further edits to it if necessary. Enable/Disable a particular metric: Any line that starts with *on* is enabled; change that keyword to *off* to disable a metric. For example, if you site runs only the PBS job-manager, then you might disable the other jobmanagers-status probes.
   <pre>   on jobmanagers-status-probe@org.osg.batch.jobmanager-pbs-status 24 */2 * * *</pre>
   More information on this is [[http://peart.ucs.indiana.edu/docs/osg/vdt-1.8.1a-package.html#configure_metrics][available here]]. Go here for documenation on [[http://peart.ucs.indiana.edu/docs/osg/vdt-1.8.1a-package.html#extra_probe_specs][adding custom switches to the !RSV !probes]].

   * Ensure you have a valid username for !RSV (say, =rsvuser=); then run !RSV config scripts as shown below. Replace entries in =<em><strong>italics</strong></em>= to appropriate values (<em>FQDN of your CE, a non-root user, and a proxy file for that user's UID owned by that user</em>):
   <pre> $VDT_LOCATION/vdt/setup/configure_osg_rsv --uri &#60;<em><strong>FQDN of host to probe</strong></em>&#62; \
   --user <em><strong>rsvuser</strong></em> --init --server y --setup-for-apache \
   --probes --gratia --verbose --proxy /tmp/x509up_u<em><strong>550</strong></em> </pre>
      More information on the !RSV configuration script is [[http://peart.ucs.indiana.edu/docs/osg/vdt-1.8.1a-package.html#configure_osg_rsv_script][available here]].

   * If you chose *not* to configure the !RSV Gratia collectorin the =configure-osg.sh= step, then run =configure_gratia= to setup metric probe:
   <pre>$VDT_LOCATION/vdt/setup/configure_gratia --probe metric --report-to &#60;Appropriate_RSV_collector_shown_below:port&#62;</pre>
     !RSV Collector to use in above command execution
     | <strong>Production Resources</strong> | <strong>ITB Resources</strong> |
     | rsv.grid.iu.edu:8880 | rsv-itb.grid.iu.edu:8880 |

   * Start Condor-devel and !RSV services
  <pre>   vdt-control --on condor-devel
   vdt-control --on  osg-rsv</pre>
      More information on this  is [[http://peart.ucs.indiana.edu/docs/osg/vdt-1.8.1a-package.html#start_rsv][available here]].

   * If you want to be sure everything worked fine, you should look for two things: 
      * Look at Gratia consumer log file: =$VDT_LOCATION/osg-rsv/logs/consumers/gratia-script-consumer.out= to see if probe results were uploaded succesfully to the !GOC maintained !RSV database. You should a bunch of entries similar to this:
   <pre>   08-20-2007 16:35:26 - Executing script '/usr/local/grid/ . . . record.py'
   OK </pre>
      *  Check out the status web page that is created with results of RSV probe runs each day. By default, this page is =$VDT_LOCATION/osg-rsv/output/html/status.html=, but can be reconfigured. You can either view the local status pages directly on the monitoring host ; or you can view these pages on the web at !http://&#60;hostname&#62;:8080/rsv, assuming you [[http://peart.ucs.indiana.edu/docs/osg/vdt-package.html#configure_osg_rsv_script_localweb][configured !RSV to use the !VDT Apache]] to serve them. Beware that you need to have an !OSG approved cert loaded in your web browser to be able to view them page. The status pages should look similar to [[http://peart.ucs.indiana.edu/docs/osg/sample_status.html][what is documented here]].

<p> More information on configuring !RSV and related topics is available in the [[http://peart.ucs.indiana.edu/docs/osg/][RSV documentation pages]].
