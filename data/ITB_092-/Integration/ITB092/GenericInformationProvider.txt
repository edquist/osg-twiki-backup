%META:TOPICINFO{author="AnthonyTiradani" date="1233870501" format="1.1" reprev="1.26" version="1.26"}%
---+!! *<noop>%SPACEOUT{ "%TOPIC%" }%*
%TOC%

Note:  This page refers to the ldapsearch command.  The ldapsearch command is not part of the standard OSG installation, however, it is commonly on many standard linux installations. If you do not have it and would like to get it from the VDT, it is part of the VDT OpenLDAP package.  Use pacman and refer to the VDT Package 'OpenLDAP.'

---++ Introduction
The Open Science Grid (OSG) Generic Information Provider (GIP) is a core part of the OSG Information Infrastructure. It should be configured carefully by the resource administrator to correctly publish the information about the site. Information collected by the GIP is sent through CEMON to both a central LDAP (BDII) server and a Resource Selection Service RESS Server.

The GIP is a grid information service that aggregates static and dynamic resource information for use with LDAP-based information systems. The GIP produces information based on the [[http://glueschema.forge.cnaf.infn.it/SpecV13/LDAP][GLUE Schema]].

---+++ GIP Release Notes
GIP release notes can be found at GipReleaseNotes.

---++ Installation
 The Generic Information Provider is installed with the standard OSG installation. To activate it, you must complete the configuration section of this document.

---++ Configuration
Configuration of the GIP is done through the config.ini configuration file and configure-osg.py.  After editing the config.ini file, run configure-osg.py.  GIP has now been configured for most sites.  The only GIP configuration work that remains is if you want to use the dCache 1.8 provider, or if you want to modify in some way the information that the GIP gathers.  This is detailed in the next section.  For full configuration details see [[GipConfiguration][GIP Configuration]].  

---++ Post Install

---+++ dCache 1.8 provider
Sites that have a dCache 1.8 Storage Element (SE) and wish to advertise it via the gip should follow the the instructions at [[https://twiki.grid.iu.edu/twiki/bin/view/InformationServices/DcacheGip][GIP setup for the dcache provider]] to setup GIP to advertise your dcache SE.

---+++ Additional Functionality
   * [[GipOverrides#Overwriting_attributes_published][Administrator Overrides]] 
      * [[GipOverrides#Case_1_Altering_values_published][Altering published values]]: E.g. Changing default values for !GlueHostNetworkAdapterInboundIP, !GlueHostNetworkAdapterOutboundIP, !GlueHostOperatingSystemName, and others. 
      * [[GipOverrides#Case_2_Adding_new_DNs][Adding New DNs]]: E.g. GIP published one !SubCluster entry by default, but if you have an heterogeneous cluster with multiple sub-clusters. 
   * [[GipOverrides#Adding_site_defined_constraints][Adding site defined constraints to custom configure condor status commands]] 

---++ Validation Webpage
 A Validator for GIP can be found at [[http://gip-validate.grid.iu.edu/]].  CHANGE THIS WHEN THE NEW VALIDATOR BECOMES AVAILABLE

One can execute:
<pre>ldapsearch -x -LLL -p 2170 -h is-itb.grid.iu.edu -b mds-vo-name=YOUR_SITE_NAME_HERE,mds-vo-name=local,o=grid </pre>

For a complete set of instructions to validate information published to BDII, see the ValidateBDII page.

For instructions to validate information published to !ReSS, see the [[ResourceSelection.WebHome#ValidationLinks][ReSS validation links]].

---++ Troubleshooting
   * Error comparing subject names.: Desired subject and actual subject of certificate do not match. %BR% Desired subject: =/CN=ldap/cmssrv09.fnal.gov= %BR% Actual subject: =/DC=org/DC=doegrids/OU=Services/CN=cmssrv09.fnal.gov= %BR% *Cause:* You are probably using your host certificate for your LDAP certificate. A common shortcut. 

   * Information is NOT sent to BDII or CEMon. Follow [[ResourceSelection.CEMonTroubleshootingGuide][CEMon troubleshooting guide]]. 

*In Progress*

---++ Miscellaneous Info
   * [[GipAttributeExplanation][Explanation of GIP / Glue Attributes]]
   * [[http://glueschema.forge.cnaf.infn.it/SpecV13/LDAP][GLUE 1.3 LDAP schema]] 
   * [[http://glueschema.forge.cnaf.infn.it/][Documents about GLUE]] 

---+++ Useful LDAP Tool

If you run an un-authenticated GRIS / GIP and want to check your results a helpful tool is the [[http://www-unix.mcs.anl.gov/~gawor/ldap/][LDAP browser]].
   1 Download the zip/tar file and unpack it. 
   1 Start it by running the lbe.sh script. A graphical user interface will appear. 
   1 Create a new connection and enter the following properties for the new connection: 

<pre>    Host: is.grid.iu.edu     Port: 2170     Base DN: mds-vo-name=local,o=grid </pre>

This will pull in information from the entire BDII. If you would prefer to see your site only, then create a new connection and enter the following properties for the new connection:

<pre>    Host: is.grid.iu.edu     Port: 2170     Base DN: mds-vo-name=your-site-name,mds-vo-name=local,o=grid </pre>

---+++ Explanation of BDii
 BDii is the Berkeley Database Information Index. It consists of two or more standard LDAP databases that are populated by an update process. The OSG BDii service collects GIP information from OSG hosts which are running the CEMon service.

The connect to the BDii service standard LDAP querying command can be used.

<pre>> *ldapsearch -LLL -x -h is.grid.iu.edu -p 2170 -b "o=grid"* </pre>

The BDii server name is "is.grid.iu.edu" the BDii port to query is 2170.

Other useful query examples follow:

This query returns site information for !FermiGrid. Piping the output of ldapsearch into perl prevents ldapsearch from cutting the output at column 80.

<pre> > ldapsearch -x -l 60 -b mds-vo-name=local,o=grid  -h is.grid.iu.edu -p 2170  "(GlueSiteName=FNAL_FERMIGRID)"  | perl -00pe 's/\r*\n //g' </pre>

This query returns information about all Authorization services.
<pre>> ldapsearch -x -l 60 -b mds-vo-name=local,o=grid  -h is-itb.grid.iu.edu -p 2170  "(&(objectClass=GlueTop)(objectClass=GlueService)(objectClass=GlueKey)(objectClass=GlueSchemaVersion)(GlueServiceName=Authorization))"  | perl -00pe 's/\r*\n //g' </pre>

%BR% 
%COMPLETE3% %BR% 
%RESPONSIBLE% Main.AnandPadmanabhan - 19 Nov 2007 %BR% 
%REVIEW% Main.AnthonyTiradani - 2 Sep 2008 %BR% 
%REVCOM% Added information to the Post Install section for the dcache provider and additional configuration options for PBS sites%BR% 
%REVFLAG% %Y% %BR%

%META:TOPICMOVED{by="AnneHeavey" date="1192821927" from="Integration/ITB_0_7.CENodeGIP" to="Integration/ITB_0_7.GenericInformationProvider"}%
