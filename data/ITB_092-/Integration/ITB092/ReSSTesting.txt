%META:TOPICINFO{author="ParagMhashilkar" date="1228347031" format="1.1" reprev="1.1" version="1.1"}%
%META:TOPICPARENT{name="ITBTestingInstructions"}%
---+!! *<nop>%SPACEOUT{ "%TOPIC%" }%*
%TOC%

%STARTINCLUDE%
%BR%
---+ _%INCLUDEHEADING%  %SPACEOUT{ "%TOPIC%" }%_
Testing advertisements to !ReSS using CEMon

%EDITTHIS%
%BR%

---++ Support for MPI

---+++ Configuring !CEMon to advertise MPI attributes
Sites can advertise support for MPI using following Glue attributes -
   * !GlueSoftwareLocalID
   * !GlueSoftwareName
   * !GlueSoftwareVersion
   * !GlueSoftwareInstalledRoot
   * !GlueSoftwareEnvironmentSetup
   * !GlueSoftwareModuleName
   * !GlueSoftwareDataParams

Change $VDT_LOCATION/gip/etc/add-attributes.conf to add MPI related information you would like to publish

<verbatim>
dn: GlueSoftwareLocalID=IntelCompilers_9,GlueSubClusterUniqueID=lepton.rcac.purdue.edu,GlueClusterUniqueID=lepton.rcac.purdue.edu,mds-vo-name=Purdue-Steele,mds-vo-name=local,o=grid
objectClass: GlueClusterTop
objectClass: GlueSoftware
objectClass: GlueKey
objectClass: GlueSchemaVersion
GlueHostApplicationSoftwareRunTimeEnvironment: IntelCompilers_9
GlueSoftwareLocalID: IntelCompilers_9
GlueSoftwareName: IntelCompilers
GlueSoftwareVersion: 9
GlueSoftwareInstalledRoot: /opt/intel
GlueSoftwareEnvironmentSetup: module load intel/9.1.049
GlueSoftwareModuleName: intel/9.1.049
GlueChunkKey: GlueSubClusterUniqueID=lepton.rcac.purdue.edu
GlueSchemaVersionMajor: 1
GlueSchemaVersionMinor: 3

dn: GlueSoftwareLocalID=MPICH_1.2.7p1_intel,GlueSubClusterUniqueID=lepton.rcac.purdue.edu,GlueClusterUniqueID=lepton.rcac.purdue.edu,mds-vo-name=Purdue-Steele,mds-vo-name=local,o=grid
objectClass: GlueClusterTop
objectClass: GlueSoftware
objectClass: GlueKey
objectClass: GlueSchemaVersion
GlueHostApplicationSoftwareRunTimeEnvironment: MPICH_1.2.7p1_intel
GlueSoftwareLocalID: MPICH_1.2.7p1_intel
GlueSoftwareName: MPICH
GlueSoftwareVersion: 1.2.7.p1_intel
GlueSoftwareInstalledRoot: /apps/steele/mpich-1.2.7p1/64/p4-intel-10.1.015
GlueSoftwareEnvironmentSetup: module load mpich-intel
GlueSoftwareModuleName: mpich-intel
GlueChunkKey: GlueSubClusterUniqueID=lepton.rcac.purdue.edu
GlueSchemaVersionMajor: 1
GlueSchemaVersionMinor: 3

dn: GlueSoftwareLocalID=MPICH_1.2.7p1_gcc,GlueSubClusterUniqueID=lepton.rcac.purdue.edu,GlueClusterUniqueID=lepton.rcac.purdue.edu,mds-vo-name=Purdue-Steele,mds-vo-name=local,o=grid
objectClass: GlueClusterTop
objectClass: GlueSoftware
objectClass: GlueKey
objectClass: GlueSchemaVersion
GlueHostApplicationSoftwareRunTimeEnvironment: MPICH_1.2.7p1_gcc
GlueSoftwareLocalID: MPICH_1.2.7p1_gcc
GlueSoftwareName: MPICH
GlueSoftwareVersion: 1.2.7p1_gcc
GlueSoftwareInstalledRoot: /apps/steele/mpich-1.2.7p1/64/p4-gcc-4.3.0
GlueSoftwareModuleName: mpich-gcc
GlueSoftwareEnvironmentSetup: module load mpich-gcc
GlueChunkKey: GlueSubClusterUniqueID=lepton.rcac.purdue.edu
GlueSchemaVersionMajor: 1
GlueSchemaVersionMinor: 3

dn: GlueSoftwareLocalID=MPICH_1.2.7p1_pgi,GlueSubClusterUniqueID=lepton.rcac.purdue.edu,GlueClusterUniqueID=lepton.rcac.purdue.edu,mds-vo-name=Purdue-Steele,mds-vo-name=local,o=grid
objectClass: GlueClusterTop
objectClass: GlueSoftware
objectClass: GlueKey
objectClass: GlueSchemaVersion
GlueHostApplicationSoftwareRunTimeEnvironment: MPICH_1.2.7p1_pgi
GlueSoftwareLocalID: MPICH_1.2.7p1_pgi
GlueSoftwareName: MPICH
GlueSoftwareVersion: 1.2.7p1_pgi
GlueSoftwareInstalledRoot: /apps/steele/mpich-1.2.7p1/64/p4-pgi-7.1-6
GlueSoftwareModuleName: mpich-pgi
GlueChunkKey: GlueSubClusterUniqueID=lepton.rcac.purdue.edu
GlueSchemaVersionMajor: 1
GlueSchemaVersionMinor: 3

dn: GlueSoftwareLocalID=MPICH2_1.0.7_intel,GlueSubClusterUniqueID=lepton.rcac.purdue.edu,GlueClusterUniqueID=lepton.rcac.purdue.edu,mds-vo-name=Purdue-Steele,mds-vo-name=local,o=grid
objectClass: GlueClusterTop
objectClass: GlueSoftware
objectClass: GlueKey
objectClass: GlueSchemaVersion
GlueHostApplicationSoftwareRunTimeEnvironment: MPICH2_1.0.7_intel
GlueSoftwareLocalID: MPICH2_1.0.7_intel
GlueSoftwareName: MPICH2
GlueSoftwareVersion: 1.0.7_intel
GlueSoftwareInstalledRoot: /apps/steele/mpich2-1.0.7/64/ssm-intel-10.1.015
GlueSoftwareModuleName: mpich2-intel
GlueChunkKey: GlueSubClusterUniqueID=lepton.rcac.purdue.edu
GlueSchemaVersionMajor: 1
GlueSchemaVersionMinor: 3

dn: GlueSoftwareLocalID=MPICH2_1.0.7_gcc,GlueSubClusterUniqueID=lepton.rcac.purdue.edu,GlueClusterUniqueID=lepton.rcac.purdue.edu,mds-vo-name=Purdue-Steele,mds-vo-name=local,o=grid
objectClass: GlueClusterTop
objectClass: GlueSoftware
objectClass: GlueKey
objectClass: GlueSchemaVersion
GlueHostApplicationSoftwareRunTimeEnvironment: MPICH2_1.0.7_gcc
GlueSoftwareLocalID: MPICH2_1.0.7_gcc
GlueSoftwareName: MPICH2
GlueSoftwareVersion: 1.0.7_gcc
GlueSoftwareInstalledRoot: /apps/steele/mpich2-1.0.7/64/ssm-gcc-4.3.0
GlueSoftwareModuleName: mpich2-gcc
GlueChunkKey: GlueSubClusterUniqueID=lepton.rcac.purdue.edu
GlueSchemaVersionMajor: 1
GlueSchemaVersionMinor: 3

dn: GlueSoftwareLocalID=MPICH2_1.0.7_pgi,GlueSubClusterUniqueID=lepton.rcac.purdue.edu,GlueClusterUniqueID=lepton.rcac.purdue.edu,mds-vo-name=Purdue-Steele,mds-vo-name=local,o=grid
objectClass: GlueClusterTop
objectClass: GlueSoftware
objectClass: GlueKey
objectClass: GlueSchemaVersion
GlueHostApplicationSoftwareRunTimeEnvironment: MPICH2_1.0.7_pgi
GlueSoftwareLocalID: MPICH2_1.0.7_pgi
GlueSoftwareName: MPICH2
GlueSoftwareVersion: 1.0.7_pgi
GlueSoftwareInstalledRoot: /apps/steele/mpich2-1.0.7/64/ssm-pgi-7.1-6
GlueSoftwareModuleName: mpich2-pgi
GlueChunkKey: GlueSubClusterUniqueID=lepton.rcac.purdue.edu
GlueSchemaVersionMajor: 1
GlueSchemaVersionMinor: 3

dn: GlueSoftwareLocalID=MPICH2_1.0.7_nemesis_intel,GlueSubClusterUniqueID=lepton.rcac.purdue.edu,GlueClusterUniqueID=lepton.rcac.purdue.edu,mds-vo-name=Purdue-Steele,mds-vo-name=local,o=grid
objectClass: GlueClusterTop
objectClass: GlueSoftware
objectClass: GlueKey
objectClass: GlueSchemaVersion
GlueHostApplicationSoftwareRunTimeEnvironment: MPICH2_1.0.7_nemesis_intel
GlueSoftwareLocalID: MPICH2_1.0.7_nemesis_intel
GlueSoftwareName: MPICH2
GlueSoftwareVersion: 1.0.7_nemesis_intel
GlueSoftwareInstalledRoot: /apps/steele/mpich2-1.0.7/64/nemesis-intel-10.1.015
GlueSoftwareModuleName: mpich2-nemesis-intel
GlueChunkKey: GlueSubClusterUniqueID=lepton.rcac.purdue.edu
GlueSchemaVersionMajor: 1
GlueSchemaVersionMinor: 3

dn: GlueSoftwareLocalID=MPICH2_1.0.7_nemesis_pgi,GlueSubClusterUniqueID=lepton.rcac.purdue.edu,GlueClusterUniqueID=lepton.rcac.purdue.edu,mds-vo-name=Purdue-Steele,mds-vo-name=local,o=grid
objectClass: GlueClusterTop
objectClass: GlueSoftware
objectClass: GlueKey
objectClass: GlueSchemaVersion
GlueHostApplicationSoftwareRunTimeEnvironment: MPICH2_1.0.7_nemesis_pgi
GlueSoftwareLocalID: MPICH2_1.0.7_nemesis_pgi
GlueSoftwareName: MPICH2
GlueSoftwareVersion: 1.0.7_nemesis_pgi
GlueSoftwareInstalledRoot: /apps/steele/mpich2-1.0.7/64/nemesis-pgi-7.1-6
GlueSoftwareModuleName: mpich2-nemesis-pgi
GlueChunkKey: GlueSubClusterUniqueID=lepton.rcac.purdue.edu
GlueSchemaVersionMajor: 1
GlueSchemaVersionMinor: 3

</verbatim>

---+++ Verifying that MPI attributes are being advertised to !ReSS
Once you configure your site to advertise MPI advertise, restart tomcat. It should take around 10 minutes (based on the CEMon configuration) for CEMon to start publishing latest information to !ReSS at osg-ress-1.fnal.gov

Run following condor_status command to verify that the MPI information is published correctly.

<verbatim>
condor_status -pool osg-ress-1.fnal.gov -constraint 'GlueSiteName == "Purdue-Steele"' \
                                                                -format 'GlueSiteName=%s\n' GlueSiteName \
                                                                -format 'GlueSoftwareLocalID=%s\n' GlueSoftwareLocalID \
                                                                -format 'GlueSoftwareName=%s\n' GlueSoftwareName \
                                                                -format 'GlueSoftwareVersion=%s\n' GlueSoftwareVersion \
                                                                -format 'GlueSoftwareInstalledRoot=%s\n' GlueSoftwareInstalledRoot \
                                                                -format 'GlueSoftwareEnvironmentSetup=%s\n' GlueSoftwareEnvironmentSetup \
                                                                -format 'GlueSoftwareModuleName=%s\n' GlueSoftwareModuleName \
                                                                -format 'GlueSoftwareDataParams=%s\n\n' GlueSoftwareDataParams
</verbatim>

The output from running above command should look like

<verbatim>
GlueSiteName=Purdue-Steele                                                                                                                                                          
GlueSoftwareLocalID=IntelCompilers_9,MPICH_1.2.7p1_intel,MPICH_1.2.7p1_gcc,MPICH_1.2.7p1_pgi,MPICH2_1.0.7_intel,MPICH2_1.0.7_gcc,MPICH2_1.0.7_pgi,MPICH2_1.0.7_nemesis_intel,MPICH2_1.0.7_nemesis_pgi                                                                                                                                                                   
GlueSoftwareName=IntelCompilers,MPICH,MPICH,MPICH,MPICH2,MPICH2,MPICH2,MPICH2,MPICH2                                                                                                
GlueSoftwareVersion=9,1.2.7.p1_intel,1.2.7p1_gcc,1.2.7p1_pgi,1.0.7_intel,1.0.7_gcc,1.0.7_pgi,1.0.7_nemesis_intel,1.0.7_nemesis_pgi                                                  
GlueSoftwareInstalledRoot=/opt/intel,/apps/steele/mpich-1.2.7p1/64/p4-intel-10.1.015,/apps/steele/mpich-1.2.7p1/64/p4-gcc-4.3.0,/apps/steele/mpich-1.2.7p1/64/p4-pgi-7.1-6,/apps/steele/mpich2-1.0.7/64/ssm-intel-10.1.015,/apps/steele/mpich2-1.0.7/64/ssm-gcc-4.3.0,/apps/steele/mpich2-1.0.7/64/ssm-pgi-7.1-6,/apps/steele/mpich2-1.0.7/64/nemesis-intel-10.1.015,/apps/steele/mpich2-1.0.7/64/nemesis-pgi-7.1-6                                                                                                                                         
GlueSoftwareEnvironmentSetup=module load intel/9.1.049,module load mpich-intel,module load mpich-gcc                                                                                
GlueSoftwareModuleName=intel/9.1.049,mpich-intel,mpich-gcc,mpich-pgi,mpich2-intel,mpich2-gcc,mpich2-pgi,mpich2-nemesis-intel,mpich2-nemesis-pgi                                     
GlueSoftwareDataParams=,,,,,,,,                                                                                                                                                     

GlueSiteName=Purdue-Steele
GlueSoftwareLocalID=IntelCompilers_9,MPICH_1.2.7p1_intel,MPICH_1.2.7p1_gcc,MPICH_1.2.7p1_pgi,MPICH2_1.0.7_intel,MPICH2_1.0.7_gcc,MPICH2_1.0.7_pgi,MPICH2_1.0.7_nemesis_intel,MPICH2_1.0.7_nemesis_pgi                                                                                                                                                                   
GlueSoftwareName=IntelCompilers,MPICH,MPICH,MPICH,MPICH2,MPICH2,MPICH2,MPICH2,MPICH2                                                                                                
GlueSoftwareVersion=9,1.2.7.p1_intel,1.2.7p1_gcc,1.2.7p1_pgi,1.0.7_intel,1.0.7_gcc,1.0.7_pgi,1.0.7_nemesis_intel,1.0.7_nemesis_pgi                                                  
GlueSoftwareInstalledRoot=/opt/intel,/apps/steele/mpich-1.2.7p1/64/p4-intel-10.1.015,/apps/steele/mpich-1.2.7p1/64/p4-gcc-4.3.0,/apps/steele/mpich-1.2.7p1/64/p4-pgi-7.1-6,/apps/steele/mpich2-1.0.7/64/ssm-intel-10.1.015,/apps/steele/mpich2-1.0.7/64/ssm-gcc-4.3.0,/apps/steele/mpich2-1.0.7/64/ssm-pgi-7.1-6,/apps/steele/mpich2-1.0.7/64/nemesis-intel-10.1.015,/apps/steele/mpich2-1.0.7/64/nemesis-pgi-7.1-6                                                                                                                                         
GlueSoftwareEnvironmentSetup=module load intel/9.1.049,module load mpich-intel,module load mpich-gcc                                                                                
GlueSoftwareModuleName=intel/9.1.049,mpich-intel,mpich-gcc,mpich-pgi,mpich2-intel,mpich2-gcc,mpich2-pgi,mpich2-nemesis-intel,mpich2-nemesis-pgi                                     
GlueSoftwareDataParams=,,,,,,,,                                                                                                                                                     

GlueSiteName=Purdue-Steele
GlueSoftwareLocalID=IntelCompilers_9,MPICH_1.2.7p1_intel,MPICH_1.2.7p1_gcc,MPICH_1.2.7p1_pgi,MPICH2_1.0.7_intel,MPICH2_1.0.7_gcc,MPICH2_1.0.7_pgi,MPICH2_1.0.7_nemesis_intel,MPICH2_1.0.7_nemesis_pgi                                                                                                                                                                   
GlueSoftwareName=IntelCompilers,MPICH,MPICH,MPICH,MPICH2,MPICH2,MPICH2,MPICH2,MPICH2                                                                                                
GlueSoftwareVersion=9,1.2.7.p1_intel,1.2.7p1_gcc,1.2.7p1_pgi,1.0.7_intel,1.0.7_gcc,1.0.7_pgi,1.0.7_nemesis_intel,1.0.7_nemesis_pgi                                                  
GlueSoftwareInstalledRoot=/opt/intel,/apps/steele/mpich-1.2.7p1/64/p4-intel-10.1.015,/apps/steele/mpich-1.2.7p1/64/p4-gcc-4.3.0,/apps/steele/mpich-1.2.7p1/64/p4-pgi-7.1-6,/apps/steele/mpich2-1.0.7/64/ssm-intel-10.1.015,/apps/steele/mpich2-1.0.7/64/ssm-gcc-4.3.0,/apps/steele/mpich2-1.0.7/64/ssm-pgi-7.1-6,/apps/steele/mpich2-1.0.7/64/nemesis-intel-10.1.015,/apps/steele/mpich2-1.0.7/64/nemesis-pgi-7.1-6                                                                                                                                         
GlueSoftwareEnvironmentSetup=module load intel/9.1.049,module load mpich-intel,module load mpich-gcc                                                                                
GlueSoftwareModuleName=intel/9.1.049,mpich-intel,mpich-gcc,mpich-pgi,mpich2-intel,mpich2-gcc,mpich2-pgi,mpich2-nemesis-intel,mpich2-nemesis-pgi                                     
GlueSoftwareDataParams=,,,,,,,,                                                                                                                                                     

[. . .]
</verbatim>
---++ Known issues
   * Configuration of MPI attributes is not done automatically and the admins need to manually add/modify information in the GIP's add-attributes.conf file

---++ More information


%STOPINCLUDE%
%BR%
%COMPLETE1% %BR%
%RESPONSIBLE% Main.ParagMhashilkar - 03 Dec 2008 %BR%
%REVIEW%
