%META:TOPICINFO{author="JenyTeheran" date="1462999444" format="1.1" version="1.1"}%
%META:TOPICPARENT{name="IncidentInformation2016"}%
%TOC%
---+ OSG-SEC-2016-05-09

Received report of a potential security issue in HDFS installations at US CMS T2 sites. Report received from WLCG Security Officer, Romain Wartel on May 9th, 2016. 
CERN was contacted over the week-end by a third party, regarding a number of exposed CMS Hadoop instances.

After an initial check done by Brian Bockelman, it was found that three T2 sites were exposed and one of them had unknown status.

   * T2_US_MIT: HDFS exposed at default non-secure mode
   * T2_US_Purdue: HDFS exposed at default non-secure mode
   * T2_US_Wisconsin: HDFS exposed at default non-secure mode
   * T2_US_Caltech: unknown status

---++ Status

<!--
Suggested status labels:
NEW: Initial report is received but incident is not confirmed.  This is a triage phase.
OPEN: The existence of a security incident requiring response has been confirmed. The response is underway.
RESOLVED: The incident has been resolved but the final report has not been submitted.
CLOSED: The final report has been submitted.
--> 

   * *Status*: Resolved
   * *Lead*: Jeny Teheran
   * *Responders*: Jeny Teheran
   * *References*: [[https://ticket.opensciencegrid.org/29764][https://ticket.opensciencegrid.org/29764]]

US CMS T3 sites were contacted to check their HDFS installations. 

---++ Analysis

   * *Severity*: High  
   * *Urgency*: Immediate 

Possibly, due to a weak password, an intruder obtained the root password, and got access to some nodes. The intruder implanted a SSH backdoor and record multiple SSH passwords. All the possible affected accounts are blocked. Also, the intruder installed a software package for digital currency mining. Due to this attack, some CPU power was lost, but there was not impact on grid resources since the machines were not in the same network with grid nodes.

---++ Mitigation Plan
   * T2_US_MIT -Administrator: Maxim Goncharov-: Off-site access has been removed. Tried accessing the URL given at the proof-of-concept, not accesible anymore.
   * T2_US_Purdue -Administrator: Manoj Kumar-: Confirmed that off-site access has been removed. 
   * T2_US_Wisconsin -Administrator: Ajit Kumar and Dan Bradley-: Confirmed that off-site access was removed. Tried accessing the URL given at the proof-of-concept, not accesible anymore.
   * T2_US_Caltech -Administrator: Wayne Hendricks-: Caltech had an Unknown status at Brian's initial assessment. The admin confirmed that their Hadoop hosts have only local non-routable IPs.  The only way to access files in Hadoop from outside our internal VLAN is through Gridftp or xRootd. Caltech were configured correctly.

---+++ Actions to take

---+++ How to monitor progress

---+++ Acceptable response time estimate

---+++ List of affected parties

---+++ Definition of End Of Event

---++ Incident Log

   * See the GOC ticket: [[https://ticket.opensciencegrid.org/29764][https://ticket.opensciencegrid.org/29764]]

<!--
Incident information accessible by Security Team members and GOC only:
   * Set ALLOWTOPICVIEW = Main.SecurityTeamGroup, Main.GocGroup
   * Set ALLOWTOPICCHANGE = Main.SecurityTeamGroup, Main.GocGroup
-->

-- Main.JenyTeheran - 11 May 2016