%META:TOPICINFO{author="AashishSharma" date="1228419286" format="1.1" reprev="1.1" version="1.1"}%
%META:TOPICPARENT{name="IncidentInformation2008"}%
<pre>
Email Announcement from DFN-CERT

** PLEASE DO NOT REDISTRIBUTE **  CERNCERT-20080805                                                           
                                                                                                              
** This message is sent to the CSIRTs of affected grid infrastructures and                                    
sites and must NOT be publicly archived **                                                                    
                                                                                                              
Dear CSIRTs,                                                                                                  
                                                                                                              
The information below was kindly provided by the DFN CERT (NREN in                                            
Germany), the SWITCH CERT (NREN in Switzerland), the EGEE Operational                                         
Security Coordination Team, the OSG security team, CfA Harvard, ISI                                           
University of South California, CERN security team and several CSIRTs                                         
from various sites.                                                                                           
                                                                                                              
*******************************************************                                                       
* What's new since the last update                            *                                               
*******************************************************                                                       
                                                                                                              
- Further attacks discovered                                                                                  
- New suspicious IP addresses                                                                                 
- Updated rootkit                                                                                             
- Updated tools                                                                                               
                                                                                                              
******************************                                                                                
* Further attacks discovered *                                                                                
******************************                                                                                
                                                                                                              
* ETH (Switzerland) affected (September)                                                                      
                                                                                                              
Several accounts have been compromised at ETH, and connections from a                                         
known malicious IP addresses have been detected between 2008-08-31                                            
23:49:54 - 2008-09-15 13:04:57 (UTC+2).                                                                       
                                                                                                              
* Another peer grid site attacked              
A partner grid site is reporting malicious connections on 2008/11/30 from:                                    
                                                                                                              
209.160.40.14   - m81.nearbygalaxies.org                                                                      
209.181.189.198 - ASN-QWEST - Qwest Communications Corporation                                                
                                                                                                              
* Malicious connections against NCSA                                                                          
                                                                                                              
NCSA reported successful connections from the IP addresses above.                                             
Investigations revealed a root compromised host running a new version (2.2c) of                               
the rootkit, which had been installed on 21st September.                                                      
                                                                                                              
* Malicious connections against CERN                                                                          
                                                                                                              
Based also on the information above, CERN has noticed malicious connections                                   
from a known malicious IP address on 2008-12-02 to one CERN account.                                          
However there is no evidence the attacker gained root access on the targeted                                  
host at CERN.                                                                                                 
                                                                                                              
************************************************                                                              
* New suspicious IP addresses as of 2008-12-04 *                                                              
************************************************                                                              
                                                                                                              
It is believed the attacker logged in from:                                                                   
                                                                                                              
- 64.72.120.48                                                                                                
- 137.248.152.49  [ pc15854.Chemie.Uni-Marburg.DE ]                                                           
- 132.239.95.85    [ npc.ucsd.edu ]                                                                           
- 69.49.172.31                                                                                                
- 207.224.103.198                                                                                             
- 69.129.17.24                                                                                                
- 209.160.40.14                                                                                               
- 209.181.189.198                                                                                             
- 189.6.137.174                                                                                               
- 190.81.35.90                                                                                                
- 202.51.211.2                                                                                                
- 131.142.42.17 (?)                                                                                           
                                                                                                              
The known list of suspicious IP addresses is now:                                                             
                                                                                                              
- 83.134.152.127                                                                                              
- 69.130.104.157                                                                                              
- 69.130.136.116                                                                                              
- 69.130.130.117                                                                                              
- 69.130.104.49                                                                                               
- 69.130.104.157 - h69-130-104-157.lkvlms.dsl.dynamic.tds.net                                                 
- 69.130.182.213 - h69-130-182-213.cytnin.dsl.dynamic.tds.net                                                 
- 69.130.80.36   - h69-130-80-36.kgldga.dsl.dynamic.tds.net                                                   
- 64.27.17.70    - vpn2.pcwerk.com                                                                            
- 208.35.255.106                                                   
- 208.35.255.106                                                                                              
- 66.230.230.230                                                                                              
- 209.181.122.222                                                                                             
- 207.225.248.150                                                                                             
- 207.206.202.54                                                                                              
- 207.206.215.122                                                                                             
- 207.224.215.94                                                                                              
- 209.181.138.229                                                                                             
- 209.181.131.209                                                                                             
- 209.181.242.70                                                                                              
- 208.42.23.94   - v-208-42-23-94.mn.visi.com                                                                 
- 99.236.185.205                                                                                              
- 99.237.220.123                                                                                              
- 208.42.23.94                                                                                                
- 216.184.13.238                                                                                              
- 216.186.49.132                                                                                              
- 75.60.89.233                                                                                                
- 136.159.55.31                                                                                               
                                                                                                              
Note that there are now several IP addresses in the 69.130 network                                            
block. Any connection from this location should be treated as suspicious                                      
and reported.                                                                                                 
                                                                                                              
* Update rootkit *                                                                                            
                                                                                                              
It is believed the attacker is now using a new version "2.2c" of the Phalanx2                                 
rootkit.                                                                                                      
It hides in different locations (ex: /usr/lib/heahu.p2/, /usr/lib/huuuh.p2,                                   
etc.).                                                                                                        
                                                                                                              
While the attacker has mostly been concentrated on SSH keys, it seems now that                                
standard passwords are being sniffed and reused.                                                              
                                                                                                              
At least the 64bit version of the 2.2c backdoor does not support                                              
some characters and should segfault using this command:                                                       
                                                                                                              
(echo SSH-2.0-OpenSSH_3.8.1p1; sleep 1; echo 'pHALANX2!                                                       
'kill_phalanx2'+++++++++++++++'| cut -c 1-31; sleep 1; echo                                                   
'test'; cat)|nc  22                                                               
                                                                                                              
( is the hostname that is checked for signs of the                                
rootkit)                                                                                                      
                                                                                                              
The resulting syslog message on  would look like:                                 
  kernel: : segfault                               
at                                                                                                            
0000000000000000 rip 0000000000418900 rsp 0000007fbfff8698 error 4                                            
                                                                                                              
Once the host has been probed, the existence of such a syslog message is a very                               
strong indication it has been infected by the rootkit.                          
                                                                                                              
*************************************************                                                             
* Suspicious SSH key and rootkit detecting tool *                                                             
*************************************************                                                             
                                                                                                              
It is possible to use suspicious SSH keys and rootkit detecting tool                                          
provided by the community. The tools on the page below are kindly                                             
provided by their authors and do not come with any guarantee whatsoever,                                      
use it at your own risk!                                                                                      
                                                                                                              
https://cern.ch/osct/7e0564aeabe51c2b1c69570c8d931bf2                                                         
                                                                                                              
Please report any suspicious activity to enable other sites to search                                         
for the patterns you may have detected. This is essential to prevent the                                      
attack from spreading further in the community.                                                               
                                                                                                              
Regards,                                                                                                      
                                                                                                              
Romain Wartel on behalf of the EGEE Operational Security Coordination Team.                                   
--                                                                                                            
Romain Wartel                           Romain.Wartel@cern.ch                                                 
EGEE Operational Security Coordination Team                                                                   
C.E.R.N. http://www.cern.ch/LCG                                                                               
Information Technology Division http://www.eu-egee.org/security                                               
Bat.28-1-012 http://cern.ch/security                                                                          
CH-1211 Geneva 23, Switzerland   

</pre>



-- Main.AashishSharma - 04 Dec 2008

---++ Access Control

_Uncomment the appropriate access control policy for this incident page. Logout of the twiki and try to access the page to ensure it is not publicly accessible. Do not attach files, as they will not be protected (see  [[http://twiki.org/cgi-bin/view/TWiki/TWikiAccessControl#Controlling_access_to_Attachment][http://twiki.org/cgi-bin/view/TWiki/TWikiAccessControl#Controlling_access_to_Attachment]])._

Incident information accessible by Security Team members and GOC only:
   * #Set ALLOWTOPICVIEW = Main.SecurityTeamGroup, Main.GocGroup
   * #Set ALLOWTOPICCHANGE = Main.SecurityTeamGroup, Main.GocGroup

Incident information accessible by all authenticated twiki users:
   * Set ALLOWTOPICVIEW = Main.GridGroup
   * Set ALLOWTOPICCHANGE = Main.GridGroup

-- Main.AashishSharma - 04 Dec 2008
