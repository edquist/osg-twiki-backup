%META:TOPICINFO{author="VonWelch" date="1359570733" format="1.1" reprev="1.3" version="1.3"}%
---++ Introduction

This document describes OSG PKI plans for certificate renewal, that is a user obtain a new certificate for the same DN and key pair, but with a refreshed expiration date.

It is current a draft and comments to vwelch@indiana.edu are welcome.

---++ Supported Modes of Renewal

User certificate renewal:
   * Users may request renewal of their own user certificate via either a new CLI script or the web (OIM).
      * RAs may not request renewal of a user's certificate.

Host certificate renewal:
   * Users may request renewal a host/service certificate they originally requested via either a new CLI script or the web (OIM)
      * A Grid Admin may also request renewal of any host/service certificate they are authorized to approve.

Explictly not supported:
   * Bulk host certificate renewal is not supported.
      * Based on feedback that it's just as easy or easier for a Grid Admin do a bulk request.

---++ Certificate Lifecycle

   * 0-6 months: Certificate cannot be renewed.
      * To prevent multiple accidential renewals.
   * 7-12 months: Certificate can be renewed.
   * 12-13 months: Weekly notifications are sent to certificate owner reminding them of renewal.
   * 13 months: Certificate expires, cannot be renewed.

Note that, by policy, user vetting is required every 5 years and renewal is only possible if user has been vetting in past 5 years.

---++ Decisions

 
   * User must have valid certificate and be registered with OIM.
      * No guest/un-authenticated renewal.
   * If renewal cannot be accomplished for any reason, the user must re-request and be vetted.
   * Renewal can only be done if the vetting is less than 5-years old.
      * Enforcing this is a future task; we expect to learn much and much to change by then.
   * On renewal, an email is sent to the user and relevant RAs/GAs notifying them of the renewal and asking them to contact the GOC if the renewal is unauthorized.
      * Required by policy.
      * An example of an unauthorized renewal would be a user who has left a VO.
   * We will re-use the CSR from the original request.
      * Makes it very easy for the web interface.

---++ Development Priorities

Top priorities are the:
   * Web interface for user certificate renewal
   * CLI for host certificate renewal

Secondary priorities are the:
   * CLI for user certificate renewal
   * Web interface for host certificate renewal

That said, we don't expect a big difference in availability and support for all four cases will probably emerge at the same time.

---++ OIM API Overview

A separate OIM method will exist for both host and user certificate renewal (even though they currently have the same signature).

The basic signature of the methods is:
   * Inputs: DN and serial number of certificate to be renewed
      * It is expected that the DN will be ignored today, but we send it in case it's useful for debugging.
   * Output: Certificate in PKCS7


---++ Relevant Policies

Policy with regards to renewal follows. In short, a certificate can be automatically renewed if not expired, nothing has changed, it hasn't been compromised and it has been less than 5 years since manual RA vetting.

Note the last bit, we should send email to the user on renewal.

Relevant portions of Section 4.6 of the [[https://twiki.grid.iu.edu/twiki/pub/Operations/OSGPKIAgreements/OSG_RPS.pdf][RPS]]:

The OSG Operator may renew a certificate if:

   1.    the associated public key has not reached the end of its validity period,
   2.    the Subscriber name and attributes are unchanged,
   3.    the associated private key remains un compromised, and
   4.    re-verification of the Subscriber’s identity is not required under Section 3.3.1.

Section 3.3.1 says: "OSG certificates have a validity period of 13 months. OSG may rekey/renew certificates prior to their expiration date for additional 13 month periods up to a maximum of five years. OSG or a Trusted Agent revalidates the certificate information at least once every five years."

No additional verification is required if the certificate subject information has not changed and less than five years have passed since the certificate’s information was verified. A Trusted Agent must represent that the renewal request is authorized.

The OSG Operator shall use contact information provided by the Subscriber to notify the Subscriber of the certificate’s issuance.

---++ Relevant JIRAs

   * https://jira.opensciencegrid.org/browse/OSGPKI-202
   * https://jira.opensciencegrid.org/browse/OSGPKI-242
   * https://jira.opensciencegrid.org/browse/OSGPKI-307


-- Main.VonWelch - 29 Jan 2013
