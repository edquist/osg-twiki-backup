%META:TOPICINFO{author="KyleGross" date="1329928466" format="1.1" version="1.6"}%
%META:TOPICPARENT{name="WebHome"}%
%DOC_STATUS_TABLE%

%TOC%

---++ DOEGrids Email Notification

From Mike - 8/16/07:

We've created 2 kinds of certificate confirmation notice messages now.
That's fine, but the notices in effect have 2 functions:

(1) Somebody, presumably you, accomplished the following at the CA'<br>
[RECEIPT]

(2) Here's what you do now<br>
[WORKFLOW]

The mission of this project was to fix #2, but it also changed #1.
But this is not good - we at DOEGrids need to give everybody the same receipt,
so that everybody has adequate information to resolve problems.

The current web-based receipt looks like this:
<verbatim>
	template certIssued_CA_PEOPLE
	
	Your Personal certificate request has been processed successfully.
	SubjectDN= $SubjectDN
	IssuerDN= $IssuerDN
	notAfter= $NotAfter
	notBefore= $NotBefore
	Serial Number= 0x$HexSerialNumber
</verbatim>
	
The script based receipt looks like this:

<verbatim>
	template certIssued_CA_PEOPLE_SCRIPT
	Your certificate requested using the script interface, request id: $RequestId,
</verbatim>

(Approx same for host/service certs - not going to discuss)

Following the receipt text, is the context driven response (browser, script).

The goal of the receipt is to give both the subscriber and DOEGrids operations
a common basis for resolving any problems that might occur (eg subscriber reports I didn't request
this certificate; it doesn't work;  I don't know what this means &c; and DOEGrids operations
when it needs to track down a particular certificate to resolve a problem).

I think the essential information that needs to be in all receipts is

<verbatim>
	SubjectDN= $SubjectDN
	Serial Number= 0x$HexSerialNum
AND
	https://pki1.doegrids.org:$HttpPort/displayBySerial?op=displayBySerial&serialNumber=$SerialNumber
</verbatim>

These validity date attributes _might_ be useful to customers 
notAfter= $NotAfter
notBefore= $NotBefore
and seem like a normal part of a receipt to me.
IssuerDN is not needed.

We need the URL here because it is not useful or interesting to provide every part
of the certificate for the subscriber to examine in the receipt.  But they 
should have an easy way to check their certificate for errors &c.

So, the receipts should say something like this:
<verbatim>
	Your Personal certificate request has been processed successfully.
	SubjectDN= $SubjectDN
	Serial Number= 0x$HexSerialNum
        [Validity dates]
	Complete details can be found here:
	https://pki1.doegrids.org:$HttpPort/displayBySerial?op=displayBySerial&serialNumber=$SerialNumber
        [mail reply to address - currently the From: address]
</verbatim>

The context dependent action or workflow section then follows as appropriate.

---++ Example notices to subscribers, OU=People
In the examples below, the ones for "on approval after submission" are
already in production on pki1.doegrids.org.
The examples for expiration notices are suggestions but not yet in production
as of 11-Oct-2007.

Note to Dhiva - I may have misspelled some of the variable names
in the templates below so don't just copy them blindly. :)

---+++ On request via browser
No notification.
---+++ On request via script
No notification.
---+++ On approval after browser submission
<verbatim>
From: DOEGrids-CA-1@doegrids.org
Subject: DOEGrids CA Certificate Request
Your Personal certificate request has been processed successfully.
SubjectDN= $SubjectDN
IssuerDN= $IssuerDN
notAfter= $NotAfter
notBefore= $NotBefore
Serial Number= 0x$HexSerialNumber

To get your certificate, please follow this URL:
https://$HttpHost:$HttpPort/displayBySerial?op=displayBySerial&serialNumber=$SerialNumber
And then click the 'Import your certificate' button at the bottom of this page.
[Note: Some browsers import successfully without indicating this to you.]

Attention:
You need to be running-
the same browser,
on the same machine,
logged in as the same user,
as you were when you made the certificate request. 

After importing your certificate, export your certificate and the private key for Grid use.
Kindly follow the instructions on http://www.doegrids.org/pages/cert-request.html#Globus

Please contact your RA if there is any problem.
</verbatim>

---+++ On approval after script submission
<verbatim>
From: DOEGrids-CA-1@doegrids.org
Subject: DOEGrids CA Certificate Request
Your Personal certificate request has been processed successfully.
SubjectDN= $SubjectDN
IssuerDN= $IssuerDN
notAfter= $NotAfter
notBefore= $NotBefore
Serial Number= 0x$HexSerialNumber
 
Complete details can be found here:
https://$HttpHost:$HttpPort/displayBySerial?op=displayBySerial&serialNumber=$SerialNumber

Your certificate requested using the script interface, request id: $RequestID,
has been approved and is available for download.  To retrieve your
certificate, execute the command below using the same working
directory from which the request was made.

# cert-retrieve -serialnum $SerialNumber

If you requested the certificate with optional parameters specifying
labelling or a non-standard directory for storing your certificate
see the cert-retrieve and cert-request man pages for additional
explanation.
# cert-retrieve -help
# cert-request -help
</verbatim>

---+++ On expiration of script requested cert
<verbatim>
The following certificate is going to expire  on
  $NotAfter
Serial number = 0x$HexSerialNumber
SubjectDN = $SubjectDN

You will continue receiving these notices until expiration.

To renew it, execute the command below on the same
computer from which your current certificate is located.

# cert-renew

If you requested the certificate with optional parameters specifying
a non-standard prefix or directory for storing your certificate see
the cert-renew man page for additional explanation.
# cert-renew -help

For information on renewal notices please see:
http://www.doegrids.org/pages/faq/faq.html#RenewalNotices

</verbatim>


---+++ On expiration of browser requested cert
<verbatim>
The following certificate is going to expire on
  $NotAfter
Serial number = 0x$HexSerialNumber
SubjectDN = $SubjectDN

You will continue receiving these notices until expiration.

To renew it, select "Replacement Certificate" under "Subscriber Enrollment" here:
https://$HttpHost:$HttpPort
or request a NEW certificate.

For information on renewal notices please see:
http://www.doegrids.org/pages/faq/faq.html#RenewalNotices

$Revision: 1.6 $ $Date: 2012/02/22 16:34:26 $
</verbatim>

-- Main.DougOlson - 08 Aug 2007

<!-- CONTENT MANAGEMENT PROJECT

   DEAR DOCUMENT OWNER
   ===================

   Thank you for claiming ownership for this document! Please fill in your FirstLast name here:
   * Local OWNER          = JamesBarlow

   Please define the document area, choose one of the defined areas from the next line
   DOC_AREA = (ComputeElement|Storage|VO|Security|User|Monitoring|General|Integration|Operations|Tier3)
   * Local DOC_AREA       = Security

   define the primary role the document serves, choose one of the defined roles from the next line
   DOC_ROLE = (Scientist|Student|Developer|SysAdmin|VOManager)
   * Local DOC_ROLE       = SysAdmin

   Please define the document type, choose one of the defined types from the next line
   DOC_TYPE = (Troubleshooting|Training|Installation|HowTo|Planning|Navigation|Knowledge)
   * Local DOC_TYPE       = Knowledge
   
   Please define if this document in general needs to be reviewed before release ( %YES% | %NO% )
   * Local INCLUDE_REVIEW = %YES%

   Please define if this document in general needs to be tested before release ( %YES% | %NO% )
   * Local INCLUDE_TEST   = %NO%

   change to %YES% once the document is ready to be reviewed and back to %NO% if that is not the case
   * Local REVIEW_READY   = %YES%

   change to %YES% once the document is ready to be tested and back to %NO% if that is not the case
   * Local TEST_READY     = %NO%

   change to %YES% only if the document has passed the review and the test (if applicable) and is ready for release
   * Local RELEASE_READY  = %NO%


   DEAR DOCUMENT REVIEWER
   ======================

   Thank for reviewing this document! Please fill in your FirstLast name here:
   * Local REVIEWER       = MineAltunay
  
   Please define the review status for this document to be in progress ( %IN_PROGRESS% ), failed ( %NO% ) or passed ( %YES% )
   * Local REVIEW_PASSED  = %NO%


   DEAR DOCUMENT TESTER
   ====================

   Thank for testing this document! Please fill in your FirstLast name here:
   * Local TESTER         = 
  
   Please define the test status for this document to be in progress ( %IN_PROGRESS% ), failed ( %NO% ) or passed ( %YES% )
   * Local TEST_PASSED    = %IN_PROGRESS%
 
-->