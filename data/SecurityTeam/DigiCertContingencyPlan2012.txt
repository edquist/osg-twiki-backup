%META:TOPICINFO{author="JenyTeheran" date="1448482611" format="1.1" version="1.4"}%
%META:TOPICPARENT{name="IdMContingencyPlanning"}%
%RED%
*OSG Restricted Information*

Information on this web page is restricted to authorized individuals only.  It should not be copied or distributed without
the express consent of the OSG Security Team and only to individuals, and while retaining this information protection notice.
%ENDCOLOR%

---+!! Information System Contingency Plan (ISCP): !DigiCert CA Service

%BLUE% DRAFT 1, 6 January 2012 %ENDCOLOR%

---++!! Contents
%TOC%

---++ Forward

This document is developed following the guidance and templates in [[http://csrc.nist.gov/publications/nistpubs/800-34-rev1/sp800-34-rev1_errata-Nov11-2010.pdf][NIST SP-800-34]],
"Contingency Planning Guide for Information Technology Systems",
and the contingency planning material developed at
Security.IdMContingencyPlanning.
It is derived from the 2009 [[IdmContingencyPlan09][DOEGrids CA Contingency Plan]].

---++ Introduction

---+++ Background
This !DigiCert CA Service Relying Party and Registration Authority Contingency Plan ( *RPRACP* ) establishes procedures to mitigate the impact
to OSG operations following a disruption of !DigiCert CA services.  The !DigiCert CA is an important part of the
larger Public Key Infrastructure (PKI) essential to OSG.  The PKI includes many IGTF accredited CAs
as well as the means of distribution of the trust anchors (CA signing certificates and related files).
Because the CA services are operated by !DigiCert this document has elements of both a contingency plan and
a continuity of operations plan since its purpose is primarily to describe how OSG will continue its PKI related
activities while service is restored to the !DigiCert CA.
The following objectives have been established for this plan:
   * Maximize the effectiveness of contingency operations through an established plan that consists of the following phases:
      * *Notification/Activation* phase to detect and assess damage and to activate the plan
      * *Recovery* phase to restore partial PKI operations and perform actions to mitigate the impact while normal operations of the !DigiCert CA is restored by !DigiCert.
      * *Reconstitution* phase to restore OSG Relying Party and Registration Authority to normal operations following re-establishment of !DigiCert CA operations by !DigiCert.
   * Identify the activities, resources, and procedures needed to carry out Relying Party and Registration Authority processing requirements during prolonged interruptions to normal operations.
   * Assign responsibilities to designated OSG personnel and provide guidance for recovering OSG Relying Party and Registration Authority during prolonged periods of interruption to normal operations.
   * Ensure coordination with other OSG and !DigiCert staff who will participate in the contingency planning strategies. Ensure coordination with external points of contact and PKI participants who will participate in the contingency planning strategies.

---+++ Scope
This OSG Relying Party and Registration Authority Contingency Plan applies to the effects on OSG of outages and service failures of the
!DigiCert Certification Authority ([[http://www.digicert-grid.com/][www.digicert-grid.com]]) and the [[http://www.opensciencegrid.org/ra/][OSG Registration Authority]].

This document describes what actions OSG should take in the event of a disruption to !DigiCert CA services.
It also describes what additional preparations OSG can make in order to mitigate the impact of such a future occurrence.

Various scenarios were considered that generally fall into two categories.
   1. Events that cause a functional outage of the service.
      * For these cases the response depends upon the length of the outage.  These are identified as
         * *Case 1* - CA service outage for < 1 week
         * *Case 2* - CA service outage for > 1 week and < 4 weeks
         * *Case 3* - CA service outage for > 4 weeks
   2. Events that corrupt the service or PKI leading to a need to replace certificates for the CA and/or End Entities.
      * For these cases the response depends on the nature of the corruption. The general cases are identified as
         * *Case 4* - some occurrence requires all (or very many) EE certificates to be replaced but the CA certificate is still trusted.
         * *Case 5* - entire PKI is compromised and all EE certificates and the CA certificate must be replaced.
         * *Case 6* - end of service of CA and/or organization running it

---+++ Assumptions

For *Cases 1, 2, 4, 5*, !DigiCert staff are able to reconstitute the CA service within one month.

For *Cases 3 and 6*, !DigiCert staff are not able to reconstitute the CA service within one month.

---+++ References / Requirements
This contingency plan is modeled after the [[http://csrc.nist.gov/publications/nistpubs/800-34/sp800-34.pdf][NIST SP-800-34]] document.

Planning material is at Security.IdMContingencyPlanning.

---++ Concept of Operations

---+++ System Description and Architecture

The !DigiCert Certification Authority is operated by [[http://www.digicert.com/][DigiCert]] under contract with OSG (Indiana University).
It supports the issuance and revocation of X509 certificates.
Additional information is available at [[http://www.digicert-grid.com/][www.digicert-grid.com]].

---+++ Line of Succession

The line of succession described here is to ensure that the decision-making
authority for this contingency plan is uninterrupted.
The OSG Security Officer is primarily responsible for the execution of this contingency plan.
In the event that the Security Officer is unavailable the OSG Deputy Security Officer will
be responsible for execution of this plan. If both those are unavailable then the OSG
Executive Director will appoint another person to execute this plan.
At any point in time, the person responsible for executing this plan is called the
_Contingency Plan Coordinator_.

---+++ Responsibilities

The OSG Security Team is responsible for carrying out the actions of this contingency plan.

---++ Activation and Notification

The OSG Security Team led by the Security Officer characterizes the nature of the occurrence that prompts activation of this contingency plan.

If the occurrence requires notifying all OSG sites and VOs the activation of this plan
is done by authority of the OSG Executive Director (ED).  In absence of the ED the plan
can be activated by the OSG Security Officer.  This applies to *Cases 2, 3, 4, 5, 6*.

If the occurrence does not require notifying the majority of the OSG sites and VOs
the plan can be activated by the OSG Security Officer.  In the absence of the
Security Officer the plan can be activated by the OSG Deputy Security Officer or
by the OSG ED.  This applies to *Case 1*.

Activation of the contingency plan will include the characterization of the occurrence, the
identification of the _Contingency Plan Coordinator_ and the _Contingency Response Team_ members.
All notifications following the activation of the plan originate with the _Contingency Plan Coordinator_.

The activation of the contingency plan requires notification to the OSG Executive Team (osg-et@opensciencegrid.org)
and the OSG Security Team (osg-security-team@opensciencegrid.org).
In the event that email services are not available notification will happen using contact information
from the OSG Information Management system (oim.grid.iu.edu).

The _Contingency Plan Coordinator_ will nofity !DigiCert staff that this contingency plan has been activated
and determine who from !DigiCert should participate on the _Contingency Response Team_.

The _Contingency Plan Coordinator_ will create a web page on the OSG Twiki with appropriate
access controls that the _Contingency Response Team_ will use to post information about the occurrence
and the status of the plan execution, recovery of the CA service, and return to normal operations.

---++ Recovery
This section describes the actions to perform before CA services are restored.
Depending upon the nature of the event disrupting the CA service the characterization
may escalate (or de-escalate) between *Cases 1,2,3*.

---+++ Case 1 - CA service outage for < 1 week

   * Recovery Goal - preserve last good certificate and CRL information
   * Recovery Goal - inform subscribers of alternative CA options as needed
   * Recovery Goal - transition certificate revocation to user banning

---+++ Case 2 - CA service outage for > 1 week and < 4 weeks

In addition to recovery goals for Case 1:
   * Recovery Goal - provide alternative CA services for urgent subscribers
   * Recovery Goal - disable CRL checking for !DigiCert CAs on OSG sites

---+++ Case 3 - CA service outage for > 4 weeks
In addition to recovery goals for cases 1 & 2:
   * Recovery Goal - establish replacement CA services
   * Recovery Goal - replace all !DigiCert certificates used in OSG with certificates from alternate CAs
   * Recovery Goal - Notify all VOMS administrators that everyone with !DigiCert certificates will be getting new certificates.

---+++ Case 4 - need replacement for all EE certificates

   * Recovery Goal - issue replacement EE certificates from !DigiCert CA, via a self-service and/or automated process to the extent possible

Manual vetting for certificate issuance will slow down the process, so we should try to allow certificate holders to replace their certificates using their current certificates and/or using a previously established PIN/password.

In cases where manual action is required, certificates should be issued in order of priority indicated by Gratia accounting system for most used People and Services certificates.

---+++ Case 5 - need CA and EE certificates replaced
In addition to recovery goal(s) for Case 4:
   * Recovery Goal - propagate new CA certificates quickly via the OSG CA distribution (for OSG sites) and the IGTF CA distribution (for WLCG and other peer grids)
   * Recovery Goal - inform subscribers of alternative CA options as needed

---+++ Case 6 - Service End of Life
   * Recovery Goal - provide alternative CA services for urgent subscribers
   * Recovery Goal - establish replacement CA services
   * Recovery Goal - replace all !DigiCert certificates used in OSG with certificates from alternate CAs
   * Recovery Goal - Notify all VOMS administrators that everyone with !DigiCert certificates will be getting new certificates.

---++ Reconstitution

---+++ When !DigiCert CA returns to service
   * Verify that new CRL is accurate
   * Notify anyone who was previously notified to modify normal CRL handling procedures that the CRL has returned to normal.
   * Notify any VOMS administrators for which user banning was enforced in place of certificate revocation.
   * Notify all certificate holders that were directed to alternate suppliers that !DigiCert CA is back in service.

---+++ When !DigiCert CA is EOL
   * Confirm (through site probes, Gratia queries, etc.) that !DigiCert certificates are no longer in use in OSG.
   * Remove !DigiCert CA from distribution on date specified for CA trust EOL.

---+++ Plan Deactivation
_Contingency Plan Coordinator_ shall notify the OSG Executive Team (ET) that the contingency plan
is deactivated and write a report on the occurance which will be submitted to the OSG ET.

---++ Appendices

---+++ Personnel & Vendor Contacts
Telephone numbers for OSG staff are kept in oim.grid.iu.edu.

   * OSG Security Officer and Security Team (security@opensciencegrid.org, osg-security-team@opensciencegrid.org, osg-ra@opensciencegrid.org)
   * OSG Executive Team (osg-et@opensciencegrid.org)
   * !DigiCert Support (see: [[http://www.digicert-grid.com/][www.digicert-grid.com]])
      * Support Toll Free: 1-800-896-7973 (US & Canada)
      * Support Direct: 1-801-877-2100
      * Fax Toll Free: 1-866-842-0223 (US & Canada)
      * Email: support@digicert.com
      * Scott Rea, VP GOV/EDU Relations & Sr. PKI Architect, Scott@DigiCert.com, Ph#(801) 701-9636, Ce#(801) 874-4114
      * Aaron Watson aaron.watson@digicert.com

---+++ Service Agreement between OSG and !DigiCert
See: [[http://www.digicert-grid.com/][www.digicert-grid.com]])

---+++ Service Agreement between OSG and alternate CA service providers
TBD

---+++ Business Impact Analysis

---++++ Changes for DOEGrids to DigiCert Transition

As this plan is derived from the 2009 [[IdmContingencyPlan09][DOEGrids CA Contingency Plan]], we document in this section those changes that are specific to the DOEGrids to DigiCert transition.

---+++++ Change of CRL Lifetimes

CRL "expiration" is one of the potential causes of service outages. CRL lifetimes are:
   * ESnet/DOEGrids: 1 year for root CA, 1 month for intermediate CA
   * DigiCert: 6 months for root CA, 7 days for intermediate CA
The move from 1 month to 7 days significantly shortens the reaction time required in case of a prolonged CRL outage.

---+++++ Commercial CA Provider

As a commercial CA provider, DigiCert is a more visible attack target than DOEGrids, but DigiCert is also held to a higher standard of operation (WebTrust and CA/Browser Forum versus IGTF). In 2011 we saw significant compromises of commercial CA providers (DigiNotar, Comodo, etc.). While the DigiCert Grid CA is a private CA not trusted by browsers, it is hosted in the same operational environment as DigiCert's other public CAs.

As with any external CA provider (DOEGrids included), there is risk to OSG that the provider will cease operations for a variety of reasons. Using a commercial provider versus a DOE lab provider arguably increases this risk.

---++++ Preventive Controls

   * Recovery PIN or some other mechanism for easy certificate re-issuance.
   * Recommend renewal of certificates one month in advance of expiration.
   * Replicate certificate information (DNs, email addresses, serial numbers) in OSG hosted database (i.e., don't rely exclusively on DigiCert information).
   * Establish agreements with alternate CA providers.

---+++ Record of Changes

-- Main.JimBasney - 4 Jan 2012 - Initial update for !DigiCert replacing DOEGrids. Currently !DigiCert CRLs are valid for 7 days, in contrast to the 30 day validity of DOEGrids CRLs, requiring changes to handling of *Case 2*.

-- Main.JimBasney - 6 Jan 2012 - Include Business Impact Analysis aspects per 800-34 template. Document changes for DOEGrids to DigiCert Transition.

   * Set ALLOWTOPICVIEW = Main.SecurityTeamGroup, Main.RuthPordes, Main.BrianBockelman, Main.FkW, Main.JohnHover, Main.DanFraser, Main.RobQ, Main.ChanderSehgal, Main.VonWelch
   * Set ALLOWTOPICCHANGE = Main.SecurityTeamGroup, Main.VonWelch, Main.NehaSharma    
   * Set DENYTOPICVIEW = Main.TwikiGuest