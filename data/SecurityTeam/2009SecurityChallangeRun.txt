%META:TOPICINFO{author="DaveDykstra" date="1481312802" format="1.1" version="1.9"}%
%META:TOPICPARENT{name="SecurityTeamWorkingArea"}%
<!--
Accessible by security team only:
   * Set ALLOWTOPICVIEW = Main.SecurityTeamTeamTeamTeamTeamTeamGroup
   * Set ALLOWTOPICCHANGE = Main.SecurityTeamTeamTeamTeamTeamTeamGroup
--> 
%TOC%


---++ SecurityTeamTeamTeamTeamTeam Challenge Run Instructions for the SecurityTeamTeamTeamTeamTeam Team
   1. The challenge against BNL is on 5/11. the challenge against FNAL is on 5/18. 
   1. On the challenge day, send a reminder email to GOC as shown below. A prior email must have already been sent. 
   1. Test Operator (TOP) will submit the test process to the site. TOP will *WAIT* until the test process starts up and sends data to http://rooier.nikhef.nl/ssc3/SSC_300yui/treeviewmenu.html (the monitoring web site)
   1. *After* the test process shows up in the monitoring web site, send an email to the site security contacts as shown below.
   1. On each email subject line, write [THIS IS A SECURITY DRILL] 
   1. Keep copy of all communications and their TIMESTAMPS. 
   1. Site security contacts are expected to email osg-security-team@opensciencegrid.org address directly for all email communication. *However* we advertise security@opensciencegrid.org address heavily as part of our incident response. Thus there could be a site which sends an email to the security@ address. GOC is aware of the situation and they will forward any such email to us asap. 
   1. Normally, security team discusses incidents on security-discuss-l or incident-discuss-l mailing lists. However, we will not use these email lists during the test drill. All email communication will happen between osg-security-team@ and site security contacts' email addresses. 
   1. Once the site kills the process and sends an email, check with the web monitoring and record the time
   1. When the site claims they banned the offending uid, try re-sending the test process to verify. If the test process runs, ask the site to re-try banning. Record the time when the offending uid can no longer access the site. 
   1. If the site cannot respond within 72 hour, the test process will kill itself. 
   1. If the site fails to clean up the test process, close ports etc, work with the site to restore the computer state prior to the drill. Clean up all files created by the test process, close the ports. Make sure there is no security holes leftover. 
   1. Once the incident is over, ask the sites to restore access to the banned user. This action is not part of the grading criteria, but necessary for restoring access t security team members. 
   1. Once the drill is completed, create a report for each site and grade the sites based on the below criteria. 
   1. Send the sites draft report
   1. Prepare the final report to OSG EB and GDB is due on Jun 10, 2009

---++ Grading Criteria for Sites: 
   1. Communications:
   * Site sends an immediate response to the security team confirming they received the notification. This email is sent as a response to step 4 above.
   * Site promptly sends updates to the the security team until the drill is over. Site gives detailed information over their actions and findings 
   * Bonus point: site uses encryption and signature on all email messages.  
   2. Containment: 
   * Site is able to find the test process and kill it. 
   * Site is able to ban the offending uid
   * Bonus Point: fast response time
   3. Forensics:
   * Site can tell which IP address the attacker was coming from. 
   * Site is able to do an analysis of network traffic -- find that test process has been sending data to the monitoring web server
   * Site is able to do an analysis of submitted binaries -- can roughly understand what the binary is supposed to do, can find out interesting strings in the binary
   * Bonus Point: site checks the gatekeeper and the worker node. 

---++ SecurityTeamTeamTeamTeamTeam Challange Alert Email  to GOC 

Dear GOC,

I am contacting you on behalf of the OSG SecurityTeamTeamTeamTeamTeam Team.                                            

This mail is about to inform you that we plan to run a security drill during the next two weeks (starting on May 11th 2009) 
for the following sites:

- BNL  [ May 11th 2009 ] 
- FNAL [ May 18th 2009 ] 

For this campaign Aashish Sharma's certificate 

/DC=org/DC=doegrids/OU=People/CN=Aashish Sharma 513862  

is used for submitting the test jobs to the above mentioned sites. 

All email correspondence among the security team, the site contacts and the GOC will tagged with a [THIS IS A SECURITY DRILL] in the email subject line. Please follow the same incident response procedure you naturally will follow when you receive such email: i.e. forward the email to osg-security-team@opensciencegrid.org asap. 

The security team will start a test process on FNAL and BNL and then send an email alert to site security contacts to trigger the drill. The site security contacts will send an email confirming that they received the alert and the drill has started. This email will go to security@opensciencegrid.org and the subject line will contain [THIS IS A SECURITY DRILL]. After this point, all communication between the security team and site will happen directly. GOC will not receive any more email. If GOC does receive any email, please forward it to the security team asap. 

In case you receive any untagged email from the security contacts, please forward it to incident-discuss-l and incident-report-l email lists as you would normally do. 

Information on the incident drill is available at https://twiki.grid.iu.edu/bin/edit/SecurityTeamTeamTeamTeamTeam/2009SecurityChallangeRun

Mine Altunay
OSG SecurityTeamTeamTeamTeamTeam Team 
	  

---++ Informatory Email to Sites

Subject: OSG SecurityTeamTeamTeamTeamTeam Drill                                                                 
                                                                                                              
Hello,                                                                                                        
                                                                                                              
The OSG SecurityTeamTeamTeamTeamTeam Team will be conducting a SecurityTeamTeamTeamTeamTeam Service Challenge                                         
(SSC) of Tier 1 sites in coordination with the EGEE/LCG Operational                                           
SecurityTeamTeamTeamTeamTeam Coordination Team. 
                                                                                                              
The SecurityTeamTeamTeamTeamTeam Team will submit a test job under a Test Operator's        
credentials to each site. The test operator and the test job will be assumed as malicious. the security team will then send email to site security contacts requesting prompt investigation of the activities of the Test Operator at their site.                                                                                       
                                                                                                              
Sites are requested to follow normal security incident response procedures. 

In particular, 

1) The security team will send an alert email to site security contacts. The email subject line will contain [THIS IS A SECURITY DRILL]. This marks the beginning of the drill.

2) Site contacts should send an immediate reply to security@opensciencegrid.org confirming they received the email alert. Sites will be graded based on how quickly they replied. 

3) Sites must include [THIS IS A SECURITY DRILL] in *ALL* of their email subject lines. 

4) Sites immediately start their investigation on the incident. At every step, sites should send email updates to the security team email address directly (osg-security-team@opensciencegrid.org)

At a minimum, sites are expected to: 

5) find the test process and kill them. Email the security team with details when accomplishing this step.  

6) ban the test user from submitting additional jobs. Email the security team with details when accomplishing this.

7) Discover the incoming IP address of the test process. Email the security team with details when accomplishing this. 

8) Do an analysis of the network traffic (broader the better: there will be bonus points). Email the security team with details when accomplishing this.

9) Do an analysis of submitted binaries (there will be bonus point) . Email the security team with details when accomplishing this. 
                                                             
Sites will be graded based on:

1) how fast they respond to the incident alerts

2) how quickly and how well they are able to accomplish steps 2-9.                         

3) Bonus points will be given to sites who accomplishes more than outlined above. 

Please note that No sanctions must be applied against the Virtual Organization (VO) that was used to submit the job.

Please contact me if you have any questions.                                                                  
                                                                                                              
Sincerely,                                                                                                    

Mine Altunay                                                                                                             

---++ Email Alert to Sites After the Test Process Starts: 
Subject: [THIS IS A SECURITY DRILL]

This e-mail is an alert about a TEST incident. It is executed under the supervision of OSG SecurityTeamTeamTeamTeamTeam Team as part of the SecurityTeamTeamTeamTeamTeam Services 
Challenge (SSC). 

You are asked to follow the normal incident procedure, but you
MUST_NOT take any collective action against the VO of the offending
user.

What you are expected to do during the incident response is explained at [[https://twiki.grid.iu.edu/bin/view/SecurityTeamTeamTeamTeamTeam/SecurityTeamTeamTeamTeamDrillInstrSites][SecurityTeamTeamTeamTeamTeam Drill Instructions for Sites]]

        *Consider any activity from the following user as malicious.*

        The distinguished name (DN) of the user is:

         /DC=org/DC=doegrids/OU=People/CN=Aashish Sharma 513862  

        Please handle this test incident according to the normal
        incident response procedure with the exceptions listed
        below:

        1. No sanctions must be applied against the Virtual
           Organization (VO) that was used to submit the job.


Thanks, 

OSG SecurityTeamTeamTeamTeamTeam Team


---++ Additional EMAIL  to be sent to recruiting sites: 


<verbatim>

Dear ,

I am contacting you on behalf of the OSG Security Team.

As part of our activities, we periodically run so-called "Security  Service Challenges (SSC)".

The objective of SSC campaigns is to improve the quality of the   
response to grid sites to security incidents, in particular:

- Compliance with the OSG Incident Response Procedure
- Timeline and quality of the response
- Ensuring that the incident response communication channels are  working as expected
- Ensuring all relevant participants are informed


More information about the challenges is available from:
https://twiki.grid.iu.edu/bin/view/Security/SecurityDrillInstrSites

We are currently preparing another SSC campaign in <MONTH><YEAR> and  
aimed at <CHALLENGED SITES LIST>.


There are several benefits to the collaborating VO:
- a better understanding of the grid incident response procedure
- a better understanding of the way communication is organised during  
incidents
- some hands-on experience in dealing with a (test) security incident
- a better view on how sites usually react, what they expect from the  
affected VO, what information they provide the VO with

Thanks in advance,
</verbatim>


-- Main.AashishSharma - 06 May 2009