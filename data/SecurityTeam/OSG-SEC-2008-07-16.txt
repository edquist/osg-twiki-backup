%META:TOPICINFO{author="MineAltunay" date="1217028549" format="1.1" reprev="1.4" version="1.4"}%
%META:TOPICPARENT{name="IncidentInformation2008"}%
%TOC%
---+ OSG-SEC-2008-07-16

Multiple DNS implementations have been found to be vulnerable to cache poisoning.

---++ Status

<!--
Suggested status labels:
NEW: Initial report is received but incident is not confirmed.  This is a triage phase.
OPEN: The existence of a security incident requiring response has been confirmed. The response is underway.
RESOLVED: The incident has been resolved but the final report has not been submitted.
CLOSED: The final report has been submitted.
-->

   * *Status*: OPEN 
   * *Lead*: Mine Altunay 
   * *Responders*: _list of involved responders (for resource tracking)_ 
   * *References*: 
      * http://www.kb.cert.org/vuls/id/800113 
      * [[https://tick.globalnoc.iu.edu/MRcgi/MRentrancePage.pl][Footprints]] ticket number 5233 
      * ticket number 5242 assigned to Keith Chadwick for OSG VOMS server -- open 
      * ticket numer 5240 assigned to Rob Quick for IU services --- closed 
      * ticket number 5241 assigned to Alain Roy for Wisconsin services --- closed 
      * ticket number 5243 assigned to Brian Bockelman for RSV services running at UNL -- open 
      * ticket number 5244 assigned to Mats rynge for Engage VOMS server -- closed 
      * ticket number 5247 assigned to Saul Youssef at Boston Univ for pacman caches -- open 

---++ Analysis

   * *Severity*: Medium: immediate exploit is unlikely, risk to core services is limited 
   * *Urgency*: Medium: IRT members will multitask response with other important tasks. 

_Add additional analytical details about the incident here, including an assessment of the risk, what assets are affected, etc._

---++ Mitigation Plan

We plan to follow the actions summarized below. We created security tickets in footprints system to keep track of our core services. We determine that the VDT caches, pacman caches and the osg distribution at Indiana university is important for OSG operations and they may be even more vulnerable to an attack. Because we do not provide software with hashes or through secure web sites, an end user can be lured into downloading malicious code from an attacking site. For this reason, we asked these services tosend us confirmation regarding their statuses. In addition, the VOMS servers can become a vulnerability. An attacker can access a site by poointing to a malicious VOMS server instead of a legitimate VOMS server. However, this attack is less likely to happen because it requires detailed knowledge over the grid infrastructure.

Nevertheless, we asked OSG VOs to check their DNS servers and apply the patches.

The remaining core OSG services are obviously important for our operations. We urged them to contact their local site admins and apply the necessary patches.

---+++ Actions to take

   1 For each core OSG service, contact the DNS administrator and verify that patches have been applied. 
   1 Send a notice to VO security contacts asking them to verify with their DNS administrators so VOMS servers are not impacted. 
   1 Send a notice to site security contacts informing them of the issue and our response. 

---+++ How to monitor progress
 <table width="481" cellspacing="1" cellpadding="0" height="95" border="1"> <tbody><tr><th>DNS server</th><th>status</th></tr> <tr><td>opensciencegrid.org</td><td>have not been upgraded</td></tr> <tr><td>vdt.cs.wisc.edu (software and CA certificates)</td><td>cs.wisc.edu DNS servers have been upgraded</td></tr> <tr><td>physics.bu.edu (Pacman distribution site)</td><td>have not been upgraded </td></tr> <tr><td>software.grid.iu.edu (OSG pacman cache)</td><td>

have been upgraded
</td></tr> </tbody></table>

---+++ Acceptable response time estimate

The risk is determined to be medium.We expect core services to notify their local site admins (where the core service runs) as soon as possible within business hours. Because the upgrades are provided by vendors, the complete mitigation is dependent on vendor-and local site' schedules.

---+++ List of affected parties

This is a well-advertised vulnerability. Thus, all our partner grids must be up-to-date. In fact, TeraGrid, EGEE are awar of the issue. Although vulnerability is not OSG specific, we can send a courtesy email to our partners at peer-grids-csirt email list. However, this is not mandatory.
---+++ Definition of End Of Event

All footprint tickets are closed, meaning all of the core OSG services have been upgraded.

---++ Incident Log

07/08/2008: http://www.kb.cert.org/vuls/id/800113 published

07/16/2008: Report by Alain Roy. OSG incident response process initiated.

Alain Roy reports the cs.wisc.edu DNS servers have been upgraded.

07/25/2008 All ticket statuses are entered into the website.

07/25/2008 We heard back from almost all of the OSG VOs and core services. The open tickets are for the RSV at UNL, Fermilab hosted services and pacman distribution at BU. In addition, Fermilab hosts a large number of services and they are currently waiting to hear from their vendor to receive the patch. Once we hear back from these core services, we will consider this issue to be closed.

We have not heard back form pacman site at BU. the ticket is still standing. 

-- Main.JimBasney - 17 Jul 2008

---++ Summary

   * *Final Report*: [[https://osg-docdb.opensciencegrid.org:440/][OSG !DocDB Document ###]] 

_What was the resolution of the incident?_

_What is the long-term mitigation plan (including changes in our operations, middleware or anything else that enabled the event) and timeline?_

Long-term:
   * Address GUMS not checking host certificates and thus being vulnerable to DNS attacks 
   * Address vdt-update-certs relying on DNS to obtain the set of root CAs to install 
   * Sign VDT software distributions? 

_Deposit the final incident report in !DocDB and fill in the !DocDB URL and document number above._

---++ Access Control

_Uncomment the appropriate access control policy for this incident page. Logout of the twiki and try to access the page to ensure it is not publicly accessible._

Incident information accessible by Security Team members and GOC only:
   * #Set ALLOWTOPICVIEW = Main.SecurityTeamGroup, Main.GocGroup 
   * #Set ALLOWTOPICCHANGE = Main.SecurityTeamGroup, Main.GocGroup 

Incident information accessible by all authenticated twiki users:
   * Set ALLOWTOPICVIEW = Main.GridGroup          
   * Set ALLOWTOPICCHANGE = Main.GridGroup
