%META:TOPICINFO{author="X509_2fDC_3dorg_2fDC_3ddoegrids_2fOU_3dPeople_2fCN_3dJames_20J_2e_20Barlow_20983221" date="1297185115" format="1.1" version="1.1"}%
%META:TOPICPARENT{name="IncidentInformation2010"}%
%TOC%

---++ Notification Email 

<verbatim>
Introduction
============

Yesterday, updates for the systemtap package were released, fixing a
vulnerability that can give any local user root privileges on RHEL 5
and 6 (and their derivates) systems that have systemtap installed.

The security researcher, Tavis Ormandy, has released an exploit for this issue.

This issue has been labeled CVE-2010-4170, and is regarded as a critical
vulnerability. Sites are requested to take immediate action as outlined
below.

This issue also affects RHEL 4 and derivates, but is much less serious
there.

Vendor updates have been released for RHEL, CentOS, Scientific Linux
and SLC.


Recommendations
===============

Sites should evaluate the need for having systemtap installed. If
there is a requirement to have the package installed, please apply
vendor updates immediately, otherwise uninstall the systemtap-runtime
rpm package.

If vendor updates are not yet available for your system, immediately
apply mitigation steps as outlined below.

Any of these actions can be taken without rebooting the system.

Further communication on this incident can be done at:

https://ticket.grid.iu.edu/goc/viewer?id=9601                                             

To access the above URL, you must authenticate with the certificate
you have registered in OIM.


Mitigation
==========

If vendor updates are not yet available for your system, the issue can
be worked around by:

a) if at all possible, uninstalling the vulnerable rpm package,
   systemtap-runtime

or

b) removing the suid bit from /usr/bin/staprun


Details
=======

Systemtap is a tool for instrumenting a live running kernel and is
typically used for debugging or diagnosis of performance problems. To
let selected users run systemtap without giving them full root
permissions, the staprun binary is installed suid root (and performs
additional internal authorization checks).

However, before doing any authorization checks, staprun first tries to
load the uprobes kernel module by running /sbin/modprobe, and it does
not properly sanitize the environment first. This makes it possible to
supply a fake configuration file for modprobe which lets an attacker
run arbitrary commands with root privileges.

For example, Tavis Ormandy's one-line exploit launches a root shell:

  $ printf "install uprobes /bin/sh" > exploit.conf; MODPROBE_OPTIONS="-C exploit.conf"
+staprun -u whatever

  sh-4.0#

The problem also exists on RHEL 4, but there an attacker must be a
member of the stapusr group to exploit the issue, which reduces the
risk significantly.


References
==========

Red Hat advisory: https://rhn.redhat.com/errata/RHSA-2010-0894.html                       


This advisory was put together in help with the EGI CSIRT.

Please contact security@opensciencegrid.org if you have any questions
or concerns.

This message is digitally signed. We encourage you to verify the
digital signatures on OSG security announcements according to:

https://twiki.grid.iu.edu/bin/view/Security/SecureEmail                                   

Sincerely,
James J. Barlow
on behalf of the OSG Security Team
</verbatim>

---++ Access Control

_Uncomment the appropriate access control policy for this incident page. Logout of the twiki and try to access the page to ensure it is not publicly accessible. Do not attach files, as they will not be protected (see  [[http://twiki.org/cgi-bin/view/TWiki/TWikiAccessControl#Controlling_access_to_Attachment][http://twiki.org/cgi-bin/view/TWiki/TWikiAccessControl#Controlling_access_to_Attachment]])._

Incident information accessible by Security Team members and GOC only:
   * #Set ALLOWTOPICVIEW = Main.SecurityTeamGroup, Main.GocGroup
   * #Set ALLOWTOPICCHANGE = Main.SecurityTeamGroup, Main.GocGroup

Incident information accessible by all authenticated twiki users:
   * Set ALLOWTOPICVIEW = Main.GridGroup, Main.RomainWartel
   * Set ALLOWTOPICCHANGE = Main.GridGroup, Main.RomainWartel
