%META:TOPICINFO{author="DaveDykstra" date="1481320530" format="1.1" version="1.9"}%
%META:TOPICPARENT{name="SecurityTeamWorkingArea"}%
<!--
Accessible by security team only:
   * Set ALLOWTOPICVIEW = Main.SecurityTeamGroup
   * Set ALLOWTOPICCHANGE = Main.SecurityTeamGroup
--> 
%TOC%
---+ 2009 Security Challenge Plan for Tier 2 sites

---++ Timeline

   * August: 
      * OSG Site Admin Meeting: preparations, announcements, etc.
      * OSG preparations
      * Doodle setup for the sites to register their preference of challenge date
         * http://doodle.com/yvimk63cd28kux2u
   * September:
      * Final preparations, announcements, etc.
      * Run security on ~25 OSG sites 
   * October:
      * Continue security runs

---++ Contacts

   * Anand Padmanabhan <apadmana@uiuc.edu> - Coordinating the Tier 2 security challenge
   * Mine Altunay <maltunay@fnal.gov> - OSG Security Officer

---++ Challenge Procedure

   * The test operator (TOP) warns the registered security contact of the site about the upcoming challenge
   * The TOP submits a job to the site using an predetermined identity that will be in MIS VO.
   * The TOP informs the site security contact that this identity should be treated as malicious and the normal OSG incident response procedure should be followed (with some caveats)
   * The TOP measures the quality of the response of the site based on an existing set of criteria
   * The site is informed of its score

---++ Questions and Concerns

   * What do we need done prepare for challenge ? 
      * Getting a special certificate/credential ? 
      * Get that certificate to MIS VO
   * What all information would they provide in their notification ? 
   * What kind of data/results they expect from sites ?  
      * entire logs / relevant logs ? 
      * different types of logs 
   * How do they rate sites 
      * whats their scoring criteria ?
      * in other words, what points do they rate sites on ? 
      * Are there a set of software/scripts which they use to parse through site response / 
   * How do they define the end of challenge ? 
      * what all sites need to do to be able to say challenge is finished ?

---++ Access to EGEE svn repository 
We will use the same code for our challange

svn co svn+ssh://svn@ndpfsvn.nikhef.nl/repos/gridssc  

Contents of the repository:

gridssc/trunk/src/ssc/ 

Two main files:

   - ssc 
   - lepus 
   - profiler.cfg 

   - ssc  : Main program file which calls lepus 
<BR>
   - lepus: traverses directories and tries to find writable directories, renames itself with random alpha-numeric string. Installs crontab, at entry ( to ensure keep running). 
<BR>
   - profiler.cfg: set up configuration variables. 
<BR>


In order to run these binaries : ./ssc <ROC> <VO> [ Ex. ./ssc OSG Test ] 

Lepus once installed is suppose to delete everthing in the directory it started from. and then send notifications via email [ EMAIL_REPORT= variable in profiler.cfg ] or via HTTP [ ALTERNATE_URL= variable in profiler.cfg ] 

It also installs itself in cron, at and multiple writable directories. Lepus also creates a file called .attaboy which is a cron like script 

The entire job will run for the duration specified by TIMEOUT_HOURS= in profiler.cfg 



---++ Link to Rooier [ Web interface to the SSC output ] 
Rooier is the webserver where ssc output is going 

http://rooier.nikhef.nl/ssc3/SSC_300yui/treeviewmenu.html 

---++ Script to submit job 

<verbatim>
executable = run-script.sh 
output = out/security_test.$(CLUSTER).out
error = err/security_test.$(CLUSTER).err
log = security_test.log
notification=never
Transfer_Executable = true
universe = grid
stream_output = false
stream_error = false
GridResource= gt2 osg-test-ce.ncsa.uiuc.edu/jobmanager-condor 
#GridResource= gt2 everest.cigi.uiuc.edu/jobmanager-fork
#GridResource= gt2 gate01.aglt2.org/jobmanager-fork
#GridResource= REMOTE_JM
environment = REMOTE_HOST=osg-test-ce.ncsa.uiuc.edu; REMOTE_PORT=6996; REMOTE_FTPPORT=2811; REMOTE_DIR=/ncsa/data-grid/data/security-test
when_to_transfer_output = ON_EXIT
should_transfer_files=YES
transfer_input_files = .lepus, ssc, profiler.cfg 
globusrsl=(jobtype=single)
queue 


</verbatim>

Job script  

<verbatim>
#!/bin/bash 


export DIRDEPTH=1

chmod +x ssc
chmod +x .lepus 
ls -laltrh 
pwd 
hostname 
date 

echo "##################### " 

./ssc OSG TEST  

pwd 
date 

</verbatim> 

---++ Draft Email to Sites 


<verbatim>
====== Draft Email ========                                                                                   
                                                                                                              
 Subject: OSG Security Drill 
                                                                   
Hello,                                                                                                        

The OSG Security Team will be conducting a Security Drill  
of CMS and Atlas Tier 2's and other large sites.

We would like to schedule the drill on your site based on our mutual availability . 
We have tentatively scheduled the weeks of Sept 21 and Sept 28 for the Tier2 
drills. Please fill out the following doodle to reflect your availability.

  http://doodle.com/yvimk63cd28kux2u

The planned security drill consists of following steps:

  * The security team will submit a test job under a Test Operator
    credentials to each site.
  * The security team will then send email to site security contacts
     requesting prompt investigation of the activities of the Test Operator
     at their site.
  *  Sites will be requested to follow normal security incident response
     procedures (with come caveats). In particular, each site should immediate 
     report the security incident to the OSG Security Team according to:                                                                                                                                                  
     - https://twiki.grid.iu.edu/bin/view/Security/IncidentDiscoveryReporting 

A more detailed instructions of what is expected of the site will be forthcoming. 

Each site's performance in this security drill will be rated according to the                                            
following criteria:                                                                                           
                                                                                                              
  * timely communication with the OSG Security Team                                                           
  * containment (find job processes and kill them, suspend the                                                
    user from submitting additional jobs)                                                                     
  * forensics (discovery of initiating site, analysis of network                                              
    traffic, analysis of submitted binaries)                                                                  
                                                                                                              
Please contact me if you have any questions.                                                                  
                                                                   
Sincerely,                                                                                                    
Mine Altunay                                                                                                  
OSG Security Officer                                                                                          
                                       


</verbatim>


---++ Links

   * [[http://osct.web.cern.ch/osct/ssc.html][EGEE OSCT Security Challenges]]
   * [[https://twiki.cern.ch/twiki/bin/view/LCG/LCGSecurityChallenge][LCG Security Challenge Wiki]]
   * [[http://osct.web.cern.ch/osct/incident-reporting.html][EGEE OSCT Incident Reporting]]
   * [[http://cern.ch/osct/ssc3/scores.html][Scores from 2008 Security Challenge]]



-- Main.AnandPadmanabhan - 01 Sep 2009