%META:TOPICINFO{author="KyleGross" date="1481047944" format="1.1" version="1.10"}%
%META:TOPICPARENT{name="SecurityTeamTeamTeamTeamTeamTeamWorkingArea"}%
<!--
Accessible by security team only:
   * Set ALLOWTOPICVIEW = Main.SecurityTeamTeamTeamTeamTeamTeamGroup
   * Set ALLOWTOPICCHANGE = Main.SecurityTeamTeamTeamTeamTeamTeamGroup
--> 
%TOC%
---+ 2009 SecurityTeamTeamTeamTeamTeam Challenge Plan

---++ Timeline

   * January and February:
      * Challenge of EGEE sites
      * OSG preparations
   * March:
      * OSG All Hands Meeting: Final preparations, announcements, etc.
      * Then: Challenge of OSG sites
   * April:
      * Sven prefers if we complete the challenge by April 12.

---++ EGEE Contacts

   * Sven Gabriel <sveng@nikhef.nl> - EGEE OCST SecurityTeamTeamTeamTeamTeam Challenge Coordinator
   * Romain Wartel <Romain.Wartel@cern.ch> - EGEE SecurityTeamTeamTeamTeamTeam Officer

---++ EGEE OSCT Procedure

   * The test operator (TOP) warns the registered CSIRT contact of the site about the upcoming challenge
   * The TOP submits a job to the site using an identity part of a random, assisting, SSC-aware VO
   * The TOP informs the site CSIRT contact point that this identity should be treated as malicious and the normal incident response procedure should be followed (with some caveats)
   * The TOP measures the quality of the response of the site based on an existing set of criteria
   * The site is informed of its score

---++ Lessons from 2008 Challenge

   * Sites are confused about which procedures (OSG/EGEE/WLCG) they should follow. OSG sites should contact OSG security team which contacts EGEE OSCT.
   * USCMS was challenged as a WLCG Tier1 site. USCMS was registered with both EGEE and OSG. We decided it should de-register from EGEE. Did it?

---++ Questions and Concerns

   * Will EGEE OCST challenge OSG sites or will the OSG SecurityTeamTeamTeamTeamTeam Team perform the challenge? OSG sites are trained to contact OSG security team (security@opensciencegrid.org), not EGEE OSCT.
   * Do we challenge only WLCG sites in OSG or all OSG sites?

<verbatim>
Concerns to discuss:
1) OSG sites may not respond to EGEE provided email address since those are not part of our standard incident response plan. 
2) Is there a standard response report format ? 
3) How do they (EGEE - Security Challenge Team ) envision OSG security team's role in the challenge ? Especially since OSG sites probably will not respond to EGEE queries and will have to go via us. 

Other questions specific to operating the challenge: 

0) What do they need from us to help them prepare for challenge ? 
	- creation of user accounts ? 
	- issuing certificates/credentials ? 
1) Their notification process 
	- how do they notify sites about incoming challenge ( if at all ). 
	- how do they notify sites about on-going challenge ? ( or do we do this ? Since sites don't know EGEE) 
	- how do they convey to sites about the details specific to the challenge ( like reporting to challenge email address etc ) 

2) What all information would they provide in their notification ? 

3) What kind of data/results they expect from sites ?  
	- entire logs / relevant logs ? 
	- different types of logs 

4) How do they rate sites 
	- whats their scoring criteria ?
	- in other words, what points do they rate sites on ? 
	- Is there a set of software/scripts which they use to parse through site response / 

5) What all do they do in the challenge ? 
	- is the scope limited to illegal job submission or other aspects involved ?
	- do they do any other thing - download exploits, test vulnerability of kernels ? 
	- do they target any other hosts or only the clusters ? Admins, their accounts ? 

6) How do they define the end of challenge ? 
	- what all sites need to do to be able to say challenge is finished ?
</verbatim>

---++ Jan 23 2009 Notes

<verbatim>
Subject: Re: Another security challenge
Date: Fri, 23 Jan 2009 17:19:34 +0100
From: Jim Basney <jbasney@ncsa.uiuc.edu>
To: Sven Gabriel <sveng@nikhef.nl>, Romain Wartel <Romain.Wartel@cern.ch>
CC: Aashish Sharma <aashish@ncsa.uiuc.edu>,  Mine Altunay <maltunay@fnal.gov>

Sven and Romain,

Thanks for the productive discussion today about the Security Service
Challenge. Here are my notes from our discussion. Please correct
anything I've got wrong.

The OSG Security Team will challenge the OSG Tier 1 sites (FNAL and BNL)
in March. We will first warn the sites and make sure communication
mechanisms are working. We will also warn the CA and VO operators. (I
expect we'll use the DOEGrids CA and the MIS VO, but that's not
finalized.) Then we'll submit the test job to both sites using the test
identity. The job will report back to Sven, who will monitor its status.
We'll inform the site security contacts that the test identity should be
considered malicious and they should investigate. We'll track and
respond to all communications from the sites.

We'll combine our communications timeline with Sven's records from his
job monitoring to compute the score, which is using the same formula as
last year (http://osct.web.cern.ch/osct/ssc3/scores.html) grading timely
communication, containment (found jobs and killed them, suspended the
user at the site), and forensics (discovery of initiating site, analysis
of network traffic -- i.e., detecting the out-of-band traffic to Sven's
server, analysis of submitted binaries -- i.e., finding the interesting
strings in the binary).

Since Aashish is off in February, Jim and Sven will work together in
February to prepare. Then Aashish will help us run the challenge when he
returns in March.

Thanks,
Jim
</verbatim>
 
---++ Links for the EGEE post challenge assesment slides 

http://indico.cern.ch/conferenceDisplay.py?confId=49905   

---++ Access to EGEE svn repository 

svn co svn+ssh://svn@ndpfsvn.nikhef.nl/repos/gridssc  

Contents of the repository:

gridssc/trunk/src/ssc/ 

Two main files:

   - ssc 
   - lepus 
   - profiler.cfg 

   - ssc  : Main program file which calls lepus 
<BR>
   - lepus: traverses directories and tries to find writable directories, renames itself with random alpha-numeric string. Installs crontab, at entry ( to ensure keep running). 
<BR>
   - profiler.cfg: set up configuration variables. 
<BR>


In order to run these binaries : ./ssc <ROC> <VO> [ Ex. ./ssc OSG Test ] 

Lepus once installed is suppose to delete everthing in the directory it started from. and then send notifications via email [ EMAIL_REPORT= variable in profiler.cfg ] or via HTTP [ ALTERNATE_URL= variable in profiler.cfg ] 

It also installs itself in cron, at and multiple writable directories. Lepus also creates a file called .attaboy which is a cron like script 

The entire job will run for the duration specified by TIMEOUT_HOURS= in profiler.cfg 



---++ Link to Rooier [ Web interface to the SSC output ] 
Rooier is the webserver where ssc output is going 

http://rooier.nikhef.nl/ssc3/SSC_300yui/treeviewmenu.html 

---++ Script to submit job 

<verbatim>
executable = run-script.sh 
#executable = security_test5.sh
output = out/security_test.$(CLUSTER).out
error = err/security_test.$(CLUSTER).err
log = security_test.log
notification=never
Transfer_Executable = true
universe = grid
stream_output = false
stream_error = false
#arguments=OSG TEST 
GridResource= gt2 osg-test-ce.ncsa.uiuc.edu/jobmanager-condor 
#GridResource= gt2 everest.cigi.uiuc.edu/jobmanager-fork
#GridResource= gt2 gate01.aglt2.org/jobmanager-fork
#GridResource= REMOTE_JM
environment = REMOTE_HOST=osg-test-ce.ncsa.uiuc.edu; REMOTE_PORT=6996; REMOTE_FTPPORT=2811; REMOTE_DIR=/ncsa/data-grid/data/security-test
when_to_transfer_output = ON_EXIT
should_transfer_files=YES
transfer_input_files = .lepus, ssc, profiler.cfg 
globusrsl=(jobtype=single)
queue 


</verbatim>

Job script  

<verbatim>
#!/bin/bash 


export DIRDEPTH=1

chmod +x ssc
chmod +x .lepus 
ls -laltrh 
pwd 
hostname 
date 

echo "##################### " 

./ssc OSG TEST  

pwd 
date 

</verbatim> 

---++ Draft Email to Sites 


<verbatim>
====== Draft Email ========                                                                                   
                                                                                                              
 Subject: OSG Security Service Challenge                                                                      
Hello,                                                                                                        
The OSG Security Team will be conducting a Security Service Challenge                                         
(SSC) of Tier 1 sites in coordination with the EGEE/LCG Operational                                           
Security Coordination Team. Background information about SSCs is                                              
available at:                                                                                                 
                                                                                                              
  http://osct.web.cern.ch/osct/ssc.html                                                                       
                                                                                                              
The Security Team will submit a test job under the Test Operator's                                            
credentials to each site and will then send email to site security                                            
contacts requesting prompt investigation of the activities of the Test                                        
Operator at their site.                                                                                       
                                                                                                              
Sites are requested to follow normal security incident response                                               
procedures. In particular, each site should immediate report the                                              
security incident to the OSG Security Team according to:                                                      
                                                                                                              
                                                                                                              
  https://twiki.grid.iu.edu/bin/view/Security/IncidentDiscoveryReporting 

Each site's performance in this SSC will be rated according to the                                            
following criteria:                                                                                           
                                                                                                              
  * timely communication with the OSG Security Team                                                           
  * containment (find job processes and kill them, suspend the                                                
    user from submitting additional jobs)                                                                     
  * forensics (discovery of initiating site, analysis of network                                              
    traffic, analysis of submitted binaries)                                                                  
                                                                                                              
Please contact me if you have any questions.                                                                  
                                                                                                              
                                                                                                              
Sincerely,                                                                                                    
Mine Altunay                                                                                                  
OSG Security Officer                                                                                          
                                       


</verbatim>


---++ Links

   * [[http://osct.web.cern.ch/osct/ssc.html][EGEE OSCT SecurityTeamTeamTeamTeamTeam Challenges]]
   * [[https://twiki.cern.ch/twiki/bin/view/LCG/LCGSecurityChallenge][LCG SecurityTeamTeamTeamTeamTeam Challenge Wiki]]
   * [[http://osct.web.cern.ch/osct/incident-reporting.html][EGEE OSCT Incident Reporting]]
   * [[http://cern.ch/osct/ssc3/scores.html][Scores from 2008 SecurityTeamTeamTeamTeamTeam Challenge]]