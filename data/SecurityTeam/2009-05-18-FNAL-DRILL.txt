%META:TOPICINFO{author="KyleGross" date="1481313480" format="1.1" version="1.6"}%
%META:TOPICPARENT{name="SecurityTeamWorkingArea"}%
<!--
Accessible by security team only:
   * Set ALLOWTOPICVIEW = Main.SecurityTeamGroup
   * Set ALLOWTOPICCHANGE = Main.SecurityTeamGroup
--> 
%TOC%

---++ Drill Summary 

<verbatim>
Current status of OSG Grid Security Incident Drill - 18-May-2009.                                             
                                                                                                              
Incident Notification:                  18 May 2009 10:34:45                                                  
SAZ Ban Instituted:                     18 May 2009 10:38:10                                                  
GUMS and SAZ logs:                      18 May 2009 10:49:32                                                  
Processes terminated:                   18 May 2009 11:03:46                                                  
Gatekeeper logs sent:                   18 May 2009 11:12:49                                                  
tar of incident files:                  18 May 2009 11:16:36                                                  
netflow analysis to gatekeeper:         18 May 2009 11:25:53                                                  
1st analysis of job:                    18 May 2009 11:48:00                                                  
netflow analysis to worker node:        18 May 2009 11:59:51                                                  
2nd analysis of job:                    18 May 2009 14:15:21                                                  
                                                                                                              
All timestamps are based on the time that the email was sent/received                                         
and are Central Time (UTC -0500).              

</verbatim>

---++ Incident Notification 
<verbatim>
Date: Mon, 18 May 2009 10:34:45 -0500                                                                         
From: Aashish Sharma <aashish@ncsa.uiuc.edu>                                                                  
Subject: [THIS IS A SECURITY DRILL] Incident Notification                                                     
To: cst <cst@fnal.gov>, cst <computer-security@fnal.gov>,                                                     
        "osg-security-team@OPENSCIENCEGRID.ORG" <osg-security-team@OPENSCIENCEGRID.ORG>,                      
        OSG- Grid Operations Center <goc@OPENSCIENCEGRID.ORG>,                                                
        fermigrid-security@fnal.gov                                                                           

Hello:                                                                                                        
                                                                                                              
This e-mail is an alert about a TEST incident. It is executed under the supervision of OSG Security Team as   
part of the Security Services Challenge (SSC).  

You are asked to follow the normal incident procedure, but you MUST_NOT take any collective action against the
VO of the offending user.                                                                                    
                                                                                                              
What you are expected to do during the incident response is explained at Security Drill Instructions for      
+Sites: https://twiki.grid.iu.edu/bin/view/Security/SecurityDrillInstrSites                                   
                                                                                                              
Consider any activity from the following user as malicious.                                                   
The distinguished name (DN) of the user is:                                                                   
/DC=org/DC=doegrids/OU=People/CN=Aashish Sharma 513862                                                        
Please handle this test incident according to the normal incident response procedure with the exceptions      
listed below:                                                                                                
                                                                                                              
1. No sanctions must be applied against the Virtual Organization (VO) that was used to submit the job.        
                                                                                                              
Thanks,                                                                                                       
OSG Security Team

</verbatim>

---++ Acknowledgement of SecurityTeamTeamTeamTeamTeam Notification 

<verbatim>
ate: Mon, 18 May 2009 10:38:36 -0500                                                                         
From: Keith Chadwick <chadwick@fnal.gov>                                                                      
Subject: Re: [THIS IS A SECURITY DRILL] Incident Notification                                                 
In-reply-to: <20090518153445.GC24194@yaksha.ncsa.uiuc.edu>                                                    
To: Aashish Sharma <aashish@NCSA.UIUC.EDU>, cst <cst@fnal.gov>,                                               
        cst <computer-security@fnal.gov>,                                                                     
        "osg-security-team@OPENSCIENCEGRID.ORG" <osg-security-team@OPENSCIENCEGRID.ORG>,                      
        OSG- Grid Operations Center <goc@OPENSCIENCEGRID.ORG>,                                                
        fermigrid-security@fnal.gov    

                                                                                                              
This user has been blacklisted.                                                                               
                                                                                                              
-Keith.                                                                                                       
                                                                                                              
At 10:34 AM -0500 5/18/09, Aashish Sharma wrote:                                                              
>Hello:              
>This e-mail is an alert about a TEST incident. It is executed under                                          
>the supervision of OSG Security Team as part of the Security                                                 
>Services Challenge (SSC).                                                                                    
              

</verbatim>

Second confirmation from Fermi Lab security Team

<verbatim> 

Date: Mon, 18 May 2009 10:40:17 -0500                                                                         
From: Joe Klemencic <jklemenc@fnal.gov>                                                                       
Subject: Re: [THIS IS A SECURITY DRILL] Incident Notification                                                 
In-reply-to: <20090518153445.GC24194@yaksha.ncsa.uiuc.edu>                                                    
To: Aashish Sharma <aashish@ncsa.uiuc.edu>                                                                    
Cc: cst <cst@fnal.gov>, cst <computer-security@fnal.gov>,                                                     
        "osg-security-team@OPENSCIENCEGRID.ORG" <osg-security-team@OPENSCIENCEGRID.ORG>,                      
        OSG- Grid Operations Center <goc@OPENSCIENCEGRID.ORG>,                                                
        fermigrid-security@fnal.gov     

Thanks for the report. We will investigate.                                                                   
                                                                                                              
Joe Klemencic                                                                                                 
Fermilab Computer Security            

</verbatim>

Confirmation from GoC 

<verbatim>

From: Kyle Gross <kagross@indiana.edu>                                                                        
To: Aashish Sharma <aashish@ncsa.uiuc.edu>                                                                    
In-Reply-To: <20090518153445.GC24194@yaksha.ncsa.uiuc.edu>                                                    
Subject: Re: [THIS IS A SECURITY DRILL] Incident Notification                                                 
Date: Mon, 18 May 2009 11:53:01 -0400       

Just as a side note, I thought I'd inform you that we (goc) received                                          
this email after we got the replies to this email from Joe and Keith.                                         
                                                                                                              
Kyle                                                                                                          
                                                                                                              
                                                                                                              
On May 18, 2009, at 11:34 AM, Aashish Sharma wrote:                                                           
                                                                                                              
>Hello:                                                                                                       
>                                                                                                             
>This e-mail is an alert about a TEST incident. It is executed under                                          
>the supervision of OSG Security Team as part of the Security                                                 
>Services Challenge (SSC).                                                                                    
>                                                                   

</verbatim>

---++ SAZ Ban Instituted
<verbatim>
Date: Mon, 18 May 2009 10:49:32 -0500                                                                         
From: Keith Chadwick <chadwick@fnal.gov>                                                                      
Subject: Re: [THIS IS A SECURITY DRILL] Incident Notification                                                 
In-reply-to: <p06240807c637316958ec@[131.225.82.50]>                                                          
To: Keith Chadwick <chadwick@fnal.gov>,                                                                       
        Aashish Sharma <aashish@ncsa.uiuc.edu>, cst <cst@fnal.gov>,                                           
        cst <computer-security@fnal.gov>,                                                                     
        "osg-security-team@OPENSCIENCEGRID.ORG" <osg-security-team@OPENSCIENCEGRID.ORG>,                      
        OSG- Grid Operations Center <goc@OPENSCIENCEGRID.ORG>,                                                
        fermigrid-security@fnal.gov   

This user was blacklisted in SAZ at:                                                                          
                                                                                                              
Date: Mon, 18 May 2009 10:38:10 -0500                                                                         
From: SAZ-ADMIN <saz-admin@fg5x4.fnal.gov>                                                                    
Subject: saz-admin-script - action log                                                                        
Sender: owner-fermigrid-security@listserv.fnal.gov                                                            
To: fermigrid-security@fnal.gov                                                                               
List-Owner: <mailto:FERMIGRID-SECURITY-request@LISTSERV.FNAL.GOV>                                             
List-Subscribe:                                                                                               
<mailto:FERMIGRID-SECURITY-subscribe-request@LISTSERV.FNAL.GOV>                                               
List-Unsubscribe:                                                                                             
 <mailto:FERMIGRID-SECURITY-unsubscribe-request@LISTSERV.FNAL.GOV>                                            
List-Help: <mailto:LISTSERV@LISTSERV.FNAL.GOV?body=INFO FERMIGRID-SECURITY>         

User: chadwick@fg5x4.fnal.gov                                                                                 
Command: /usr/bin/mysql -u root -e "update user set enabled = 'N'                                             
where user_name like '%513862%'; select user_name, enabled, trusted,                                          
changeAt from user where user_name like '%513862%'" SAZDB                                                     
Comment: OSG Security Drill                                                                                   
                                
</verbatim>           

---++ GUMS and SAZ logs                                                                   
                                                                                                              
This user was mapping in GUMS as follows:                                                                     
                   
<verbatim>                                                                                           

[chadwick@fg6x2 logs]$ grep '/DC=org/DC=doegrids/OU=People/CN=Aashish                                         
Sharma 513862' gums-service-admin.log                                                                         
18 May 2009 09:41:32,354 [INFO ]:                                                                             
GridID[/DC=org/DC=doegrids/OU=Services/CN=fnpcosg1.fnal.gov] - Mapped                                         
on host '/DC=org/DC=doegrids/OU=Services/CN=fnpcosg1.fnal.gov' the                                            
user '/DC=org/DC=doegrids/OU=People/CN=Aashish Sharma 513862' /                                               
'/mis/Role=NULL/Capability=NULL' to 'mis'                                                                     
18 May 2009 09:41:33,318 [INFO ]:                                                                             
GridID[/DC=org/DC=doegrids/OU=Services/CN=fnpcosg1.fnal.gov] - Mapped                                         
on host '/DC=org/DC=doegrids/OU=Services/CN=fnpcosg1.fnal.gov' the                                            
user '/DC=org/DC=doegrids/OU=People/CN=Aashish Sharma 513862' /                                               
'/mis/Role=NULL/Capability=NULL' to 'mis'                                                                     
18 May 2009 09:41:37,631 [INFO ]:                                                                             
GridID[/DC=org/DC=doegrids/OU=Services/CN=fnpcosg1.fnal.gov] - Mapped                                         
on host '/DC=org/DC=doegrids/OU=Services/CN=fnpcosg1.fnal.gov' the                                            
user '/DC=org/DC=doegrids/OU=People/CN=Aashish Sharma 513862' /                                               
'/mis/Role=NULL/Capability=NULL' to 'mis'                                                                     
18 May 2009 10:39:31,841 [INFO ]:                                                                             
GridID[/DC=org/DC=doegrids/OU=Services/CN=fnpcosg1.fnal.gov] - Mapped                                         
on host '/DC=org/DC=doegrids/OU=Services/CN=fnpcosg1.fnal.gov' the                                            
user '/DC=org/DC=doegrids/OU=People/CN=Aashish Sharma 513862' /                                               
'/mis/Role=NULL/Capability=NULL' to 'mis'                                                                     
[chadwick@fg6x2 logs]$                                                                                        
                                                                                                              
                             
</verbatim>                                                                                 

Here are the corresponding entries in the SAZ logs:     fg5x3:                                                                                                        
                                                                                      
<verbatim>
                        
2009-05-18 10:43:10 :INFO :Thread-1468691: Received SAZclient                                                 
authorization request from 131.225.166.2 : fnpcosg1.fnal.gov                                                  
2009-05-18 10:43:10 :INFO :Thread-1468691: VO mis                                                             
2009-05-18 10:43:10 :INFO :Thread-1468691: Role mis/Role=NULL/Capability=NULL                                 
2009-05-18 10:43:10 :INFO :Thread-1468691: User                                                               
/DC=org/DC=doegrids/OU=People/CN=Aashish Sharma 513862                                                        
2009-05-18 10:43:10 :INFO :Thread-1468691: Cert                                                               
/DC=org/DC=DOEGrids/OU=Certificate Authorities/CN=DOEGrids CA 1                                               
2009-05-18 10:43:10 :INFO :Thread-1468691: Sending to client N                                                
                                                                                                              
fg6x3:                                                                                                        
                                                                                                              
[chadwick@fg6x3 ~]$ grep 'Aashish Sharma 513862'                                                              
/usr/local/vdt/saz/server/log/sazserver.log                                                                   
2009-05-18 09:41:32 :INFO :Thread-1624621: User                                                               
/DC=org/DC=doegrids/OU=People/CN=Aashish Sharma 513862                                                        
2009-05-18 09:41:33 :INFO :Thread-1624622: User                                                               
/DC=org/DC=doegrids/OU=People/CN=Aashish Sharma 513862                                                        
2009-05-18 09:41:37 :INFO :Thread-1624625: User                                                               
/DC=org/DC=doegrids/OU=People/CN=Aashish Sharma 513862                                                        
2009-05-18 10:39:32 :INFO :Thread-1627328: User                                                               
/DC=org/DC=doegrids/OU=People/CN=Aashish Sharma 513862                                                        
2009-05-18 10:44:33 :INFO :Thread-1627776: User                                                               
/DC=org/DC=doegrids/OU=People/CN=Aashish Sharma 513862                                                        
                                                                                                              
[chadwick@fg6x3 ~]$ grep 'Thread-1624621'                                                                     
/usr/local/vdt/saz/server/log/sazserver.log                                                                   
2009-05-18 09:41:32 :INFO :Thread-1624621: Received SAZclient                                                 
authorization request from 131.225.166.2 : fnpcosg1.fnal.gov                                                  
2009-05-18 09:41:32 :INFO :Thread-1624621: VO mis                                                             
2009-05-18 09:41:32 :INFO :Thread-1624621: Role mis/Role=NULL/Capability=NULL                                 
2009-05-18 09:41:32 :INFO :Thread-1624621: User                                                               
/DC=org/DC=doegrids/OU=People/CN=Aashish Sharma 513862           
2009-05-18 09:41:32 :INFO :Thread-1624621: Cert                                                               
/DC=org/DC=DOEGrids/OU=Certificate Authorities/CN=DOEGrids CA 1                                               
2009-05-18 09:41:32 :INFO :Thread-1624621: Sending to client Y                                                
                                                                                                              
[chadwick@fg6x3 ~]$ grep 'Thread-1624622'                                                                     
/usr/local/vdt/saz/server/log/sazserver.log                                                                   
2009-05-18 09:41:33 :INFO :Thread-1624622: Received SAZclient                                                 
authorization request from 131.225.166.2 : fnpcosg1.fnal.gov                                                  
2009-05-18 09:41:33 :INFO :Thread-1624622: VO mis                                                             
2009-05-18 09:41:33 :INFO :Thread-1624622: Role mis/Role=NULL/Capability=NULL                                 
2009-05-18 09:41:33 :INFO :Thread-1624622: User                                                               
/DC=org/DC=doegrids/OU=People/CN=Aashish Sharma 513862                                                        
2009-05-18 09:41:33 :INFO :Thread-1624622: Cert                                                               
/DC=org/DC=DOEGrids/OU=Certificate Authorities/CN=DOEGrids CA 1                                               
2009-05-18 09:41:33 :INFO :Thread-1624622: Sending to client Y                                                
                                                                                                              
[chadwick@fg6x3 ~]$ grep 'Thread-1624625'                                                                     
/usr/local/vdt/saz/server/log/sazserver.log                                                                   
2009-05-18 09:41:37 :INFO :Thread-1624625: Received SAZclient                                                 
authorization request from 131.225.166.2 : fnpcosg1.fnal.gov                                                  
2009-05-18 09:41:37 :INFO :Thread-1624625: VO mis                                                             
2009-05-18 09:41:37 :INFO :Thread-1624625: Role mis/Role=NULL/Capability=NULL                                 
2009-05-18 09:41:37 :INFO :Thread-1624625: User                                                               
/DC=org/DC=doegrids/OU=People/CN=Aashish Sharma 513862                                                        
2009-05-18 09:41:37 :INFO :Thread-1624625: Cert                                                               
/DC=org/DC=DOEGrids/OU=Certificate Authorities/CN=DOEGrids CA 1                                               
2009-05-18 09:41:37 :INFO :Thread-1624625: Sending to client Y                                                
                                                                                                              
[chadwick@fg6x3 ~]$ grep 'Thread-1627328'                                                                     
/usr/local/vdt/saz/server/log/sazserver.log                                                                   
2009-05-18 10:39:31 :INFO :Thread-1627328: Received SAZclient                                                 
authorization request from 131.225.166.2 : fnpcosg1.fnal.gov                                                  
2009-05-18 10:39:32 :INFO :Thread-1627328: VO mis                                                             
2009-05-18 10:39:32 :INFO :Thread-1627328: Role mis/Role=NULL/Capability=NULL                                 
2009-05-18 10:39:32 :INFO :Thread-1627328: User                                                               
/DC=org/DC=doegrids/OU=People/CN=Aashish Sharma 513862     
2009-05-18 10:39:32 :INFO :Thread-1627328: Cert                                                               
/DC=org/DC=DOEGrids/OU=Certificate Authorities/CN=DOEGrids CA 1                                               
2009-05-18 10:39:32 :INFO :Thread-1627328: Sending to client N                                                
                                                                                                              
[chadwick@fg6x3 ~]$ grep 'Thread-1627776'                                                                     
/usr/local/vdt/saz/server/log/sazserver.log                                                                   
2009-05-18 10:44:33 :INFO :Thread-1627776: Received SAZclient                                                 
authorization request from 131.225.166.2 : fnpcosg1.fnal.gov                                                  
2009-05-18 10:44:33 :INFO :Thread-1627776: VO mis                                                             
2009-05-18 10:44:33 :INFO :Thread-1627776: Role mis/Role=NULL/Capability=NULL                                 
2009-05-18 10:44:33 :INFO :Thread-1627776: User                                                               
/DC=org/DC=doegrids/OU=People/CN=Aashish Sharma 513862                                                        
2009-05-18 10:44:33 :INFO :Thread-1627776: Cert                                                               
/DC=org/DC=DOEGrids/OU=Certificate Authorities/CN=DOEGrids CA 1                                               
2009-05-18 10:44:33 :INFO :Thread-1627776: Sending to client N                                                
                                                                                                              
-Keith.                                                                                                       
                   

</verbatim>

---++ Network flows 

<verbatim>
>Original-recipient: rfc822;chadwick@imapserver2.fnal.gov                                                     
>Date: Mon, 18 May 2009 11:57:04 -0500                                                                        
>From: Tim Rupp <tarupp@fnal.gov>                                                                             
>Subject: Re: Fwd: Re: Fwd: Re: [THIS IS A SECURITY DRILL] Incident                                           
>Notification                                                                                                 
>To: Keith Chadwick <chadwick@fnal.gov>                                                                       
>Cc: computer-security@fnal.gov                                                                               
>X-Enigmail-Version: 0.95.7                                                                                   
>                                                                                                             
>Netflow for fermi and 141 ips as both src and dst attached.                                                  
>                                                                                                             
>Tim Rupp wrote:                                                                                              
>> collecting it now, will send it zipped in a second.                                                        
>>                                                                                                            
>> -Tim                                                                                                       
>>                                                                                                            
>> Keith Chadwick wrote:                                                                                      
>>> Tim,                                                                                                      
>>>                                                                                                           
>>> We will also need any offsite netflow information from/to fnpc350.                                        
>>>                                                                                                           
>>> -Keith.                                                                                                   
>>>                                                                                                           
>>> At 11:25 AM -0500 5/18/09, Tim Rupp wrote:                                                                
>>>> Here's netflow from that IP                                                                              
>>>>                                                                                                          
>>>>                                                                                                          
>>>>                                                                                                          
>>>>                                                                                                          
>>>>                                                                                                          
>>>>                                                                                                          
>>>>                                                                                                          
>>>>                                                                                                          
>>>>                                                                                                          
>>>> Running command: /usr/local/netflow/bin/netflow.pl -r r-s-bdr -s                                         
>>>> 141.142.234.178 -sd 05-18-2009 -st 00:00:00 -ed 05-18-2009 -et 23:59:59                                  
>>>> -F /tmp/http-1242663553.flt                                                                              
>>>>                                                                                                          
>>>> Command=web:netflow.pl -r r-s-bdr -s 141.142.234.178 -sd 05-18-2009 -st                                  
>>>> 00:00:00 -ed 05-18-2009 -et 23:59:59 -F /tmp/http-1242663553.flt                                         
>>>> Start             End               Sif   SrcIPaddress    SrcP  DIf                                      
>>>> DstIPaddress    DstP    P Fl Pkts       Octets                                                           
>>>> 0518.00:01:31.538 0518.00:01:31.538 58    141.142.234.178 36475 94                                       
>>>> 131.225.70.20   80    6   0  7          449                                                              
>>>> 0518.00:07:02.607 0518.00:07:02.671 58    141.142.234.178 42424 94                                       
>>>> 131.225.107.213 80    6   0  8          1321                                                             
>>>> 0518.00:17:03.946 0518.00:17:03.946 58    141.142.234.178 52869 94                                       
>>>> 131.225.107.213 80    6   0  8          1321                                                             
>>>> 0518.00:27:02.472 0518.00:27:02.536 58    141.142.234.178 60472 94                                       
>>>> 131.225.107.213 80    6   0  8          1321                                                             
>>>> 0518.00:37:02.656 0518.00:37:02.656 58    141.142.234.178 38228 94                                       
>>>> 131.225.107.213 80    6   0  8          1321                            
>>>> 131.225.107.213 80    6   0  8          1321                                                             
>>>> 0518.00:47:03.486 0518.00:47:03.550 58    141.142.234.178 43431 94                                       
>>>> 131.225.107.213 80    6   0  8          1321                                                             
>>>> 0518.00:57:02.841 0518.00:57:02.905 58    141.142.234.178 42199 94                                       
>>>> 131.225.107.213 80    6   0  8          1321                                                             
>>>> 0518.01:07:02.836 0518.01:07:02.900 58    141.142.234.178 53667 94                                       
>>>> 131.225.107.213 80    6   0  8          1321                                                             
>>>> 0518.01:17:04.110 0518.01:17:04.110 58    141.142.234.178 50385 94                                       
>>>> 131.225.107.213 80    6   0  8          1321                                                             
>>>> 0518.01:26:17.705 0518.01:26:18.601 58    141.142.234.178 45825 94                                       
>>>> 131.225.107.140 8443  6   0  53         5801                                                             
>>>> 0518.01:26:18.987 0518.01:26:19.307 58    141.142.234.178 45826 94                                       
>>>> 131.225.107.140 8443  6   0  64         6373                                                             
>>>> 0518.01:26:20.779 0518.01:26:20.907 58    141.142.234.178 45829 94                                       
>>>> 131.225.107.140 8443  6   0  15         3857                                                             
>>>> 0518.01:26:35.433 0518.01:26:35.561 58    141.142.234.178 45847 94                                       
>>>> 131.225.107.140 8443  6   0  15         3825                                                             
>>>> 0518.01:26:36.202 0518.01:26:36.330 58    141.142.234.178 56094 94                                       
>>>> 131.225.107.138 8443  6   0  16         3893                                                             
>>>> 0518.01:26:32.169 0518.01:26:32.681 58    141.142.234.178 45835 94                                       
>>>> 131.225.107.140 8443  6   0  43         5281                                                             
>>>> 0518.01:26:33.384 0518.01:26:33.448 58    141.142.234.178 45837 94                                       
>>>> 131.225.107.140 8443  6   0  19         4065                                                             
>>>> 0518.01:26:34.027 0518.01:26:34.155 58    141.142.234.178 45842 94                                       
>>>> 131.225.107.140 8443  6   0  15         3857                                                             
>>>> 0518.01:26:34.538 0518.01:26:34.666 58    141.142.234.178 45845 94                                       
>>>> 131.225.107.140 8443  6   0  16         3877                                                             
>>>> 0518.01:26:38.890 0518.01:26:39.018 58    141.142.234.178 45857 94                                       
>>>> 131.225.107.140 8443  6   0  16         3877                                                             
>>>> 0518.01:27:09.227 0518.01:27:09.355 58    141.142.234.178 44693 94                                       
>>>> 131.225.107.213 80    6   0  8          1321                                                             
>>>> 0518.01:57:02.750 0518.01:57:02.750 58    141.142.234.178 35388 94                                       
>>>> 131.225.107.213 80    6   0  8          1321                                                             
>>>> 0518.02:07:02.868 0518.02:07:02.932 58    141.142.234.178 41056 94                                       
>>>> 131.225.107.213 80    6   0  8          1321                                                             
>>>> 0518.02:17:03.377 0518.02:17:03.441 58    141.142.234.178 57396 94                                       
>>>> 131.225.107.213 80    6   0  8          1321                                                             
>>>> 0518.02:26:38.092 0518.02:26:38.156 58    141.142.234.178 56311 94                                       
> >>> 131.225.70.20   80    6   0  7          449                                                             
>>>> 0518.02:27:02.669 0518.02:27:02.733 58    141.142.234.178 43447 94                                       
>>>> 131.225.107.213 80    6   0  8          1321                                                             
> >>> 0518.02:37:02.859 0518.02:37:02.923 58    141.142.234.178 48059 94                                      
>>>> 131.225.107.213 80    6   0  8          1321                                                             
>>>> 0518.02:47:03.425 0518.02:47:03.489 58    141.142.234.178 44941 94                                       
>>>> 131.225.107.213 80    6   0  8          1321                                                             
>>>> 0518.02:57:03.681 0518.02:57:03.681 58    141.142.234.178 39708 94                                       
>>>> 131.225.107.213 80    6   0  8          1321                                                             
>>>> 0518.03:07:03.228 0518.03:07:03.292 58    141.142.234.178 33226 94                                       
>>>> 131.225.107.213 80    6   0  8          1321                                                             
>>>> 0518.03:17:04.375 0518.03:17:04.375 58    141.142.234.178 40087 94                                       
>>>> 131.225.107.213 80    6   0  8          1321                                                             
>>>> 0518.03:27:02.768 0518.03:27:02.832 58    141.142.234.178 35601 94      
>>>> 0518.10:49:33.537 0518.10:49:34.433 58    141.142.234.178 9602  94                                       
>>>> 131.225.166.2   2119  6   0  15         8780                                                             
>>>> 0518.10:57:03.390 0518.10:57:03.454 58    141.142.234.178 39344 94                                       
>>>> 131.225.107.213 80    6   0  8          1320                                                             
>>>> 0518.11:07:03.960 0518.11:07:04.024 58    141.142.234.178 36552 94                                       
>>>> 131.225.107.213 80    6   0  8          1320                                                             
>>>> 0518.11:17:04.278 0518.11:17:04.342 58    141.142.234.178 59702 94                                       
>>>> 131.225.107.213 80    6   0  8          1320                                                             
>>>>                                                                                                          
>>>>                                                                                                          
>>>>                                                                                                          
>>>>                                                                   

</verbatim>


---++ Submitted Netflows 

<verbatim>
Archive:  /tmp/netflow.zip                                                                                    
 Length   Method    Size  Ratio   Date   Time   CRC-32    Name                                                
--------  ------  ------- -----   ----   ----   ------    ----                                                
  153881  Defl:N    20807  87%  05-18-09 11:55  d967fb3c  netflow-141.142.234.178-and-131.225.167.30.txt      
--------          -------  ---                            -------                                             
  153881            20807  87%                            1 file    

</verbatim>


---++ Malware Analysis
Here are the files that the attacker was running.   

<verbatim>

>>>> Keith Chadwick wrote:                                                                                    
>>>>>  Here are the files that the attacker was running.                                                      
>>>>>                                                                                                         
>>>>>  -Keith.                                                                                                
>>>>>                                                                                                         
>>>>>>  Original-recipient: rfc822;chadwick@imapserver2.fnal.gov                                              
>>>>>>  Date: Mon, 18 May 2009 11:03:46 -0500 (CDT)                                                           
>>>>>>  From: Steven Timm <timm@fnal.gov>                                                                     
>>>>>>  Subject: Re: Fwd: Re: [THIS IS A SECURITY DRILL] Incident                                             
>>>>>>  Notification                                                                                          
>>>>>>  To: Keith Chadwick <chadwick@fnal.gov>                                                                
>>>>>>                                                                                                        
>>>>>>  Terminated.                                                                                           
>>>>>>  All executables were first saved.                                                                     
>>>>>>  Attached in incident.tar                                                                              
>>>>>>                                                                                                        
>>>>>>  Attack came from 141.142.234.178 at 09:41.                                                            
>>>>>>                                                                                                        
>>>>>>  [root@fnpc3x1 log]# cat /root/.incident_script                                                        
>>>>>>  [root@fnpc3x1 lib]# condor_q mis                                                                      
>>>>>>                                                                                                        
>>>>>>                                                                                                        
>>>>>>  -- Quill: quill@fnpcosg1.fnal.gov : <131.225.166.5:5432> : quill :                                    
>>>>>>  2009-05-18 10:51:55-05                                                                                
>>>>>>   ID      OWNER            SUBMITTED     RUN_TIME ST PRI SIZE CMD                                      
>>>>>>  939637.0   mis             5/18 09:41   0+01:10:08 R  0   14.6 data                                   
>>>>>>                                                                                                        
>>>>>>  1 jobs; 0 idle, 1 running, 0 held                                                                     
>>>>>>  [root@fnpc3x1 lib]# condor_q -l mis | grep x509userproxysubject                                       
> >>>>>  x509userproxysubject = "/DC=org/DC=doegrids/OU=People/CN=Aashish                                     
>>>>>>  Sharma 513862"                                                                                        
>>>>>>  [root@fnpc3x1 lib]# condor_rm 939637                                                                  
>>>>>>  Cluster 939637 has been marked for removal.        
> >>>>>  [root@fnpc3x1 lib]# condor_q mis                                                                     
>>>>>>                                                                                                        
>>>>>>  Job ran on fnpc350.fnal.gov,                                                                          
>>>>>>  which has been cleaned up of all files that the process brought in.                                   
>>>>>>  More summary available as necessary.                                                                  
>>>>>>                                                                                                        
>>>>>>  Steve Timm                                                                                            
>>>>>>                                                                                                        
>>>>>>                                                                                                        
>>>>>>  On Mon, 18 May 2009, Keith Chadwick wrote:                                                            
>>>>>>                                                                                                        
>>>>>>>  Steve,                                                                                               
>>>>>>>                                                                                                       
>>>>>>>  Please terminate any processes from this user.                                                       
>>>>>>>                                                                                                       
>>>>>>>  -Keith.                                                                                              
>>>>>>>                
</verbatim>


---++ Detailed analysis 

<verbatim>

Date: Mon, 18 May 2009 14:15:21 -0500                                                                         
From: Keith Chadwick <chadwick@fnal.gov>                                                                      
Subject: Re: [THIS IS A SECURITY DRILL] Incident Notification                                                 
To: computer-security@fnal.gov, fermigrid-security@fnal.gov,                                                  
        security@OPENSCIENCEGRID.ORG, osg-security-team@OPENSCIENCEGRID.ORG                                   
Precedence: list                                                                

>Original-recipient: rfc822;chadwick@imapserver2.fnal.gov                                                     
>Date: Mon, 18 May 2009 12:46:00 -0500                                                                        
>From: Tim Rupp <tarupp@fnal.gov>                                                                             
>Subject: Re: Fwd: Re: Fwd: Re: [THIS IS A SECURITY DRILL] Incident                                           
>Notification                                                                                                 
>To: Keith Chadwick <chadwick@fnal.gov>                                                                       
>Cc: computer-security@fnal.gov                                                                               
>                                                                                                             
>There were hidden files in the directory as Steve noted.  

>                                                                                                             
>They were named using UUID as far as I can tell. All the files were                                          
>exactly the same according to md5sum. The files were                                                         
>                                                                                                             
>                                                                                                             
>                                                                                                             
>MD5: b51282bd5fd3b593566a673bcdb5fd4b                                                                        
>FILE: .aa6b0a6cb-ab24-4fb5-88f1-83ca12f1fa141242916910                                                       
>                                                                                                             
>                                                                                                             
>MD5: b51282bd5fd3b593566a673bcdb5fd4b                                                                        
>FILE: .e6fea9707-2cff-4a11-bb1b-55dc4757b5951242916910                                                       
>                                                                                                             
>                                                                                                             
>MD5: b51282bd5fd3b593566a673bcdb5fd4b                                                                        
>FILE: .e8ebb43a6-e920-4c5a-8379-afa44fc0233a1242916910                                                       
>                                                                                                             
>                                                                                                             
>MD5: b51282bd5fd3b593566a673bcdb5fd4b                                                                        
>FILE: .k12d7b363-df6e-4736-929b-9772d053647b1242916910                                                       
>                                                                                                             
>                                                                                                             
>                                                                                                             
>The strings of the files suggest that it is variety of stuff bundled                                         
>together.                                                                                                    
>                                                                                                             
>                                                                                                             
>                                                                                                             
>See the strings output below, then I'll explain  
>                                                                                                             
>LD_LIBRARY_PATH                                                                                              
>yyyy-mm-dd_hh:mm:ss                                                                                          
>SYSLOG_IDENT                                                                                                 
>EMAIL_REPORT                                                                                                 
>malloc(%d) failed (%d: %s)                                                                                   
>%Y-%m-%d_%H:%M:%S                                                                                            
>echo '%s UTC                                                                                                 
>%s/%s/%s                                                                                                     
>%s' | mail -nN -s 'SSC:%s/%s/%s' %s                                                                          
>unlink('%s') failed (%d: %s)                                                                                 
>unlink('%s')                                                                                                 
>exit(%d)                                                                                                     
>ALTERNATE_URL                                                                                                
>malloc(%d) failed (%d: %s)                                                                                   
>[%s:%05d:%s]%s                                                                                               
>[%05d]%s                                                                                                     
>wget --no-cache -o /dev/null -O                                                                              
>%s %s %s/%s.pl?%s=%s/%s/%s/id.%ld_%s                                                                         
>First attempt: system(%s)                                                                                    
>wget -o /dev/null -O                                                                                         
>Second attempt; system(%s)                                                                                   
>open(%s) failed (%d: %s)                                                                                     
>got cmd line '%s'                                                                                            
>malloc(%d) failed in createXname(%ld) (%d: %s)                                                               
>Kain                                                                                                         
>Abel                                                                                                         
>%s%s%ld                                                                                                      
>createXname(%ld)=>'%s'                                                                                       
>First                                                                                                        
>Last                                                                                                         
>DIRDEPTH                                                                                                     
>Could not eval. DIRDEPTH='%s'                                                                                
>Try directory:'%s'                                                                                           
>dirScan(): %ld/%ld directories listed  
>DIRPATHS                                                                                                     
>Try from PATH element:'%s'                                                                                   
>After Paths; dirDepth=%ld                                                                                    
>Gotcha %s %ld/%ld                                                                                            
>Reject directory: %s                                                                                         
>newArgv0[%ld/%ld]%s                                                                                          
>Cannot copy executable from '%s' to '%s' (%d: %s)                                                            
>Copied file from '%s' to '%s'                                                                                
>Cannot chmod(%s, %o) (%d: %s)                                                                                
>dirPick(..,%ld) randy=%ld failed                                                                             
>.attaboy                                                                                                     
>tryAt() Cannot open '%s' (%d: %s)                                                                            
>#!/bin/sh                                                                                                    
>%s %s %s >/dev/null 2>&1                                                                                     
>rm -f $0                                                                                                     
>chmod(%s) in tryAt() failed (%d: %s)                                                                         
>atScript:'%s'                                                                                                
>cat %s                                                                                                       
>at -f %s now + %d minutes                                                                                    
>atDenied                                                                                                     
>Name                                                                                                         
>atAccept[atdPid:%05d,%dmin]                                                                                  
>.cronos                                                                                                      
>%d %d * * * %s %s %s >/dev/null 2>&1                                                                         
>Crontab:                                                                                                     
>cat %s 1>&2                                                                                                  
>crontab %s >/dev/null                                                                                        
>fork of system(%s) failed (%d: %s)                                                                           
>cronDenied                                                                                                   
>crond                                                                                                        
>cronAccept[crondPid:%05d,%d:%.2d]                                                                            
>crontab -l                                                                                                   
>jumpLepus prepares list of writable directories                                                              
>dirScan failed                                                                                               
>dirCount() says there are no directories                                                                     
>dirList() failed (%ld)                         
>lepusJump: identified %ld friendly locations                                                                 
>Trying 'at'                                                                                                  
>Trying 'cron'                                                                                                
>fork() failed (%d: %s)                                                                                       
>Abel: transplantXPath(%s) to '%s' succeeded                                                                  
>execv(%s, ...) illicit return                                                                                
>transplantXPath(%s) failed                                                                                   
>Kain: transplantXPath(%s) to '%s' succeeded                                                                  
>Kain: Waiting for Abel @%ld                                                                                  
>Rendez-vous with Abel @%ld (q=%d)                                                                            
>execv(%s ...) failed (%d: %s)                                                                                
>execv(%s, ...) should never return                                                                           
>getcwd(%s) failed (%d:'%s')                                                                                  
>chdir(%s) failed (%d: %s)                                                                                    
>Old CWD='%s', New CWD='%s'                                                                                   
>./%s/%s                                                                                                      
>pid=%05d: %s execv(%s, ...)                                                                                  
>execv(%s, ...) failed (%d: %s)                                                                               
>execv(%s ...) illicit return                                                                                 
>Could not get CWD (%d:'%s')                                                                                  
>Could not chdir(%s)                                                                                          
>execv(%s ...)                                                                                                
>execv(%s ...) should never returned                                                                          
>Internal error; unknown GENESIS                                                                              
>[ppid:%05d,sid:%05d,uid:%d,siduid:%s]                                                                        
>%stimeLeft%+ld                                                                                               
>goon                                                                                                         
>exit                                                                                                         
>Prelude: Order to exit@%ld:timeLeft%+ld                                                                      
>Prelude: Unrecognized Cmd '%s'; exit@%ld:timeLeft%+ld                                                        
>Prelude: Could not get command                                                                               
>Stage=%d/Prelude; illicit return from lepusJump (%d)                                                         
>Stage != 2, but %d in Suite; internal error                                                                  
>Suite: Order to exit @%ld                                                                                    
>Suite: Unrecognized command:'%s'; exit @%ld                                                                  
>Suite cannot get cmd                  
>TIMEOUT_HOURS                                                                                                
>lepus                                                                                                        
>Environment does not contain '%s'                                                                            
>Cannot deduce timeOut time from '%s'                                                                         
>%s=%d timeOut=%ld[s]                                                                                         
>Warning; too many arguments in call of '%s'                                                                  
>main() sid=%05d                                                                                              
>             CWD: %s                                                                                         
>        argv[%02d]: %s                                                                                       
>             ROC: %s                                                                                         
>            Site: %s                                                                                         
>            DBUG: %d                                                                                         
>Adjusted CWD '%s'                                                                                            
>gethostname(%s, ...) failed                                                                                  
>gethostbyname(%s) failed (%d: %s)                                                                            
>Not an AF_INET type address                                                                                  
>gethostbyaddr() failed                                                                                       
>Enter@%ld                                                                                                    
>commute(%s) failed                                                                                           
>Order to exit; timeLeft%+ld                                                                                  
>Unrecognized cmd '%s'                                                                                        
>Prelude failure (%d)                                                                                         
>Stage2BreakOut:%d, q:%d, timeOut:%ld                                                                         
>Exit@%ld:timeLeft%+ld                                                                                        
>crontab -r >/dev/null 2>&1                                                                                   
>system(%s) (%d: %s)                                                                                          
>pB                                                                                                           
>Insert '%s' after '%s' (%ld)                                                                                 
>Remove '%s' between '%s' and '%s'                                                                            
>sym %s                                                                                                       
>Probing ownership: dirStep('%s', '%p', ..) prev='%s' mode=%o                                                 
>unreadable: '%s' modeMask:%07o modeStat:%07o st_mode:%07o                                                    
>Exceptional could not opendir('%s'); errno:%d '%s'                                                           
>writable: '%s' modeMask:%07o modeStat:%07o st_mode:%07o                                                      
>calloc() failed; errno:%d '%s'                                                                               
>Could not insert new directory element          
>Inserted '%s'                                                                                                
>List compromised (%d); bailing out                                                                           
>%ld     '%s'    mode:%lo mask:%lo                                                                            
>yyyy-mm-dd_hh:mm:ss                                                                                          
>%s%s                                                                                                         
>%3s %3s %d %s %d                                                                                             
>%s: %s                                                                                                       
>Need valid destination path; from: '%s' to:'%s'                                                              
>Cannot open file '%s' for write (%d: %s)                                                                     
>Cannot open file '%s' for read (%d: %s)                                                                      
>Cannot alloc buffer for file copy(%d)                                                                        
>Failure reading from file '%s' ... (%d: %s)                                                                  
>Failure writing to file '%s' ... (%d: %s)                                                                    
>SANCTION                                                                                                     
>=== List_our_brethren ===                                                                                    
>PPID === %d                                                                                                  
>Could not opendir(%s) (%d: %s)                                                                               
>%s/%s/stat                                                                                                   
>fopen('%s', 'r') (%d: %s)                                                                                    
>%d %s %1c %d                                                                                                 
>  |-- %d - %c - %s .                                                                                         
>Stat: %s                                                                                                     
>killed incriminating PID=%d                                                                                  
>Could not parse the Status Line:'%s'                                                                         
>===================                                                                                          
>0 0 0 0                                                                                                      
>getProcStatus(.., PID=%ld, tag='%s')                                                                         
>%s/%s/status                                                                                                 
>getProcStatus(): Testing path: '%s'                                                                          
>fopen('%s', 'r') failed (%d: %s)                                                                             
>getProcStatus(): Valid path: '%s'                                                                            
>chackStatusTagValue(..., tag=%s tagValue=%s                                                                  
>0123456789                                                                                                   
>fopen('%s', 'r') ...                                                                                         
>Checking '%s'                                                                                                
>DBUG                   
>Could not malloc() %d bytes (%d:'%s')                                                                        
>'%s' length=%d                                                                                               
>Processed %d elements from:                                                                                  
>'%s'                                                                                                         
>/dev/urandom                                                                                                 
>/dev/random                                                                                                  
>/var/lib/libuuid/clock.txt                                                                                   
>/usr/sbin/uuidd                                                                                              
>clock: %04x tv: %lu %lu adj: %d                                                                              
>%08x-%04x-%04x-%02x%02x-%02x%02x%02x%02x%02x%02x                                                             
>%08X-%04X-%04X-%02X%02X-%02X%02X%02X%02X%02X%02X                                                             
>localhost                                                                                                    
>)>]}                                                                                                         
>(<[{                                                                                                         
>1234567890                                                                                                   
>; bailing out                                                                                                
>Site                                                                                                         
>GENESIS                                                                                                      
>Congratulations! If you can read this, then you have qualified for the                                       
>SSC_3 raffle.                                                                                                
>/proc                                                                                                        
>                                                                                                             
>                                                                                                             
>                                                                                                             
>                                                                                                             
>                                                                                                             
>                                                                                                             
>Maybe these are binary log files or something. Anyway, here's the rundown.                                   
>                                                                                                             
>                                                                                                             
>Some mail gets sent                                                                                          
>                                                                                                             
>echo '%s UTC                                                                                                 
>%s/%s/%s                                                                                                     
>%s' | mail -nN -s 'SSC:%s/%s/%s' %s    
>A URL is tried with wget                                                                                     
>                                                                                                             
>                                                                                                             
>                                                                                                             
>wget --no-cache -o /dev/null -O                                                                              
>%s %s %s/%s.pl?%s=%s/%s/%s/id.%ld_%s                                                                         
>First attempt: system(%s)                                                                                    
>wget -o /dev/null -O                                                                                         
>Second attempt; system(%s)                                                                                   
>open(%s) failed (%d: %s)                                                                                     
>got cmd line '%s'                                                                                            
>                                                                                                             
>                                                                                                             
>                                                                                                             
>                                                                                                             
>and of course the sprintf of that URL probably sends you right to the                                        
>fnpc url I mentioned earlier.                                                                                
>                                                                                                             
>                                                                                                             
>                                                                                                             
>another hidden file, .attaboy is run; it's a shell script. It's contents are                                 
>                                                                                                             
>                                                                                                             
>#!/bin/sh                                                                                                    
>/var/tmp/.e8ebb43a6-e920-4c5a-8379-afa44fc0233a1242916910 OSG FNAL                                           
>>/dev/null 2>&1                                                                                              
>rm -f $0                                                                                                     
>                                                                                                             
>                                                                                                             
>                                                                                                             
>.attaboy                                                                                                     
>tryAt() Cannot open '%s' (%d: %s)                                                                            
>#!/bin/sh                                 
>%s %s %s >/dev/null 2>&1                                                                                     
>rm -f $0                                                                                                     
>                                                                                                             
>                                                                                                             
>                                                                                                             
>                                                                                                             
>an at command is scheduled                                                                                   
>                                                                                                             
>                                                                                                             
>                                                                                                             
>                                                                                                             
>atScript:'%s'                                                                                                
>cat %s                                                                                                       
>at -f %s now + %d minutes                                                                                    
>atDenied                                                                                                     
>Name                                                                                                         
>atAccept[atdPid:%05d,%dmin]                                                                                  
>.cronos                                                                                                      
>%d %d * * * %s %s %s >/dev/null 2>&1                                                                         
>                                                                                                             
>                                                                                                             
>                                                                                                             
>If you refer to my earlier URL                                                                               
>                                                                                                             
>                                                                                                             
>http://rooier.nikhef.nl/ssc3/logs/Depot/OSG/FNAL/fnpc350.fnal.gov/id.1242916910/Stamp/Log                    
>                                                                                                             
>                                                                                                             
>You'll see this kind of stuff in the strings file                                                            
>                                                                                                             
>                                                                                                             
>cronAccept[crondPid:%05d,%d:%.2d]                                                                            
>crontab -l                                                                                                   
>                                                                                                             
>                                                                                                             
>which is also, conveniently located in the Log file above. hmm.... 
>                                                                                                             
>                                                                                                             
>                                                                                                             
>Tries to run Kain and abel (password cracker), but fails                                                     
>                                                                                                             
>                                                                                                             
>                                                                                                             
>fork() failed (%d: %s)                                                                                       
>Abel: transplantXPath(%s) to '%s' succeeded                                                                  
>execv(%s, ...) illicit return                                                                                
>transplantXPath(%s) failed                                                                                   
>Kain: transplantXPath(%s) to '%s' succeeded                                                                  
>Kain: Waiting for Abel @%ld                                                                                  
>Rendez-vous with Abel @%ld (q=%d)                                                                            
>execv(%s ...) failed (%d: %s)                                                                                
>execv(%s, ...) should never return                                                                           
>                                                                                                             
>                                                                                                             
>                                                                                                             
>The we see the "goon" command as we saw in the cmd file                                                      
>                                                                                                             
>                                                                                                             
>goon                                                                                                         
>exit                                                                                                         
>Prelude: Order to exit@%ld:timeLeft%+ld                                                                      
>Prelude: Unrecognized Cmd '%s'; exit@%ld:timeLeft%+ld                                                        
>Prelude: Could not get command                                                                               
>Stage=%d/Prelude; illicit return from lepusJump (%d)                                                         
>Stage != 2, but %d in Suite; internal error                                                                  
>Suite: Order to exit @%ld                                                                                    
>Suite: Unrecognized command:'%s'; exit @%ld                                                                  
>Suite cannot get cmd                                                                                         
>                                                                                                             
>                                                    
>then the output of the .e8... hidden file (I know because I ran it in a VM)                                  
>                                                                                                             
>                                                                                                             
>TIMEOUT_HOURS                                                                                                
>lepus                                                                                                        
>Environment does not contain '%s'                                                                            
>                                                                                                             
>                                                                                                             
>                                                                                                             
>Tries to get the hostname of the machine, fails and axes the crontab                                         
>file, destroying the content that it has just inserted into it.                                              
>                                                                                                             
>                                                                                                             
>                                                                                                             
>gethostname(%s, ...) failed                                                                                  
>gethostbyname(%s) failed (%d: %s)                                                                            
>Not an AF_INET type address                                                                                  
>gethostbyaddr() failed                                                                                       
>Enter@%ld                                                                                                    
>commute(%s) failed                                                                                           
>Order to exit; timeLeft%+ld                                                                                  
>Unrecognized cmd '%s'                                                                                        
>Prelude failure (%d)                                                                                         
>Stage2BreakOut:%d, q:%d, timeOut:%ld                                                                         
>Exit@%ld:timeLeft%+ld                                                                                        
>crontab -r >/dev/null 2>&1                                                                                   
>system(%s) (%d: %s)                                                                                          
>pB                                                                                                           
>                                                                                                             
>                                                                                                             
>                                                                                                             
>                                                                                                             
>Starts walking a directory looking for writable stuff                                                        
>                                                                                                             
>                                                                                                             
>Probing ownership: dirStep('%s', '%p', ..) prev='%s' mode=%o            
>unreadable: '%s' modeMask:%07o modeStat:%07o st_mode:%07o                                                    
>Exceptional could not opendir('%s'); errno:%d '%s'                                                           
>writable: '%s' modeMask:%07o modeStat:%07o st_mode:%07o                                                      
>                                                                                                             
>                                                                                                             
>Lists compromised directories.                                                                               
>                                                                                                             
>                                                                                                             
>Inserted '%s'                                                                                                
>List compromised (%d); bailing out                                                                           
>%ld     '%s'    mode:%lo mask:%lo                                                                            
>yyyy-mm-dd_hh:mm:ss                                                                                          
>%s%s                                                                                                         
>%3s %3s %d %s %d                                                                                             
>%s: %s                                                                                                       
>Need valid destination path; from: '%s' to:'%s'                                                              
>                                                                                                             
>                                                                                                             
>                                                                                                             
>kills child processes                                                                                        
>                                                                                                             
>                                                                                                             
>=== List_our_brethren ===                                                                                    
>PPID === %d                                                                                                  
>Could not opendir(%s) (%d: %s)                                                                               
>%s/%s/stat                                                                                                   
>fopen('%s', 'r') (%d: %s)                                                                                    
>%d %s %1c %d                                                                                                 
>  |-- %d - %c - %s .                                                                                         
>Stat: %s                                                                                                     
>killed incriminating PID=%d                                                                                  
>Could not parse the Status Line:'%s'                                                                         
>                                                                                                             
>                                                                                                             
>                                                                                                             
>And not really sure what its doing here. I guess there's the UUID    
>generation for you. UUIDD is the UUID daemon                                                                 
>                                                                                                             
>Processed %d elements from:                                                                                  
>'%s'                                                                                                         
>/dev/urandom                                                                                                 
>/dev/random                                                                                                  
>/var/lib/libuuid/clock.txt                                                                                   
>/usr/sbin/uuidd                                                                                              
>clock: %04x tv: %lu %lu adj: %d                                                                              
>%08x-%04x-%04x-%02x%02x-%02x%02x%02x%02x%02x%02x                                                             
>%08X-%04X-%04X-%02X%02X-%02X%02X%02X%02X%02X%02X                                                             
>localhost                                                                                                    
>)>]}                                                                                                         
>(<[{                                                                                                         
>1234567890                                                                                                   
>; bailing out                                                                                                
>Site                                                                                                         
>GENESIS                                                                                                      
>Congratulations! If you can read this, then you have qualified for                                           
>the SSC_3 raffle.                                                                                            
>/proc                                                                                                        
>                                                                                                             
>                                                                                                             
>                                                                                                             
>And I guess we qualify for the SSC_3 raffle.                                                                 
>                                                                                                             
>                                                                                                             
>-Tim                                                                                                         
>                                                                                                             
>                                                                                                             
>Tim Rupp wrote:                                                                                              
>>Netflow for fermi and 141 ips as both src and dst attached.                                                 
>>                                                                                                            
>>Tim Rupp wrote:                                                                                             
>>>collecting it now, will send it zipped in a second.        
>>                                                                                                           
>>>-Tim                                                                                                       
>>>                                                                                                           
>>>Keith Chadwick wrote:                                                                                      
>>>>Tim,                                                                                                      
>>>>                                                                                                          
>>>>We will also need any offsite netflow information from/to fnpc350.                                        
>>>>                                                                                                          
>>>>-Keith.                                                                                                   
>>>>                                                                                                          
>>>>At 11:25 AM -0500 5/18/09, Tim Rupp wrote:                                                                
>>>>>Here's netflow from that IP                

</verbatim>




---++ End of Challenge 

<verbatim>

Hello GoC:                                                                                                    
                                                                                                              
Security challenge for Fermi Lab is over. They have submitted reports as desired. Please close this ticket.   
                                                                                                              
Thanks,                                                                                                       
Aashish                                                                                                       
                                                                                                              
On Mon, May 18, 2009 at 03:21:52PM -0400, Grid Operations Center wrote:    

</verbatim>



-- Main.AashishSharma - 27 May 2009