%META:TOPICINFO{author="KyleGross" date="1480453380" format="1.1" version="1.10"}%
%META:TOPICPARENT{name="SecurityTeamTeamWorkingArea"}%
%TOC%

---+ Incident Response Communication in OSG

The OSG Computer SecurityTeam Incident Response Team (CSIRT) requires mechanisms to facilitate the appropriate handling of sensitive and private data related to computer security incidents.
Essential components of these mechanisms include authentication (to verify the identity of incident responders), access control (to ensure that sensitive and private incident data is accessible only to responders involved in an incident on a need-to-know basis), and encryption (to avoid eavesdropping on sensitive and private data at rest and as it moves across the network).
Sensitive data must be protected from disclosure to adversaries who may use it to attack systems and disrupt the incident response process.
Private data about users must be protected from disclosure to avoid identity theft and other personal privacy invasions.

This page documents available mechanisms and proposes the adoption of new mechanisms and procedures.
This is a draft for discussion and does not represent official OSG policy.

---++ Incident Reporting

The email address for reporting security incidents to OSG is security@opensciencegrid.org.
An [[https://twiki.grid.iu.edu/twiki/bin/view/Documentation/IncidentDiscoveryReporting][Incident Reporting Form]] is also available.
On submission, the form posts a cleartext email message to the current OSG security officer.

Current best practice for CSIRTs is to publish a public key for receiving encrypted security incident reports.
For example:
   * http://www.cert.org/contact_cert/encryptmail.html
   * http://www.us-cert.gov/pgp/email.html
   * http://www.redhat.com/security/team/key/
   * http://www.apple.com/support/security/pgp/
Supporting encrypted incident reports would encourage appropriate disclosure of incident information to the OSG CSIRT.
Without an avenue for encrypted communication with the OSG CSIRT, incident reporters may be barred by local policy from sharing incident logs and other sensitive/private incident details with OSG.

*RECOMMENDATIONS*
   * Publish a public PGP key and S/MIME certificate for security@opensciencegrid.org. OSG GOC personnel should have access to the associated private key(s) for decrypting incoming messages.
   * The Incident Reporting Form should be modified to use HTTPS POST rather than cleartext email.

---++ SecurityTeam Advisories

SecurityTeam advisories and other announcements and instructions from OSG security and operations personnel must be trustworthy.
OSG security and operations personnel may require prompt action by site administrators for containment of a security incident.
Furthermore, site administrators should be protected from phishing attacks or other security exploits that involve spoofed messages claiming to come from OSG personnel.
Digitally signing these messages would allow recipients to verify their authenticity.
PGP is the most common method for digitally signing security advisories.

*RECOMMENDATIONS*
   * OSG security and operations personnel should digitally sign messages containing official security advisories, announcements, and instructions using PGP and/or S/MIME.
   * OSG should publish a policy stating that official messages will be digitally signed and should provide instructions for recipients for verifying the digital signatures.

---++ Incident Tracking

An incident tracking system is a critical tool for incident investigations.
When an incident is reported, the CSIRT creates a new "ticket" in the tracking system, assigning the incident an identification number.
CSIRT members record the investigation progress and status updates in the tracking system.

The OSG GOC uses the !FootPrints system for helpdesk ticket tracking.
It would be convenient to also use this system for incident tracking.
However, we must first examine the security of the !FootPrints system.
!FootPrints provides both web and email interfaces.
The web interface is accessible via username/password login over HTTPS.
The email interfaces supports submission and notification of ticket updates.
!FootPrints can be customized regarding what information is included in email notifications.

*RECOMMENDATIONS*
   * OSG should use the !FootPrints system for incident tracking. (This is already current practice.)
   * The !FootPrints email notification configuration should be customized so that sensitive incident information is not included in cleartext email messages. One option is to simply disable email notifications for security incident tickets in !FootPrints. Another option is to classify some ticket fields (such as Title) as public and others (such as Description) as private and only include information from public fields in incident notifications.
   * !FootPrints user privileges should be set appropriately for incident response tickets. (This requires further investigation.)

%BLUE%
*Comments*
   * Is it sufficient privacy for incident information in Footprints if all users with Footprints login can see it, or should it be more restrictive?
%ENDCOLOR%

---++ Incident Workspace

An incident workspace, where incident information can be securely maintained, can complement the incident tracking system.
Incident responders use the tracking system to log their progress on an incident, while maintaining up-to-date incident notes and evidence in the workspace.
One best practice is to have a README for the incident in the workspace that contains the latest information about the scope of the incident and the actions that personnel should take to contain the incident and monitor for spread of the incident.
The README would include a description of the attack vector, a list of compromised accounts/credentials, a list of vulnerable software and updates/patches to be applied, and a list of log messages and/or network traffic to look for to detect a compromise.
The README is particularly useful when new incident responders join an incident investigation in progress (because, for example, it has been discovered that a compromise has spread to a new site).

The OSG twiki could be used for incident workspaces, leveraging [[http://twiki.org/cgi-bin/view/TWiki/TWikiAccessControl][TWikiAccessControl]] to create web spaces with access restricted to only those involved in the incident.
The twiki already uses HTTPS for network encryption.

*ISSUES*
   * Kyle has indicated that the OSG twiki is "not secure enough" for this use. Do we need to setup another service for this?
   * Managing twiki groups for incident response could be cumbersome. It would be better if we could create a twiki group automatically from the list of security contacts in OIM.

*RECOMMENDATIONS*
   * Use of the twiki for incident response requires further study.

---++ Email Discussions

The INCIDENT-REPORT-L mailing list is available for initial incident reporting among primary grid security contacts for sites and support centers.
The INCIDENT-DISCUSS-L mailing list is available for discussion of reported incidents, with the same members as INCIDENT-REPORT-L plus other grid security contacts.
Posts to these lists should be PGP signed according to current policy.
Access to the list archives at http://listserv.fnal.gov/archives/incident-discuss-l.html is available to subscribers via (cleartext) authentication by email address and LISTSERV password.
The incident report list does not appear to be archived.

Managing encryption keys for email lists can be a challenge.
NCSA could host PGP-based Secure Email List Service ([[http://sels.ncsa.uiuc.edu/][SELS]]) lists for OSG.
SELS provides email list encryption using standard PGP email plugins (i.e., list subscribers don't need to install any new software).
A unique feature of SELS is that only the list members can decrypt the messages, not the list server, so less trust is required in the list server than in other mailing list encryption systems.
The !TeraGrid CSIRT is currently using SELS in a pilot phase.
Alternatives to SELS include [[http://www.sympa.org/manual/x509][Sympa]] (S/MIME) and the [[http://non-gnu.uvt.nl/mailman-ssls/][SURFnet Secure List Server]] (PGP and S/MIME).

*RECOMMENDATIONS*
   * The OSG security team should review the membership of the INCIDENT-REPORT-L and INCIDENT-DISCUSS-L lists periodically.
   * Membership in the INCIDENT-DISCUSS-L list should be automatically maintained to include the current security contacts in OIM.
   * The INCIDENT-DISCUSS-L list archives should be accessible only via HTTPS.
   * The SecurityTeam Team and GOC should investigate the use of encrypted email lists.

---++ Instant Messaging

Chat or instant messaging services can facilitate real-time communication between incident responders.
A dedicated "incident response" chat room could be established for use as needed.
OSG does not currently have a policy or facility for instant messaging for incident responders.

For two-party instant messaging using commercial services, the [[http://www.cypherpunks.ca/otr/][Off-the-Record (OTR) Messaging]] provides encryption and authentication.
[[http://www.jabber.org/][Jabber]] (XMPP) supports encrypted instant messaging over TLS.

*RECOMMENDATIONS*
   * The security team and GOC should consider setting up a secure Jabber server with an incident response "chat room". (!TeraGrid did this.)

%BLUE%
*Comments*
   * [D.O.] perhaps we could use a jabber chatroom like the one for community support. <br>See https://twiki.grid.iu.edu/twiki/bin/view/Trash/Trash/CommunitySupport/ChatRoom but room name osgsec, with password 883180. <br>We can try it and see how if it works OK.
   * [D.O.] If we use a chatroom I think we should use it regularly and not just for incidents, or else it won't work when needed.
%ENDCOLOR%

---++ Telephone

The CSIRT needs up-to-date phone numbers for all security contacts in the OSG Information Management (OIM) system.
Additionally, a distributed CSIRT like OSG's can benefit from a secure teleconference facility.
(This conclusion is based in part on the experience of the !TeraGrid CSIRT.) 
Requirements for the teleconference system include:
   * Phone conferences must be easy for any CSIRT member to quickly setup on-demand.
   * Participants must enter a secret code to join.
   * Joining participants must be prompted for their name before they can enter the conference call.
   * The system must announce participants when they join.
   * At any time, it must be possible to make the system announce the current participants.

*RECOMMENDATIONS*
   * SecurityTeam contacts should be periodically prompted to update their phone numbers in OIM.
   * The security team should establish an on-demand, secure teleconference capability.

%BLUE%
*Comments*
   * ESnet ad-hoc conferencing has PIN access control as option and could be used
%ENDCOLOR%

---++ References
   * [[http://osg-docdb.opensciencegrid.org/cgi-bin/ShowDocument?docid=19][OSG SecurityTeam Incident Handling and Response Guide]]
   * [[http://www.teragridforum.org/mediawiki/index.php?title=TeraGrid_Security_Playbook][TeraGrid SecurityTeam Playbook]]
   * [[http://www.cert.org/archive/pdf/csirt-handbook.pdf][Handbook for Computer SecurityTeam Incident Response Teams]]