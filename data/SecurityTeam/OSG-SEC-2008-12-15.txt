%META:TOPICINFO{author="JimBasney" date="1229464422" format="1.1" version="1.5"}%
%META:TOPICPARENT{name="IncidentInformation2008"}%
%TOC%
---+ OSG-SEC-2008-12-15

The [[http://vdt.cs.wisc.edu/components/glexec.html][glexec]] configuration distributed with VDT does not validate the proxy it was given.
This could potentially allow an attacker to change to any other UID (but not root) once on the worker node.
In our analysis, the vulnerability is exploitable only by locally authenticated users who can submit jobs to worker nodes.

---++ Status

<!--
Suggested status labels:
NEW: Initial report is received but incident is not confirmed.  This is a triage phase.
OPEN: The existence of a security incident requiring response has been confirmed. The response is underway.
RESOLVED: The incident has been resolved but the final report has not been submitted.
CLOSED: The final report has been submitted.
--> 

   * *Status*: OPEN 
   * *Lead*: Main.JimBasney
   * *Responders*: Main.JimBasney, Main.IgorSfiligoi, Main.AlainRoy
   * *References*: [[https://tick.globalnoc.iu.edu/MRcgi/MRentrancePage.pl][Footprints]] ticket #6145

---++ Analysis

   * *Severity*: Medium - immediate exploit is unlikely
   * *Urgency*: Medium - multitask response with other important tasks

---++ Mitigation Plan

---+++ Actions to take

   * Notify affected sites.
   * Issue a new VDT release with a fix.

---+++ How to monitor progress

---+++ Acceptable response time estimate

A VDT update is expected in January or February.

---+++ List of affected parties

This issue only affects OSG deployments (the bug is specific to the OSG glexec deployment) and then only a subset of it.
FNAL and UCSD use glexec. BNL maybe uses it, too.

---+++ Definition of End Of Event

End of event occurs when all OSG sites using glexec have deployed the fix.

---++ Incident Log

---+++ 15-Dec-2008: Initial Report
<verbatim>
Subject: glexec security problem
Date: Mon, 15 Dec 2008 16:27:25 -0600
From: Sfiligoi Igor <sfiligoi@fnal.gov>

Hi all.

We just found out that glexec configuration distributed with VDT is
wrong and does not validate the proxy it is given.
This could potentially lead to an attacker to change to any other UID
(but not root) once on the worker node.

The error is in the LCMAPS configuration file
/etc/glexec/lcmaps/lcmaps-suexec.db

The current one (in VDT is)
------------------------
path = MAGIC_VDT_LOCATION/MAGIC_VDT_PACKAGE/MAGIC_VDT_LIB/modules

good = "lcmaps_dummy_good.mod"
bad  = "lcmaps_dummy_bad.mod"

gums = "lcmaps_gums.mod -exec
MAGIC_VDT_LOCATION/MAGIC_VDT_PACKAGE/contrib/gums_interface/getmapping"

glexec_get_account:
gums -> good | bad
------------------------

instead, it should be
------------------------
path = MAGIC_VDT_LOCATION/MAGIC_VDT_PACKAGE/MAGIC_VDT_LIB/modules

good = "lcmaps_dummy_good.mod"
bad  = "lcmaps_dummy_bad.mod"

gums = "lcmaps_gums.mod -exec
MAGIC_VDT_LOCATION/MAGIC_VDT_PACKAGE/contrib/gums_interface/getmapping"

verifyproxy = "lcmaps_verify_proxy.mod"
           "--allow-limited-proxy"
           " -certdir /etc/grid-security/certificates"

glexec_get_account:
verifyproxy -> gums
------------------------
PS: This assumes the CA certificates are in /etc/grid-security/certificates.

Igor
</verbatim>

---+++ 16-Dec-2008: Phone Conference


---++ Summary

   * *Final Report*: [[https://osg-docdb.opensciencegrid.org:440/][OSG !DocDB Document ###]]

_What was the resolution of the incident?_

_What is the long-term mitigation plan (including changes in our operations, middleware or anything else that enabled the event) and timeline?_

_Deposit the final incident report in !DocDB and fill in the !DocDB URL and document number above._

---++ Access Control

_Uncomment the appropriate access control policy for this incident page. Logout of the twiki and try to access the page to ensure it is not publicly accessible. Do not attach files, as they will not be protected (see  [[http://twiki.org/cgi-bin/view/TWiki/TWikiAccessControl#Controlling_access_to_Attachment][http://twiki.org/cgi-bin/view/TWiki/TWikiAccessControl#Controlling_access_to_Attachment]])._

Incident information accessible by Security Team members, GOC, and other responders:
   * Set ALLOWTOPICVIEW = Main.SecurityTeamGroup, Main.GocGroup, Main.GabrieleGarzoglio, Main.IgorSfiligoi, Main.AlainRoy
   * Set ALLOWTOPICCHANGE = Main.SecurityTeamGroup, Main.GocGroup, Main.GabrieleGarzoglio, Main.IgorSfiligoi, Main.AlainRoy

Incident information accessible by all authenticated twiki users:
   * #Set ALLOWTOPICVIEW = Main.GridGroup
   * #Set ALLOWTOPICCHANGE = Main.GridGroup