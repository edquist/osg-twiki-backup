%META:TOPICINFO{author="NehaSharma" date="1427834924" format="1.1" reprev="1.19" version="1.19"}%
%META:TOPICPARENT{name="SecurityTeamWorkingArea"}%
<!--
   * Set ALLOWTOPICVIEW = Main.GridGroup    
   * Set DENYTOPICVIEW = Main.TwikiGuest
-->
%TOC%
---+ OSG CA Testing Plan

---++ Purpose
The OSG CA was designed with a modular architecture, so new back-end signing CAs can be used to do the actual certificate signing. This is the procedure to verify a new signing CA is working correctly.

---++ Testing Phases

| *Phase* | *Owner* | *Co-ordinator* | *Duration* |  *Status* |
| All CA functions work correctly with the new signing CA | OSG Operations/OSG Security Team/Neha | | _4/1/15 - 4/30/15_ | %ORANGE%IN PROGRESS%ENDCOLOR% | 
| Testing on ITB servers to uncover any issues with the new certs and existing OSG software | ITB Site Admins | Neha/OSG Security | _5/1/15 - 6/30/15_ | %ORANGE%IN PROGRESS%ORANGE% |
| Invite VOs to test custom software/workflows with new certificates | VO Managers | Neha/OSG Security | _5/1/15 - 6/30/15_ | %RED%NOT STARTED%ENDCOLOR% |

---++ CA Functionality Tests

| *Scenerio* | *Use Case* | *Status* | *Notes* |
| Getting Personal Cert | Request, approve and import new certificate into browsers | | |
| | New DN should appear in expected format | | |
| | Numeric prefix should be the same as in the old certificate | | |
| Renewing Personal Cert | Renew new certs | | May be issues with testing this with production setup without waiting 13 months.Should be able to test a shorter lived cert. |
| | Test whether users with existing !DigiCert certs can get new certificates without going through identity vetting | | |
| Revoking User Cert| Revoke certificate via OIM interface| | |
| |Verify certificate's serial number appears in published CRL within expected time limit (? hours) | | |
| Getting Host Cert|Get host cert via command line tools | | |
| | Verify DN matches old certificate with new prefix | | |
| | Get host cert via OIM web interface | | |
| | Verify DN matches old certificate with new prefix | | |
| Revoking Host Cert | Revoke host cert via OIM web interface | | |
| | Verify certificate's serial number appears in published CRL within expected time limit (? hours) | | |
| Getting Service Cert|Get service cert via command line tools | | |
| | Verify DN matches old certificate with new prefix | | |
| | Get service cert via OIM web interface | | |
| | Verify DN matches old certificate with new prefix | | |
| Revoking Service Cert | Revoke service cert via OIM web interface | | |
| | Verify certificate's serial number appears in published CRL within expected time limit (? hours) | | |

---+++ Known Issues
   * (1) 
   * (2) 

---++ ITB Tests

---+++ Testers

We have commitment from following sites/ITB testers 

|Site|Admin|Availability|Services to be tested|VO under which you will be requesting certs|Comment|
| |Suchandra Thapa|Now| GWMS Frontend, HTCondor-CE, GRAM CE, Bestman, Dcache, GWMS Factory(?), GUMS, Condor | OSG | |
| |Xin Zhao|Now| HTCondor-CE, GRAM CE, FetchCrl, gridFTP, RSV, OSG info services, Gratia, osg-configure, glexec, HTCondor| ATLAS | |
| |Horst Severini|Now| !FetchCrl, HTCondor CE, GRAM CE, gridFTP, uberFTP, Xrootd, RSV, CVMFS, Bestman, OSG Info Services, Gratia, osg-configure, edg-mkgridmap, HTCondor | DOSAR | |
| |Garhan Attebury|Now| | | | 
| |Brian Lin|Now| !FetchCrl, HTCondor CE, GRAM CE, gridFTP, uberFTP, lcmaps, Xrootd, RSV, CVMFS, VOMS, !MyProxy, Bestman, OSG Info Services, Gratia, osg-configure, glexec, edg-mkgridmap, lcgutil, gfal2util, HTCondor, PBS| |OSG Software Nightly Builds| 

Sites participating in ITB Testing need to:

   * Install [[http://pepperjack.fnal.gov/repo/1.0/][CA certs]] for the new signing CA ( temporary location to expedite testing )
   * Request [[https://oim-itb.grid.iu.edu/oim/certificaterequestuser][User]] and [[https://oim-itb.grid.iu.edu/oim/certificaterequesthost][Host/Service]] certificates
   * Deploy the new host/service certs on server nodes and restart services
   * Generate VOMS credentials using new user cert
   * Run Service tests as mentioned below
 
---+++ Use cases
Initial software list taken from _SoftwareTeam.ComponentHome_

| *Service* | *Use Case* |
| !BeStMan  | Authenticate and transfer files with proxies derived from new CA signed certs | 
| CA certificates  | Proper packaging? |
| cctools  | |
| !CEMon  | | 
| CVMFS  | | 
| Fetch CRL  | CRLs getting updated | 
| Frontier Squid  | | 
| Generic Information Provider (GIP)  | | 
| !GlideinWMS VO Frontend  | | 
| !GlideTester  | |
| Globus GRAM; gatekeeper, jobmanagers  | Test job submitted with VOMS proxy derived from new CA cert should run correctly  | 
| Gratia  | | 
| GratiaWeb | |
| !GridFTP| Authenticate and transfer files with proxies derived from new CA signed certs |
| !GSI-OpenSSH  | | 
| GUMS | Run jobs with new cert when mapped via gums |
| Hadoop Distributed File System (HDFS)  | | 
| !HTCondor CE and BLAHP  | | 
| !InstalledCapacityReport  | | 
| OSG Configure  | | 
| OSG Display  | | 
| OSG Info Services  | | 
| OSG PKI Tools  | |
| RSV  | |
| VOMS | Add new CA signed personal cert to existing VOMS account and be successfully approved |
| | voms-proxy-init with new cert |
| VOMS Admin | New user registration with new cert |
| VO Package aka vo-client  | | 
| Worker Node | |
| !XRootD  | |

---+++ Test Results
| *Site* | *Admin* | *Service* | *Status* | *Notes* |
| Test Site1  | Admin | Service1 | %GREEN%OK%ENDCOLOR% | See Test details (1) | 
|   |  | Service2 | %RED%FAIL%ENDCOLOR% | See Test details (2) and Known Issues (1) |
| Test Site2  | Admin | Service1 | %GREEN%OK%ENDCOLOR% | See Test details (3) | 
|  |  |  |  | | 

---+++ Test Details

   * (1) Service1 started up ok and was able to authenticate clients
   * (2) Service2 couldn't talk to Service3

---+++ Known Issues
Url for JIRA tickets that will be created for items that require fixing should be included here.
   * (1) Service2 fails to even startup
   * (2) 

---++ VO-specific Software Test
VO manager should test all VO specific software that handles certificates.

To get new certificates/setup CA/CRL files:
   * Install [[http://pepperjack.fnal.gov/repo/1.0/][CA certs]] for the new signing CA ( temporary location to expedite testing )
   * Request [[https://oim-itb.grid.iu.edu/oim/certificaterequestuser][User]] and [[https://oim-itb.grid.iu.edu/oim/certificaterequesthost][Host/Service]] certificates

| *VO* | *Software* | *Status* | *Notes* |
| CMS | CRAB | %GREEN%OK%ENDCOLOR% | status merely for display purpose for now |
| Fermilab | Jobsub | %RED%NOT OK%ENDCOLOR% | status merely for display purpose for now |

---+++ Test Details

   * (1) 
   * (2)

---+++ Known Issues

   * (1) 
   * (2) 

-- Main.KevinHill - 20 Feb 2015
