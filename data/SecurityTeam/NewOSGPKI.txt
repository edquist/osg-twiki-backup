%META:TOPICINFO{author="VonWelch" date="1348770427" format="1.1" reprev="1.9" version="1.9"}%
%META:TOPICPARENT{name="OsgRaOperations"}%
---+!! OSG Registration Authority Information

%TOC%


---++ Certificate Workflow

   1.	Subscriber requests a personal certificate, using web browser or a script interface to OIM
   2.	OIM creates a ticket and sends an email acknowledgement of the request to the subscriber and a notice of the request to the Agent. The email notice to Agent will contain the name of the VO (or institution) selected by the subscriber. 
   3.	An Agent for the specified VO views the ticket and request web page then acknowledges that the request has been reviewed by entering an entry into the ticket request. Using the information provided for name, email address and phone numbers for subscriber and sponsor, the Agent determines one or more valid Sponsors who may be able to confirm the request. 
   4.	The Agent contacts the sponsor by telephone or email to ask for confirmation of the certificate request. 
      a.	Agent looks up approved sponsor for this request based on specified institution or VO. 
      a.	Contact is done by either email or telephone to the Sponsor providing details about request and asking for confirmation. 
      a.	Sponsor makes direct contact with subscriber to verify the certificate request. 
      a.	Subscriber acknowledges or disavows having made the request. 
      a.	Sponsor conveys result from subscriber back to Agent by digitally signed email. 
   5.	Agent approves or rejects the request via web interface in OIM. 
   6.	If approved, OIM sends the certificate signed request (CSR) to !DigiCert CA for signing. 
   7.	!DigiCert signs the request and returns the signed certificate to OIM. 
   8.	OIM notifies the subscriber that certificate has been issued and provides a URL for downloading the certificate. 
   9.	!DigiCert then publishes the signed certificate into their system. 
   10.	Agent will then review recorded information about processing the request for future reference in the ticket and sets the ticket status to “Resolved”. 


---++ Instructions for Agents 

---+++ Processing OU=People certificate requests
   1.	Email notification received by agents contain the name of the submitter in the subject line. 
      * E.g., *Open Science Grid Dev: User Certificate Request for <Submitter’s name> ISSUE=### PROJ=###*
      * Identifies who submitted the request and the associated ticket created. 
      * A link to the actual certificate request is provided in the body of the email notification. 
   2.	An agent for the identified VO mention in the email should follow the link in the email notice to view the complete information about the request within one business day.  The agent is to then submit an entry into the ticket acknowledging that the ticket has been reviewed and have determined it is a request that they then can process. %BLUE%Each request should be claimed by an agent in 2 business days at most%ENDCOLOR%
   3.  Agent should confirm that the domain in the email address is [[https://www.opensciencegrid.org/bin/view/Security/OSGPKIRegisteredDomains][registered]] and if not, request registration at https://www.opensciencegrid.org/bin/view/Security/OSGPKIRegisteredDomains.
   3.	Using the additional information provided in the request the agent should confirm who are acceptable sponsors that would best validate the request. This may or may not be the same as the sponsor shown in the request. 
   4.	Agent should contact the sponsor by email or telephone to confirm the request. 
      * Agent can accept confirmation by telephone directly, if using previously validated telephone number for the sponsor. 
      * If sponsor responds by email it must be digitally signed to verify the sponsors identity. 
      * %BLUE%Email sent to Sponsor should be cc'd to person requesting certificate, so they will see the progress of their request, and can check with the Sponsor if something is taking too long.%ENDCOLOR% 
      * %BLUE%An agent can ask for an alternative Sponsor in case the first Sponsor cannot confirm the request. When an alternative sponsor is emailed, agent copies the requestor to his email.%ENDCOLOR%  
   5.	If the requestor's previous certificate has expired, and the agent or sponsor can confirm that the requestor is indeed the holder of the previous certificate, the agent may edit the DN in the request to match the previous certificate's DN, so that it is not necessary to update the requestor's DN in VOMS. 
   6.	%BLUE%If a sponsor is not responsive after 3 business days,%ENDCOLOR% 
      * %BLUE%The Agent should send a reminder email that is also copied to the Requestor.%ENDCOLOR% 
      * %BLUE%After business 5 days, Agent should email an alternative Sponsor, if one exists. The Agent should copy the Requestor to this second email so that the Requestor can follow the process.%ENDCOLOR% 
      * %BLUE%An agent can contact the OSG RA or VO Manager if a particular request or sponsor takes longer than usual, a week or 10 days at most.%ENDCOLOR% 
   7.	If sponsor confirms the certificate requestor by an acceptable means, the agent can issue the certificate. 
      * If the sponsor denies the requestor then the agent should reject the request. 
   8.	%BLUE%Agent must record a summary of the verification (or rejection) of the request as an entry into the ticket.%ENDCOLOR%   The recorded information should include 
      * Request identifier (for certification requests) 
      * Description of action take (approve, reject, cancel, revoke, etc.) 
      * Name and/or individual email address of Agent who processed the request. 
      * Name of Sponsor who confirmed the request (in some cases the Agent is also the Sponsor). 
      * For certification requests, statement of why the requestor qualifies to receive certificate, i.e., membership in a particular VO, or association with a science program participating with OSG. 
      * Certificate serial number 
      * Certificate subject name, i.e., DN 


---+++ Processing OU=Services certificate requests 
   1.   Email notification received by agents will contain the name of the Grid Admin for which the certificate is requested in the subject line of the notification email. 
      * E.g., *Open Science Grid Dev: Host Certificate Request by <Submitter’s name> ISSUE=### PROJ=###*	
      * Identifies who submitted the request and the associated ticket created. 
   2. An agent with responsibility for the domain should click on the link in the email notice to check the complete information for the request within %BLUE%one business day of receiving the notice. %ENDCOLOR%
   3. If the agent is able to process the request they are to submit an entry into the ticket acknowledging that the ticket has been reviewed and have determined it is a request that they then can process.
   3.  Agent should confirm that the domain in the email address is [[https://www.opensciencegrid.org/bin/view/Security/OSGPKIRegisteredDomains][registered]] and if not, request registration at https://www.opensciencegrid.org/bin/view/Security/OSGPKIRegisteredDomains.
   4. If the requestor has a valid !DigiCert personal certificate the agent should get a digitally signed email from the requestor in order to issue the certificate. 
   5. If the requestor does not have a valid !DigiCert personal certificate then they need to be authenticated as described for a personal certificate request above before issuing the new certificate. 
   6. %BLUE%Agent must record a summary of the verification (or rejection) of the request as an entry into the ticket. %ENDCOLOR%  The recorded information should include 
      * Request identifier (for certification requests) 
      * Description of action taken (approve, reject, cancel, revoke, etc.) 
      * Name and/or individual email address of Agent who processed the request. 
      * Name of Sponsor who confirmed the request (in some cases the Agent is also the Sponsor). Not needed if requestor has a valid personal certificate. 
      * For certification requests, statement of why the requestor qualifies to receive certificate, i.e., membership in a particular VO, or association with a science program participating with OSG. 
      * Certificate serial number 
      * Certificate subject name, i.e., DN

---+++ %BLUE%Audits of Agent activities%ENDCOLOR%
%BLUE%Auditing the registration process is an important part of maintaining the integrity of the whole identify certification system. At times there will be sampling audits of individual certificate requests and Agents may be contacted regarding those requests if the information in the tickets is insufficient.%ENDCOLOR%

---+++ Becoming a OSG PKI Trusted Agent (Registration Authority Agent or Grid Admin)
Page can be found [[https://twiki.grid.iu.edu/bin/view/Operations/OSGPKITrustedAgent][here]].

---+++ Certificate Revocation
When a certificate is revoked it is included in the Certificate Revocation List and it can no longer be used for authentication.
There are several conditions that are grounds to revoke a certificate.  These are:
   * the private key is suspected of being compromised (out of control of the owner)
   * the certificate is no longer in use
   * the information in the certificate is no longer accurate (name, hostname, email address)
   * the owner no longer has a valid reason to have the certificate (no longer working on a project of interest to OSG)
If the certificate owner or some other responsible party notifies an Agent that any of these conditions is true
then the Agent should revoke the certificate.  If in doubt, open a trouble ticket [[http://ticket.grid.iu.edu/goc/submit][here]] and CC osg-ra@opensciencegrid.org for clarification. The revocation should be recorded by providing an entry into the ticket describing in detail the actions taken.

---+++ Other Agent Actions
 The main URL at the CA for actions authorized for Agents is found [[https://oim.grid.iu.edu/oim/certificateuser][here]]. The most frequently used actions are searching for certificates, and revocation. Any action causing changes (revocation, issuing certificates, granting privileges, etc.) should be recorded by providing an entry into the ticket describing the actions taken in detail.

---+++ Termination of Agent or Grid Admin privileges
 When you wish to terminate any RA or Grid Admin privileges you have, due to change of job or responsibilities you should open a trouble ticket [[http://ticket.grid.iu.edu/goc/submit][here]] and CC osg-ra@opensciencegrid.org stating that you are ending your responsibilities and privileges. You should state who, if anyone, is taking over for your RA or Grid Admin responsibilities. When Agents terminate their privileges there need to be arrangements made to transfer the log of Agent actions to another Agent or to the OSG PKI staff. If the Agent has provided an entry into the ticket on all actions  then no additional transfer is necessary.


-- Main.AlainDeximo - 27 Sep 2012
