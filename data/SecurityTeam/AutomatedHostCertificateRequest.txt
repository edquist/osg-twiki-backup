%META:TOPICINFO{author="AnandPadmanabhan" date="1470263418" format="1.1" reprev="1.1" version="1.1"}%
---++ Purpose
Host certificate requests & renewals require an intermediate step where the grid administrator's certificate to sign the request. The intention of having this step was to force a manual process where the administrator would verify that the requests were legitimate. With automated deployment  tools like puppet, this step may tend to be potentially onerous, and sites would like it to automate it. 

This document provides an initial attempt to provide an alternative automated approach to issue secure host certificate 

---++ Requirements 
The requirements of securing the host private key has been loosened as below
   * Private host keys should either (a) generated and always stay on the host machine itself;  or (b) CSR and private key maybe generated on a secure central server from where it is to be promptly transferred via a secure channel to the  host machine and then deleted from the central machine.
      * The secure central server used for generation and signing of the host certificated should be well-secured and its access controlled to trusted system administrators of the site (preferably only grid admins) 
   * Grid administrators private certificate may be stored on the secured server, however a manual approval by OSG gridadmin is essential. 
      * This approval does not need to be manual intervention at the point of signing, it could, for example, be a predefined list of hosts the grid admin has compiled and pre-approved as valid host names in his/her domain. 

---+++ Details  

   * CA and OSG restrictions on private keys: OSG CA CP/CPS explains in details how and where the host keys are created and how they are treated. This is carefully reviewed by the IGTF reviewers. IGTF also has a policy on private key management https://www.eugridpma.org/guidelines/pkp/. However, IGTF guideline does not say anything explicitly about host certs. The OSG security team is of the view is as long as the central server is a securely maintained machine which deletes the private keys as soon as transporting them, we are not exposing ourselves to any new risks. 

   * Approval of certificated by system admins who are not OSG grid-admins . It is *not ok* for all root-level sys admins to implicitly "cause a host cert to be requested" without an OSG grid-admins approval. OSG security team has the gridadmin concept because we want to keep track of gridadmin actions and also make sure they understand their responsibilities. Obviously, a root-level admin can access private keys and host certs on any system he is root privileges on.  However,  we do not want to have bulk requests made and approved by sys admins that are not recognized by OSG. We will have no way of knowing if these are authorized Gridadmins understanding and promising to follow OSG policies. 

   * Manual review by OSG gridadmin review: A manual review by grid administrator is not exactly required at the time of signing but it can happen before hand. For example, a gridadmin can create a list of hosts the central server system (e.g. Puppet) may host/serve. This list should be only edited by the authorized gridadmins. Likewise the puppet should invoke a certify-like tool that can create certs and ship them to the hosts. The important thing is only gridadmins and a select few Puppet sys admins (maintaining the central puppet server) can access to the certify-like tool. The OSG security team would require a periodic out-of-band review of issued certificates to hosts and the certify-like tool by a gridadmin. this will make sure the code is not tampered and there are no mistakes. This review can happen periodically a few times a year to make sure systems are working. So, in essence no manual intervention is required by the grid admin at the time of the request, but we secure the systems by a) only defining the host list by a gridadmin b) only alowing a gridadmin rwx rights over a certify-like tool (obviously it does not have to be certify but a script who can create keys, get certs and ship them to the hosts) c) having periodic review of certificates issued to hosts. 

  

-- Main.AnandPadmanabhan - 03 Aug 2016
