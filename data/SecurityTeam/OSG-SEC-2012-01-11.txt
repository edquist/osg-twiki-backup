%META:TOPICINFO{author="KevinHill" date="1326472536" format="1.1" reprev="1.2" version="1.2"}%
%META:TOPICPARENT{name="IncidentInformation2012"}%
%TOC%
---+ OSG-SEC-2012-01-11

Several grid systems at Texas Tech University were compromised and the ssh daemons replaced.

---++ Status

<!--
Suggested status labels:
NEW: Initial report is received but incident is not confirmed.  This is a triage phase.
OPEN: The existence of a security incident requiring response has been confirmed. The response is underway.
RESOLVED: The incident has been resolved but the final report has not been submitted.
CLOSED: The final report has been submitted.
--> 

   * *Status*: _OPEN_ 
   * *Lead*: _Kevin Hill_
   * *Responders*: _list of involved responders (for resource tracking)_
   * *References*: _https://ticket.grid.iu.edu/goc/viewer?id=11451_

_Optionally include additional status information here._

---++ Analysis

   * *Severity*: _Medium_: compromise was limited to root on the ttu.edu systems. It has not appeared to affect other grid systems.
   * *Urgency*: _High_: some proxies were still valid at the time of the systems removal, but most were less than 48 hours.

The largest risk is unexpired credentials that may have been on these systems. It appears that most jobs were submitted via proxies that expired in 48 hours or less.

---++ Mitigation Plan

Determine if any long lived credentials were used to submit jobs to the system. If there were unexpired credentials, contact the affected users and have them renew their credentials and revoke their old ones.

---+++ Actions to take

Monitor Gratia for any credential use we haven't gotten answers back from. Watch for unual activity.

Need to get information from TTU security team on the actual compromise.

---+++ How to monitor progress

Responders should report their actions back to the incident lead.

---+++ Acceptable response time estimate

Notice was sent to all OSG security contacts the same day. Individual users with credentials in the affected system logs were contacted within 24 hours and most responded within 48 hours.

---+++ List of affected parties

_This list determines who we need to communicate with, who needs to take action, etc.  However, be careful about handling sensitive information._`

---+++ Definition of End Of Event

_What is the condition under which we can declare this incident to be resolved?_

---++ Incident Log

_Append descriptions of response activities here. Sign and date each log entry. Use the "signature to copy/paste" provided below the twiki edit box._

List of dn's from TTU GUM's log:
* /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=asciaba/CN=430796/CN=Andrea Sciaba
* expired after 12 hours

* /DC=gov/DC=fnal/O=Fermilab/OU=Robots/CN=fermigrid0.fnal.gov/CN=cron/CN=Keith Chadwick/CN=UID:chadwick
* already expired

* /DC=org/DC=doegrids/OU=People/CN=Anand Padmanabhan 75166
* already expired

* /DC=org/DC=doegrids/OU=People/CN=Bockjoo Kim 740786
* replaced/revoked cert.

* /DC=org/DC=doegrids/OU=Services/CN=frontend.ligo.caltech.edu
* up to 72 hours. Monitoring Gratia for unusual activity. Nothing unusual as of Friday AM.

* /DC=org/DC=doegrids/OU=Services/CN=pilot/glidein.chtc.wisc.edu
* up to 48 hours. Monitoring Gratia for unusual activity. Nothing unusual as of Friday AM.

*  /DC=org/DC=doegrids/OU=Services/CN=rsv/antaeus.hpcc.ttu.edu
* Will need to be replaced when system comes back on line

Here's an example log entry. -- Main.JimBasney - 01 Jul 2008

<verbatim>
Use the verbatim tag when pasting in text to disable HTML code.
</verbatim>

---++ Summary

   * *Final Report*: [[https://osg-docdb.opensciencegrid.org:440/][OSG !DocDB Document ###]]

_What was the resolution of the incident?_

_What is the long-term mitigation plan (including changes in our operations, middleware or anything else that enabled the event) and timeline?_

_Deposit the final incident report in !DocDB and fill in the !DocDB URL and document number above._

---++ Access Control

_Uncomment the appropriate access control policy for this incident page. Logout of the twiki and try to access the page to ensure it is not publicly accessible. Do not attach files, as they will not be protected (see  [[http://twiki.org/cgi-bin/view/TWiki/TWikiAccessControl#Controlling_access_to_Attachment][http://twiki.org/cgi-bin/view/TWiki/TWikiAccessControl#Controlling_access_to_Attachment]])._

Incident information accessible by Security Team members and GOC only:
   * Set ALLOWTOPICVIEW = Main.SecurityTeamGroup, Main.GocGroup
   * Set ALLOWTOPICCHANGE = Main.SecurityTeamGroup, Main.GocGroup

Incident information accessible by all authenticated twiki users:
   * #Set ALLOWTOPICVIEW = Main.GridGroup
   * #Set ALLOWTOPICCHANGE = Main.GridGroup

%META:TOPICMOVED{by="KevinHill" date="1326469747" from="Security.OSGSEC20120111" to="Security.OSG-SEC-2012-01-11"}%
