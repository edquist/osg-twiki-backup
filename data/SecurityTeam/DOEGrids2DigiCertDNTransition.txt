%META:TOPICINFO{author="JimBasney" date="1330724077" format="1.1" reprev="1.3" version="1.3"}%
%META:TOPICPARENT{name="DigiCertPilotProject"}%
---+!! Plan for DOEGrids to !DigiCert Distinguished Name Transition

The [[OSGCATransition2012][2012 OSG CA Transition]] will require OSG participants who currently hold certificates from the DOEGrids CA to obtain certificates from a new CA (expected to be the [[http://www.digicert-grid.com/][DigiCert Grid CA]]). Since each [[http://www.igtf.net/][IGTF]] accredited CA must issue certificates with non-overlapping names, the certificates from the new CA will have different names (called Distinguished Names or DNs). This plan documents the implications of this name change and procedures for making this transition as smooth as possible for OSG participants.

%TOC%

---++ Impacts

The most significant impact of the DN change is that OSG participants will need to register new DNs in VOMS for any certificates used to submit jobs or access data. This includes both user certificates and pilot certificates.

What about the certificates that VOMS servers use to sign assertions? What is the impact of a DN change for those?

DN changes will also impact data access. (Requires investigation... "As for files on disk/tape, access to these shouldn't rely on fine-grained UNIX identity anyway. For the cases where it must (like dCache at BNL) everyone from a given VO is mapped to a single group account anyway." Still, at least CMS relies on individual DN to account mappings. Need to determine how widespread that is.)

Other OSG services that will require DN registration updates are:
   * https://twiki.grid.iu.edu
   * https://oim.grid.iu.edu
   * https://osg-docdb.opensciencegrid.org:440/cgi-bin/DocumentDatabase/

In general, DN changes do not cause problems for server certificates, because clients check that the server certificate matches the server's hostname, rather than checking the full DN of the server certificate. Note however the issue of VOMS server certificates discussed above.

---++ Transition Plan

The following transition plan options are presented *for discussion purposes only* and are *not yet approved*.

---+++ Option A: Manual Transition

DN Transition Plan Option A is the default or basline approach that does not rely on developing new software or making changes to the OSG infrastructure.
Each VO is responsible for updating the VOMS registrations for that VO's users, however the VO sees fit.
Manual updates will likely be OK for small VOs, but could be very expensive for large VOs. (Need to quantify this...)
(Maybe some VOs require only a small number of pilot certificates registered in VOMS?)

In this option OSG will:
   * Provide documentation for the VOs to assist with the VOMS transition.
   * Provide documentation for the sites to assist with any needed GUMS-related transition steps.
   * Provide a process for users to update their OIM, Twiki, and !DocDB registrations.

---+++ Option B: OSG DN Transition App

In DN Transition Plan Option B, OSG provides a (web? command-line?) application where users authentication with both their DOEGrids and their DigiCert Grid certificates to create an identity mapping, and this identity mapping is pushed out to OSG VOMS servers and other OSG services via some automated (but not yet defined) process.

---+++ Option C: ???

---++ Prior Experience

---+++ UK eScience

"There are technical limitations in VOMS that can be problematic if DNs are preserved when the CA changes.  There's an ongoing issue with the UK eScience CA doing precisely this, and is getting resolved one DN at a type by hand." See: https://ggus.eu/ws/ticket_info.php?ticket=77179

---++ VO Details

---+++ ALICE

---+++ ATLAS

---+++ CMS

Brian Bockelman reports that CMS relies on individual DN to account mappings for output data.

---+++ LIGO

---++ Technical Details

---+++ Software Support

VOMS has the concept of multiple DNs per user, so users can retain their VO roles when their DN changes. However, currently this feature does not work well with GUMS. (More details needed...)

GUMS does not have the concept of multiple DNs per user in the web interface, unless you use the manual mapping feature.  When a user's DN changes, sites:
   * Don't have any files on disk from the user and just ignore it.
   * Already have the user mapped manually, and just alter the manual mapping.
   * Log into the !MySQL interface and change the user account mapping by hand.

---+++ Distinguished Names

Certificates issued by the DOEGrids CA contain distinguished names of the following forms:
   * /DC=org/DC=doegrids/OU=People/CN=<em>full name ID#</em>
   * /DC=org/DC=doegrids/OU=Hosts/CN=<em>fqdn</em>
   * /DC=org/DC=doegrids/OU=Services/CN= <em>servicename</em>

For example:
   * /DC=org/DC=doegrids/OU=People/CN=James Alan Basney 710056
   * /DC=org/DC=doegrids/OU=Hosts/CN=ce.example.edu
   * /DC=org/DC=doegrids/OU=Services/CN=uscmspilot/cmssrv105.fnal.gov

Certificates issued by the !DigiCert Grid CA contain distinguished names of the following forms:
   * /DC=com/DC=DigiCert-Grid/...
   * /DC=com/DC=DigiCertGrid/...
   * /C=US/O=DigiCert Grid/...

For example:
   * /DC=com/DC=DigiCert-Grid/OU=People/CN=Jim Basney
   * /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=Services/CN=ce.example.edu
