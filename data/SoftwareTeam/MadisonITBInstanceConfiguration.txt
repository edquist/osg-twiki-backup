%META:TOPICINFO{author="MatyasSelmeci" date="1395766817" format="1.1" reprev="1.1" version="1.1"}%
%META:TOPICPARENT{name="MadisonITBInstance"}%
---+ Configuration for the Madison ITB Instance

---++ Overview

Configuration for the Madison ITB Instance is handled using [[http://docs.puppetlabs.com][Puppet]].
We are using a Puppet Master that is run by the UW Center for High-Throughput Computing.
The master is shared by multiple sites, but we will have separate environments for the ITB site.

---++ Environment Setup

The environments for the ITB site are hosted on =wid-service-1.chtc.wisc.edu=,
in the directory =/etc/puppet/environments=.

*Note*: That directory also contains Puppet environments for other machines and clusters managed by the CHTC, not just our ITB site.
Please be careful when making changes!

The =vdt= environment holds the Puppet configuration for the ITB site;
it lives in the =vdt= subdirectory.

In addition to the =vdt= environment, team members will have their own environments for testing.
Your environment will be named after your UW CS login name;
if you do not have an environment, you should mail Tim C or Mat.
You can manage your own environment however you want,
but it is recommended to store the configs in the =/puppet= directory tree in SVN.

---++ SVN Setup

The canonical location for files in the =vdt= environment is in the [[https://vdt.cs.wisc.edu/svn][VDT SVN repo]],
in the directory =/puppet/production=.
All changes to the =vdt= environment must be committed there.
The =vdt= environment on =wid-service-1= updates from SVN in 10-minute intervals, discarding local changes.

*Note* that this is a publicly accessible SVN repository.
Do not store any sensitive data such as passwords or private keys in it.

The 

---++ Puppet Agent Setup

The puppet agent is installed on each of the nodes in the ITB site.
It is not running persistently, but instead runs once a night from cron.
The agent will pull from the =vdt= environment, stored at =/etc/puppet/environments/vdt= on =wid-service-1.chtc.wisc.edu=.



