%META:TOPICINFO{author="MatyasSelmeci" date="1359503245" format="1.1" reprev="1.2" version="1.2"}%
%META:TOPICPARENT{name="InternalDocs"}%
---+!! Proposal for repository of upcoming software (osg-upcoming)

Underlying ticket: [[https://jira.opensciencegrid.org/browse/SOFTWARE-883][SW-883]]

%TOC%


---++ Process for packaging upcoming software

   1. Put package files in the upcoming software svn area ( =$SVN/native/upcoming/trunk= )
   1. osg-build the package, selecting the =el5-osg-upcoming= or =el6-osg-upcoming= target
   1. Install osg-release and enable the upcoming-minefield repo; install and test the package.%BR%
      The main osg repos still need to be enabled so the package can get prerequisities.
   1. Package follows the same promotion cycle that regular packages follow (development &rarr; testing &rarr; release), use osg-promote to promote

It hasn't been decided whether or not "upcoming" should be released in sync with the regular osg releases.

---++ Initial list of software to be placed in upcoming

   * hadoop 2.0
   * java packages rebuilt as part of OracleJdk6Deprecation
   * TODO others?

---++ Todo lists


---+++ What to do in Koji

| *Task* | *Priority* | *Owner/Status* | *Time Estimate* |
| =el[56]-osg-upcoming-{release,testing,development,build}= | %RED%Required%ENDCOLOR% | | &lt;1 hour |
| Make the following targets: =el[56]-osg-upcoming= ( =el[56]-osg-upcoming-build -> el[56]-osg-upcoming-development= ) | %RED%Required%ENDCOLOR% | | &lt;1 hour |
| Get GOC to use mash on the new tags | %RED%Required%ENDCOLOR% | | ? |
| Add appropriate policies (ACLs) for various actions on the upcoming tags/targets <sup>1</sup> | %ORANGE%Recommended%ENDCOLOR% | | 2&mdash;4 hours |
   
1. Proposed ACLs:
   * packages in upcoming-development can be tagged upcoming-testing
   * packages in upcoming-testing can be tagged upcoming-release
   * Alternatives for how to handle tagging between upcoming and regular:
      1. Disallow it except for koji admins
      1. Allow tagging from upcoming-* to regular-development, and regular-* to upcoming-development only.%BR%
         (i.e. no going straight from upcoming-testing to regular-testing)

---+++ What to do in SVN

| *Task* | *Priority* | *Owner/Status* | *Time Estimate* |
| Make =$SVN/native/upcoming/{branches,tags,trunk}= and move over packages that are going to be in upcoming | %RED%Required%ENDCOLOR% | | &lt;1 hour |
| Add new repos to the =osg-release= rpm, disabled by default | %RED%Required%ENDCOLOR% | | &lt;1 hour |

---+++ What to do in osg-build

| *Task* | *Priority* | *Owner/Status* | *Time Estimate* | 
| Add promotion paths to =osg-promote= | %RED%Required%ENDCOLOR% | | 1&mdash;2 hours |
| Add some way of making sure builds don't use the wrong target by default <sup>1</sup> | %ORANGE%Recommended%ENDCOLOR% | | 2&mdash;4 hours |

1. This can be done perhaps by selecting target based on SVN branch (unless otherwise specified).
Koji can't automatically do this for us

---+++ What to do in osg-test

| *Task* | *Priority* | *Owner/Status* | *Time Estimate* | 
| Go through each of our test cases and make sure they handle which version of the software they are testing properly. \
  E.g. do the hadoop tests either work with both 0.20 and 2.0.0 or at least test which one is installed and make the right configs | %RED%Required%ENDCOLOR% | | 1&mdash;2 days |
| Create an =osg-tested-internal= equivalent for packages we test in upcoming; no need to recheck packages that haven't changed. | %ORANGE%Recommended%ENDCOLOR% | | 1&mdash;2 hours |
| Add upcoming to our nightlies <sup>1</sup> | %ORANGE%Recommended%ENDCOLOR% | | 1&mdash;2 hours |

1. This doubles the number of tests we run, but currently, our tests take under an hour to run and are given two-hour time-slots, so this is doable.

---+++ What to do in documentation

| *Task* | *Priority* | *Owner/Status* | *Time Estimate* | 
| A separate SoftwareTeam.PreReleaseNotes page for packages promoted to upcoming-testing | %RED%Required%ENDCOLOR% | | &lt;1 hour |
| An addition to SoftwareTeam.UpcomingReleases for upcoming changes to upcoming | %RED%Required%ENDCOLOR% | | &lt;1 hour |
| Instructions on how to enable the upcoming repos that can be included in instructions for specific software much like Documentation.Release3.YumRepositories currently is | %RED%Required%ENDCOLOR% | | 1&mdash;2 hours |
| Instructions for specific software that we place in upcoming, e.g. hadoop-2.0.0; these should also contain migration instructions if possible | %RED%Required%ENDCOLOR% | | ? |

<!-- vim:ft=twiki
-->
