%META:TOPICINFO{author="MatyasSelmeci" date="1312576618" format="1.1" version="1.4"}%
%META:TOPICPARENT{name="RPMTempDocuments"}%
---+!! Koji Workflow
[[https://koji-hub.batlab.org/koji][OSG Koji]]

---++ Adding new package

Note that if a package with the same NVR (Name-Version-Release) as the one
you're trying to build already exists in koji, your build will fail.

Either use =rpmdev-bumpspec= (from =rpmdevtools=) to increment the Release of
your package, or pass =--scratch= to =koji build= or =vdt-build koji= to create
a scratch build.  The results of a scratch build won't be saved, so they won't
block subsequent builds with the same NVR. This is useful for experimenting
with koji.
---+++ Preferred: Using vdt-build (0.0.15+)
<pre class="screen">
%UCL_PROMPT% vdt-build koji %RED%package_name%ENDCOLOR% --kojilogin="your_cn" </pre>

---+++ Only if needed: Manually
Add new packages to the el5-osg tag.  Your CN will look like =Derek Weitzel 285345=
<pre class="screen">
%UCL_PROMPT% koji add-pkg el5-osg %RED%package_name%ENDCOLOR% --owner="your_cn" </pre>

Build packages to the el5-osg build target.  This will automatically put them in the development repo.
<pre class="screen">
%UCL_PROMPT% koji build el5-osg %RED%SRPM%ENDCOLOR% </pre>


---++ Upgrading packages from development -> testing -> release
Only an admin can upgrade packages to testing and release.

Build name is the name-version-release of the build.
<pre class="screen">
%UCL_PROMPT% koji tag-pkg el5-osg-testing %RED%build_name%ENDCOLOR% </pre>

And to release:
<pre class="screen">
%UCL_PROMPT% koji tag-pkg el5-osg-release %RED%build_name%ENDCOLOR% </pre>