%META:TOPICINFO{author="MatyasSelmeci" date="1438188543" format="1.1" reprev="1.9" version="1.9"}%
%META:TOPICPARENT{name="InternalDocs"}%
%LINKCSS%

<!-- This is the default OSG documentation template. Please modify it in -->
<!-- the sections indicated to create your topic.                        --> 

<!-- By default the title is the WikiWord used to create this topic. If  -->
<!-- you want to modify it to something more meaningful, just replace    -->
<!-- %TOPIC% below with i.e "My Topic".                                  -->

---+!! Installing an OSG Build Box
%TOC%

---++ Installing OSG and EPEL repos
Like with any OSG software, the OSG and EPEL repos (preferably the latest) must be installed.
See [[Documentation.Release3.YumRepositories]] for instructions.

---++ Installing the osg-build tool
osg-build is used to build OSG packages.
It is a wrapper for tools like rpmbuild and mock.
It is available in the regular OSG repositories, and can be installed by running:

<pre class="screen">
%UCL_PROMPT_ROOT% yum install osg-build
</pre>

However, it may also be run directly from a Subversion checkout, which may be useful if you want the latest features.
<pre class="screen">
%UCL_PROMPT% svn co https://vdt.cs.wisc.edu/svn/software/osg-build/trunk osg-build
</pre>

---++ Checking out the package source from subversion
Current work is done in subversion.  The command to check out the subversion is:
<pre class="screen">
%UCL_PROMPT% svn co https://vdt.cs.wisc.edu/svn/native/redhat
</pre>

---++ Setting up Mock
Install mock (should be brought in by osg-build in newer builds):
<pre class="screen">
%UCL_PROMPT_ROOT% yum -y install mock
</pre>

Add your user to the mock group.  Edit =/etc/group=, adding your %RED%username%ENDCOLOR% (as returned by =id=) to the mock line:
<pre class="file">
mock:x:109:%RED%username%ENDCOLOR%
</pre>

---+++ Performance Suggestions
It is suggested that mock builds are done in ram, if you have enough -- 4GB or more.
Mock build are all conducted under =/var/lib/mock/=.
Mounting that directory in a tmpfs file system will cause builds to be much faster.

An example mount command for creating a 3GB 'tmpfs' filesystem in =/var/lib/mock=:
<pre class="screen">
%UCL_PROMPT_ROOT% mount -t tmpfs -o size=3072m tmpfs /var/lib/mock
</pre>

---++ Enabling OSG-Development Repo by default (optional)
Edit =/etc/yum.repos.d/osg-development.repo= or =/etc/yum.repos.d/osg-el6-development.repo=, changing enabled to %RED%1%ENDCOLOR%.
<pre class="file">
[osg-development]
name=OSG Software for Enterprise Linux 6 - Development - $basearch 
mirrorlist=http://repo.grid.iu.edu/mirror/osg-development/$basearch
failovermethod=priority
priority=98
enabled=%RED%1%ENDCOLOR%
gpgcheck=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-OSG
</pre>

%META:TOPICMOVED{by="AlainRoy" date="1317757957" from="Documentation.VDTRPMBuildBox" to="SoftwareTeam.VDTRPMBuildBox"}%
