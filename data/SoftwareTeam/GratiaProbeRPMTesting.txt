%META:TOPICINFO{author="SuchandraThapa" date="1380057194" format="1.1" reprev="1.2" version="1.2"}%
%META:TOPICPARENT{name="TestingRecipes"}%
---+ Gratia Probe RPM Testing

This page documents the testing procedure to test the gratia probes sufficiently tested to be promoted to the osg-testing repository.  The test procedure is the same on both SL5 and SL6.

   * install or update the =gratia-probe-condor= rpm as appropriate
   * On each VM download the gratia-probe-setup.sh script and run it
   * In =/etc/gratia/condor/ProbeConfig=, verify the following have been changed:
      * change =SiteName= to something aside from =Generic Site=
      * change =EnableProbe= to 1
      * change =CollectorHost=, =SSLHost=, and =SSLRegistrationHost= to the an invalid host (E.g. test.com) or the localhost
   * Create =/var/lib/osg/= and download the attached =user-vo-map= file and place it in that directory
   * Edit the =user-vo-map= file and change the account from =sthapa= to the account you'll be using to submit the condor jobs in the following step
   * Download and submit the attached condor_submit file (note, on the default fermicloud VM, this takes about 3 hours, so you may want to set =NUM_CPUS= to 50 so that 50 jobs will run at a time)
   * Run =/usr/share/gratia/condor/condor_meter=
   * Check =/var/lib/gratia/tmp/gratiafiles/= for a =subdir.condor_...= directory and verify that there are 200 xml jobs and the cpus/wall times are appropriate (either PT0S or PT1M).





-- Main.SuchandraThapa - 24 Sep 2013

%META:FILEATTACHMENT{name="gratia-probe-setup.txt" attachment="gratia-probe-setup.txt" attr="" comment="Script to setup gratia probe" date="1380057133" path="gratia-probe-setup.txt" size="1529" stream="gratia-probe-setup.txt" tmpFilename="/usr/tmp/CGItemp43704" user="SuchandraThapa" version="1"}%
%META:FILEATTACHMENT{name="sleep.sub" attachment="sleep.sub" attr="" comment="Condor submit file for sleep jobs" date="1380057153" path="sleep.sub" size="146" stream="sleep.sub" tmpFilename="/usr/tmp/CGItemp47661" user="SuchandraThapa" version="1"}%
%META:FILEATTACHMENT{name="user-vo-map" attachment="user-vo-map" attr="" comment="user-vo-map file for gratia" date="1380057164" path="user-vo-map" size="615" stream="user-vo-map" tmpFilename="/usr/tmp/CGItemp47868" user="SuchandraThapa" version="1"}%
