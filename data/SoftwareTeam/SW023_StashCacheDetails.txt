%META:TOPICINFO{author="TimCartwright" date="1425400869" format="1.1" reprev="1.3" version="1.3"}%
---+ !StashCache Project Details

Go to [[SW023_XrootdAcrossOsg][main project page]].

---++ Design Questions

   * The phrase “common input data” (and variants) is ambiguous &ndash; the word _common_ could mean _shared_ (which is the intended meaning) or _prevalent_ or _not special_. How about seeking a less ambiguous phrase? Some possibilities include “shared input data” or “reusable input data”.

   * It might be good to settle on and consistently use a range of dataset sizes that we are targeting initially. For a lower bound, is it 1 GB, 10 GB, 100 GB? For an initial upper bound that we are willing to support, is it 100 GB, 1 TB, 10 TB?

   * I think it is written “OSG Connect”, now “OSG-Connect” – we should stick with established usage.

   * It would be good to standardize on a single name for the caches. Various documents have used “caching proxy”, “cache”, and “proxy cache”, at least. Let’s pick one and use it everywhere.

   * What does it mean for a Source to “subscribe” to the central OSG Redirector? The usage of “subscribe” in this case may be specialized computer jargon and we should strive to find a plainer term or phrase that everyone will understand.

   * In the initial description of the overall architecture, I think it would help to describe the purpose of Sources a little more. Something like “A *Source* is a place where users upload their shared input data files, with the intent that users upload any given file just once regardless of how many times it will be used by their jobs.” Or whatever is accurate.

   * What does it mean that “jobs discover and download files from the local cache”? I think that there is a lot to unpack there. Do jobs discover files or caches? And whichever it is, what does that mean? Are we just trying to say that job will have the means to find one or more nearest caches, for some definition of “nearest”?

   * Does the Redirector really need to contact each Source? I thought that the namespace was designed such that a given path identifies its Source.

   * In the overview introduction, there is mention of the need for cleaning out caches (“automated eviction”). How and where does that happen in !StashCache? Presumably, the individual caches clean out stale contents. What about the Sources? Is the clean-up policy the responsibility of the VO? If so, what tools do we give the VO to manage a Source?

   * In the Component Architecture section of the overview, what is a Source server? It would be nice to spell out the main software components that form such a thing. Is !XRootD involved? If so, which parts of it? The document says “The OSG will provide packaging for this server,” so presumably there are specific software components to install and configure.

   * How much storage is each cache server (again, we need a consistent name!) expected to provide, at a minimum? Frank’s presentation mentioned 48&nbsp;TB, the whiteboard notes at UCSD had 90&nbsp;TB, the overview document has >&nbsp;10&nbsp;TB. Is it possible at this time to declare a single lower bound?

   * Also in the Component Architecture, is it possible to be more explicit about the software components needed for each pilot and/or for each job environment?

---++ Meeting Notes

---+++ 26 February 2015 – Weekly conference call

1:00–2:00 p.m. CT

*Overview document*
   * !BrianB wrote an overview document and version 2 is now uploaded to [[SW023_XrootdAcrossOsg][the main project page]]
   * Can multiple VOs share the same Redirector and Caches?
      * Yes, but there are separate namespaces to avoid filesystem conflicts
      * But OSG must monitor VO usage, because otherwise one VO could take advantage of the system and use all of the resources
      * Yet, as a matter of principle, we will not limit VOs to a subset of the whole cache
      * The overview document should contain a list of guiding principles, so we know what they are and when they are causing us problems
   * For the range of shared input datasets we are hoping to support, let’s use 5&nbsp;GB to 5&nbsp;TB
   * Do OSG worker nodes have enough space to handle these cached datasets?
      * Long term, we plan to use the POSIX preload library to transfer data over the network on demand, so complete files will not be stored on worker nodes
      * In the meantime, we need to mention disk space on worker nodes

*Operations*
   * At first, start with local control and management of Cache Servers
      * Then aim to view and set configuration remotely
      * The initial offering will be “ITB grade” services, meaning in particular that the GOC will watch over them but will not fix problems
      * Eventually, we need to make sure that the transition to production is done right
   * What will remote control of Cache Servers look like?
      * Functions supported: start/restart services, [missed one], view and set configuration, and get service status and information
   * Stages of pilot operations:
      * Frank prefers to run things as pilots until we are “dead certain” that they are ready for production
      * Stage 1: All-Hands Meeting
      * Stage 2: Summer
      * Stage 3: Late fall or early winter
   * Terminology update: the term “Origin Server” was settled on
   * The OSG Connect Origin Server at UChicago, owned by Lincoln, is done

*WBS Review*
(Sorry, no notes)

---+++ 19 February 2015 – Weekly conference call

1:00–2:00 p.m. CT%BR%*Attending:* (may be incomplete) Anna, !BrianB, Chander, Ilija, Lincoln, !RobG, Robert, !TimC

   * Addition to the agenda:
      * Convert TWiki items to 1–2 page white-paper about the project
      * Document planned architecture and design, plus user perspective
      * The intended audience is this group of stakeholders and developers
      * One basic question to answer: How do we know when we are done?

   * Operations – !RobQ has a conflict yet this week, will be available next week to discuss Operations

   * AAA updates
      * WBS 2.7 (cache consistency): Ilija is working on this and the cache cleanup issue from Anna; aiming for Monday updates
      * WBS 2.6
         * Browse through test preload library
         * Port lazy downloading code (DONE); lazy caching allows us to do latency hiding; written as !XRootD client plugin, owned by AAA, probably will end up in !XRootD some day

   * Anna
      * WBS 2.3: HTCondor is not installed somewhere (?), working on that
      * WBS 2.4: start next week

   * Software: assigning people to tasks soon


---+++ 12 February 2015 – Weekly conference call

1:00–2:00 p.m. CT%BR%*Attending:* Bo, Chander, Frank, Jeff, Tim, !RobG, Ilija, Lincoln, Anna, Tanya, Robert

   * Frank gave high-level charge
      * About one third of OSG’s hours went to non-CMS/ATLAS users, which should be considered a success
      * Data over about a few GB doesn’t work in OSG
      * We want to make it easy to do 10&nbsp;TB instead of 10&nbsp;GB
      * Set up !XRootD caches – 10 sites with $5,000 in hardware, about 48&nbsp;TB cache connected to 10&nbsp;Gb/s network
      * We have a few customers with 100&nbsp;GB–10&nbsp;TB data across OSG
      * It is an assumption that the input files are read-only
      * It is fair to claim success if the input files are 10&nbsp;GB or greater
      * Users will upload about 1&nbsp;TB data into custodian [later named “origin server”], then cached across OSG
      * It is explicitly out-of-scope to deal with cache thrashing; OSG will have to manage users and caches manually
   * Reviewed high-level deliverables in [[SW023_XrootdAcrossOsg][the project plan]]
   * Chander: is there a set of constraints on the project?
      * Can we say that “no compute is required to do anything to participate”?
      * Generally, there are no extra requirements on sites to participate – everything is in the origin servers, caches, glidein pilot environment, and OASIS
      * Users do not see !XRootD protocol details - only our defined interfaces (cp, file transfer, posix).
      * “Do we make VOs register their source endpoints?”
         * Yes: We have this be “invite only” right now (OSG VO [XD allocation, Connect], Simons Foundation, and IF). Not open to other VOs until the system is delivered.
         * Only thing required is !XRootD API; we can open up in the future.
      * Suggestion from Chander: Look at the notes from the !iRODS project.
      * How many origin servers can a site have?
   * !TimC: How does this look to the user?
      * All software and environment variables are setup by the pilot; possibly pulling software from OASIS.
      * The POSIX-complaint preload library method for accessing data is the most ambitious, lower priority, and maybe at a later date
      * Pilot will need to figure out the location of the nearest cache (or skip it altogether if it’s running at the source site!).
   * Anna:  Updates since Xrootd workshop:
      * Improve monitoring information from stashcp itself.
      * Waiting on software update from !XRootD.
      * 7 caches: UC (one testing, one production), IU, BU (broken?), UNL, UCSD, Illinois
      * All underneath https://github.com/OSGConnect/StashCache
   * Note to self: Need to make diagrams!
   * Milestones:
      * Beta version: AHM.  All components (RPMs) in place at some level.
      * Version 1: HTCondor Week.
      * After that, move out to “regularly scheduled areas”.
   * Review of responsibilities: see updated twiki pages.
   * Try to squeeze this to a 30 minute meeting (1:30–2:00?)

---+++ 29 January 2015 – UCSD

*Attending:* Brian Bockelman, Tim Cartwright, Rob Gardner, Bo Jayatilaka, Rob Quick, Frank Würthwein

The notes below are mostly transcribed (with a few clarifications) from whiteboard notes of a project brainstorming session. The <a href="%ATTACHURLPATH%/stashcache-whiteboard-2015-01-29.png"/>original whiteboard photo</a> is attached for reference.

90 TB Stash with !XRootD at University of Chicago &rarr; Custodian A

Proxy caches:
   * University of Chicago, UCSD, Indiana University, Boston University
   * (BNL, UNL, UW, SLAC)

Top-level namespace [as agreed upon by all present]:
   * =/stash= – for OSG Connect users
   * =/osgxd= – for OSG-XD users
   * =/<em>VO-NAME</em>= – for VO members (where VO names are according to OIM)

Changes:
   * Add OSG redirector
   * Each cache has some HTCondor information to push info to collector at Indiana University:<br>(OSG Software team will write cron/Python to do this)
      * Total size of cache
      * Amount of data in cache
      * “Heartbeat” [= Timestamp of last report?]
      * Amount of data written today
      * &hellip;
   * HTCondor master runs the !XRootD server
   * Explicit HTCondor group within OSG VO pool
      * Business rule for !ClassAd attribute that declares “I want to use data federation”
   * Use chirp in combination with =stashcp= to put success/failure/performance [information] into !ClassAd
   * Plugin for HTCondor such that files from cache can be used as part of HTCondor file transfer
   * Streamline the setup scripts that establish OSG runtime environment
   * AAA to do a code review of preload library

Brian B. and Tim C. will take care of all of the above changes except for the first one (“Add OSG redirector”)

%META:FILEATTACHMENT{name="stashcache-whiteboard-2015-01-29.png" attachment="stashcache-whiteboard-2015-01-29.png" attr="h" comment="StashCache UCSD meeting whiteboard - 2015-01-29" date="1425398042" path="stashcache-whiteboard-2015-01-29.png" size="6428604" stream="stashcache-whiteboard-2015-01-29.png" tmpFilename="/usr/tmp/CGItemp45018" user="TimCartwright" version="1"}%
