%META:TOPICINFO{author="DerekWeitzel" date="1471470681" format="1.1" reprev="1.1" version="1.1"}%
%META:TOPICPARENT{name="DerekWeitzel"}%
%TOC{depth="3"}%

---++ About This Guide

[[http://xrootd.org/][XRootD]] is a hierarchical storage system that can be used in a variety of ways to access data, typically distributed among actual storage resources. One way to use !XRootD is to have it refer to many data resources at a single site, and another way to use it is to refer to many storage systems, most likely distributed among sites. An !XRootD system includes a _redirector_, which accepts requests for data and finds a storage repository&nbsp;&mdash; locally or otherwise&nbsp;&mdash; that can provide the data to the requestor.

Use this page to learn how to install, configure, and use an !XRootD storage server for anonymous read-only access to a filesystem.


---++ Before Starting

Before starting the installation process, consider the following points:

   * *User IDs:* If it does not exist already, the installation will create the Linux user ID =xrootd= <!-- no fixed UID -->
   * *Networking:* The !XRootD service uses port 1094 by default


%INCLUDE{"Documentation/Release3/YumRepositories" section="OSGRepoBrief" }%

---++ Install !XrootD Server

An installation of the !XRootD server consists of the server itself and its dependencies. Install these with Yum:

<pre class="rootscreen">%UCL_PROMPT_ROOT% yum install xrootd</pre>

---++ Configuring the !XRootD Server

The default configuration of !XrootD from the OSG is designed for a clustered xrootd system.  Since we are installing a *standalone* !XrootD server, we have to change the configuration.

In the file =/etc/sysconfig/xrootd=, uncomment the following line:

<pre class="file">XROOTD_DEFAULT_OPTIONS="-l /var/log/xrootd/xrootd.log -c /etc/xrootd/xrootd-standalone.cfg -k fifo"</pre>

Next, we have to specify what directory to share, and what permissions are available on that directory.  In the file =/etc/xrootd/xrootd-standalone.cfg=, locate the line:

<pre class="file">all.export %RED%/tmp%ENDCOLOR%</pre>

Replace the =%RED%/tmp%ENDCOLOR%= with the directory you wish to give others access.  Further, add the option =readonly= after the directory to enforce read-only access of the shared directory.

As an example, if we are sharing the directory =/store=, the option would look like:

<pre class="file">all.export /store readonly</pre>


---++ Start the !XrootD Service

Starting the !XrootD service is through the usual =service= command:

<pre class="rootscreen">service xrootd start</pre>

---++ Testing !XrootD

To test our new !XrootD server, we must:

   1. Install the =xrootd-client= package.
   <pre class="rootscreen">yum install xrootd-client</pre>
   1. Create a test file in the directory we configured to share above.
   <pre class="rootscreen">dd if=/dev/urandom of=/store/random.big bs=1M count=20</pre>
   1. Run the =xrdcp= command to test copy that file.
   <pre class="rootscreen">xrdcp root://localhost:1094//store/random.big ./</pre>
   1. Confirm that both files are the same
   <pre class="rootscreen">md5sum /store/random.big ./random.big</pre>

---++ Debugging Failures

If any failures occur during testing or otherwise, it can always be useful to look at the !XrootD logs located in =/var/log/xrootd=.  Further, the =xrdcp= command can increase the debugging and verbosity with the =-d3= option.

<pre class="rootscreen">xrdcp %RED%-d3%ENDCOLOR% root://localhost:1094//store/random.big ./</pre>  
