%META:TOPICINFO{author="JohnWeigand" date="1204124810" format="1.1" reprev="1.1" version="1.1"}%
%META:TOPICPARENT{name="JohnWeigand"}%
<!--
  set x = y
-->

---+!!<nop>Auhtz Tool Notes
%TOC%
%STARTINCLUDE%

---++ Overview
The intent is  to enhance GUMS with a new interface. This will create a gridmap-file equivalent that will show VO/fqan vs. account name (e.g. group name OR pool name + range of available accounts), for a given host. Invoking the interface will NOT change the GUMS db config (no instantiation of DN to account mappings).

It is envisioned that OSG will maintain such a map in the OSG pacman cache, together with the gums.template. This map contains all VOs and FQANs supported by OSG. The map is derived from the template and can be created whenever the gums.template changes.

RSV probes will be written and run on each gatekeepers. The probes download the official OSG map and compare it with the GUMS configuration at the site and  the available accounts at the gatekeeper. 
   1 Do all account mapped by GUMS exist on the CE? ERROR
   1 Do all VO in OSG have maps? WARNING
   1 Is there an FQAN specified by a VO that is NOT mapped in GUMS?
   1 Are there 2 FQANs mapped to the same username ? WARNING
      * 2 users from 2 different VOs mapped to the same account: ERROR
   1 Are there 2 FQANs mapped to the same pool account (i.e. they should have different privileges) ? WARNING
   1 User group is defined in GUMS, but no members. E.g. There is a typo -> when GUMS tries to contact VOMS it cannot pull anything. OR you just added the group but GUMS is not synch'ed yet OR VOMS has an expired certificate. WARNING.

For OSG v1.0.0, we are evaluating if we can provide test 1-3. This should take 1 month FTE (until mid Mar). Other tests can be implemented at a later time in the RSV framework. 

Assumption: only group and pool accounts are used; manual and ldap mappers are more complicated: 

---++ Do all account mapped by GUMS exist on the CE? ERROR
---+++ Purpose
Verify that all UNIX accounts that can be assigned by GUMS exist on the CE node.  This insures that a grid user who is authorized to use the services will not be rejected because the UNIX account does not exist.

---+++ Notes
These are already identified as a part of the _gums-host-cron_ and _edg-mkgridmap_ cron services.

When these cron processes are run a check is made to verify the UNIX account exists.

These are identified in the _VDT_LOCATION/monitoring/osg-undefined-accounts.txt_ file.
   * This file is only updated (i.e., the timestamp changed) if there was a change.
   * To verify when this check was last performed, you can check the timestamp on the _VDT_LOCATION/monitoring/osg-undefined-accounts.txt/last_checked_ file.

The script that performs the check for UNIX accounts is _$VDT_LOCATION/osg-vo-map/sbin/check-vo-map_ . It does a simple _/usr/bin/id_ on the accounts that would/are assigned.

---+++ Deficiencies
   1 For pool accounts, only those accounts that have been assigned are used in the 
 _./gums/scripts/gums-host generateOsgUserMap_ client process used by the the _gums-host-cron_  service.  Therefore, those accounts that have been allocated, but not yet assigned, are not checked.

---+++ Documentation
Can be found in the [[ReleaseDocumentation/ValidateVoAccess][Validate VO Access]] twiki as a part of [[ReleaseDocumentation/SiteValidationTable][Site Validation]] within OSG.


---++ Do all VO in OSG have maps? WARNING
---+++ Purpose
---+++ Notes
---+++ Deficiencies
---+++ Documentation
Documentation can be found in the [[ReleaseDocumentation/ValidateVoAccess][Validate VO Access]] twiki as a part of [[ReleaseDocumentation/SiteValidationTable][Site Validation Table]] within OSG.

---++ Is there an FQAN specified by a VO that is NOT mapped in GUMS?
---+++ Purpose
---+++ Notes
---+++ Deficiencies
---+++ Documentation

---++ Are there 2 FQANs mapped to the same username ? WARNING

      * 2 users from 2 different VOs mapped to the same account: ERROR
---+++ Purpose
---+++ Notes
---+++ Deficiencies
---+++ Documentation

---++ Are there 2 FQANs mapped to the same pool account (i.e. they should have different privileges) ? WARNING
---+++ Purpose
---+++ Notes
---+++ Deficiencies
---+++ Documentation

---++ User group is defined in GUMS, but no members. 
---+++ Purpose
---+++ Notes
---+++ Deficiencies
---+++ Documentation


%STOPINCLUDE%

-- Main.JohnWeigand - 27 Feb 2008
