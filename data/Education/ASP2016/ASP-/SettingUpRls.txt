%META:TOPICINFO{author="ForrestChristian" date="1172615688" format="1.1" reprev="1.1" version="1.1"}%
%META:TOPICPARENT{name="LectureEightTutorial"}%
%LINKCSS%

---+ Setting Up The Replica Catalog (RLS)
%STARTINCLUDE%
%EDITTHIS%

In this exercise you will insert entries into the Replica Catalog. The replica catalog that we use is <span class="firstterm">Globus RLS</span>.

A Replica Catalog maintains the lfn to pfn mapping for the input files of your workflow. Pegasus queries it to determine the locations of the raw input data files required by the workflow. Additionally, all the materialized data is registered into RLS for data reuse later on. 

You can use the =rc-client= command to insert, query and delete from the replica catalog.

The input data to be used for your workflow resides in the =$HOME/Data= directory. We are going to insert entries into the replica catalog that point to the files in this directory.

The instructors have provided a replicas.in.template, the input data file for the rc-client that  contains the mappings that need to be populated in the RLS.

You will need to write some things yourself, by following the instructions below:

<ol>
   <li>Copy the template file to a file (=replicas.in=) in the =COMPOUND= subdirectory. </li>
   <li>Do =@USER@= substitution on the copied file. Replace =@USER@= with your username of the form =trainXX=. </li>
   <li>Insert the entries in the RLS and verify if they are correctly inserted.
       <pre class="screen">
$ <span class="in">cp /opt/vdltut/PEGASUS?replicas.in.template replicas.in</span>
$ <span class="in">vi replicas.in</span>
</pre> </li>
   <li>Let's see what the file looks like.
      <pre class="screen">
$</span> <span class="in">cat replicas.in</span>
<span class="out">train99_180.2004.1014.0.raw gsiftp://gridlab1/opt/vdltut/Data/180.2004.1014.0.raw pool="local" 
train99_180.2004.1014.2.raw gsiftp://gridlab1/opt/vdltut//Data/180.2004.1014.2.raw pool="local"
train99_180.2004.1017.1.raw gsiftp://gridlab1/opt/vdltut/Data/180.2004.1017.1.raw pool="local"
train99_180.2005.0126.0.raw gsiftp://gridlab1/opt/vdltut/Data/180.2005.0126.0.raw pool="local"
train99_180.2005.0926.0.raw gsiftp://gridlab1/opt/vdltut/Data/180.2005.0926.0.raw pool="local"
train99_180.2005.0126.1.raw gsiftp://gridlab1/opt/vdltut/Data/180.2005.0126.1.raw pool="local"
train99_180.geo gsiftp://gridlab1/opt/vdltut/Data/180/180.geo pool="local"</span> 
</pre> </li>
   <li> Now we are ready to run =rc-client= and populate the data. Since each of you have uniques lfn's that are being registered, all the 7 entries should be successfully registered.
      <pre class="screen">
$ <span class="in">rc-client --insert replicas.in</span>
<span class="out">#Successfully worked on    : 7 lines
#Worked on total number of : 7 lines.</span> 
</pre> </li>
   <li> <p>Now the entries have been successfully inserted into the LRC. We should confirm whether the mappings have propogated to the RLI or not. Let us wait about 30 seconds and then query the replica catalog for a particular lfn.</p> <p>Run =rc-client lookup @USER@_180.geo= where =@USER@= is replaced by your username (e.g., =train76=).</p>
       <pre class="screen">
$ <span class="in">rc-client lookup train_180.geo</span>
<span class="out">train46_180.geo gsiftp://skynet-login.isi.edu/opt/vdltut/Data/180/180.geo pool="local"</span>
</pre> </li>
</ol>

Congratulations!! You have the replica catalog setup correctly for use. This is the catalog which you will tinker with most, while running Pegasus.


%STOPINCLUDE%

%BOTTOMMATTER%
-- Main.ForrestChristian - 27 Feb 2007
