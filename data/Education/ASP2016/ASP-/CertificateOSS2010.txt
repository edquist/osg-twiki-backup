%META:TOPICINFO{author="AlainRoy" date="1279565890" format="1.1" version="1.4"}%
%META:TOPICPARENT{name="MaterialsOSS2010"}%
---+ Getting a Certificate 

---++ Introduction

We'd like you to get a certificate on your own time before Tuesday morning. For now, we're asking you to walk through this process without much explanation of the background. We want you to have the certificate ready to use, and various aspects will be explained as needed throughout the school. 

Your certificate (really, your pair of public certificate and private key) are needed for security purposes. They are used to uniquely identify you when you access computing or storage resources in Open Science Grid. 

Your certificate is based on the underlying Public Key Infrastructure ([[http://en.wikipedia.org/wiki/Public_key_infrastructure][background from Wikipedia]]). 

---++ Getting your certificate

---+++ If you already have a certificate from DOEGrids

If you already have a certificate from DOEGrids, email the DN to Alain Roy, roy@cs.wisc.edu. 

---+++ If you don't have a certificate

_Step 1:_ Log into vdt-itb.cs.wisc.edu. You should have been provided with the user name and password when you arrived at the school. Let us know if you cannot log in.

_Step 2:_ Run the following =cert-request= command, changing the text in red:
<pre style="margin-left:4em">
> cert-request -ou p -agree \
     -name %RED% "Firstname Lastname"%ENDCOLOR% \
     -email %RED%your@email.address%ENDCOLOR%  \
     -phone %RED%123456789%ENDCOLOR% \
     -reason "Student at OSG Summer School 2010" \
     -affiliation osg \
     -vo OSGEDU \
     -sponsor_name "Alain Roy" -sponsor_email roy@cs.wisc.edu -sponsor_phone 6082655736  \
     -label certrequest 
</pre>

_Step 3:_ You'll be prompted for a password (a.k.a PEM pass prhase). Use a good one and don't forget it. Also, look at the output. Notice that there is a serial number in it. Tell Alain what the serial number is.
<pre style="margin-left:4em">
checking CertLib version, V2-5,  This is latest version, released 24 Aug 2007. 
Processing OU=People request. 
you will be  prompted for a passphrase to encyrpt the private key that is being generated. 
Generating a 2048 bit RSA private key 
....+++ ................................+++ 
writing new private key to '~/.globus/req1key.pem' 
Enter PEM pass phrase: %RED%Type a good password here %ENDCOLOR%
Verifying - Enter PEM pass phrase: 
----- 
osg OSG OSG:OSG  
Your Certificate Request has been successfully submitted 
Your Certificate Request id: %RED%99999%ENDCOLOR%
You will receive a notification email from the CA when your certificate         
has been issued. Please disregard the instructions to download your         
certificate though a web browser and use the cert-retrieve script instead.
</pre>

_Step 4:_ Once Alain tells you that you've gotten a certificate, you can download it with the =cert-retrieve= script. You'll get an automated email, and it will contain a _certificate serial number_. Change the serial number (in red) to match the serial number in the email.
<pre style="margin-left:4em">
> cert-retrieve -serialnum %RED%99999%ENDCOLOR% \
     -label certrequest \
     -p12 mycert.p12
checking CertLib version, V2-5,  This is latest version, released 24 Aug 2007.  
using CA doegrids Using URL 
https://pki1.doegrids.org/displayBySerial?op=displayBySerial&serialNumber=0xNNNN 
Checking that the usercert and ~/.globus/req1key.pem match 
Enter pass phrase for /home/olson/.globus/req1key.pem: 
writing RSA key 
~/.globus/usercert.pem and ~/.globus/userkey.pem now contain your Globus credential 
Enter pass phrase for ~/.globus/userkey.pem: 
Enter Export Password: 
Verifying - Enter Export Password: 
Your PKCS12 file mycert.p12 credential with your certificate and private key was generated.  
For information on how to import it into your favorite browser or email application   
Google  import certificate  
and you will get lots of examples.
</pre>

_Step 5:_ Try out your new certificate:
<pre style="margin-left:4em">
% voms-proxy-init -voms osgedu
Enter GRID pass phrase:
Your identity: /DC=org/DC=doegrids/OU=People/CN=Alain Roy 424511
Creating temporary proxy ................................................................... Done
Contacting  voms.grid.iu.edu:15003 [/DC=org/DC=doegrids/OU=Services/CN=http/voms.grid.iu.edu] "osgedu" Done
Creating proxy ............................. Done
Your proxy is valid until Wed Jul  7 05:37:09 2010
</pre>