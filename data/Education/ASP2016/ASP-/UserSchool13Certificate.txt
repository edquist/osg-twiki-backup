%META:TOPICINFO{author="AlainDeximo" date="1371748921" format="1.1" version="1.3"}%
%META:TOPICPARENT{name="UserSchool13Materials"}%
---+ Getting a Certificate 

---++ 1.0 Introduction

We'd like you to get a certificate on your own time before Tuesday morning. For now, we're asking you to walk through this process without much explanation of the background. We want you to have the certificate ready to use, and various aspects will be explained as needed throughout the school. 

Your certificate (really, your combination of a public certificate and private key) are needed for security purposes. They are used to uniquely identify you when you access computing or storage resources in Open Science Grid. 

Your certificate is based on the underlying Public Key Infrastructure ([[http://en.wikipedia.org/wiki/Public_key_infrastructure][background from Wikipedia]]). 

---++ 2.0 Getting your certificate

---+++ 2.1 If you already have a certificate from DOEGrids

If you already have a certificate from DOEGrids, email the DN to Tim Cartwright, cat@cs.wisc.edu. 

---+++ 2.2 If you don't have a certificate

If you don't already have a certificate from DOEGrids (and this is probably most of you.)

_Step 1:_ Start your browser and go to https://oim.grid.iu.edu/oim/certificaterequestuser.

_Step 2a:_ Begin by selecting the appropriate VO from the drop down menu, which in this case will be OSGEDU.%BR% 

               %ATTACHURL%/VO_select.png  %BR%

_Step 2b:_ Next be sure that Tim's name shows up by default as the sponsor.  If you do not see Tim's name then drill down on the drop box and select his name as the sponsor.%BR% 

               %ATTACHURL%/Sponsor_select.png  %BR%

_Step 2c:_ Now read through the OSG Policy Agreement and after having done so, check the "I AGREE" box and click on Submit..%BR% 

               %ATTACHURL%/OSG_Policy.png  %BR%

_Step 3a:_ After having submitted your request, you will receive an automated email regarding your request.  It will contain your requested DN and a link to the request ticket.

              %ATTACHURL%/Request_email.png  %BR%  

_Step 3b:_ Once the RA agent of the OSGEDU VO (Tim) has approved your request, you will receive another automated email regarding your request with a link to download your certificate.

              %ATTACHURL%/Approved_email.png  %BR%  

_Step 4a:_ Now click on the link found in the email where it says "To retrieve your certificate please visit."  You will then be taken to your "User Certificate Requests" page in OIM.

_Step 4b:_ On this page you will be able to download your approved user certificate.  To do so, you first will have to go down to the section labeled "Next Action", enter your password twice and click on "Issue Certificate..."
                  
*Note:* Please be sure to note your password and to enter it correctly.  The password is not stored in the system in any way.  The password is used to encrypt your private key and isn't known by OSG as a security measure.  The only course of action is to cancel out the request and to submit another one. 

              %ATTACHURL%/Enter_password.png  %BR% 

_Step 4c:_  The page will refresh and this is where you will download your certificate.  To download your certificate go down to the section labeled "Certificates" and click on the button "Download Certificates & Private Key (PKCS12)." 

*Note:* Please be sure to note the directory/folder where the certificate will be saved.   The file will be saved as a .p12 file.

_Step 5:_ Try out your new certificate:
<pre style="margin-left:4em" class="screen">
% voms-proxy-init -voms osgedu
Enter GRID pass phrase:
Your identity: /DC=org/DC=doegrids/OU=People/CN=Alain Roy 424511
Creating temporary proxy ...................................................... Done
Contacting  voms.grid.iu.edu:15003 [/DC=org/DC=doegrids/OU=Services/CN=http/voms.grid.iu.edu] "osgedu" Done
Creating proxy ......................................................................... Done

Your proxy is valid until Sun Jun 24 00:24:21 2012
</pre>

---++ 3.0 Converting .p12 to .pem

To convert a single =.p12= file into two =.pem= files:

<pre style="margin-left:4em" class="screen">
openssl pkcs12 -in <em>cert</em>.p12 -clcerts -nokeys -out $HOME/.globus/usercert.pem
openssl pkcs12 -in <em>cert</em>.p12 -nocerts -out $HOME/.globus/userkey.pem
</pre>

%META:FILEATTACHMENT{name="VO_selection.png" attachment="VO_selection.png" attr="h" comment="" date="1371736285" path="VO_selection.png" size="86913" stream="VO_selection.png" tmpFilename="/usr/tmp/CGItemp23065" user="AlainDeximo" version="1"}%
%META:FILEATTACHMENT{name="OSG_policy_agreement.png" attachment="OSG_policy_agreement.png" attr="h" comment="" date="1371736850" path="OSG_policy_agreement.png" size="112603" stream="OSG_policy_agreement.png" tmpFilename="/usr/tmp/CGItemp23180" user="AlainDeximo" version="1"}%
%META:FILEATTACHMENT{name="Request_email.png" attachment="Request_email.png" attr="h" comment="" date="1371738756" path="Request_email.png" size="30635" stream="Request_email.png" tmpFilename="/usr/tmp/CGItemp23321" user="AlainDeximo" version="1"}%
%META:FILEATTACHMENT{name="Approved_email.png" attachment="Approved_email.png" attr="h" comment="" date="1371739185" path="Approved_email.png" size="34119" stream="Approved_email.png" tmpFilename="/usr/tmp/CGItemp23082" user="AlainDeximo" version="1"}%
%META:FILEATTACHMENT{name="VO_select.png" attachment="VO_select.png" attr="h" comment="" date="1371740118" path="VO_select.png" size="12328" stream="VO_select.png" tmpFilename="/usr/tmp/CGItemp23230" user="AlainDeximo" version="1"}%
%META:FILEATTACHMENT{name="Sponsor_select.png" attachment="Sponsor_select.png" attr="h" comment="" date="1371740370" path="Sponsor_select.png" size="7077" stream="Sponsor_select.png" tmpFilename="/usr/tmp/CGItemp23089" user="AlainDeximo" version="1"}%
%META:FILEATTACHMENT{name="OSG_Policy.png" attachment="OSG_Policy.png" attr="h" comment="" date="1371740684" path="OSG_Policy.png" size="40227" stream="OSG_Policy.png" tmpFilename="/usr/tmp/CGItemp23053" user="AlainDeximo" version="1"}%
%META:FILEATTACHMENT{name="Enter_password.png" attachment="Enter_password.png" attr="h" comment="" date="1371742320" path="Enter_password.png" size="24866" stream="Enter_password.png" tmpFilename="/usr/tmp/CGItemp23053" user="AlainDeximo" version="1"}%
%META:FILEATTACHMENT{name="Click_download.png" attachment="Click_download.png" attr="h" comment="" date="1371743003" path="Click_download.png" size="29519" stream="Click_download.png" tmpFilename="/usr/tmp/CGItemp23106" user="AlainDeximo" version="1"}%
%META:TOPICMOVED{by="AlainDeximo" date="1371748921" from="Education.OSGSS2013Certificate" to="Education.UserSchool13Certificate"}%
