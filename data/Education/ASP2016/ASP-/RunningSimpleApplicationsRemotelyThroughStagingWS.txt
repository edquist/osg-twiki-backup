%META:TOPICINFO{author="BenClifford" date="1181334554" format="1.1" version="1.2"}%
%LINKCSS%

---+ Running a simple application remotely, through "staging"

%STARTINCLUDE%
%EDITTHIS%

Now we'll create a simple application - in this case a shell script - and send the application itself to remote Grid sites. We'll call this application =genr=  - a simple script to generate fixed-width pseudo-random numbers.

<pre class="programlisting">
#! /bin/sh
NLINES=$1
NDIGITS=$2
awk "BEGIN {
  for (i = 0 ; i < $NLINES; i++ ) {
    print int(rand() * 10^$NDIGITS )
  }
}"
</pre>

<ol></li>
   <li>Using copy/paste, copy the script above into a new file named =genr=. </li>
   <li>Save the file in your home directory on %LOGINHOST%.</li>
   <li>Make the =genr= script executable: 
<pre class="screen">
%LOGINHOSTSHORT%$ <userinput>chmod +x genr</userinput>
</pre></li>
   <li>Test the script locally.
        <p>Your genr script should behave like this:
<pre class="screen">
%LOGINHOSTSHORT%$ <userinput>./genr 5 8</userinput> # 5 lines of 8 digits
23778751
29106573
84581385
15220829
58553734
$ 
</pre></p></li>
   <li>Test =genr= under =globusrun-ws= to make sure it runs locally through the Globus GRAM interface:
<pre class="screen">
%LOGINHOSTSHORT%$ <userinput>globusrun-ws -submit -s -job-command /home/train99/genr 5 5</userinput>
23773
29102
84589
15225
58553
$
</pre></li>
   <li>Execute =genr= on %OTHERHOST% from %LOGINHOST%:
<pre class="screen">
%LOGINHOSTSHORT%$ <userinput>globusrun-ws -submit -F %OTHERHOST% -s -job-command /home/train99/genr 5 4</userinput>
</pre>

    <p>What happens? Why?</p></li>

<li>So now we introduce a new command, globus-url-copy, that can be used to copy files between grid nodes:

<pre>
%LOGINHOSTSHORT%$ globus-url-copy file:///home/train99/genr gsiftp://%OTHERHOST%/home/train99/
%LOGINHOSTSHORT%$ globusrun-ws -submit -F %OTHERHOST% -s -job-command /bin/chmod +x /home/train99/genr
</pre>
</li>

<li>Now try running the submission again. Does it work now?</li>

</ol>

Can you run the same application on <em>%GRIDHOST%</em>?  Did it really stage, or did the application already exist out there?  How can you be sure?


<!-- ***  Comments plugin to create comments table for section   ***    -->

<span style="text-align:center; font-weight:bold; font-size:1.2em;">ADD A COMMENT</span>
%STARTMore%

%TABLE{ }%
|  *COMMENT*  |  *NAME*  |  *DATE*  |
%COMMENT{ type="tableappend" }%

%ENDMore%
<!-- ***  End Comment                                            ***    -->



%STOPINCLUDE%

%BOTTOMMATTER%
-- Main.ForrestChristian - 29 Jan 2007: edited from original

<!--                                                                            
      * Set LOGINHOST = workshop2.lac.uic.edu
      * Set LOGINHOSTSHORT = workshop1
      * Set LOGINIP = 131.193.181.56
      * Set GRIDHOST = tg-login.sdsc.teragrid.org
      * Set OTHERHOST = workshop2.lac.uic.edu
      * Set OTHERHOSTSHORT = workshop2
      * Set CERTSUBJECT = /O=Grid/OU=OSG/CN=Training User 99
      * Set LOGINNAME = train99
      * Set HOMEDIR = /home/%LOGINNAME%
--> 
