%META:TOPICINFO{author="BrianLin" date="1437605726" format="1.1" version="1.6"}%
%META:TOPICPARENT{name="UserSchool15Materials"}%
---+ Wednesday Exercise 1.1: Refresher - Making a simple DAG

The goal of this exercise is to map the physical locations of some worker nodes in our local cluster. To do this, you will write another 'wide' DAG that will submit many jobs into the cluster and concatenates the results into a single file.

---++ Where in the World Are My Jobs?

To find the physical location of the computers your jobs our running on, you will be utilizing a method called geolocation. Geolocation uses a computer's public IP address and matches it to an IP address registry that has the computer's approximate location. The following is a Python script that finds geolocates the machine that it is running on, returning latitude and longitude coordinates:

<pre class="file">
#!/bin/env python

import socket
import urllib2
import json

hostname = socket.getfqdn()
ipaddr = socket.gethostbyname(hostname)
response = urllib2.urlopen('http://www.freegeoip.net/json/' + ipaddr).read()
json_response = json.loads(response)
print "%s,%s" % (json_response['latitude'], json_response['longitude'])
</pre>

   1. In a new folder on =osg-ss-submit=, save the above Python script into a file called =location.py=
   1. Create a submit file that runs =location.py=
   1. Write a script that will concatenate all of the output files from the previous step. Here's an example:\
<pre class="file">#!/bin/env sh

cat hostname-*.out
</pre>\
<p>In this script, the * acts as a *wildcard*, meaning that it wi</p> 

---++ Using the Output

http://www.mapcustomizer.com/
http://multiplottr.com/

%META:TOPICMOVED{by="BrianLin" date="1437598620" from="Education.UserSchool15Wed11Glideins" to="Education.UserSchool15Wed11DagRefresher"}%
