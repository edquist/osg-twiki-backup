%META:TOPICINFO{author="BrianBockelman" date="1278460743" format="1.1" reprev="1.1" version="1.1"}%
%META:TOPICPARENT{name="MaterialsOSS2010"}%
---+ Condor-G Exercises

---+ About This Document

This document contains the initial exercises related to using Condor-G.  After completing these exercises, you should be able to:
   * Understand how to turn a Condor job into a Condor-G job.
   * Manage (submit, query, remove) grid jobs using Condor-G.
   * Convert a scientific workflow from Condor to the grid.

Prior to completing this document, you should have completed the Condor and proxy exercises.

---++ Condor-G Submit Files

The =condor_schedd= daemon controls the contents of a Condor queue; it interacts directly with the negotiator (to match a job to a worker node) and a startd (which runs the job on behalf of the schedd).

With Condor-G, a user can utilize the familiar interfaces and capabilities of the schedd (familiar submit file format, queueing, state tracking, job submitting, etc) and have a separate process, the "gridmanager" do the internal state tracking.  The gridmanager interacts with the grid so the user doesn't have to.  Each grid middleware flavor can implement their own gridmanager process, allowing Condor to interact with many different grid types (even if it's really a "cloud", such as EC2, not a true grid).

To tell Condor to use "Condor-G" mode, you need to specify the job to be in the grid universe and specify the grid flavor.  On the OSG, we use Globus Toolkit 2's protocol, so the grid flavor is called "gt2".

Start off by saving the following script as =mytest.sh=:
%TWISTY{
mode="div"
showlink="Show simple script file..."
hidelink="Hide simple script file"
showimgleft="%ICONURLPATH{toggleopen-small}%"
hideimgleft="%ICONURLPATH{toggleclose-small}%"
}%
<pre class="file">
#!/bin/sh
echo "Hello from `hostname`"
echo "Going to source the file $OSG_GRID/setup.sh"
source $OSG_GRID/setup.sh
echo "Resulting environment:"
printenv
echo "Output of lcg-cp --help (lcg-cp is a commonly used SRM client):"
lcg-cp --help
echo 'Directories in \$OSG_APP'
ls $OSG_APP
date
sleep 120
date
</pre>
%ENDTWISTY%

Let's start with the following simple Condor job
<pre class="file">
Universe        = vanilla
Executable      = mytest.sh
Output          = job_test.output
Error           = job_test.error
Log             = job_test.log
queue
</pre>

---++ Job Submission and Management

---++ Converting and Running our Science Application on the Grid
