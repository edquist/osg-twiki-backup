%META:TOPICINFO{author="ForrestChristian" date="1175710347" format="1.1" reprev="1.4" version="1.4"}%
%META:TOPICPARENT{name="MidwestSyllabus"}%
%LINKCSS%

---+!! Tutorial: An Introduction to the Grid
%TOC%

These exercises explore some simple Grid operations to start developing a few very basic techniques for distributed computing.

We assume you're using the default "bash" shell set up on your logins on the laptops and lab servers. We recommend you don't change your shell.

---++ Connecting to the Linux training hosts 


You will be doing almost all the lab exercises this week on a set of Linux computers ("hosts") named =workshop1=, =workshop2=, =workshop3= and =workshop4= (its "fully qualified host name" looks like "%LOGINHOST%").  From these machines, we will run Grid jobs and explore various Grid sites.

To access this machine from your computer, we will use "secure shell".

On a Windows machine, we will use the PuTTY program. Open PuTTY and enter the hostname of the computer that you will use.

On a Mac, we will use the Terminal and ssh command-line tool. Open Terminal and type =ssh= followed by your training user name, an "@" symbol and the name of the computer you wish to connect to. For example:
<pre class="screen">
mac$ <userinput>ssh %LOGINNAME%@%LOGINHOST%</userinput>
The authenticity of host '%LOGINHOST% (%LOGINIP%)' can't be established.
RSA key fingerprint is 36:74:78:a8:ed:6b:38:96:63:20:01:df:46:9b:59:3b.
Are you sure you want to continue connecting (yes/no)? <userinput>yes</userinput>
Warning: Permanently added '%LOGINHOST%,%LOGINIP%' (RSA) to the list of known hosts.
%LOGINNAME%@%LOGINHOST%'s password: <userinput>PASSWORD</userinput>  <em># not echoed !!!</em>
%LOGINHOSTSHORT%$    <em># Now you're talking to a shell on the workshop1 server</em>
</pre>

After the first time you do this, you won't get the "Are you sure." prompt. Some of you will never see this, as your computers were used for testing this material, and the "yes" reply was already supplied by a tester.  So it will look like:

<pre class="screen">
mac$ <userinput>ssh %LOGINNAME%@%LOGINHOST%</userinput>
Password: <userinput>PASSWORD</userinput> 
%LOGINHOSTSHORT%$
</pre>

You should be able to reach all four lab hosts - %LOGINHOSTSHORT% ... workshop4 - in this manner.

For the rest of this exercise, we will use simpler prompts: =$laptop= for commands typed directly to the shell of your laptop Terminal window, and =%LOGINHOSTSHORT$= for the %LOGINHOSTSHORT% lab server.

---++ Conventions

Note the conventions for command-line dialogs that will be used throughout these exercises:

What you type <tt><userinput>looks like this</userinput></tt>. The system's responses =look like this=.

Our comments to you (which you should *not* enter) look like:  =<em># some comment here</em>=

<pre class="screen">
laptop$ <userinput>pwd</userinput>    <em># You type "pwd" but NOT this comment!</em>
/home/%LOGINNAME%   <em># the system's response</em>
laptop$          <em># the system's command prompt</em>
</pre>

In these exercises, we'll use the prompt =laptop$= for responses from the shell on the lab laptops, and =workshop$= (or =%OTHERHOSTSHORT%$=, =workshop3$=, etc.) for responses from remote shells. 

%NOTE% The actual shell prompts you'll see may be different from those we show here.

To start, practice cutting text from your this page in your web browser to run a command or set of commands: cut the =pwd= command from the box above and paste it into your terminal window to execute it. This is a good way to avoid making typos while entering commands from the examples.


---++ "Logging in" to the Grid

%INCLUDE{ "LoggingInToTheGrid" }%

---++ Running jobs with Globus Commands

%INCLUDE{ "RunningJobsWithGlobusCommands"}% 

---++ Running under a remote shell

%INCLUDE{ "RunningUnderARemoteShell" }% 

---++ Immediate (fork) and Batch (scheduled) Job managers


Notice that we follow the system name that you want to run the command on with the qualifier =/jobmanager-fork=. GRAM, the Globus protocol for running remote jobs, supports the concept of a "job manager" as an adapter to local job management environments.  Each "Grid site" - or collection of resources - can support one or more such job managers. The "fork" job manager runs an immediate job through the UNIX fork() interface. Another job manager we have installed on the gridlab hosts, =jobmanager-condor= acts as an interface to the Condor batch scheduling system.

Which do you think will be faster?  Lets find out: use the command =time= to test which jobmanager is faster.

To time a command, just enter =time <em>commandname</em>=:

<pre class="screen">
%LOGINHOSTSHORT%$ <userinput>time sleep 3</userinput>
</pre>

Use this to time a few trivial Grid jobs to compare =jobmanager-fork= and =jobmanager-condor=.

The "fork" job manager is very fast - it has rather low "scheduling latency".  It runs trivial commands very quickly.  But it also has no compute power - its usually just a single CPU on a cluster-controlling computer called the _gatekeeper_ or _headnode_.  A batch job manager, on the other hand, has a higher scheduling overhead.  But it gives you access to all computers in a cluster, and the opportunity to do real parallel computing.

It turns out that each of our workshop machines is just an ordinary single-processing machine. We've just "tricked" Condor onto thinking that it had a real "cluster" there with a set of CPUs. (We configured each of the hosts with 16 such virtual CPUS).

While our four gridlab hosts use the Condor scheduler, and thus =jobmanager-condor=, other systems use other schedulers. For example, systems using _PBS_ (Portable Batch System) require that you use =jobmanager-pbs=.  You'll get a chance to try this later in this lab.

Now try running a few jobs through condor:

<pre class="screen">
%LOGINHOSTSHORT%$ <userinput>globus-job-run %OTHERHOST%:/jobmanager-condor /bin/hostname</userinput>
</pre>

Next try starting five such jobs on workshop3 at once: put an "&" at the end of the line, and either use cut-and-past, or shell command history, or a simple shell script to run five of these commands at once.  



---++ Running a simple application remotely, through "staging"

%INCLUDE{ "RunningSimpleApplicationsRemotelyThroughStaging" }%

<!--                                                                            
      * Set LOGINHOST = workshop2.lac.uic.edu
      * Set LOGINHOSTSHORT = workshop1
      * Set LOGINIP = 131.193.181.56
      * Set GRIDHOST = tg-login.sdsc.teragrid.org
      * Set OTHERHOST = workshop2.lac.uic.edu
      * Set OTHERHOSTSHORT = workshop2
      * Set CERTSUBJECT = /O=Grid/OU=OSG/CN=Training User 99
      * Set LOGINNAME = train99
      * Set HOMEDIR = /home/%LOGINNAME%
--> 

