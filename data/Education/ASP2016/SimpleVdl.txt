%META:TOPICINFO{author="ForrestChristian" date="1172614248" format="1.1" version="1.1"}%
%META:TOPICPARENT{name="LectureEightTutorial"}%
%LINKCSS%

---+!! Simple VDL
%STARTINCLUDE%
%EDITTHIS%

In this exercise, you will write your own VDL to run one step in the QuarkNet? problem code, which takes the processed data and generates a graph.

You are provided with:
   * the input data files for this step, =simplevdl-extra= and =simplevdl-freqs=. (These are the same as some of the intermediate files that were generated in your =PROBINTRO/= directory). These have already been registered with the replica location system (which you will see in greater depth in a later exercise);
   * a transformation definition that defines how to use =Plot.pl= from the =<nop>QuarkCode/= directory to convert input data files into a graph, in =transform.vdl=;
   * a template file =simple.vdl.template= for the derivation.

Armed with these tools, you will need to write a derivation which uses the supplied transformation on the supplied data files to produce the output graph.

Copy the =SIMPLEVDL/= directory into your workspace, and use the supplied template to make a =simple.vdl= file:

<pre class="screen">
$ <b>cp -av /opt/vdltut/SIMPLEVDL ~ </b>

$ <b>cd ~/SIMPLEVDL/ </b>
$ <b>cp simple.vdl.template simple.vdl </b>
$ <b>vi simple.vdl </b>
</pre>

%NOTE% Or use any text editor you choose.

In the last step using vi, modify the derivation so that =@USER@= is replaced with =trainXX= in all three places that it occurs.

Now try compiling, planning and running your workflow:

<pre class="screen">
$ <b>vdlc simple.vdl transform.vdl </b>
20060609T152414.181: [app] using label "simple"
20060609T152414.182: [app] using output file "simple.dax"
$ <b>vds-plan --pegasus -g QuarkCode --option pools=local --option output=local --option force simple.dax --base ./dags </b>
[...]

2006.06.09 19:18:14.059 PDT: [INFO] Time taken to execute is 1.029 seconds
d46 1
I have concretized your abstract workflow. The workflow has been entered
into the workflow database with a state of "planned". The next step is 
to start or execute your workflow. The invocation required is

vds-run  /home/train99/SIMPLEVDL/dags/QuarkCode/simple/run0017</span>
vds-run  /home/train99/SIMPLEVDL/dags/QuarkCode/simple/run0017

$ <b>vds-run /home/train99/SIMPLEVDL/dags/QuarkCode/simple/run0017 </b>
[...]

I have started your workflow, committed it to DAGMan, and updated its
state in the work database. A separate daemon was started to collect
information about the progress of the workflow. The job state will soon
be visible. Your workflow runs in base directory

cd /home/train99/SIMPLEVDL/dags/QuarkCode/simple/run0017

$ <b>cd /home/train99/SIMPLEVDL/dags/QuarkCode/simple/run0017 </b>
$ <b>tail -f tailstatd.log </b>
[... output over time ...]
20060611T122510.413 [172]: DAGMan finished with exit code 0
20060611T122510.413 [173]: processed chunk of 1094 byte
# updated state in workman
20060611T122510.416 [173]: skipping plots
20060611T122510.416 [173]: finishing, exit with 0
20060611T122510.418 [173]: copied common log to /nfs/home/vdsuser-2/SIMPLEVDL/dags/QuarkCode/simple/run0017

$ <b>cd /nfs/scratch01/train02/QuarkCode/vdsuser-2/simple/run0017/ </b>
$ <b>cp simplevdl-myuser9999.png ~/public_html/ </b>
</pre>

Now go to [[http://skynet-login.isi.edu/~vdsuser-99999/simplevdl-myuser9999.png][http://skynet-login.isi.edu/~vdsuser-99999/simplevdl-myuser9999.png]].

%STOPINCLUDE%

%BOTTOMMATTER%
-- Main.ForrestChristian - 27 Feb 2007