%META:TOPICINFO{author="ForrestChristian" date="1170103813" format="1.1" version="1.1"}%
%META:TOPICPARENT{name="WorkshopTutorialModules"}%

---+ Running a simple application remotely, through "staging"

%STARTINCLUDE%
%EDITTHIS%

Now we'll create a simple application - in this case a shell script - and send the application itself to remote Grid sites. We'll call this application =genr=  - a simple script to generate fixed-width pseudo-random numbers.

<pre class="programlisting">
#! /bin/sh
NLINES=$1
NDIGITS=$2
awk "BEGIN {
  for (i = 0 ; i < $NLINES; i++ ) {
    print int(rand() * 10^$NDIGITS )
  }
}"
</pre>

<ol></li>
   <li>Using copy/paste, copy the script above into a new file named =genr=. </li>
   <li>Save the file in your home directory on gridlab1.</li>
   <li>Make the =genr= script executable: %BR% =$<b> chmod +x genr</b>= </li>
   <li>Test the script locally.  %BR% =$ ./genr nlines ndigits= 
        <p>Your genr script should behave like this:
<pre class="screen">
$ <userinput>./genr 5 8</userinput> # 5 lines of 8 digits
23778751
29106573
84581385
15220829
58553734
$ 
</pre></p></li>
   <li>Test =genr= under =globus-job-run= to make sure it runs locally through the Globus GRAM interface:
<pre class="screen">
gridlab1$ <userinput>globus-job-run gridlab1/jobmanager-fork /home/train35/genr 5 4 </userinput>
2377
2910
8458
1522
5855
gridlab1$
</pre></li>
   <li>Execute =genr= on the remote Grid site (gridlab3) from gridlab1:
    <pre class="screen">gridlab1$ <userinput>globus-job-run gridlab3/jobmanager-fork /home/train35/genr 5 4</userinput></pre>
    <p>What happens? Why?</p></li>
   <li>Add the =-s= or =stage= option to the request. This will automatically copy this mini-application to the remote Grid site (gridlab3) so that it can be executed there:
<pre class="screen">gridlab1$ <userinput>globus-job-run gridlab1/jobmanager-fork -s /home/train35/genr 5 4</userinput></pre></li>
</ol>

---+++ Exercise: 
Can you run the same application at ISI in California?  Did it really stage, or did the application already exist out there?  How can you be sure?


%STOPINCLUDE%
d75 12
%BOTTOMMATTER%
-- Main.ForrestChristian - 29 Jan 2007: edited from original

<!--                                                                            
      * Set LOGINHOST = workshop2.lac.uic.edu
      * Set LOGINHOSTSHORT = workshop1
      * Set LOGINIP = 131.193.181.56
      * Set GRIDHOST = tg-login.sdsc.teragrid.org
      * Set OTHERHOST = workshop2.lac.uic.edu
      * Set OTHERHOSTSHORT = workshop2
      * Set CERTSUBJECT = /O=Grid/OU=OSG/CN=Training User 99
      * Set LOGINNAME = train99
      * Set HOMEDIR = /home/%LOGINNAME%
--> 