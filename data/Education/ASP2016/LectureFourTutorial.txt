%META:TOPICINFO{author="ForrestChristian" date="1170111414" format="1.1" version="1.2"}%
%META:TOPICPARENT{name="WorkshopTutorialModules"}%
<link rel="stylesheet" type="text/css" href="%PUBURL%/%WEB%/WorkshopTutorialModules/exercises.css">

---+!! Tutorial: Grid Data Management

%TOC%


---++Getting set up

Check that you have a valid proxy.

<pre class="screen">
gridlab$ <userinput>grid-proxy-init</userinput>
Your identity: /C=US/O=Globus Alliance/OU=User/CN=10bd8f410f6.5f0086b4
Enter GRID pass phrase for this identity:
Creating proxy ................................................ Done
Your proxy is valid until: Thu Jun 22 22:15:25 2006
</pre>

Now, make a working directory for this exercise. For the rest of this exercise, all your work should be done in there.

<pre class="screen">
gridlab$ <userinput>mkdir dataex</userinput>
gridlab$ <userinput>cd dataex</userinput>
</pre>

Next create some files of different sizes, to use for exercises. Each file should have a unique name, so use your name or something similar below. For example, do the following:

<pre class="screen"> 
$ <userinput>dd if=/dev/zero of=./smallfile-train30 bs=1M count=10</userinput>
$ <userinput>dd if=/dev/zero of=./mediumfile-train30 bs=1M count=50</userinput>
$ <userinput>dd if=/dev/zero of=./largefile-train30 bs=1M count=200</userinput>
$ <userinput>ls -sh</userinput>
total 261M
201M largefile-train30   51M mediumfile-train30   11M smallfile-train30
</pre>



---++Moving files with !GridFTP

%INCLUDE{ "MovingFilesWithGridFTP" }%



---++Reliable File Transfer (RFT)

Next we'll use RFT, the reliable file transfer service, to transfer a block of files between two sites.

First, we need to create a transfer job file, which lists some RFT parameters and all of the files to transfer. You can get an example from =gridlab1:~benc/rft.xfr=. Read through this and change the URLs at the end to copy your files.

This example lists three transfers: =largefile= will be transfered three times, once each to gridlab2, gridlab3, and gridlab4.

You can launch it as follows. The client will periodically output transfer status. You can watch jobs move from the pending state, to the Active state and then to the Finished state.

<pre class="screen">
$ <userinput>cp ~train30/rft.xfr .</userinput>
$ <userinput>EDIT rft.xfr</userinput>
$ <userinput>rft -h gridlab1.phys.utb.edu -f ./rft.xfr </userinput>
Number of transfers in this request: 3
Subscribed for overall status
Termination time to set: 60 minutes

 Overall status of transfer:
Finished/Active/Failed/Retrying/Pending
0/1/0/0/2

 Overall status of transfer:
Finished/Active/Failed/Retrying/Pending
1/0/0/0/2

 Overall status of transfer:
Finished/Active/Failed/Retrying/Pending
1/1/0/0/1

 Overall status of transfer:
Finished/Active/Failed/Retrying/Pending
2/0/0/0/1

 Overall status of transfer:
Finished/Active/Failed/Retrying/Pending
2/1/0/0/0

 Overall status of transfer:
Finished/Active/Failed/Retrying/Pending
3/0/0/0/0
All Transfers are completed
</pre> 

Initally all jobs start in the pending state, move to active state and then hopefully to finished state (but maybe fail, in which case they go to the failed state).

The transfer file has a number of options, documented in-line. You can experiment changing them. Interesting ones to try:
   * Add more URLs to transfer
   * Transfer between two remote sites
   * Use parallel streams
   * Increase the transfer concurrency

In particular you should check that you understand the difference between parallel streams (the number of streams used when transferring one file) and concurrency (the number of files that can be transferred at once).



---++Finding replicas with RLS

%INCLUDE{ "FindingReplicasWithRLS" }%



---++Treasure hunt
There are three files with logical filenames =treasure1=, =treasure2= and =treasure3= stored on the grid. Use RLS to find them and RFT to move them into your home directory.

