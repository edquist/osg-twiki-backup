%META:TOPICINFO{author="BenClifford" date="1150751252" format="1.0" version="1.4"}%
%META:TOPICPARENT{name="SummerGridSyllabus2006"}%
---+Summer Grid Workshop Lab 2: Security

- SDSC Certificate already installed in default location
- CA installed for SDSC certificates
- Differentiate things that need to be done on local machine and those
on login machine.

%TOC{depth="3"}%

---++What is in a certificate

grid-cert-info

---++Use certificates to transfer file

X509_USER_CERT = cert
X509_USER_KEY = key
globus-url-copy 

Will fail since the private key is encrypted. Will need passphrase
decrypt private key.

---++Proxies
---+++Create Proxy Certificate	  

grid-proxy-init

---+++What is in a proxy

grid-proxy-info

---+++Use proxy to transfer file

Since proxy is in default location, no need to set environment
variable.

globus-url-copy

---+++Proxy lifetime

grid-proxy-init -valid 10

Use expired proxy

Wait for proxy to expire. Check by using grid-proxy-info

globus-url-copy 

Will fail because of expired proxy
Generate proxy and transfer file.

---++Obtaining a certificate

---+++Introduction to Globus Certificate Service

grid-cert-request

Copy request and paste in web form on local machine

save signed certificate to local machine

scp that to login machine

---+++Use GCS credentials to submit job to remote server

globusrun-ws whoami

Fails because CA is not trusted

---+++Use GCS credentials to submit job to local server

globusrun-ws whoami

Authorization error, since not present in gridmap file.

---+++Use gx-gridmap to add yourself to gridmap

gx-grimap

---+++Use trusted GCS credentials to subject job to local server

globusrun-ws whoami

---+++Sumbit job to run g-u-c on remote machine

---++ Delegation

globusrun-ws g-u-c 

Will fail because credentials were not delegated

---+++Sumbit job to run g-u-c on remote machine and delegate

globusrun-ws -delegate g-u-c 

---++MyProxy
load proxy

myproxy-init

Get copy to local machine

delete localcopy

run client that uses my proxy to get credential and submits job

swap machine with a friend and test 
		  a) you can run job client that uses myproxy (whoami, to see it
		  is your login)
		  b) run without myproxy (whoami, friend's login).

delete from my proxy

do (19) on your machine to see it fail.

