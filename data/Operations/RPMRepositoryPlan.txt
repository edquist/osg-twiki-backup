%META:TOPICINFO{author="ScottTeige" date="1313163008" format="1.1" reprev="1.7" version="1.7"}%
%META:TOPICPARENT{name="WebHome"}%
---+ Proposed Plan for OSG Software Repository at GOC

One side-effect of the transition to RPMs is that we have the ability to unify software repositories, and make GOC the primary endpoint for OSG software. That is, instead of having separate VDT and OSG software caches, we will have a single software repository. This repository can be mirrored. The official, supported repository should be hosted at the GOC and the contents maintained primarily by the OSG Software Team.

   1. The GOC will host the OSG Software development, testing, release, and contrib repositories at software.grid.iu.edu (and software-itb.grid.iu.edu for testing the repository creation process itself).  These require about 2 GB per repository (except contrib; size is currently minimal), and may grow to 3GB as time goes forward.
      A. The creation of these repositories will be done using the =mash= tool, which will copy software from the Koji-based build server (koji-hub.batlab.org) to the GOC. The OSG Software Team will provide the appropriate configuration files for =mash=, while Operations will script and automate its invocation.
      A. _The total estimated disk space, allowing for a comfortable safety margin is 45 GB. Is this a problem?_
      A. _Can we freeze software.grid and software-itb.grid and create a new service? Perhaps repo.grid? Not really an increase in effort since work on software.grid would be transferred to repo.grid._
   1. The development and testing repositories will be updated automatically (cronjob every 30 or 60 minutes), but the release repository is only updated manually by designated team members.
      A. The release repository will only be updated during designated release or maintenance windows.
      A. _It is anticipated that after a release many site-admins will update immediately. This raises a concern for required bandwidth. If a total of 13.6 GB is to be transferred over 4 hours this implies a required bandwidth of 7.6 Mb/sec. No problem? Check my assumptions._
      A. _There will be multiple instances of the repository implemented in Bloomington using LVS. This will allow additional capacity to be added as needed and give additional fault tolerance._
   1. The software repositories will be covered by the same [[SoftwareCacheServiceLevelAgreement][SLA as the webserver]].
      A. GOC will assist the Software team in updating the SLA as necessary.
   1. GOC will host a rsync server so sites can create their own mirrors of the repository.  We believe this service should be at a "normal" level of priority, and considered a routine IT service.
      A. _What do we need to open to the public and what are the security implications of this? Are the access mechanisms already proposed sufficient for creation of a "mirror" site?_
   1. OSG Software, Security, and Operations will come to an agreement about whether to phase-out the existing CA certificate repository, and the timeline.
      A. _Freezing software.grid is a non-destructive first step in this direction._
   1. The hosted repository will only contain precisely the contents of the repository at the OSG Software Koji server.  Specifically, if a team (such as Software, Operations _or Security_) wants to add RPMs to the repository, they will have to add it to Koji first, then promote it to the appropriate repository.  This is a limitation of =mash=.  OSG Software will help create the correct ACLs in Koji for each piece of software.  Pieces of software that will have special ACLs include:
      A. Security team will be the only ones allowed to promote CA certificates from development to testing, and from testing to release.
      A. _Security team will update the koji repository directly, the release repository will only be updated during designated release or maintenance windows._
      A. Operations team will be the only ones allowed to promote vo-client (vomses file) and osg-voms (LSC files) from testing to release.

---+ Timeline

   1. This will be filled in once Software and Operations sign off on the deliverables.
