%META:TOPICINFO{author="RobQ" date="1323807558" format="1.1" reprev="1.2" version="1.2"}%
-- Main.ScottTeige - 13 Dec 2011

---+++ The Event Timeline

*December 13th Maintenance Window*
   * 9:00 AM EST two new instances of BDII were added to DNS round robin. 
   * 10:00 AM EST is3 failed. It was found that it was erroneously also running two copies of the CEMon collector. These were removed and the service restarted. 
   * By 11:05 AM EST Both new instances failed. A request was sent to Indana University DNS adminstrators to remove the new instances from round robin. To minimize impact the services were restarted while the round robin change was made and propagated. Both instances ran without problem until the round robin change was completed. 
   * 13:00 eastern service had been restored to its previous state.

---+++ Impact
There were two partial outages effecting some (but not all) users. Each of these lasted less than 10 minutes and occurred within the maintenance window.

---+++ Cause (hypothesis at the moment)
A detailed root cause analysis is underway and will include testing to verify (or refute) the current hypothesis. Examination of the logs immediately before the two failures of instance "is3" showed that in both cases there was a large "spike" in connection requests. The request rate 5 seconds before the first failure was the largest rate observed in the time ranges examined. During the following second the request rate was zero indicating saturation of some sort had occurred. The pattern repeated twice in the following three second before the failure occurred. This situation would not have been detected by previous testing because of the design of those tests. The tests showed that a very large data rate could be achieved but used sequential connections from a relatively small number of hosts. 

---+++ Next steps
A plan using a large number of hosts making sequential requests is planned to verify or refute the above hypothesized cause. Two instances will be compared, one running on vmware, another on KVM. If the effect is reproduced steps to prevent it will be investigated, if not the root cause analysis will continue. 
