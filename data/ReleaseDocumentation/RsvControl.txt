%META:TOPICINFO{author="MarcoMambelli" date="1253898696" format="1.1" reprev="1.2" version="1.2"}%
%META:TOPICPARENT{name="WebHome"}%
---+!! *<nop>%SPACEOUT{ "%TOPIC%" }%*
%TOC%

%STARTINCLUDE%
%BR%
---+ _%INCLUDEHEADING%  %SPACEOUT{ "%TOPIC%" }%_
_Instructions for the rsv-control utility._

%EDITTHIS%
%BR%

---++ Introduction
*Metrics* are the values measured by _probes_ and have names like <tt>org.osg.general.ping-host</tt>. 
*Probes* are scripts that can be executed locally or against a specific HOST and evaluate _metrics_.
For a definition of the probes see _probe_reference_url_

---++ Installation
<pre>
download rsv-scripts-test-v08.tar.gz 
tar xvzf rsv-scripts-test-v08.tar.gz                                                                                                                                                    
cd test-rsv/bin/                                                                                                                                                                             
./config-installdir.sh    (to create links and set permissions)                                                                                                                              
</pre>

<!--
<pre>
pacman -get
</pre>
-->

---+++ Requirements
<tt>rsv-control</tt> requires Pacman for the installation.
It can be installed anywhere but it is recommended to install it inside a VDT installation.
It acts on a OSG-RSV installation and uses also Condor-Cron (required by OSG-RSV).

---+++ Upgrade
At the moment there is no upgrade of rsv-control. Just remove the installation directory and install it again.

---++ Setup
<!--
<pre>
</pre>
-->
<pre>
source $VDT_LOCATION/setup.sh                                                                                                                                             
export PATH=<install_dir>/test-rsv/bin/:$PATH                                                                                                                             
</pre>

---++ Description
<pre>
usage: rsv-control [ --verbose ] 
      --help | -h 
      --version 
      --list [ --wide | -w | --full-width] [ --format &lt;format> ] [ all | &lt;probeID>]
      --enable  [--user &lt;user>] --metric  &lt;metric-name>  --host &lt;host-name>
      --enable  [--user &lt;user>] --service &lt;service-name> --host &lt;host-name>
      --disable --metric  &lt;metric-name>  --host &lt;host-name>
      --disable --service &lt;service-name> --host &lt;host-name>
      --test    [--user &lt;user>] --metric &lt;metric-name>   --host &lt;host-name>
</pre>    

Here is a description of the options, grouped according to the command. Long options are preceeded by "--", short by "-". Options may have an argument. Between parenthesis there are alternative formats for the option. Some options specify commands for rsv-control, some are modifiers.

Generic options (no commands):
   * *--version*: show program's version number and exit
   * *--help* (*-h*): show a help message and exit

For all commands:
   * *--vdt-location=DIR* (*-pDIR*, *--vdt-install=DIR*): Specify the root directory of the OSG or VDT installation (prefer --vdt-location)
   * *--verbose-output*: verbose output

*--list* (*-l*) List probe information. If no probe is specified in the argument all probes are listed in a short tabular form. Each line has probe name, type and status or host (if the probe is enabled). Lines may be truncated to fit the page. The table list one line for each enabled metric. If that metric is not enabled against any host, it list one line with the metric status (probably DISABLED). 
   * *--wide* (*-w*): Wide list display (156 columns instead of the 76 by default)
   * *--full-width*: To avoid truncation in probe listing
   * *--format=LIST_FORMAT* (*-fLIST_FORMAT*): Specify the list format (['local', 'brief', 'long', 'full', 'log', 'out', 'err']; default: 'local')
      * *local*: status in OSG-RSV
      * *brief*: status for the submitter (condor-cron)
      * *long*: long status (output of 'condor_cron_q ID')
      * *full*: full status (full list of classads returned by condor-cron)
      * *log*: dump of the log file (userlog for condor-cron)
      * *out*: dump of the stdout returned by the probe execution againsts the specific host 
      * *err*: dump of the stderr returned by the probe execution againsts the specific host 
  
*--test* Test against the host URI the probe returning METRIC. --metric is mandatory. --host may be mandatory if the probe requires it (see the documentation for the specific probe). Probe is executed only once, immediately.
   * *--user=USER* Specify the user to run OSG-RSV probes
   * *--metric=METRIC* Specify the metric to enable/disable (e.g. <tt>org.osg.general.ping-host</tt>)
   * *--host=URI* Specify the host FQDN and optionally the port to be used by the probe (e.g. host or host:port)

*--enable* (*-e*) Enable probe. Support the same options as test plus --service.
   * *--service=SERVICE* Specify the service to enable/disable (e.g. <tt>OSG-CE</tt>)

*--disable* (*-d*) Disable probe. Support the same options as enable.
  
*--describe* NOT READY... COMING SOON: Describes the probe returning METRIC.
   * *--metric=METRIC* Specify the metric to enable/disable (e.g. <tt>org.osg.general.ping-host</tt>)

*--setup* NOT READY... COMING SOON: Setup the RSV installation (change file permissions, start Condor, ...)

---++ Use cases
Follows a list of practical use cases

---+++ List all the metrics
<pre>
./rsv-control -l
</pre>

---+++ Enable/Disable a metric

---+++ Troubleshoot a probe

---++ Known issues

---++ More information


%STOPINCLUDE%
%BR%
%COMPLETE1% %BR%
%RESPONSIBLE% Main.MarcoMambelli - 25 Sep 2009 %BR%
%REVIEW%
