%META:TOPICINFO{author="JamesBarlow" date="1266593005" format="1.1" version="1.18"}%
%META:TOPICPARENT{name="WebHome"}%
---+ Security Best Practices
%TOC%

%ICON{wip}% Work in Progress

This page documents security practices recommended by the OSG Security Team.  Many of them may be discussed on other OSG web pages, but are also included here to try and maintain a thorough list as well as being able to cover more details on this page.


---++ Risks for Grid Sites

When sites become members of the OSG (or any other grid community) there may be additional risks to the local resources associated with grid computing.  We try and outline some of these potential risks on the following page.

   * [[SecurityRisksCE][Security Risks of Grid Resources]]

---++ Communicate with Security team
   * *Notify security team of any incidents*.
      * This is the primary requirement the OSG security team places on the site admin.
      * Procedures to report security incidents are identified [[Security.IncidentDiscoveryReporting][here]]
   * We ask users and sites to report incidents so that we can
      * Access the risk it poses to the OSG at large
      * Notice any patterns in the attacks
      * Notify sites with attack information
      * Contain the spread of the incident/attack
   * Communication during incident is critical
      * Emails from/to the security team should be signed
      * Take actions advised by security team promptly
      * Need to send encrypted data. Instructions [[Security.SecureEmail][here]]
   * We work with you to keep your security incident information you send us confidential
      * We release to OSG site/VO security contacts only as much information as necessary to maintain security
   * Know your local institutions cyber-security contacts and report incidents to then in addition to OSG security team.
   * When you have questions *ASK*
      * Questions could be on general UNIX security in general or specific Grid security topics. 
      * You may have questions about specific OSG polices and procedures.
      * OSG security team and/or your fellow OSG site administrators will more often than not be able to help address your questions.
      * *PLEASE, JUST ASK*. osg-security-team@opensciencegrid.org.

---++ System Updates

Promptly apply security updates from software vendors, including operating system kernel updates and VDT updates.  This has been mentioned multiple times on our other OSG security pages, but it is still one of the best ways to protect your systems from compromise.

Resources:
   * [[ReleaseDocumentation.UpdateInstructions][Update between minor OSG revisions]]
      * Updating between minor OSG releases has been drastically improved
      * Please promptly install the latest OSG update.
   * [[ReleaseDocumentation.VdtUpdateGuide][VDT Update Guide]]
   * [[https://www.redhat.com/rhn/][Red Hat Network]]: Automates updates for Red Hat Linux systems.

---++ Securing services on your grid machines

All of your grid nodes should be configured with the best practice guideline of not running any services on the machine which are not needed.  So if local SSH access is not needed on your CE's then do not enable GSI-SSH.  Another good stance to take is don't implicitly trust your local users.  So patching against local vulnerabilities can be just as important as patching against remote vulnerabilities.  You cannot protect against a users desktop getting compromised and then being used as an attack against your systems.  Lastly, even if users do not have interactive login access to your machines they can still run pretty much anything they want with submitting jobs.  So keep your machines patched and running with the minimal services needed.


---++ Incident Handling

Promptly report security incidents involving OSG resources according to 
[[Security.IncidentDiscoveryReporting][these instructions]].

Resources:
   * [[BanningUsersAtSite][Banning User DNs at your site]]
   * [[BasicForensics][Basic Forensics Techniques]]

---++ Monitoring

Monitor for suspicious activity such as 
   * connection attempts from suspicious IP addresses
   * instances of suspicious ssh keys, files, and malware 

Recommended monitoring tools:
   * [[http://www.logwatch.org/][Logwatch]]: A customizable log analysis system.
   * [[http://www.la-samhna.de/samhain/][Samhain]]: A host-based intrusion detection system (HIDS).
   * [[http://www.bro-ids.org/][Bro]]: A network intrusion detection system (NIDS).
   * [[http://www.chkrootkit.org/][chkrootkit]]: A tool to locally check for signs of a rootkit.


---++ Firewalls and blocking hosts

Use firewalls to restrict access to system services:
   * Allow ssh connections (port 22) only from trusted hosts. See [[Security.SshHostsAllow]] for documentation on how to restrict access using =/etc/hosts.allow= and =/etc/hosts.deny=.

Firewall resources:
   * [[http://vdt.cs.wisc.edu/releases/1.10.1/firewall.html][VDT and Firewalls]] - lists all ports used with VDT software.
   * [[http://www.netfilter.org/projects/iptables/][iptables]]: The command-line program for configuring the Linux firewall.

Another option for blocking hosts is using the [[http://denyhosts.sourceforge.net/features.html][DenyHosts package]].  This package can help protect against the constant SSH brute force attacks.  It will watch the system logs and detect when a brute force attack is occurring and then block the offending host in real time.  There are many other nice features that [[http://denyhosts.sourceforge.net/features.html][DenyHosts]] also provides.

---++ Mapping Grid DN's to local accounts

At some point sites are going to need to decide on how to map users grid DN's to local accounts.  Traditionally OSG has not mandated to sites how they need to map accounts, so there are a few models that have arisen.  We'll touch on the security implications for each of these methods.

<B>Mapping DN's to a local VO account (group account)</B>

This is one of the easiest ways to enable users within VO's to run jobs at your site.  You only need to create one local user for each VO you are going to allow access, then each of the individual user's DN's within that VO will map to that local account.  Though this may be the easiest to configure, it may be one of the less secure methods.  Since all users are mapped to the same local account, that account is acting like a group account.  When a problem may occur it could lead to difficulty in tracking down which user in the VO may have caused the problem.  Also, since it is a group account all users will have access to any source or data files that are in that local accounts directory.  Some users may clean up after themselves when a job is finished, but others may not.  There may be VO's with a small number of users, who happen to share all their data and code, where this method would work great.  But this may not be the best option for all VO's.  Each site needs to determine if this is the appropriate model for them.

<B>Mapping DN's to a floating pool of accounts</B>

This method of mapping accounts may be more difficult to set up.  In this method a pool of accounts is created for each VO.  When a user is submitting a job their account will be mapped with the next available VO account in that pool of accounts.  When all accounts in the pool have been cycled through then it starts at the beginning again.  The security problems with this are similar to the problems above.  Good logging is needed in order to know which DN was mapped with which account in the pool.  Also, source and data files that are not cleaned up are left in the pool accounts directory.  I do not know of any currnt VO that is using this method, however, there are some sites in some of the European grids that are using this method.

<B>Mapping DN's to a static pool of accounts</B>

With this method a pool of accounts is created for each VO where the number of accounts will be equal to the number of users in each VO.  Then each unique DN is mapped to a unique account within the VO pool.  This is the most secure method of mapping DN's to local accounts.  In this case no user should ever be able to see another users source or data files, as well as having a straightforward auditing capability to track problems with a local account to the specific user.  There are some additional administration items to cover in this method (such as needing to create potentially hundreds or thousands of local accounts for a VO), but the benefits of this usually outweigh the risks.

<B>Mapping all DN's (in all VO's) to one account</B>

This method is NOT a supported configuration within OSG.  If it is discovered that a site has mapped all DN's in all VO's to one account then we will work with them on modifying their configuration to one of the above valid options.  The security implications of this is hopefully obvious to most admins where any data, source code, etc. will be accessible to all users in any VO.

---++ SSH Keys

Protect SSH private keys with passphrases.  There have been recent attacks at grid sites where miscreants are stealing users ssh keys, searching for keys without pass phrases, and then using those to attack other sites.

Also don't share keys.  Your account is your own (and you are responsible for it).

[[BestPractices:MonitoringSSHActivity][Simple ways to monitor your systems for SSH activity]]

---++ Account Passwords

There has been a ton of research into the use and security of passwords.  But a few of the most basic security practices for passwords are:

Use different passwords for different accounts.  Sharing passwords across different accounts may seem to make it easier, but it can also be more damaging if one of the many accounts gets compromised.

Always use good passwords.  It is good practice to use different character classes in passwords (upper, lower, numerical, special characters, etc.).  Also, pass phrases are becoming very popular to user rather than passwords.  So instead of using an 8 character password, you can use a much longer pass phrase (which may even be easier to remember), such as something like "B3tter0ffDead" (3 different character classes and 13 characters long).  But don't use that one...

---++ Security considerations when using GUMS

There is a section in the [[https://www.racf.bnl.gov/Facility/GUMS/1.4/][GUMS online documentation]] that addresses the [[https://www.racf.bnl.gov/Facility/GUMS/1.4/installation_security.html][security concerns when running a GUMS server]].

---++ Hands-on Training
   *  [[SecurityHandsOnTraining][Security Training]] (from OSG All Hands Meeting, Baron Rouge, LA, Mar 2, 2009)

---++ Reference Materials
   * [[http://tldp.org/HOWTO/Security-HOWTO/][A How-To Guide for Basic Linux Security]]
   * [[http://oreilly.com/catalog/9780596003234/][O Reilly - Practical UNIX & Internet Security]]