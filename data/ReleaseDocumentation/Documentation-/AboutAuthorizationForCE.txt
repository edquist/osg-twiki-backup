%META:TOPICINFO{author="AnneHeavey" date="1191601612" format="1.1" version="1.3"}%
%LINKCSS%

<!-- This is the default OSG Integration template. Please modify it in the sections indicated to create your topic! --> 

<!-- By default the title is the WikiWord used to create this topic !-->
<!-- if you want to modify it to something more meaningful, just replace %TOPIC% below with i.e "My Topic"!-->

<!-- !! %SPACEOUT{ "%TOPIC%" }% -->
%TOC%

%STARTINCLUDE%
---+ Description of OSG CE Authorization Modes
%EDITTHIS%

You need to determine the authorization mode you wish to implement. The Authorization mode determines who can access your resources and how. OSG supports three of the [[http://grid.racf.bnl.gov/GUMS/guide_architecture.html#GUMS_in_the_grid_architecture][available GUMS authorization scenarios]]: _Grid3/Local_ (doesn't use GUMS), _Compatibility_, and _Full Privilege_. All three use VOMS. 

In the CE install guide, the initial test case only authorizes yourself as a local user.  You'll need to authorize other users before performing the *OSG Registration* of your service (otherwise no one but you will be able to access it!). Do this before doing the rest of the monitoring configuration steps in the CE install guide, otherwise you may  have to repeat the steps later, particularly if your site is using GUMS.

The flowchart below will help you decide what kind of configuration you should set up.
<pre class="programlisting">
            
  ---------------------------------                    
  | Is your site going to support |    YES  
  |  role-based authorization?    |------------> <a href="#Full_Privilege_Configuration">Full privilege configuration</a>
  ---------------------------------                   
                 |                                           
              NO |
                 |
  ---------------------------------               
  | Do you want to use account    |     YES    
  |    pools at your site?        |------------> <a href="#Compatibility_Mode_Configuration">Compatibility configuration</a>
  ---------------------------------  
                 |                                           
              NO |
                 |
  ---------------------------------   
  |   Would you like to use one   |     YES 
  |    gridmap file to control    |------------> <a href="#Compatibility_Mode_Configuration">Compatibility configuration</a>
  |      all your gatekeepers?    |               
  ---------------------------------               
                 |
              NO |
                 |
                 V
     <a href="#Grid3_or_Local_configuration">Grid3/Local configuration</a>

</pre>

We'll present the "how to" information in order of simplest (Grid3) to most sophisticated (full privilege) so that you can implement step-by-step and test as you go, if you like.

Here is a brief explanation of each.

%NOTE% In order to run in Compatibility or Full Privilege mode, a GUMS server must be installed at your site. Installation and configuration instructions are available from [[http://vdt.cs.wisc.edu/releases/1.8.0/gums.html][VDT]] and the [[https://www.racf.bnl.gov/Facility/GUMS/1.2/][GUMS web site]].  %RED%What about our gums install guide in the rel doc?%ENDCOLOR%

For some background information, see [[Documentation/UserAuthAndPrivilege][An Introduction to User Authorization and Privilege in OSG]].

---++ <nop>Grid3 or local <nop>GridMap file
Authorization is performed only via the <i>grid-mapfile</i> on the Compute Element (CE) node. 

The grid-mapfile is either created manually on each CE node, or created using the <i>edg-mkgridmap</i> root cron entry based upon the =edg-mkgridmap.conf= configuration file in =$VDT_LOCATION/edg/etc=. This file is installed by the VO package which can be updated to add or update VO information. The OSG Operations sends update announcements to each support center.  VOMS is used; GUMS is not used. 

Synchronizing all the <i>grid-mapfiles</i> for multiple CE nodes needs to be done manually in this case.  You may prefer this configuration if:
   * You are a small site (one gatekeeper) and,
   * You deal with a small set of fairly static VOs
   * You are <b>not</b> supporting <i>role-based</i> authorizations (voms proxies with extended attributes)

---++ Compatibility
Authorization is performed via the grid-mapfile on the gatekeeper, and the file is created by GUMS.  

GUMS polls VOMS Admin periodically and creates/updates the grid-mapfile. If the site has only one GUMS server (one communication point to VOMS), centralized mapping is enabled. Given the GUMS configuration options, account pools (many accounts, one-to-one DN-to-account mapping) can be implemented as well as group accounts (many-to-one DN-to-account mapping).  You should consider this configuration if:
   * Your gatekeeper(s) or service must be configured using a grid-mapfile (i.e., you have tools or services that manipulate this file directly, without passing through globus)
   * You'd rather approach with caution than jump right into running GUMS 24/7.

<a name="FullPrivilegeMode"/a>
---++ Full Privilege (role-enabled) 
This scenario implements the PRIMA authorization module with GUMS and does not use the grid-mapfile.  The gatekeeper uses a callout to PRIMA upon receipt of each request, PRIMA forwards the request to the GUMS web service which performs the dynamic mapping. PRIMA can process <span class="firstterm">Fully Qualified Attribute Names (FQAN)</span>, thus enabling mapping based on VO groups and roles as defined in VOMS. 

<a name="GUMSInstallation"/a>


%STOPINCLUDE%

%BOTTOMMATTER%

-- Main.AnneHeavey - 30 Aug 2007
