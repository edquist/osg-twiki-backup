%META:TOPICINFO{author="BrianBockelman" date="1312828847" format="1.1" version="1.3"}%
%META:TOPICPARENT{name="RPMTempDocuments"}%
---+ Creating the VO Client package

---++ Overview

The VO Client package is just a conversion of the tarball created by GOC into the RPM format.

In order to build the RPM, one needs:
   * The tarball containing the:
      * =vomses= file
      * =edg-mkgridmap.conf= file
      * =vomsdir= directory tree, containing the lsc files.
   * The RPM spec file

---++ Making the tarball

In order to create the tarball, one needs the =osg-make-vomsdir= package, available from the OSG yum repository.

To make the tarball:
   * start with a clean directory
   * copy in the =vomses=  and =edg-mkgridmap.conf= files
   * create the vomsdir directory with<br>
     osg-make-vomsdir --vomsdir vomsdir --vomses vomses
   * =tar -czf vo-client-<version>.tar.gz vomses edg-mkgridmap.conf vomsdir=

Upload the tarball into the [[https://twiki.grid.iu.edu/bin/view/SoftwareTeam/RPMDevelopmentGuide#Upstream_Source_Cache][upstream source cache]], in the<br>
=vo-client/<version>/= directory.

---++ RPM spec file maintenance

The OSG RPM spec file is [[https://twiki.grid.iu.edu/bin/view/SoftwareTeam/RPMDevelopmentGuide#Revision_Control_System][maintained in Subversion]].

The VO Client package is located in<br>
=native/redhat/trunk/vo-client=

There are two files that need to be maintained:
   * =osg/vo-client.spec= - This is the RPM spec file proper. One needs to update the version (and/or the release number) every time a new RPM is created.
   * =upstream/release_tarball.source= - This file contains the relative path of the tarball within the [[https://twiki.grid.iu.edu/bin/view/SoftwareTeam/RPMDevelopmentGuide#Upstream_Source_Cache][upstream source cache]]. Since the tarball file name will change with every new RPM version, this file has to be changed accordingly.

---++ RPM building

After installing the [[https://twiki.grid.iu.edu/bin/view/Documentation/VDTRPMBuildBox][vdt-build tools]], check out a clean copy from svn, then:
   * =vdt-build prebuild .=
   * =vdt-build rpmbuild .=
   * # once there are no errors, run<br>
     =vdt-build koji .=

This will push the RPMs into the OSG development repository.  Koji requires additional setup compared to rpmbuild; [[Documentation.KojiWorkflow][see the documentation here]].
