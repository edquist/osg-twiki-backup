%META:TOPICINFO{author="ShawnMcKee" date="1442402593" format="1.1" reprev="1.8" version="1.8"}%
%META:TOPICPARENT{name="NetworkingInOSG"}%
%LINKCSS%

<!-- This is the default OSG documentation template. Please modify it in -->
<!-- the sections indicated to create your topic.                        --> 

<!-- By default the title is the WikiWord used to create this topic. If  -->
<!-- you want to modify it to something more meaningful, just replace    -->
<!-- %TOPIC% below with i.e "My Topic".                                  -->

---+!! %SPACEOUT{ "Deploying !perfSONAR for WLCG/OSG" }%
%TOC%

%STARTINCLUDE%
This  page provides  details for site admins installing, upgrading or  using  perfSONAR  in  WLCG/OSG.     The sections  below are intended to allow users  to  find  quickly the  specific information they are  interested in. 

Our  *strong recommendation* for  anyone maintaining/using  perfSONAR is that they join either/both of the following mailing lists:
   * *User's Mailing List*  The perfSONAR project maintains a mailing list for communication on matters of installation, configuration, bug reports, or general performance discussions:  https://lists.internet2.edu/sympa/subscribe/perfsonar-user
   * *Announcement Mailing List* The perfSONAR project also maintains a low volume mailing list used for announcements related to software updates and vulnerabilities: https://lists.internet2.edu/sympa/subscribe/perfsonar-announce

---+++ Overview of perfSONAR in WLCG/OSG 

The following topical sections provide details about perfSONAR for WLCG/OSG
   * [[IntegrationPS][Overview,  Motivation  and Requirements (new sites)]]
   * [[InstallUpdatePS][Installation/upgrade guide]]
   * [[TroubleFAQPS][Troubleshooting/FAQ]]
   * [[ExGuidePS][Guide for experiments (storage APIs, dashboard, etc.)]]

---++++ Changes for perfSONAR 3.4.x

For those of you have are familiar  with installing  perfSONAR  in  WLCG  we summarize what is changed going to v3.4.x below.    *We would also note that perfSONAR v3.5 is targeted to be released on September 28, 2015.   Sites following our recommendation to have auto-update enabled should self-update once the repository has version 3.5.*

   *  *Upgrades  or  reinstalls  to perfSONAR v3.4.x* should  just  follow the  perfSONAR page instructions
      * If there  is  any suspicion your system  could have  been  compromised  we  recommend  a  clean install  of  v3.4.2 (or whatever is most current),  though this  will  lose any existing data.
      * For running v3.3.x versions this should  be as  simple  as  =yum clean all=;  =yum -y update=;  =reboot=  (But read the  install/upgrade notes)
   *  *We are  deprecating the  use  of  =NDT=  and =NPAD=.*   These components,  while  useful in  some cases,  force  the  use of  Web100 kernels and RENO  as  the  TCP  protocol.  
      * Sites  can  choose  to  run these  but  it  is not a  recommendation from  OSG  or  WLCG
   *  perfSONAR v3.4 uses a new measurement archive based upon Esmond and the measurement archive access URLs inside our meshes need to be updated.
      * Updated mesh-configurations have been created but work  only with perfSONAR  3.4+ versions.
      * Sites  must  either  open  port  80 or port 443 to  our monitoring  subnets  to  allow the  test metrics  to  be  collected (see  iptables  item  below).
   *  *The mesh-config  URLs are now hosted at OSG* and  the updated  URLs  are document in the [[InstallUpdatePS][Installation/upgrade  Guide]]  above
      * Until the OSG created meshes are  ready,  the  OSG  URLs will redirect  to the manually configured  CERN instances  we  have  been  using.
   *  *The  monitoring  for  perfSONAR has  migrated to  OSG (but we continue  to maintain  the  prototype  instances on  maddash.aglt2.org*)
      * !MaDDash *production* URL:  http://psmad.grid.iu.edu/maddash-webui/index.cgi
      * OMD *production* URL: https://psomd.grid.iu.edu/WLCGperfSONAR/check_mk/
      * !MaDDash protoytpe  URL: https://maddash.aglt2.org/maddash-webui/index.cgi
      * OMD prototype URL:  https://maddash.aglt2.org/WLCGperfSONAR/check_mk/
   * We are providing instructions for sites concerned about ports 80/443 with examples for  tightening the  iptables  configuration which  comes  with  perfSONAR while ensuring the data is still accessible.
      * Either port  80 or  443  *must be  open*  for  the OSG/WLCG monitoring  subnets and any desired  local  subnets
   * For sites  with IPv6 available we  are *strongly recommending configuring  perfSONAR to  be  dual-stacked*
      * Sites with  IPv6 should get both =A= and =AAAA= records for  their  perfSONAR  DNS name (as  well  as  ensuring  the reverse  is  in place).
      * All existing meshes will support both IPv4 and IPv6 testing.  Sites with both IPv4 and IPv6 addresses testing to sites that also have both will run *two* tests.   A side effect of this is that as more sites provide IPv6 addresses, the amount of testing will increase.  
      * At some future point when most sites have IPv6, we may need to adjust the testing frequency to reduce the overall amount of testing

The [[https://twiki.cern.ch/twiki/bin/view/LCG/NetworkTransferMetrics][WLCG Network and Transfer Metrics Working Group]] is responsible for monitoring the WLCG/OSG instances and for defining and maintaining the mesh-configurations that we use to control perfSONAR testing.   Please contact them if you have questions or suggestions related to perfSONAR testing amongst WLCG sites.







%STOPINCLUDE%

%BOTTOMMATTER%

-- Main.ShawnMcKee - 14 Oct 2014
