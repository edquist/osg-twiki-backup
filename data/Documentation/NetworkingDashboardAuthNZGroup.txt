%META:TOPICINFO{author="GabrieleGarzoglio" date="1351720035" format="1.1" reprev="1.7" version="1.7"}%
%META:TOPICPARENT{name="NetworkingModularDashboard"}%
%LINKCSS%

<!-- This is the default OSG documentation template. Please modify it in -->
<!-- the sections indicated to create your topic.                        --> 

<!-- By default the title is the WikiWord used to create this topic. If  -->
<!-- you want to modify it to something more meaningful, just replace    -->
<!-- %TOPIC% below with i.e "My Topic".                                  -->

---+!! %SPACEOUT{ "Networking Dashboard AuthN/Z Working Group" }%
%TOC%

%STARTINCLUDE%

---++ Charge

This group discuss how to provide authentication (identifying users) and authorization (defining what users are allowed to do) for the networking dashboard.

The initial goal of the group is to understand the infrastructure for authentication (!AuthN) and authorization (!AuthZ) that is most adequate for the Networking Dashboard. 

For !AuthN, the typical approach on the Grid is based on a public key infrastructure implemented with X509 proxies and end-entity certificates. Membership to groups is authenticated using x509 /extended/ certificates, whereby authoritative membership services (e.g. VOMS) include a signed membership assertion pertaining to the user /within/ the user's certificate (e.g. voms certificate).
The group will investigate if this is an adequate standard for the dashboard.

For !AuthZ, various alternatives are being considered:
   1. the [[http://www.fnal.gov/docs/products/voprivilege/][AuthZ infrastructure of OSG]]
   1. a dedicate software module for the Dashboard
   1. integrating systems to help with the !AuthZ function, such as [[http://www.internet2.edu/grouper/][Internet2 Grouper]].

Questions to be addressed by the group include
   * How should the dashboard API be changed to accomodate the best way forward? 
   * How is the Dashboard dealing with user "groups"?

---++ Overview of the options on Authorization
This group is considering a few main alternatives to manage fine-grained authorization to access privileges.

---+++ The OSG Authorization Mechanism in a Nutshell 

The OSG Authorization infrastructure assumes an authentication scheme based on x509 extended proxies. All users have digital identities in the form of x509 credentials. All users also belong to communities (Virtual Organizations - VO - in OSG). The organizational structure of a community is a hierarchy of groups; members of a group can optionally have roles (non hierarchical entitites). This structure is maintained in membership services (VOMS servers) where the registration of users in groups and roles is managed by VO and group administrators. Before accessing any Grid resource, a user interacts with a membership service presenting its credentials and claiming membership to a group and role; the server verifies the claim and digitally signs and embeds a membership assertion within the user certificate itself.

On the OSG, access to resources is granted on the bases of the user membership to a group and role, rather than on the identity of the user. In other words, users presents the extended credentials to resources to obtain the access privileges associated with the group and role membership. The resource gateway (Globus gatekeeper, GridFTP, SRM, etc.) first authenticated the user's extended credentials using cryptographic techniques. Then the gateway determines the level of privileges associated with that user membership through the authorization function. For fine-grained authorization, the gateway calls-out to site-based policy decision points (e.g. SAZ and GUMS) passing all relevant attributes of the user identity, the resource, the intended action, and the environment. The policy decision point maps these attributes to local privileges (e.g. local user account). It is the responsibility of the gateway to grant the user access to the resources adhering to the policy decision point's obligations. 

In the case of the Dashboard, this group has to understand 
   * if an externally maintained structure of groups and roles (i.e. using VOMS) captures an adequate organizational model for its use cases. 
   * if the administrative properties of VOMS (user-initiated registration, approcal delegation, AUP signing, etc.) are adequate or an overkill for the dashboard
   * if embedding membership infromation in the user's credential is significant for the dashboard use cases (e.g. for identity propagation and delegation)
   * if delegating access rights to an external policy decision point (such as GUMS) is an advantage for our use cases or a complication
   * if the simple model of associating privileges to local user identities (GUMS) is sufficient for the Dashboard or if more complicated obligations (such as local user and group information) are needed, instead
   * if it is worth to base the authentication infrastructure on x509 in order to reuse the OSG authorization infrastructure

---+++ A Dedicated Authorization Software Module in the Dashboard
As an alternative to using the OSG authorization infrastructure, the dashboard could implement its own module to maintain privileges associated with user identities, membership information, and other relevant attributes.

This group has to understand
   * if this module won't end up replicating most of the functionalities already available via other systems (VOMS, GUMS, Grouper, etc.)
   * if membership and privilege management will need to be delegated to external administrators in the future (complexity of the administrative interfaces)
   * if a simple authentication infrastructure (e.g. user name and password) is sufficient or worth implementing

---+++ Integrating External Systems to Help with the !AuthZ Function
The organization of users in groups is at the basis of most fine-graned privilege infrastructures. Such systems enable the development of access authorization based on user membership. We have discussed VOMS as an example of such as system, based on x509 authentication.

Internet2 has developed Grouper to address the needs of managing user's membership. The advantage of Grouper with respect to VOMS is that it does not assume an authentication based on x509. For an insfrastructure based on x509, though, the disadvantage is that it is not as well integrated with x509 as VOMS.

Other alternatives include the integration of the Dashboard with identity federation systems, such as !InCommon, or othe mechanisms to convey identity information, such as Shibboleth, OpenId, etc.

This group has to understand
   * if systems such as Grouper offer a middle-way between a fully home-grown authorization system and a fully x509-based authorization infrastructure as for OSG.
   * is it worth attempting an integration with identity federations ?
   * what other mechanisms to assert identity is it worth considering (Shibboleth, OpenId, etc.) ?

---++ Group meeting - Oct 9, 2012

Present: Shawn, Soichi, Gabriele, Tom, Shawn<br>
Date: Oct 9, 2012

---+++ Action Items
   * Gabriele will get more info on Grouper: can we map the authz layer in the Dashboard to Grouper and OIM?
      * Grouper provides an administrative Web Services interface: https://spaces.internet2.edu/display/Grouper/Grouper+Web+Services
      * Grouper is a generic tool and does not come out of the box configured for x509 AuthN/Z
      * Instead of using Grouper, one should consider to use VOMS to hold the groups and roles relevant to the Dashboard access control. The dashboard can then access these using the Web Services interfaceof VOMS. In this case, users would NOT present the dashboard with an extended x509 certificate; rather they'd present their standard certificate and the dashboard would find out their affiliation by interacting with VOMS.

   * Soichi will provide information about OIM authN/Z
      * OIM documentation at: https://confluence.grid.iu.edu/pages/viewpage.action?pageId=4980895
      * Ideally Soichi would like to see a structure similar to this for !AuthZ plugin
<pre>

class OIMAuthorization implements PerfsonarAuthorizationPlugin {
@Override
public boolean canUpdateVO(UserContext user, String voname) {
    //TODO -- access OIM-DB and see if the current user is listed as contact in VO contact list
}
@Override
public boolean canAdmin(UserContext user) {
    //TODO -- access OIM-DB and see if the current user is given access to "admin_perfsonar" action.
}

}

</pre>

---+++ Tentative next meeting date
In a couple of weeks / last week of Oct

---+++ Minutes
We want to focus on the use cases for AuthN/Z of the Dashboard and understand if those requirements can be addressed by existing infrastructure. 

With the current implementation, a user with a certificate in the browser, can register with the system. This way the admin can define read/write access. DOEGrids certs are trusted.<br>
AuthZ can be done in front of the servlet in the servlet filters. This way, it can be decided who has access to a given screen.<br>
The API goes through a web request. Can be invoked through curl. Attributes are passed on the URL and a JSON object is returned. Web pages display this object.<br>

Soichi: GOC services are defined via the OIM database. Identities and privileges are also defined in OIM.<br>
I would like for the OSG Dashboard to be connected to the OIM authZ system<br>
Tom: we could connect to OIM from the servlet filters.<br>
Soichi: if there is a simple class e.g. Implementing can read / can write, I can rewrite the class to interface the Dashboard to OIM<br>

*Q: How can we provide a plug in module to tight the access control layer of the Dashboard to OIM?*<br>
*Q: How rich and fine grained is authZ in the OIM system? Will this give us info on how to design the dashboard."

*TODO: Soichi will provide information about OIM authN/Z*

Going over VOMS and GUMS / SAZ

OIM does not use VOMS. In OIM users define resources and are put in a contact list; if you are in the contact list, you can edit the resources. We wanted to make a distinction between distributed reousrces and central resource.

Gabriele: How many dashboard instances are there? If many, then GUMS makes sense.<br>
Shawn: not many instances. In a single dashboard instance there are multiple functions. Some information are specific to VOs e.g. US Atlas: they'll want to control how the sites are going to do tests with each others, etc. Who is allowed to define the list of people in US Atlas, change the tests, display the information, etc. Certain people are allowed to add sites, create new metrics, change site names, etc. We need something that provides that functionality in the dashboard.<br>
Depending on what VO the user belongs to, she may want to see certain information instead of others e.g. The metrics of the sites belonging to that VO. We want to allow VOs to manage their own setup.<br> 
Gabriele:  If it is central you do not need GUMS. You may want to use VOMS-extended certificate to convey membership attributes.<br>

Discussing VOMS vs. internal authorization<br>
Soichi: we decided to use OIM and a central AuthZ model because not everybody in OSG uses VOMS.<br>
OIM only deal with IGTF X509 certificates. No username and password.<br>
Tom: In the BNL dashboard, we use the trustmanagers library and we trust the Cas that are packaged with that.<br>

Discussing synchronization of attributes in a central Dashboard AuthZ DB with VOMS.  For example, all people in CMS may be known to the Dashboard (updated every hour).<br>
Shawn: This may be an overkill: in practice there aren't that many people or roles that will need to access the dashboard.<br>

Tom: the AuthN/Z mechanism needs to be easy to install out-of-the-box for the dashboard installations beyond OSG.<br>

Discussing Grouper.<br> 
Comparing OIM and Grouper. OIM is already integrated with x509. Grouper must have the option. <br>
Grouper could be the default, then we could develop an interface for OIM.<br>

OIM is a good source of names for sites, resources, VO names, etc. The names for the dashboard should come from OIM.

When a site deploys a PerfSONAR instance, it does it on behalf of a VO. The VOs should have recommendations e.g. for mash configurations. There is a central URL that has the info about all the participants in the mash (say US Atlas) and the tests that should be done. PerfSONAR points to all the mash URL and when the central configuration changes, then the perfSONAR instances changes for that VO.

The Dashboard could watch those URL and reconfigure based on that info e.g. If sites are added, then the dashboard can display a larger metrics table.

Should the mash url configuration be validated against the OIM data?<br>
One can have a mash configuration for that site e.g. a null configuration. A manager can add a test at that URL to create tests on demand.<br>

Who is authorized to write to the URLs? There is a list of people e.g. for CMS it is on a twiki, so access is controlled via twiki.<br> 
In principle, today the URL could be spoofed, so that a user one can pass malicious configurations. Today it is done via http i.e. There is no authentication of the source of information.<br>

In PerfSONAR there are 3 levels of authorization, but there is no strong authentication.<br>
Users define tests against your perfSONAR instance. Tests can be<br>
   * unprivileged: e.g. duration of a bandwidth test should be limited to e.g. 30 sec
   * privileged: perfSONAR admins put the subnet or IP on a list: the parameters for the tests are more permissive e.g. full UPD bandwidth tests allowed for 1 minute
   * banned: no tests allowed.

*TODO: get more info on Grouper: can we map the authz layer in the Dashboard to Grouper and OIM?*

*Tentative meeting date: in a coupld of weeks / last week of Oct*

---++ Group meeting - Oct 31, 2012

Present: Soichi, Gabriele, Parag, Tom, Shawn<br>
Date: Oct 31, 2012

---+++ Action Items
   * Tom will provide use cases of interaction from the Dashboard to OIM
   * Soichi will evaluate if the use cases can be address by OIM as it or not
   * All can try grouper and VOMS and see what is possible

---+++ Short term plan
   * Tom will provide use cases of interaction from the Dashboard to OIM
   * Soichi will evaluate if the use cases can be address by OIM as it or not
   * The group willi agree on new functionality for OIM
   * Soichi will prototype the new functionality in OIM.

---+++ Next meeting
Fri Nov 16 at 2 pm CDT / 3 pm EDT
 
---+++ Minutes
Deliverable of the group: document with a set of recommendations

<b>OIM !AuthN: going over the documentation</b><br>
https://confluence.grid.iu.edu/pages/viewpage.action?pageId=4980895

Can you limit yourself to 1 role? You can be authorized to take an action because you belong to multiple roles.<br>
You can have multiple DNs mapped to different roles. This is how developers would check new authorization schemes per role.

We would integrate OSG Dash with OIM for the OSG instance

Tom: can we use OIM from Struts?<br>
Soichi: yes, OIM is framework independent.

<b>grouper vs voms pros and cons</b>

Gabriele installed grouper and voms to prototype the dashboard !AuthN API against real membership registration services.

Installation:<br>
grouper: straight forward after setting up java<br>
voms: x509 service certificate needed<br>

Integration with x509<br>
grouper: probably possible, no easily accessible docs on the web: need to contact the developers<br>
voms: supports x509 out of the box<br>

Do we want to support !AuthN beyond x509?<br>
Possibly. Potential communities interested in the dashboard are a FrenchCloud and a UK cloud group.<br>
Do they have x509?<br>
If these groups have ties with the Grid, they may prefer VOMS.<br>

Strategy: we integrate OIM, then we have probably an API that can support both.

We need to discuss what the dashboard use cases actually are. How do you organize the data for the sites and resources? This will influence how to configure OIM at the !MyOSG.<br>
If data belongs to a set of resources, it is a good fit for !MyOSG<br>
!MyOSG provides limited views in other systems, such as Gratia. It may provide a subset of the functionality of the Dashboard.<br>

%STOPINCLUDE%

%BOTTOMMATTER%

-- Main.GabrieleGarzoglio - 31 Oct 2012
