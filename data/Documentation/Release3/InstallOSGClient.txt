%META:TOPICINFO{author="JamesWeichel" date="1318260710" format="1.1" reprev="1.13" version="1.13"}%
%META:TOPICPARENT{name="WebHome"}%
---+!! Installing OSG RPM Client
%DOC_STATUS_TABLE%
%TOC%

---++ Requirements

%INCLUDE{"Documentation.InstallVDTRepo" headingoffset="1"}%
%INCLUDE{"Documentation/Release3.InstallCACerts" headingoffset="1"}%

---++ Install the Client
   1. Install the Sun/Oracle JDK. This step must be done manually, since the JDK RPMs are not signed and so GPG checking must be disabled for their installation. <pre class="rootscreen">
%UCL_PROMPT_ROOT% yum --enablerepo=osg-testing --nogpgcheck install jdk</pre>
   1. Install the osg-client meta package, which will pull in all dependencies. <pre class="rootscreen">
%UCL_PROMPT_ROOT% yum install --enablerepo=osg-testing osg-client   </pre>

---+++ Enable and Start fetch-crl:
CRLs are not required on the client, but are recommended to keep your installation secure.<br>
However, be aware that this will periodically use a non-negligible amount of networking, so it may not be suitable for mobile installations (e.g. laptops).

To enable fetch-crl by default on the node:
<pre class="rootscreen">
%UCL_PROMPT_ROOT% chkconfig fetch-crl-cron on
</pre>
To start fetch-crl:
<pre class="rootscreen">
%UCL_PROMPT_ROOT% service fetch-crl-cron start
</pre>

You may also consider enabling fetch-crl at boot time, to guarantee up-to-date CRLs even after long power offs.
However, this may significantly lengthen your boot times, so decide for yourself what is more important.
<pre class="rootscreen">
%UCL_PROMPT_ROOT% chkconfig fetch-crl-boot on
</pre>
To start fetch-crl:
<pre class="rootscreen">
%UCL_PROMPT_ROOT% service fetch-crl-boot start
</pre>

---++++ Configure Proxy Server
If you have a campus Web Proxy (e.g. Squid) that you can use, please use it, as it will drastically reduce the network bandwidth used by fetch-crl.

To configure fetch-crl to use a proxy server, create  =/etc/fetch-crl.conf= and add =export http_proxy=http://your.squid.fqdn= to the file.

---+++ Install Condor-G
Optionally, you may want to install Condor-G, too. Condor-G is needed to submit jobs directly to the OSG sites.<br>
*Note:* Most users don't need this.

   1. Install the osg-client-condor meta package, which will pull in all dependencies. <pre class="rootscreen">
%UCL_PROMPT_ROOT% yum install --enablerepo=osg-testing osg-client-condor   </pre>

---++++ Enable and Start Condor

To enable Condor by default on the node:
<pre class="rootscreen">
%UCL_PROMPT_ROOT% chkconfig condor on
</pre>
To start Condor:
<pre class="rootscreen">
%UCL_PROMPT_ROOT% service condor start
</pre>

---++++ Firewall tunning
Condor-G requires a set of ports open in order to talk to OSG CEs.
If you are running a restrictive firewall, you will need to open O(1k) ports in the firewall and tell condor what port range you opened.

Assuming you use iptables and chose the range 20k-25k, you must
   1. insert the following rules <pre>
-A RH-Firewall-1-INPUT  -m state --state NEW -p tcp -m tcp --dport 20000:24999 -j ACCEPT
-A RH-Firewall-1-INPUT  -m state --state NEW -p udp -m udp --dport 20000:24999 -j ACCEPT
</pre>    into =/etc/sysconfig/iptables= and restart iptables with <pre class="rootscreen">
%UCL_PROMPT_ROOT% service iptables restart
</pre>
   1. create  =/etc/condor/config.d/10firewall_condor.config= and add <pre>
LOWPORT=20000
HIGHPORT=24999
</pre> to the file<br>and restart Condor with <pre class="rootscreen">
%UCL_PROMPT_ROOT% service condor restart
</pre>

You may also want to set the Globus port range, in case you want to use the simple globus tools:<pre class="rootscreen">
%UCL_PROMPT_ROOT% cat << CFG >> /etc/profile.d/globus_firewall.sh
export GLOBUS_TCP_PORT_RANGE=20000,24999
export GLOBUS_TCP_SOURCE_RANGE=20000,24999
CFG
%UCL_PROMPT_ROOT% cat << CFG >> /etc/profile.d/globus_firewall.csh
setenv GLOBUS_TCP_PORT_RANGE 20000,24999
setenv GLOBUS_TCP_SOURCE_RANGE 20000,24999
CFG
</pre>

---++ Test the Client

[[Documentation/Release3.TestOSGClient][Instructions for testing the client]]. These are meant for the VDT/ITB teams, but may help you out.

---++ Known Issues
   * osg-discovery invokes "locate" to find Java.  This might cause a spurious error message if locate is not installed. Temporary workaround: install locate. 
<!-- CONTENT MANAGEMENT PROJECT
############################################################################################################
 DEAR DOCUMENT OWNER
 ===================

 Thank you for claiming ownership for this document! Please fill in your FirstLast name here:
   * Local OWNER = FirstLast

 Please define the document area, choose one of the defined areas from the next line
 DOC_AREA = (ComputeElement|General|Integration|Monitoring|Operations|Security|Storage|Tier3|User|VO)
   * Local DOC_AREA       = General

 define the primary role the document serves, choose one of the defined roles from the next line
 DOC_ROLE = (Developer|Documenter|Scientist|Student|SysAdmin|VOManager)
   * Local DOC_ROLE       = SysAdmin

 Please define the document type, choose one of the defined types from the next line
 DOC_TYPE = (HowTo|Installation|Knowledge|Navigation|Planning|Training|Troubleshooting)
   * Local DOC_TYPE       = Installation
  Please define if this document in general needs to be reviewed before release ( %YES% | %NO% )
   * Local INCLUDE_REVIEW = %YES%

 Please define if this document in general needs to be tested before release ( %YES% | %NO% )
   * Local INCLUDE_TEST   = %YES%

 change to %YES% once the document is ready to be reviewed and back to %NO% if that is not the case
   * Local REVIEW_READY   = %NO%

 change to %YES% once the document is ready to be tested and back to %NO% if that is not the case
   * Local TEST_READY     = %NO%

 change to %YES% only if the document has passed the review and the test (if applicable) and is ready for release
   * Local RELEASE_READY  = %NO%


 DEAR DOCUMENT REVIEWER
 ======================

 Thank for reviewing this document! Please fill in your FirstLast name here:
   * Local REVIEWER       = 
 Please define the review status for this document to be in progress ( %IN_PROGRESS% ), failed ( %NO% ) or passed ( %YES% )
   * Local REVIEW_PASSED  = %NO%


 DEAR DOCUMENT TESTER
 ====================

 Thank for testing this document! Please fill in your FirstLast name here:
   * Local TESTER         = 
 Please define the test status for this document to be in progress ( %IN_PROGRESS% ), failed ( %NO% ) or passed ( %YES% )
   * Local TEST_PASSED    = %NO%
############################################################################################################
-->

%META:TOPICMOVED{by="JamesWeichel" date="1317239924" from="Documentation.InstallOSGClient" to="Documentation/Release3.InstallOSGClient"}%
