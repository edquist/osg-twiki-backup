%META:TOPICINFO{author="JamesWeichel" date="1318347784" format="1.1" reprev="1.17" version="1.17"}%
%META:TOPICPARENT{name="WebHome"}%
---+!! Installing OSG Client
%DOC_STATUS_TABLE%
%TOC%

---+ About This Document
%ICON{hand}% This document is for grid users and system administrators. It covers the installation of the OSG Client Tools Package. This package is required on every host used by grid users to submit jobs, transfer data, or interact otherwise with the OSG. Note there is also a [[InstallWNClient][Worker Node Client]] that is not a valid substitute for this package.  Likewise the OSG Client cannot replace the Worker Node Client in the batch jobs environment on %LINK_GLOSSARY_WN% and %LINK_GLOSSARY_CE%.  

The OSG Cient Tools Package includes:
   * the %LINK_GLOBUS_TOOLKIT% providing client tools for authorization, data transfer and job submission.
   * a list of [[Documentation/GlossaryC#DefsCA][CA]] [[Documentation/GlossaryC#DefsCertificate][Certificates]] trusted by the OSG (installed separately).
   * the [[Documentation/GlossaryC#DefsCRL][Certificate Revocation List]] and tools to keep it current.
   * %LINK_GLOSSARY_CONDOR% client tools for job submission and workflow management.
   * client tools to access a %LINK_GLOSSARY_SRM% provided by a %LINK_GLOSSARY_SE%.

%NOTE% This document does not cover the usage of the client tools. An introduction how to use the OSG can be found [[Documentation.UsingTheGrid][here]]. A more detailed description how to interact with a %LINK_GLOSSARY_CE% is located [[ReleaseDocumentation.UserCESimpleTest][here]].

%INCLUDE{"Documentation/DocumentationTeam/DocConventions" section="Header"}%
%INCLUDE{"Documentation/DocumentationTeam/DocConventions" section="CommandLine"}%

---+ Engineering Considerations

The OSG Client Tools Package is required on hosts used to submit jobs to the Open Science Grid. We recommend to install the OSG Client Tools on a _dedicated_ job submission host for large scale job submissions to production resources on the OSG. We recommend to use a [[#Public_IP_Address_and_DNS][public IP address and a fully qualified domain name]] for shared job submission hosts. 

---+ How to get Help?

To get assistance please use [[HelpProcedure][this page]].

---+ Requirements

   1 A host to install the OSG Client (pristine node). No grid host certificate is required.
   1 OS is Red Hat Enterprise Linux 5 32 and 64 bit and variants (Scientific Linux 5 and !CentOS 5). Currently most of our testing has been done on Scientific Linux 5.
   1 Root access
   1 To test and use the installation a valid [[Documentation.CertificateGet][grid user certificate]] is required.

---+ Installation and Configuration Procedure

%INCLUDE{"YumRepositories" section="OSGRepoBrief" TOC_SHIFT="+"}%

%INCLUDE{"InstallCertAuth" section="OSGBriefCaCerts" TOC_SHIFT="+"}%

%STARTSECTION{"InstallOSGClientRPMs"}%
---++ Install the Client
   1. Install the Sun/Oracle JDK. This step must be done manually, since the JDK RPMs are not signed and so GPG checking must be disabled for their installation. <pre class="rootscreen">
%UCL_PROMPT_ROOT% yum --enablerepo=osg-testing --nogpgcheck install jdk</pre>
   1. Install the osg-client meta package, which will pull in all dependencies. <pre class="rootscreen">
%UCL_PROMPT_ROOT% yum install --enablerepo=osg-testing osg-client   </pre>
%ENDSECTION{"InstallOSGClientRPMs"}%


%INCLUDE{"InstallCertAuth" section="FetchCRLConfig"}%


---++ Install Condor-G
Optionally, you may want to install Condor-G, too. Condor-G is needed to submit jobs directly to the OSG sites.<br>
*Note:* Most users don't need this.

   1. Install the osg-client-condor meta package, which will pull in all dependencies. <pre class="rootscreen">
%UCL_PROMPT_ROOT% yum install --enablerepo=osg-testing osg-client-condor   </pre>

---+++ Enable, Start and Stop Condor

To enable Condor by default on the node:
<pre class="rootscreen">
%UCL_PROMPT_ROOT% chkconfig condor on
</pre>
To start and stop Condor you can use the service command, e.g. to start:
<pre class="rootscreen">
%UCL_PROMPT_ROOT% service condor start
</pre>

---+++ Firewall tuning for Condor
Condor-G requires a set of ports open in order to talk to OSG CEs.
If you are running a restrictive firewall, you will need to open O(1k) ports in the firewall and tell condor what port range you opened.

Assuming you use iptables and chose the range 20k-25k, you must
   1. insert the following rules <pre>
-A RH-Firewall-1-INPUT  -m state --state NEW -p tcp -m tcp --dport 20000:24999 -j ACCEPT
-A RH-Firewall-1-INPUT  -m state --state NEW -p udp -m udp --dport 20000:24999 -j ACCEPT
</pre>    into =/etc/sysconfig/iptables= and restart iptables with <pre class="rootscreen">
%UCL_PROMPT_ROOT% service iptables restart
</pre>
   1. create  =/etc/condor/config.d/10firewall_condor.config= and add <pre>
LOWPORT=20000
HIGHPORT=24999
</pre> to the file<br>and restart Condor with <pre class="rootscreen">
%UCL_PROMPT_ROOT% service condor restart
</pre>

You may also want to set the Globus port range, in case you want to use the simple globus tools:<pre class="rootscreen">
%UCL_PROMPT_ROOT% cat << CFG >> /etc/profile.d/globus_firewall.sh
export GLOBUS_TCP_PORT_RANGE=20000,24999
export GLOBUS_TCP_SOURCE_RANGE=20000,24999
CFG
%UCL_PROMPT_ROOT% cat << CFG >> /etc/profile.d/globus_firewall.csh
setenv GLOBUS_TCP_PORT_RANGE 20000,24999
setenv GLOBUS_TCP_SOURCE_RANGE 20000,24999
CFG
</pre>

---+ Test the Client

[[Documentation/Release3.TestOSGClient][Instructions for testing the client]]. These are meant for the VDT/ITB teams, but may help you out.

---+ Known Issues
   * osg-discovery invokes "locate" to find Java.  This might cause a spurious error message if locate is not installed. Temporary workaround: install locate. 
<!-- CONTENT MANAGEMENT PROJECT
############################################################################################################
 DEAR DOCUMENT OWNER
 ===================

 Thank you for claiming ownership for this document! Please fill in your FirstLast name here:
   * Local OWNER = MarcoMambelli

 Please define the document area, choose one of the defined areas from the next line
 DOC_AREA = (ComputeElement|General|Integration|Monitoring|Operations|Security|Storage|Tier3|User|VO)
   * Local DOC_AREA       = General

 define the primary role the document serves, choose one of the defined roles from the next line
 DOC_ROLE = (Developer|Documenter|Scientist|Student|SysAdmin|VOManager)
   * Local DOC_ROLE       = SysAdmin

 Please define the document type, choose one of the defined types from the next line
 DOC_TYPE = (HowTo|Installation|Knowledge|Navigation|Planning|Training|Troubleshooting)
   * Local DOC_TYPE       = Installation
  Please define if this document in general needs to be reviewed before release ( %YES% | %NO% )
   * Local INCLUDE_REVIEW = %YES%

 Please define if this document in general needs to be tested before release ( %YES% | %NO% )
   * Local INCLUDE_TEST   = %YES%

 change to %YES% once the document is ready to be reviewed and back to %NO% if that is not the case
   * Local REVIEW_READY   = %YES%

 change to %YES% once the document is ready to be tested and back to %NO% if that is not the case
   * Local TEST_READY     = %NO%

 change to %YES% only if the document has passed the review and the test (if applicable) and is ready for release
   * Local RELEASE_READY  = %NO%


 DEAR DOCUMENT REVIEWER
 ======================

 Thank for reviewing this document! Please fill in your FirstLast name here:
   * Local REVIEWER       = JamesWeichel
 Please define the review status for this document to be in progress ( %IN_PROGRESS% ), failed ( %NO% ) or passed ( %YES% )
   * Local REVIEW_PASSED  = %IN_PROGRESS%


 DEAR DOCUMENT TESTER
 ====================

 Thank for testing this document! Please fill in your FirstLast name here:
   * Local TESTER         = JamesWeichel
 Please define the test status for this document to be in progress ( %IN_PROGRESS% ), failed ( %NO% ) or passed ( %YES% )
   * Local TEST_PASSED    = %NO%
############################################################################################################
-->

%META:TOPICMOVED{by="JamesWeichel" date="1317239924" from="Documentation.InstallOSGClient" to="Documentation/Release3.InstallOSGClient"}%
