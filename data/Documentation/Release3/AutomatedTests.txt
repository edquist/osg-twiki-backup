%META:TOPICINFO{author="JamesWeichel" date="1317240451" format="1.1" reprev="1.4" version="1.4"}%
%META:TOPICPARENT{name="WebHome"}%
%LINKCSS%

<!-- This is the default OSG documentation template. Please modify it in -->
<!-- the sections indicated to create your topic.                        --> 

<!-- By default the title is the WikiWord used to create this topic. If  -->
<!-- you want to modify it to something more meaningful, just replace    -->
<!-- %TOPIC% below with i.e "My Topic".                                  -->

---+!! %SPACEOUT{ "Running the OSG Automated Tests (=osg-test=)" }%
%TOC%

%STARTINCLUDE%
%EDITTHIS%

The =osg-test= package contains software that performs automated, functional integration tests an OSG Software installation.

%RED%WARNING:%ENDCOLOR% The tests and associated test framework run as =root= and may destroy your system! It is *strongly* recommended that =osg-test= be run only on “disposable” systems — ones that can be reimaged or reinstalled from scratch with little effort. Virtual machines are ideal for this kind of test.

---++ Basic Instructions

All steps are performed as =root=:

   1. Download and prepare the bootstrap script: <pre class="rootscreen">
$ wget --quiet http://vdt.cs.wisc.edu/native/bootstrap-osg-test
$ chmod 0755 bootstrap-osg-test</pre>
   1. Bootstrap the test system using the =osg-testing= Yum repository. To get =osg-test= from the =osg-development= Yum repository, replace the first argument with =development=; to get =osg-test= from the production repository, omit the first argument. This step makes sure that both the EPEL and OSG repositories are available, then installs and verifies the =osg-test= package itself. <pre class="rootscreen">
$ ./bootstrap-osg-test testing</pre>
   1. Run the tests (see below for options): <pre class="rootscreen">$ osg-test -vaci <em>PACKAGE</em> -r osg-testing</pre>

---++ The =osg-test= Script

Fundamentally, the =osg-test= script runs tests and reports on their results. However, the script can also perform many of the housekeeping tasks associated with setting up and tearing down the test environment, including adding (and later removing) a test user and its X.509 certificate, installing (and later removing) one or more RPMs, and so on. The following options are available:

%TABLE{sort="off"}%
| =-a=, =--add-user= | Add and configure the test user account (see also =-u= below). By default, the script assumes that the test user account already exists and is configured with a valid X.509 certificate in its =.globus= directory. |
| =-c=, =--cleanup= | Run clean-up steps after all tests are done; removes the test user account and all installed packages. This step is *not* done by default. |
| =-d=, =--dump-output= | After all test output, print all commands and their output from the test run. Typically generates *a lot* of output. |
| =-i=, =--install= PACKAGE | Before running tests, use =yum= to install the given package; may be specified more than once to install more than one top-level package. By default, the script assumes that the user has installed all packages to be tested in advance. |
| =-p=, =--password= PASSWORD | Password for the grid certificate of the test user. Defaults to the password that works with the X.509 certificate for the default test user. |
| =-r=, =--extra-repo= REPO | Enable the given extra repository (in addition to production) when using yum to install packages. Use actual repo names, such as =osg-testing= and =osg-development=. Can be used multiple times with different repositories. |
| =-T=, =--no-tests= | Skip running the tests themselves. Useful for running/testing just the set-up and/or clean-up steps. |
| =-u=, =--test-user= USERNAME | Use the test user account with the given name. See also the =-a= and =-p= options. |
| =-v=, =--verbose= | Print the name of each test as it is run; generally a good idea. |
| =-h=, =--help= | Print usage information and exit. |
| =--version= | Print the script version and exit. |

%STOPINCLUDE%

%META:TOPICMOVED{by="JamesWeichel" date="1317240434" from="Documentation.AutomatedTests" to="Documentation/Release3.AutomatedTests"}%
