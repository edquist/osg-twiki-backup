%META:TOPICINFO{author="SuchandraThapa" date="1348006444" format="1.1" reprev="1.2" version="1.2"}%
%META:TOPICPARENT{name="WebHome"}%
---+!! Installing GSI !OpenSSH
%DOC_STATUS_TABLE%
%TOC{depth="3"}%

---+ About This Document

This document gives instructions on installing and using the GSI !OpenSSH server available in the OSG repository and configuring it so that you can use on your cluster.
 

---+ Engineering Considerations

---+ Requirements
---++ Host and OS
The GSI !OpenSSH rpms will require an user account and group in order for the privilege separation to work.  In addition, =/var/empty/gsisshd= must exist on the server and belong to the =gsisshd= user and group.  The rpms will try to create the =gsisshd= user and group and the =/var/empty/gsisshd= directory with the correct ownership when you install it if these are not present.

#NetworkingReq
---++ Networking
%STARTSECTION{"Firewalls"}%
%INCLUDE{"FirewallInformation" section="FirewallTable" lines="gsissh"}%
%ENDSECTION{"Firewalls"}%

You'll find more client specific details also in the [[#Firewall_Considerations][Firewall section]] of this document.

---+ Installation procedure
%INCLUDE{"YumRepositories" section="OSGRepoBrief" TOC_SHIFT="+"}%

%STARTSECTION{"InstallGSIOpenSSHRPMs"}%
---++ GSI Openssh Installation
 Start with installing GSI !OpenSSH from the repository
<pre  class="rootscreen">
%UCL_PROMPT_ROOT% yum install gsi-openssh-server
</pre>

---+ Configuration and Operations

#ImportantFiles
---++ Useful configuration and log files

Configuration Files
| *Service or Process* | *Configuration File* | *Description* |
| gsissh | =/etc/gsissh/sshd_config= | Configuration file |
| | =/etc/gsissh/ssh_host_rsa_key= | RSA Host key | 
| | =/etc/gsissh/ssh_host_dsa_key= | DSA Host key | 

Log files
| *Service or Process* | *Log File* | *Description* |
| gsisshd | =/var/log/messages= | All log files |


---++ Configuration
In order to get a running instance of the GSI !OpenSSH server, you'll need to change the default configuration.  However, before you go any further, you'll need to decide whether you want GSI !OpenSSH to be your primary OpenSSH service or not (e.g. whether the GSI !OpenSSH service will replace your existing SSH service).  If you choose not to replace your existing service, you'll need to change the port setting in the GSI !OpenSSH configuration to another port (e.g. 2222) so that you can run both SSH services at the same time.  Regardless of your choice, you should probably have both services use the same host key.  In order to do this, symlink =/etc/gsissh/ssh_host_dsa_key= and =/etc/gsissh/ssh_host_rsa_key= to =/etc/ssh/ssh_host_dsa_key= and =/etc/ssh/ssh_host_rsa_key=  respectively. In addition, you'll need to create mappings in your =/etc/grid-mapfile= for the DNs that you will allow to login.  


---++ Starting and Enabling Services
To start the services:
   1. To start GSI !OpenSSH you can use the service command, e.g.: <pre class="rootscreen">
%UCL_PROMPT_ROOT% /sbin/service gsisshd start
</pre>

You should also enable the appropriate services so that they are automatically started when your system is powered on: 
   * To enable !OpenSSH by default on the node: <pre class="rootscreen">
%UCL_PROMPT_ROOT% /sbin/chkconfig gsisshd on
</pre>

---++ Stopping and Disabling Services
To stop the services:
   1. To stop !OpenSSH you can use: <pre class="rootscreen">
%UCL_PROMPT_ROOT% /sbin/service gsisshd stop
</pre>

In addition, you can disable services by running the following commands.  However, you don't need to do this normally.
   * Optionally, to disable !OpenSSH: <pre class="rootscreen">
%UCL_PROMPT_ROOT% /sbin/chkconfig gsisshd off
</pre>

---+ Troubleshooting
You can get information on troubleshooting errors on the [[http://grid.ncsa.illinois.edu/ssh/ts_server.html][NCSA page]].


---++ Test GSI !OpenSSH

After starting the =gsisshd= service you can check if it is running correctly<pre  class="screen">
%UCL_PROMPT% grid-proxy-init
Your identity: /DC=org/DC=doegrids/OU=People/CN=User Name
Enter GRID pass phrase for this identity:
Creating proxy .................................................................. Done
%UCL_PROMPT% gsissh localhost -p 2222
Last login: Tue Sep 18 16:08:03 2012 from itb4.uchicago.edu
%UCL_PROMPT%  </pre>



---+ How to get Help?
To get assistance please use this [[HelpProcedure][Help Procedure]].


---+ References

---+ Comments
%COMMENT{type="tableappend"}%

<!-- CONTENT MANAGEMENT PROJECT
############################################################################################################ 
   DEAR DOCUMENT OWNER
   ===================

   Thank you for claiming ownership for this document! Please fill in your FirstLast name here:
   * Local OWNER          = SuchandraThapa

   Please define the document area, choose one of the defined areas from the next line
   DOC_AREA = (ComputeElement|Storage|VO|Security|User|Monitoring|General|Integration|Operations|Tier3)
   * Local DOC_AREA       =  ComputeElement

   define the primary role the document serves, choose one of the defined roles from the next line
   DOC_ROLE = (EndUser|Student|Developer|SysAdmin|VOManager|Documenter)
   * Local DOC_ROLE       = SysAdmin

   Please define the document type, choose one of the defined types from the next line
   DOC_TYPE = (Troubleshooting|Training|Installation|HowTo|Planning|Navigation|Knowledge)
   * Local DOC_TYPE       = Installation
   
   Please define if this document in general needs to be reviewed before release ( %YES% | %NO% )
   * Local INCLUDE_REVIEW = %YES%

   Please define if this document in general needs to be tested before release ( %YES% | %NO% )
   * Local INCLUDE_TEST   = %YES%

   change to %YES% once the document is ready to be reviewed and back to %NO% if that is not the case
   * Local REVIEW_READY   = %YES%

   change to %YES% once the document is ready to be tested and back to %NO% if that is not the case
   * Local TEST_READY     = %YES%

   change to %YES% only if the document has passed the review and the test (if applicable) and is ready for release
   reviewed during the DOC workshop
   * Local RELEASE_READY  = %NO%


   DEAR DOCUMENT REVIEWER
   ======================

   Thank for reviewing this document! Please fill in your FirstLast name here:
   * Local REVIEWER       = 
  
   Please define the review status for this document to be in progress ( %IN_PROGRESS% ), failed ( %NO% ) or passed ( %YES% )
   * Local REVIEW_PASSED  = %IN_PROGRESS%


   DEAR DOCUMENT TESTER
   ====================

   Thank for testing this document! Please fill in your FirstLast name here:
   * Local TESTER         = 
  
   Please define the test status for this document to be in progress ( %IN_PROGRESS% ), failed ( %NO% ) or passed ( %YES% )
   * Local TEST_PASSED    = %IN_PROGRESS%
############################################################################################################ 
-->



-- Main.SuchandraThapa - 13 Sep 2012
