%META:TOPICINFO{author="SuchandraThapa" date="1318264220" format="1.1" reprev="1.14" version="1.14"}%
%META:TOPICPARENT{name="InstallBestPractices"}%
---+!! Worker Node Client RPM Install
%DOC_STATUS_TABLE%
%TOC%

---++ Introduction
This document is intended to guide system administrators through the process of installing the worker node software and configuring the installed worker node software.

---++ About This Document

%ICON{hand}% This document is intended for system administrators that are installing the worker node software on compute nodes.  It covers installation and configuration of the worker node software using the RPMs distributed by OSG.

---++ Requirements
A RHEL5 (or !CentOS 5, SL5) machine with [[http://fedoraproject.org/wiki/EPEL][EPEL]] repos enabled.

---++ Install Instructions
---+++ Configure yum repositories
%INCLUDE{"Documentation.InstallVDTRepo" headingoffset="1"}%
---+++ Setup and configure CA Certs
Some of the worker node client software verifies proxies or certificates.  In order to do this, they will need the CA certificates used to sign the proxies.  OSG provides three options for CA certs RPMs.
%INCLUDE{"Documentation/Release3.InstallCACerts" headingoffset="1"}%
---+++ Install Sun/Oracle JDK
   1. Install the Sun/Oracle JDK. This step must be done manually, since the JDK RPMs are not signed and so GPG checking must be disabled for their installation. <pre class="rootscreen">
%UCL_PROMPT_ROOT% yum --enablerepo=osg-testing --nogpgcheck install jdk</pre>
   1. Install the WN-Client <pre class="rootscreen">
%UCL_PROMPT_ROOT% yum --enablerepo=osg-testing install osg-wn-client </pre>

---+++ Configuring fetch-crl on the Worker Node
In addition to the CA certificates, certificate revocation lists (CRLs) are needed to verify that certificates and proxies are valid.  fetch-crl is used to update and maintain the CRLs for each CA certificate.  Unlike, with the pacman release, fetch-crl is now installed as a system service.  There are two services available.  fetch-crl-boot runs only at boot time.  The fetch-crl-cron "service" runs fetch-crl every 6 hours (with a random sleep time included) by default.  Both services are disabled by default.  
---++++ Enable and Start fetch-crl:
To enable fetch-crl by default on the node:
<pre class="rootscreen">
%UCL_PROMPT_ROOT% chkconfig fetch-crl-boot on
%UCL_PROMPT_ROOT% chkconfig fetch-crl-cron on
</pre>
To start fetch-crl:
<pre class="rootscreen">
%UCL_PROMPT_ROOT% service fetch-crl-boot start
%UCL_PROMPT_ROOT% service fetch-crl-cron start
</pre>
---++++ Configure Proxy Server
To configure fetch-crl to use a proxy server, create  =/etc/fetch-crl.conf= and add =export http_proxy=http://your.squid.fqdn= to the file.
---++++ Modify fetch-crl-cron run times
To modify the times that fetch-crl-cron runs, edit =/etc/cron.d/fetch-crl=.  Cron job files are marked as a config/noreplace files in the RPM.  Any updates to those files will be preserved during an RPM update.
---++ Configuring the CE for wn-client RPMs
Using the wn-client software installed from RPMs will require a few changes on the compute element so that the resource's configuration can be correctly reported.  The =$OSG_GRID= variable, which points to the location of the wn-client installation directory, will need to change.  Most jobs source =$OSG_GRID/setup.sh= before performing any work.  For backwards capability, we have created =/etc/osg/wn-client/setup.sh= to mimic this functionality.  Setting =$OSG_GRID= (in the CE config.ini) to =/etc/osg/wn-client= should provide backward capability.

On an mixed RPM/pacman based system, a possible solution would be to symlink the existing =$OSG_GRID= location to =/etc/osg/wn-client=.

---++ Other considerations
Please see the documentation on using [[Documentation/Release3.YumRpmBasics][yum and RPM]], [[Documentation/Release3.InstallBestPractices][the best practices]] for using yum to install software, and using [[Documentation/Release3.YumRepositories][yum repositories]].

---++ Where to report problems
If you have issues, email osg-software@opensciencegrid.org.

---+ Comments
%COMMENT{type="tableappend"}%

<!-- REVIEW PROCESS

   * Local DOC_ROLE		  = SysAdmin
   
   * Local DOC_TYPE		  = Installation
   
   * Local DOC_AREA               = ComputeElement

   * Local OWNER                  = SuchandraThapa
   * Local INCLUDE_REVIEW = %YES%
   * Local INCLUDE_TEST   = %YES%
   * Local REVIEW_READY   = %YES%
   * Local TEST_READY     = %NO%
   * Local RELEASE_READY  = %NO%

   * Local REVIEWER       = AlainRoy
   * Local REVIEW_PASSED  = %IN_PROGRESS%
 
   * Local TESTER         = AlainRoy
   * Local TEST_PASSED  = %IN_PROGRESS%

-->


%META:TOPICMOVED{by="JamesWeichel" date="1317238795" from="Documentation/Release3.InstallWorkerNode" to="Documentation/Release3.InstallWNClient"}%
