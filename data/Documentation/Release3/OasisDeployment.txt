%META:TOPICINFO{author="JoseCaballero" date="1412877692" format="1.1" reprev="1.2" version="1.2"}%
*WORK IN PROGRESS!!!*

*WORK IN PROGRESS!!!*

*WORK IN PROGRESS!!!*

*WORK IN PROGRESS!!!*

---+!! %SPACEOUT{ "Deployment of OASIS 2" }%
<!--
%DOC_STATUS_TABLE%
-->

%TOC{depth="3"}%

---# About this Document
This document describes how to install and configure OASIS 2 in a server host, an user login host, and a replica host.  

%INCLUDE{"Documentation/DocumentationTeam/DocConventions" section="Header"}%
%INCLUDE{"Documentation/DocumentationTeam/DocConventions" section="CommandLine"}%

---# Applicable versions
The applicable software versions for this document are OASIS 2.0.0 and, as requirements, CVMFS server 2.0.x and 2.1.x.

---# Requirements
QUESTION: Do we need an specific requirement section, or they are already explained in other twikies (CVMFS, ...) and can be linked???

---# Install Instructions

These instructions apply to the 3 hosts, if needed: the server host, the user login host, and the replica host. 
In the case of the server host and the replica host, CVMFS need to be installed first. 
Instructions to install CVMFS can be found here [[https://twiki.grid.iu.edu/bin/view/Documentation/Release3/InstallCvmfsStratum1][here]]

Install the OASIS RPM:
<pre class="rootscreen">
%UCL_PROMPT_ROOT% yum -y install oasisi</pre>

*TEMPORARY SOLUTION:*

as the RPM is not yet available in the OSG repo, meanwhile it can be installed from source code:

<pre class="rootscreen">
%UCL_PROMPT_ROOT% mkdir src
%UCL_PROMPT_ROOT% cd src
%UCL_PROMPT_ROOT% svn co http://svn.usatlas.bnl.gov/svn/oasis/oasis-server/trunk/ .
%UCL_PROMPT_ROOT% python setup.py bdist_rpm
%UCL_PROMPT_ROOT% rpm -Uhv dist/oasis-2.0.0-1.noarch.rpm
</pre>

---# Configuration:

The same configuration must be identical in the user login host and the server host. No configuration is needed for the replica host. 

There are at least 3 configuration files: the oasis.conf, the oasisprojects.conf, the oasisprobes.conf.
Then, for each project (typically a VO, but not necessarily), there is a dedicated {project}probes.conf.

The format of the configuration files is similar to the Microsoft INI files. 
The configuration file consists of sections, led by a *[section]* header and followed by *name: value* entries, with continuations in the style of [[http://tools.ietf.org/html/rfc822.html][RFC 822]] (see section 3.1.1, “LONG HEADER FIELDS”); *name=value* is also accepted. Note that leading whitespace is removed from values. The optional values can contain format strings which refer to other values in the same section, or values in a special *[DEFAULT]* section. Additional defaults can be provided on initialization and retrieval. Lines beginning with '#' or ';' are ignored and may be used to provide comments.

Configuration files may include comments, prefixed by specific characters (# and ;). Comments may appear on their own in an otherwise empty line, or may be entered in lines holding values or section names. In the latter case, they need to be preceded by a whitespace character to be recognized as a comment. (For backwards compatibility, only ; starts an inline comment, while # does not.)

It supports interpolation. This means values can contain format strings which refer to other values in the same section, or values in a special *[DEFAULT]* section. Additional defaults can be provided on initialization.

As the python package !ConfigParser is being used to digest the configuration files, a wider explanation and examples can be found in the [[https://docs.python.org/2/library/configparser.html][python documentation page]].

---## Configuring oasis.conf:

It has a single section, called *[OASIS]*. This head section name can not changed.

| *Variable* | *Description* | *Mandatory* |
| =sleep= | it is the time between cycles for the daemon, waiting to see if all threads, one per Project, need to be shutdown Time is expressed in seconds.  | MANDATORY |
| =email= | email address to notify CRITICAL events | OPTIONAL |
| =SMTPServer= | SMTP server to be used to send email notifications | OPTIONAL |
| =projectsconf= | path to the oasisproject.conf configuration file | MANDATORY |
| =probesconf= | path to the configuration file with generic OASIS probes | MANDATORY |

A typical configuration file looks like this:

<pre class="file">
[OASIS]

sleep = 100 
email = neo@matrix.net
SMTPServer = server
projectsconf = /etc/oasis/oasisprojects.conf
probesconf = /etc/oasis/oasisprobes.conf
</pre>


---## Configuring oasisprojects.conf:

---## Configuring oasisprobes.conf:



-- Main.JoseCaballero - 08 Oct 2014



























