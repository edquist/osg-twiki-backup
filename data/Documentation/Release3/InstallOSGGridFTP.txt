%META:TOPICINFO{author="DouglasStrain" date="1314634490" format="1.1" reprev="1.1" version="1.1"}%
%META:TOPICPARENT{name="RPMTempDocuments"}%
%LINKCSS%
---+!! %SPACEOUT{ "Install Stand-alone OSG GridFTP" }%
%TOC%

---+ Installing the Stand-alone OSG !GridFTP from RPMs

This page explains how to install the stand-alone Globus !GridFTP server.

---++ Requirements
A RHEL5 (or !CentOS 5, SL5) machine with [[http://fedoraproject.org/wiki/EPEL][EPEL]] repos enabled.

---++ Install Instructions

%INCLUDE{"InstallVDTRepo" headingoffset="1"}%

!GridFTP requires a certificate package to run.  If you require a specific certificate package, follow the InstallCACerts instructions to install it.  
If you do not install a grid certificate package first, the install procedure will install one for you as part of its dependencies.  (usually osg-ca-certs).

First, you will need to install the !GridFTP meta-package:

<pre class="rootscreen">
%UCL_PROMPT_ROOT% yum --enablerepo=osg-development --nogpgcheck install osg-gridftp
</pre> 

---+++ Configuring GUMS support

By default, !GridFTP uses a gridmap file, found in =/etc/grid-security/gridmap-file=.
If you want to use GUMS security (recommended), you will need to enable using the following steps:

First, edit =/etc/grid-security/gsi-authz.conf= and uncomment the globus callout.
<pre class="file">
globus_mapping /usr/lib64/liblcas_lcmaps_gt4_mapping.so lcmaps_callout
</pre> 
This should be =/usr/lib64= for x86_64 architectures and =/usr/lib= for i386 architectures.

Next edit =/etc/lcmaps.db= to edit your gums information:
<pre class="file">
# Module definitions
path = /usr/lib64/modules

...
gumsclient = "lcmaps_gums_client.mod"
             "-resourcetype ce"
             "-actiontype execute-now"
             "-capath /etc/grid-security/certificates"
             "-cert   /etc/grid-security/hostcert.pem"
             "-key    /etc/grid-security/hostkey.pem"
             "--cert-owner root"
# Change this URL to your GUMS server
             "--endpoint https://*gums.fnal.gov:8443*/gums/services/GUMSXACMLAuthorizationServicePort"
</pre> 

If you would like to run SAZ, you will need to enable the relevant lines in the above file as well (more documentation to be added later).

---++ TEMPORARY HACK FIX

Until we get our act together and add this to the sysconfig, edit =/etc/init.d/globus-gridftp-server= and add this to the beginning after the comments:
<pre class="file">
      export LCAS_LOG_LEVEL=0
      export LCAS_DEBUG_LEVEL=0
      export LCAS_DB_FILE=/etc/lcas/lcas.db
      export LCAS_DIR=/etc/lcas
      export LCAS_MOD_HOME=/usr/lib64/modules
      export LCMAPS_LOG_LEVEL=0
      export LCMAPS_DEBUG_LEVEL=0
      export LCMAPS_DB_FILE=/etc/lcmaps.db
      export LCMAPS_MOD_HOME=/usr/lib64/modules
      export LCMAPS_POLICY_NAME=osg_default
</pre>

---++ Starting and Stopping !GridFTP

Starting !GridFTP:
<pre class="rootscreen">
%UCL_PROMPT_ROOT% service globus-gridftp-server start
</pre> 


Stopping !GridFTP:
<pre class="rootscreen">
%UCL_PROMPT_ROOT% service globus-gridftp-server stop
</pre> 



-- Main.DouglasStrain - 29 Aug 2011
