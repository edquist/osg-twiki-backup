%META:TOPICINFO{author="MarcoMambelli" date="1318262743" format="1.1" reprev="1.9" version="1.9"}%
%META:TOPICPARENT{name="WebHome"}%
%DOC_STATUS_TABLE%

---+!! Installing CA Certificate Authorities with RPMs 
%TOC%

---+About this Document 
This document provides you with details of various options to install the Certificate Authority (CA) certificates.

---+ Background

When installing software with RPMs, you need to decide how you want to install the Certificate Authority (CA) certificates. You might ask "why do I care? Can't you just give them to me?" We can, but you have a few things to consider:

   * What set of CA certificates do you want? How much control do you want over the set of CA certificates? (Some sites might not want to install specific CAs for policy or security reasons.)
   * How do you want to update them? 
   * Do you want to centrally manage the CA certificates or install them on each computer at your site?

You have four options for installing CA certificates:

   1. Install an RPM for a specific set of CA certificates. 
   1. Install =osg-update-certs=, a program that lets you install/update a predefined set of CA certificates, then adjust the set by adding or deleting specific CAs.
   1. Install an RPM that installs *no* CAs. This is useful when you want your RPM installations to succeed (because our RPMs require CA certificates, and this RPM satisfies that dependency) but you want to manage them with your own technique. 
   1. Make no choice, let =yum= decide for you.

---+ First: Set up the yum repositories

%INCLUDE{"YumRepositories" section="OSGRepoBrief"}%

---+ Option 1: Install an RPM for a specific set of CA certificates

If you want to install an RPM for one of our predefined CA certificates, you have two choices to make:

*Choice 1: Which set of CAs?*
   a. (_recommended_) The OSG CA certificates. This is similar to the IGTF set, but may have a small number of additions or deletions. 
   a. The default [[http://www.igtf.net/][IGTF]] CA certificates.

*Choice 2: Which format?*
   a. (_recommended_) A format compatible with both !OpenSSL 0.9.x and !OpenSSL 1.0
   a. A format only compatible with !OpenSSL 0.9.x. This may be important if you have installed programs that don't understand the newer format. 

Depending on your choice, you select one of four RPMs:

%TABLE{ sort="off" valign="top" }%
| *Set of CAs* | *Format* | *RPM name* | *Installation command (as root)* |
| OSG | !OpenSSL-both | osg-ca-certs | =yum install osg-ca-certs= | 
| OSG | !OpenSSL 0.9.x | osg-ca-certs-compat | =yum install osg-ca-certs-compat= | 
| IGTF | !OpenSSL-both | igtf-ca-certs | =yum install igtf-ca-certs= | 
| IGTF | !OpenSSL 0.9.x | igtf-ca-certs-compat | =yum install igtf-ca-certs-compat= | 

---+ Option 2: Install osg-update-certs

(In the Pacman world, this was vdt-update-certs).

Install this with: <pre class=screen>%UCL_PROMPT_ROOT% yum install osg-ca-scripts</pre>

You have the same choices for CA certificates as above. In order to choose, you will run osg-ca-manage, which will install the CA certificates. Then (if desired) you need to enable periodic updating of the CA certificates. 

%TABLE{ sort="off" valign="top" }%
| *Set of CAs* | *Format* | *CA certs name* | * Installation command (as root)* |
| OSG | !OpenSSL-both | osg | =/usr/sbin/osg-ca-manage setupCA --location root --url osg= | 
| OSG | !OpenSSL 0.9.x | osg-compat | =/usr/sbin/osg-ca-manage setupCA --location root --url osg-compat= | 
| IGTF | !OpenSSL-both | igtf | =/usr/sbin/osg-ca-manage setupCA --location root --url igtf= | 
| IGTF | !OpenSSL 0.9.x | igtf-compat | =/usr/sbin/osg-ca-manage setupCA --location root --url igtf-compat= | 

Here is an example:

<pre class="screen">
%UCL_PROMPT_ROOT% /usr/sbin/osg-ca-manage setupCA --location root --url osg 
Setting up CA Certificates for OSG installation
CA Certificates will be installed into /etc/grid-security/certificates
osg-update-certs
  Log file: /var/log/osg-update-certs.log
  Updates from: http://software.grid.iu.edu/pacman/cadist/ca-certs-version-new

Will update CA certificates from version unknown to version 1.21NEW.
Update successful.

Setup completed successfully.
</pre>

Initially the CA certificates will not be updated. You can tell by looking at:

<pre class="screen">%UCL_PROMPT_ROOT% /sbin/service osg-update-certs-cron  status
Periodic osg-update-certs is disabled.</pre>

You can enable the =cron= job that updates the CA certs with:
<pre class="screen">%UCL_PROMPT_ROOT% /sbin/service osg-update-certs-cron  start
Enabling periodic osg-update-certs:                        [  %GREEN%OK%ENDCOLOR%  ]</pre>

For now, we don't have further documentation on figuring these scripts, but the =osg-ca-manage= command in your interface to adding and removing CAs. 

---+ Option 3:  Install an RPM that installs no CAs
Install this with: <pre class=screen>yum install empty-ca-certs</pre>

%RED%*Warning:*%ENDCOLOR% If you choose this option, you are responsible for installing the CA certificates yourself. You must install them in =/etc/grid-security/certificates=, or make a symlink from that location to the directory that contains the CA certificates. 

---+ Option 4: Make no choice, let yum decide for you
If you use =yum= to install software that requires CA certificates but you haven't made one of these choices, yum will choose a default. Right now, it is Option #1 from above (_Install an RPM for a specific set of CA certificates_), and the osg-ca-certs RPM is chosen.

---+ Appendix: Install other CAs

In addition to the above CAs, you can install other CAs via RPM. These only work with the RPMs that provide CAs (that is, =osg-ca-certs= and the like, but not =osg-ca-scripts=.) They are in addition to the above RPMs, so do not only install these extra CAs. 

%TABLE{ sort="off" valign="top" }%
| *Set of CAs* | *Format* | *RPM name* | *Installation command (as root)* |
| cilogon-basic & cilogon-openid | !OpenSSL-both | cilogon-ca-certs | =yum install cilogon-ca-certs= | 
| cilogon-basic & cilogon-openid | !OpenSSL 0.9.x | cilogon-ca-certs-compat | =yum install cilogon-ca-certs-compat= | 

%STARTSECTION{"OSGBriefCaCerts"}%
---%SHIFT%+ Quick Summary: Installing the CA Certificates
Install one set of CA certificates.  The OSG provides two pre-defined sets:
   * (default) The OSG certificates.  These *include* all the IGTF certificates and additional CAs the OSG has vetted.
   * The IGTF (International Grid Trust Federation) certificates. The IGTF verifies each CAs policy is up to a minimum, internationally-accepted standard.  <br/>
Only one can be installed on a system at a time; you must pick one.  To install the OSG CA certificates: <pre class="rootscreen">
%UCL_PROMPT_ROOT% yum install osg-ca-certs </pre>
      To install the IGTF certificates: <pre class="rootscreen">
%UCL_PROMPT_ROOT% yum install igtf-ca-certs </pre>

For more details, please see our [[Documentation.Release3.InstallCertAuth][CA certificates documentation]].
%ENDSECTION{"OSGBriefCaCerts"}%

<!-- CONTENT MANAGEMENT PROJECT
############################################################################################################
 DEAR DOCUMENT OWNER
 ===================

 Thank you for claiming ownership for this document! Please fill in your FirstLast name here:
   * Local OWNER = AnandPadmanabhan MarcoMambelli

 Please define the document area, choose one of the defined areas from the next line
 DOC_AREA = (ComputeElement|Storage|VO|Security|User|Monitoring|General|Integration|Operations|Tier3)
   * Local DOC_AREA       = VO

 define the primary role the document serves, choose one of the defined roles from the next line
 DOC_ROLE = (EndUser|Student|Developer|SysAdmin|VOManager)
   * Local DOC_ROLE       = SysAdmin

 Please define the document type, choose one of the defined types from the next line
 DOC_TYPE = (Troubleshooting|Training|Installation|HowTo|Planning|Navigation|Knowledge)
   * Local DOC_TYPE       = Installation
  Please define if this document in general needs to be reviewed before release ( %YES% | %NO% )
   * Local INCLUDE_REVIEW = %YES%

 Please define if this document in general needs to be tested before release ( %YES% | %NO% )
   * Local INCLUDE_TEST   = %YES%

 change to %YES% once the document is ready to be reviewed and back to %NO% if that is not the case
   * Local REVIEW_READY   = %YES%

 change to %YES% once the document is ready to be reviewed and back to %NO% if that is not the case
   * Local TEST_READY   = %YES%

 change to %YES% only if the document has passed the review and the test (if applicable) and is ready for release
   * Local RELEASE_READY  = %NO%


 DEAR DOCUMENT REVIEWER
 ======================

 Thank for reviewing this document! Please fill in your FirstLast name here:
   * Local REVIEWER       = MarcoMambelli
 Please define the review status for this document to be in progress ( %IN_PROGRESS% ), failed ( %NO% ) or passed ( %YES% )
   * Local REVIEW_PASSED  = %IN_PROGRESS%


DEAR DOCUMENT TESTER
 ====================

 Thank for testing this document! Please fill in your FirstLast name here:
   * Local TESTER         = MarcoMambelli
 Please define the test status for this document to be in progress ( %IN_PROGRESS% ), failed ( %NO% ) or passed ( %YES% )
   * Local TEST_PASSED    = %IN_PROGRESS%

############################################################################################################
-->

%META:TOPICMOVED{by="JamesWeichel" date="1317238515" from="Documentation.InstallCertAuth" to="Documentation/Release3.InstallCertAuth"}%
