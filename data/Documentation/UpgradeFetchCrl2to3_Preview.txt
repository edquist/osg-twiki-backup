%META:TOPICINFO{author="KyleGross" date="1480625583" format="1.1" version="1.4"}%
%META:TOPICPARENT{name="SoftwareTeam.FetchCrl3OnEl5Proposal"}%
%LINKCSS%

%DOC_STATUS_TABLE%

---+!! %SPACEOUT{ "Upgrading Fetch-Crl 2 to Fetch-Crl 3 on EL5 (preview)" }%
%TOC%

---++ Procedure

   1. =service disable fetch-crl-{boot,cron}=
   1. Either =yum install fetch-crl3= or =yum upgrade= any package that used to require =fetch-crl= (see above lists)
   1. =service enable fetch-crl3-{boot,cron}=
   1. Edit =/etc/cron.d/fetch-crl3= to change parameters if desired (it's marked as a &#37;config file in the rpm)
   1. Edit =/etc/fetch-crl3.conf= as desired, see table
   1. Test it; once satisfied that it works, you can =yum erase fetch-crl= to get rid of the old version

---++ *Translation table from fetch-crl.conf to fetch-crl3.conf:*

| *fetch-crl.conf* | *fetch-crl3.conf* |
|<code>ALLWARNINGS=yes</code> | can't be set, but see =nowarnings= and =verbosity= |
|<code>CACHEDIR=/var/cache/fetch-crl</code> |<code>statedir = /var/cache/fetch-crl3</code> (I think?) |
|<code>CACHEDIR=</code> (disables cache) |<code>nocache</code> or <code>stateless</code> (those aren't synonyms but I don't know what the difference is) |
|<code>CRLDIR=/etc/grid-security-certificates</code> |<code>infodir = /etc/grid-security/certificates</code> |
|<code>CRL_AGING_THRESHOLD=24</code> |<code>agingtolerance = 24</code> |
|<code>FETCH_CRL_OPENSSL=/usr/bin/openssl</code> |<code>openssl = /usr/bin/openssl</code> |
|<code>FORCE_OVERWRITE=yes</code> | always 'yes' |
|<code>HTTP_PROXY=...</code> |<code>http_proxy = ...</code> or set in <code>/etc/sysconfig/fetch-crl3</code> and use <code>http_proxy = ENV</code> |
|<code>QUIET=yes</code> |<code>verbosity = -1</code> |
|<code>RESETPATHMODE=yes</code> |<code>path = /bin:/usr/bin</code> |
|<code>RESETPATHMODE=searchopenssl</code> | ? |
|<code>SERVERCERTCHECK=no</code> | always 'no'; install =perl-Crypt-SSLeay= and set =HTTPS_CA_FILE= in =/etc/sysconfig/fetch-crl3= if you want to check server cert, but the docs suggest that since the crls are signed, checking server cert is unnecessary and may give false positives for security warnings |
|<code>SLOPPYCRLHASHES=yes</code> | can't be set |
|<code>SYSLOGFACILITY=daemon</code> |<code>syslogfacility = daemon |
|<code>WGET_OPTS=...</code> | can't be set |
|<code>WGET_RETRIES=2</code> | can't be set |
|<code>WGET_TIMEOUT=120</code> |<code>httptimeout = 120</code> (I think?) |

See also =/usr/share/doc/fetch-crl3-*/fetch-crl.conf.example=


<!-- CONTENT MANAGEMENT PROJECT
############################################################################################################
 DEAR DOCUMENT OWNER
 ===================

 Thank you for claiming ownership for this document! Please fill in your FirstLast name here:
   * Local OWNER = MatyasSelmeci

 Please define the document area, choose one of the defined areas from the next line
 DOC_AREA = (ComputeElement|General|Trash/Integration|Monitoring|Operations|SecurityTeam|Storage|Trash/Tier3|User|VO)
   * Local DOC_AREA       = General

 define the primary role the document serves, choose one of the defined roles from the next line
 DOC_ROLE = (Developer|Documenter|Scientist|Student|SysAdmin|VOManager)
   * Local DOC_ROLE       = SysAdmin

 Please define the document type, choose one of the defined types from the next line
 DOC_TYPE = (HowTo|Installation|Knowledge|Navigation|Planning|Training|Troubleshooting)
   * Local DOC_TYPE       = HowTo
  Please define if this document in general needs to be reviewed before release ( %YES% | %NO% )
   * Local INCLUDE_REVIEW = %YES%

 Please define if this document in general needs to be tested before release ( %YES% | %NO% )
   * Local INCLUDE_TEST   = %YES%

 change to %YES% once the document is ready to be reviewed and back to %NO% if that is not the case
   * Local REVIEW_READY   = %NO%

 change to %YES% once the document is ready to be tested and back to %NO% if that is not the case
   * Local TEST_READY     = %NO%

 change to %YES% only if the document has passed the review and the test (if applicable) and is ready for release
   * Local RELEASE_READY  = %NO%


 DEAR DOCUMENT REVIEWER
 ======================

 Thank for reviewing this document! Please fill in your FirstLast name here:
   * Local REVIEWER       = 
 Please define the review status for this document to be in progress ( %IN_PROGRESS% ), failed ( %NO% ) or passed ( %YES% )
   * Local REVIEW_PASSED  = %IN_PROGRESS%


 DEAR DOCUMENT TESTER
 ====================

 Thank for testing this document! Please fill in your FirstLast name here:
   * Local TESTER         = 
 Please define the test status for this document to be in progress ( %IN_PROGRESS% ), failed ( %NO% ) or passed ( %YES% )
   * Local TEST_PASSED    = %IN_PROGRESS%
############################################################################################################
-->


<!-- vim:ft=twiki
-->

%META:TOPICMOVED{by="MatyasSelmeci" date="1357774583" from="Documentation.UpgradeFetchCrl2to3" to="Documentation.UpgradeFetchCrl2to3_Preview"}%
