%META:TOPICINFO{author="BrianBockelman" date="1266366828" format="1.1" version="1.8"}%
%META:TOPICPARENT{name="UsingTheGrid"}%
%LINKCSS%

---+!! Find an available resource
%TOC%

%STARTINCLUDE%
%EDITTHIS%

This section will discuss first how to find sites by hand and how to find sites in a machine-readable format.  The point is to first get a "human grasp" on what's available, then slowly introduce the machine-readable formats.

---++++ Finding resources by hand.
All OSG sites are registered in a central database called OIM and presented via a webpage called [[http://myosg.grid.iu.edu][MyOSG]]. OIM maintains information on every site in a DB, and verifies this information regularly. Resources that fail basic functionality tests are marked in red, resources that pass all basic tests are green.

[[https://myosg.grid.iu.edu/rgsummary/index?datasource=summary&summary_attrs_showdesc=on&summary_attrs_showhierarchy=on&summary_attrs_showservice=on&summary_attrs_showrsvstatus=on&summary_attrs_showfqdn=on&summary_attrs_showvoownership=on&summary_attrs_showcontact=on&all_resources=on&gridtype=on&gridtype_1=on&service_1=on&service_5=on&service_2=on&service_3=on&active=on&active_value=1&disable_value=1][Here is a direct link to the MyOSG resource summary page.]]

Each endpoint is called a "resource", and each resource provides resources such as "CE" or "SRMv2".  The right-hand column allows you to filter by facility, current status, or the VO which owns the resource.  Notice there is some necessary information missing:
   1 The full contact information for the resource (port used, URL, etc)
   1 Whether the service will support your VO.

MyOSG allows you to explore the resources, but it is not meant to match jobs to resources.  There are two servers - !ReSS and BDII - that provide very detailed data for using the endpoints.  The BDII provides data in the LDIF format while !ReSS provides data in a Condor ClassAd format.  Both formats express the information in a schema called "GLUE".

We will give a few examples, but suggest that you use try these queries once, then use pre-built tools such as OSG-MM.  We will be using the results you receive later for some of the job management examples.   If you find yourself programming BDII queries into your code, ask for help - you might be approaching something wrong.

To get a list of contact string for sites that support your VO, you can query the BDII server.  Try the following query directly:

<pre class="screen">
<userinput>ldapsearch -LLL -h is.grid.iu.edu -p 2170 -x -b 'o=grid' '(&(objectClass=GlueCE)(GlueCEAccessControlBaseRule=VO:cms))' GlueCEInfoHostName GlueCEInfoGatekeeperPort GlueCEInfoJobManager</userinput>
</pre>

One example result is:

<pre class="screen"
dn: GlueCEUniqueID=cit-gatekeeper.ultralight.org:2119/jobmanager-condor-cms_us
 er,Mds-Vo-name=CIT_CMS_T2,Mds-Vo-name=local,o=grid
GlueCEInfoHostName: cit-gatekeeper.ultralight.org
GlueCEInfoGatekeeperPort: 2119
GlueCEInfoJobManager: condor
</pre>

We can use the information found here to build a query to a tool like Condor-G or globus-job-run.

You can get the additional information about the site.  For example, if you want to find out if worker nodes at =CIT_CMS_T2= have outgoing connections, you can do:

<pre class="screen">
<userinput>ldapsearch -LLL -h is.grid.iu.edu -p 2170 -x -b   &#92;
   mds-vo-name=CIT_CMS_T2,o=grid "(GlueHostNetworkAdapterOutboundIP=*)"   &#92;
   GlueHostNetworkAdapterOutboundIP</userinput>
GlueHostNetworkAdapterOutboundIP: TRUE
</pre>


%STOPINCLUDE%