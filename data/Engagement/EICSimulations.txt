%META:TOPICINFO{author="MarkoSlyz" date="1315601029" format="1.1" reprev="1.2" version="1.2"}%
%META:TOPICPARENT{name="WebHome"}%
%TOC%

---+!! Electron Ion Collider (EIC) Simulations on OSG (Proof-of-principle Phase)

---++ Introduction.
The OSG User Support group is working with Thomas Ullrich and Tobias Toll from BNL on porting event simulations for the Electron Ion Collider (EIC) project to OSG. The project attracts collaborators from the Nuclear Physics community and is currently preparing the physcis case for the collider for 2012/2013.

---++ Requirements

<b>DRAFT</b><br>
These requirements need to be vetted with EIC. <br>

---+++ Production requirements
The application is one of the first implementations of an event generator for Electron / Ion collisions. It takes minutes to generate an event. The program is logically split in 2 parts: (1) generate  a table of branching ratios for the products of the Electron / Ion collisions, (2) look up the table to generate events. 

Generating events from 1 brancing ratio table for 1 nucleus requires about 50 CPU yrs -> ~45 days on ~400 CPU. This is the target computation for the proof-of-principle phase.

The simulation application is currently run on multi-core (16-core) nodes, producing the branching ratio table (1), then running about 100 event generator threads concurrently (2). Running a single-threaded application on 100 nodes is a more appropriate approach to fit the DHTC model of OSG. 

The table of branching ratios can be
   A.  computed completely by every job / thread, or
   B.  computed by each job for the portion of the parameter space evaluated by the job / thread, or
   C. pre-computed completely and shipped with every job, or
   D. pre-computed completely and pre-staged at all sites.
 (A) is inefficient as it duplicates the same computation at all worker nodes for every job, (B) requires too many code modifications, (C) requires to move ~1 GB per job, (D) is considered the least expensive: data will be deployed using the OSG Match Maker.

---+++ Platform requirements

   * Job duration on common OSG platforms = 6-12 hours / job (easily tuned)
   * Job application = SL5 64bits binaries
   * Job Memory requirement = 1 GB (??)
   * Local WN disk requirements = 1 GB (??)

---+++ I/O Data requirements

   * Input to the simulation job:
      * Common data: a table of the branching ratios for the products of the Electron / Ion collisions
         * Data are fairly static
         * 2 GB uncompressed; ~1GB compressed  -- the compression happens automatically by the application
         * Each job needs access to the table file
         * These are pre-installed in $OSG_DATA/engage/EIC 
      * Parameter file
         * Each job needs a different and specific set of input parameters. 
         * 2 MB uncompressed per job
         * Data is send with the jobs

   * Output of the simulation job:
      * Generated events
         * A few MB uncompressed per job
         * Output data from all jobs will be aggegated offline

---+++ P

---+++ Current Status

9/9/11: The main program, called  tableGeneratorMain, has been modified to run single threaded, so it won't inadvertently use more cores.
tableGeneratorMain also now reads the parame


-- OSG User Support
