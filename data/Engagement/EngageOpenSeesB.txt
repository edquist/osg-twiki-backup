%META:TOPICINFO{author="X509_2fDC_3dorg_2fDC_3ddoegrids_2fOU_3dPeople_2fCN_3dMarko_20Slyz_20664315" date="1297802567" format="1.1" reprev="1.5" version="1.5"}%
%META:TOPICPARENT{name="WebHome"}%
---+ Running the !OpenSees application of the Network Earthquake Engineering Simulation (NEES) on the Open Science Grid


[[http://opensees.berkeley.edu/OpenSees/home/about.php][OpenSees]] is a program that simulates the response of
buildings and other structures to earthquakes. It can
require a lot of computation time so it is useful to
run multiple simultaneous instances of it.             

The integration of the NEES community with the
Open Science Grid infrastructure will be approached in
phases. Each phase is a subproject in itself,
with well defined goals and time line. Each new phase
will either increase the functionality of the system, or
its reliability, or the number of users of the system.
The final goal of this process is to empower the NEES
community to run their computations on OSG independently
and with minimal support from OSG.

Currently, the OSG User Support team is working with NEES
on two fronts: (1) running !OpenSees on OSG through direct
job submission (this project); (2) integrating the OSG
glidein workload management system with the NEES HubZero
portal as a mechanism to run canned applications on OSG.

This web page discusses the first phase of integration
of !OpenSees on OSG through direct job submission.

----+Goals and Requirements

The goals of this phase are to run the !OpenSees
application on the Open Science Grid with a set of
realistic inputs from one user, and to create scripts
and documentation to make the workflow
straightforward. We expect that the resulting prototype
will be a good basis for other uses of !OpenSees.

The !OpenSees requirements when using the chosen inputs
are as follows:

* Be able to run on the order of 60 simultaneous jobs
  at once. Could be somewhat more sometimes.

* There would typically be multiple batches of runs
  over the course of a month followed by a time with no
  runs.

* Ideally some runs could be fairly long, 36+ hours,
  though shorter ones, up to 1 day long, are still
  useful.

  OSG does not generally support 36+ hour runs. We are
  currently looking into this problem, including some
  [[VirtualOrganizations.VOGroupMeeting20110210#Running_long_jobs_without_fixed][discussion at the VO Forum.]] The basic problems are
  that in this case glidein pilots don't run for more
  than 24 hours, many sites evict jobs after a certain
  amount of run time, and many sites preempt jobs if
  there are higher priority ones.

* Does not need special dynamically-linked libraries.

* Does not need to handle much input or output data. At
  least during the current testing the input tar file
  after compression is on the order of 4Mb, which
  includes both the !OpenSees executable and input
  data. The output file can be at least up to 30Mb but
  was often smaller.

* Does not need much RAM. During one test an !OpenSees
  job needed less than 200Mb although this could be
  checked.

We have some instructions for the [[running_OpenSees_on_OSG_b][prototype integration with OSG]].

----+ Timeline and Responsibilities
                                                       
The work for this project started in mid-January.
At the time of this writing (Feb 15, 2011), we
envision that we will close down this first phase
of integration at the end of February 2011.

Currently, the system satisfies all requirements except
the ability to run long jobs. The OSG User Support
group has started to work with Glidein WMS operational
teams to devise a solution and possibly implement
it in a future project phase.

The OSG User Support team is responsible for writing
scripts and configuration files to enable the
integration of !OpenSees with OSG, for testing the
infrastructure, for writing documentation, and for
solving problems due to the configuration of OSG. This
prototype also builds on [[Main.OpenSeesAndCactusDocs][previous work done by OSG]] 
to remove the dependencies of !OpenSees from MPI
libraries (which are not always installed on OSG
sites).

NEES staff is responsible for explaining how to run
!OpenSees, for providing test cases, for doing further
testing, and for giving feedback on the scripts and
documentation.

At the end of this phase, it is expected that the NEES
staff will be able to run jobs on OSG with the
limitations in capability discussed above (system
addressing the agreed requirements with no support for
long jobs). Requests for support will preferentially be
directed through the standard OSG support channels (GOC
tickets and VO Forum), even if directed email will still
be answered at a best effort level.

    -- M. Slyz, G. Garzoglio - 15 Feb 2011

%META:FILEATTACHMENT{name="running_OpenSees_on_OSG.html" attachment="running_OpenSees_on_OSG.html" attr="h" comment="Details about the integration." date="1297408134" path="running_OpenSees_on_OSG.html" size="14980" stream="running_OpenSees_on_OSG.html" tmpFilename="/usr/tmp/CGItemp3529" user="X509_2fDC_3dorg_2fDC_3ddoegrids_2fOU_3dPeople_2fCN_3dMarko_20Slyz_20664315" version="1"}%
%META:FILEATTACHMENT{name="interactive_access_to_running_jobB.txt" attachment="interactive_access_to_running_jobB.txt" attr="h" comment="" date="1297406180" path="interactive_access_to_running_jobB.txt" size="5428" stream="interactive_access_to_running_jobB.txt" tmpFilename="/usr/tmp/CGItemp61848" user="X509_2fDC_3dorg_2fDC_3ddoegrids_2fOU_3dPeople_2fCN_3dMarko_20Slyz_20664315" version="1"}%
%META:FILEATTACHMENT{name="untarring_multiple_output_filesA.txt" attachment="untarring_multiple_output_filesA.txt" attr="h" comment="" date="1297406243" path="untarring_multiple_output_filesA.txt" size="3433" stream="untarring_multiple_output_filesA.txt" tmpFilename="/usr/tmp/CGItemp61629" user="X509_2fDC_3dorg_2fDC_3ddoegrids_2fOU_3dPeople_2fCN_3dMarko_20Slyz_20664315" version="1"}%
%META:FILEATTACHMENT{name="running_OpenSees_on_OSG.pdf" attachment="running_OpenSees_on_OSG.pdf" attr="h" comment="" date="1297409942" path="running_OpenSees_on_OSG.pdf" size="218300" stream="running_OpenSees_on_OSG.pdf" tmpFilename="/usr/tmp/CGItemp64438" user="X509_2fDC_3dorg_2fDC_3ddoegrids_2fOU_3dPeople_2fCN_3dMarko_20Slyz_20664315" version="1"}%
