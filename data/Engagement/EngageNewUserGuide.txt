%META:TOPICINFO{author="MatsRynge" date="1317231556" format="1.1" reprev="1.14" version="1.14"}%
%META:TOPICPARENT{name="WebHome"}%
%TOC%

<!--
   * Set EngageFqanExample = Engage
-->

%EngageFqanExample%

---++ 1. Overview

The Engagement VO (Virtual Organization) has been established to help new communities make use of Open Science Grid. For any questions or comments, please email Engage support at engage-team@opensciencegrid.org The purpose of this document is to provide some quick notes on things you need to do to run jobs on OSG as a member of the Engagement VO. If you need more detailed information than this document provides, see the OSG documentation.

[[https://twiki.grid.iu.edu/twiki/bin/view/ReleaseDocumentation/OverviewOfServicesInOSG][Overview of Services in OSG]]

[[https://twiki.grid.iu.edu/twiki/bin/view/Documentation/WebHome][OSG Documentation Hub]]

---++ 2. Getting a Certificate

Open Science Grid authentication is a single-sign on system based on X.509 certificates. In order to submit jobs you need a certificate for authentication. *We strongly recommend that you use Mozilla Firefox for this*. Also make sure that you use your own computer, as you need to use the same browser for applying and retrieving the certificate.

---++++ Updating the DOEGrids CA Chain

The first step is to ensure you have the latest DOEGrids CA Chain in your browser.

%STARTSECTION{"UpdateDOECAChain"}%
   * Browse to [[https://pki1.doegrids.org/][https://pki1.doegrids.org/]]
   * In the top navigation bar, click Retrieval. - In the left navigation bar, click Import CA Certificate Chain.
   * Import the certificate chain. Under Users, ensure that the default choice, Import the CA certificate chain into your browser, is selected, and then click Submit.
   * In the Downloading Certificate dialog, enable all three options to allow "ESnet Root CA 1" to identify web sites, email users, and software developers, and then click OK. 
%ENDSECTION{"UpdateDOECAChain"}%

---++++ Applying for a Personal Certificate

%STARTSECTION{"ApplyForDOECert"}%
To apply for a personal certificate, use a web browser and go to:

[[https://software.grid.iu.edu/cert/certreg.php][https://software.grid.iu.edu/cert/certreg.php]]

Fill out the form. For Virtual Organization name, select ' *Engage* '. Please pick your Engagement contact as sponsor. If you are unsure about who to put, please contact your Engage contact or the Engage team at engage-team@opensciencegrid.org
%ENDSECTION{"ApplyForDOECert"}%

---++++ Retrieving/Exporting a Personal Certificate

It will take a day or two for the certificate to be approved. Once you receive the email about the certificate being ready, follow these instructions on how to export the certificate to a Grid public/private key pair:

[[http://www.doegrids.org/pages/cert-request.html][http://www.doegrids.org/pages/cert-request.html]]

Under the &ldquo;Exporting your key pair for use by Globus grid-proxy-init&rdquo; heading. note that after generating the usercert.pem and userkey.pem files in your $HOME/.globus directory, you need to change the permissions: chmod 600 ~/.globus/userkey.pem

---++ 3. Joining the Engage VO

%STARTSECTION{"JoinTheEngageVO"}%
Once you have your certificate, you can join the Engage Virtual Organization (VO). Go to:

%STARTSECTION{"EngageVOMRSLink"}%
[[https://osg-engage.renci.org:8443/vomrs/Engage/vomrs][https://osg-engage.renci.org:8443/vomrs/Engage/vomrs]]
%ENDSECTION{"EngageVOMRSLink"}%

The browser should present your certificate to the server, and you should see something like this on the bottom of the page (but with your name):

<verbatim>
DN: /DC=org/DC=doegrids/OU=People/CN=Mats Rynge 722233
</verbatim>

Fill out and submit the form. 
%ENDSECTION{"JoinTheEngageVO"}%
You will get a confirmation email, which asks you to click a link to verify your email address. Once that is done, in less than a day, you should receive an email stating that you are now part of the Engage VO.

---++ 4. Submit Host

%STARTSECTION{"SubmitHostBasic"}%
The submit host is the machine managing your jobs. RENCI has a submit node for you to use with all of the client software pre-installed and configured. You could run your own, but until you are more familiar with the tools and how they work together, it is recommended to use RENCI's submit host. The current host is engage-submit3.renci.org. To get an account on this host, please email engage-team@opensciencegrid.org for instructions.
%ENDSECTION{"SubmitHostBasic"}%

---++ 5. Initializing a User Proxy
%STARTSECTION{"InitUserProxyBasic"}%
Note that you will have to have your certificate exported as mentioned above, and placed in ~/.globus/ on the submit host. A proxy is a time limited version of your certificate. The proxy is what is actually presented to the remote site during authentication. To create a proxy, use the voms-proxy-init command:

<pre>[rynge@nantahala ~]$ voms-proxy-init -voms %EngageFqanExample% -valid 72:00
Cannot find file or dir: $prefix/etc/vomses
Your identity: /DC=org/DC=doegrids/OU=People/CN=Mats Rynge 722233
Enter GRID pass phrase:
Creating temporary proxy ...................................... Done
Contacting  osg-engage.renci.org:15001 [/DC=org/DC=doegrids/OU=Services/CN=osg-engage.renci.org] "Engage" Done

Creating proxy ............................................ Done
Your proxy is valid until Thu Apr  5 10:29:08 2007
</pre>

Note that you can specify how long the proxy should be valid for. It should be long enough for the job run to finish, but should not be longer than 72 hours. You might see some warnings in the output of voms-proxy-init. Do not worry about them as long as you get a proxy at the end. You can check the proxy with voms-proxy-info:

<verbatim>
[rynge@nantahala ~]$ voms-proxy-info
WARNING: Unable to verify signature! Server certificate possibly not installed.
Error: Cannot find certificate of AC issuer for vo Engage
subject   : /DC=org/DC=doegrids/OU=People/CN=Mats Rynge 722233/CN=proxy
issuer    : /DC=org/DC=doegrids/OU=People/CN=Mats Rynge 722233
identity  : /DC=org/DC=doegrids/OU=People/CN=Mats Rynge 722233
type      : proxy
strength  : 512 bits
path      : /tmp/x509up_u1031
timeleft  : 23:20:17
</verbatim>
%ENDSECTION{"InitUserProxyBasic"}%


-- Main.MatsRynge - 02 Mar 2009
