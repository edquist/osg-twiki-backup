%META:TOPICINFO{author="RansomBriggs" date="1149024849" format="1.0" version="1.2"}%
%META:TOPICPARENT{name="SrmDrm"}%
<!-- This is the default OSG Integration template. 
Please modify it in the sections indicated to create your topic!
If you have any comments/complaints about this template, then please email me:
rwg@hep.uchicago.edu.  (Adapted from Atlas wiki template, Ed Moyse)
--> 

<!-- By default the title is the WikiWord used to create this topic !-->
<!-- if you want to modify it to something more meaningful, just replace %TOPIC% below with i.e "My Topic"!-->

---+!!<nop>%TOPIC%
%TOC%
%STARTINCLUDE%


---++Introduction

This page is not intended to replace the official manual provided by the SDM group but instead to supplement it with notes from from DRM administrators and users.

---++Installation Overview

Start by getting appropriate binaries either through VDT or directly from the SRM distribution page: http://sdm.lbl.gov/srm-dist/.  Also get the user guide from the SRM distribution page.  Chapter 1 of the user guide describes in detail what you need to do to start your DRM, which is is basically three steps:

1) Start nameserv (use an open port):  nameserv -OAport &lt;portnumber&gt; &

2) Modify the configuration file (drm.rc by default) for your installation.  Some parameters must be changed, but if it's not obvious that a parameter needs to be changed then it probably doesn't and the default should work.  Also, pay attention to whether you are specifying just a path or a path including a filename.

3) Start your DRM server (simplest example):  drmServer.linux drm.rc &

---++Testing your DRM server

The simplest test is to get a valid proxy and try the drm-ping client something like this:

drm-ping.linux -debug 15 -conf drm.rc

The drm.rc file needs to have the same information as was used to start your DRM if it's not in fact the same file.  The -conf option is used to explicitly specify the configuration file (recommended).  The -debug 15 will print out extra messages - note that without it the messages might not be useful.  If your DRM is working you'll see something like this:

<verbatim>
[rhic23] ~/> drm-ping.linux -conf wsu.rc -debug 15
**************** begin config ****************
EnableLogging = true
HRMName = DRMServer
ClientLogFile = /tmp/srm_client.log
NSPort = 6171
NSHost = rhic23.physics.wayne.edu
***************** end config *****************
srm-ping initializing...
binding Naming Service done...
Berkeley DRM 1.2.10 package
		  DRM is alive.
cache size = 10737418240 bytes
avail size = 10737243675 bytes
Wed Mar 22 17:20:08 2006
SRM-PING exiting...
[rhic23] ~/> 
</verbatim>

This and other tests are described in Chapter 1 of the user guide.

---++Examples of Client Usage

An example from STAR using the -f option in srm-copy to transfer a list of files:

srm-copy.linux -d -f list.txt -conf /home/hjort/hrm2/hrm.rc -l P05if.log

Each line of list.txt has the form &lt;sourceURL&gt; &lt;size&gt; &lt;destinationURL&gt;

gsiftp://stargrid03.rcf.bnl.gov/star/diskpath/st_physics_6167088_raw_2030003.MuDst.root 32313129 srm://garchive.nersc.gov/nersc/hpsspath/st_physics_6167088_raw_2030003.MuDst.root

This example does not use a remote SRM installation - instead, it gets files through the gsiftp server running on the remote gatekeeper and uses a TRM running with DRM at the destination to put the files into HPSS.

---++Troubleshooting

Notes pertain to VDT version 1.3.10b which will soon be subsumed by 1.3.11 which will contain the latest version

Helpful log files are located in $VDT_LOCATION/drm/logs

The email list referenced on http://sdm.lbl.gov/srm-dist/ is very helpful

---+++org.gridforum.ogsi.InvalidHandleFaultType in server logs

In the configuration file for the DRM server there is the following line

wsg*ServiceHandle=srm/DRM/srmv1

This line should be changed to the following

wsg*ServiceHandle=/srm/service/manager

---+++Infinite .TURL Running Down the Screen

On the client side, you should upgrade your drm tools to the latest from http://sdm.lbl.gov/srm-dist/.  This will be fixed in the VDT 1.3.11 release with the planned update.

---+++Hanging put and get commands

Need to specify a firewall port for put and get to use, for example

<verbatim>
./drm-put.linux -debug 15 -conf conf/drm.rc -s file:/tmp/hello -g hello_world2 -OAport 24999
</verbatim>

<!-- MAJOR UPDATES
For significant updates to the topic, consider adding your 'signature' (beneath this editing box) !-->

*Major updates*:%BR%
<!--Future editors should add their signatures beneath yours!-->
-- Main.EricHjort - 22 Mar 2006

%STOPINCLUDE%

