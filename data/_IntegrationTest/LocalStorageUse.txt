%META:TOPICINFO{author="StevenTimm" date="1134168417" format="1.0" version="1.6"}%
%META:TOPICPARENT{name="LocalStorageRequirements"}%
<!-- By default the title is the WikiWord used to create this topic !-->
<!-- if you want to modify it to something more meaningful, just replace %TOPIC% below with i.e "My Topic"!-->

---+!!<nop>%TOPIC%
%TOC%
%STARTINCLUDE%


---++Introduction

This document describes how users can use an OSG CE and discover its features.

REMEMBER: In OSG not all CEs will offer the same features in terms of disk space

---++Possibilities

A definition of the concepts used in this document can be found in LocalStorageRequirements, including a [[LocalStorageRequirements#Minimum_requirements][section]] describing which are the possible minimum features available (different alternatives possible).

You will always be provided a WN_TMP area where you will have to put your current working directory (possibly in a unique subdirectory to avoid conflicts with other jobs running on the same host). 

You will have to define your favorite way of working and possibly be ready to adopt alternatives if that is not available.

The path/URL of CE storages can be provided to you in different ways:

	* <b>Environment Variables:</b>

		Well defined environment variables that resolve to the correct path or URL. Starting from VDT-1.3.8, these variables will be automatically propagated into the worker node environment (User does not need to source any file).  The environment 
variables are found in =$VDT_LOCATION/monitoring/osg-attribute.conf=.
Below is a section of a sample =osg-attribute.conf= where these variables are defined:  (Example from FNAL_GPFARM_TEST). For instructions on how to run this script to configure this file, see LocalStorageConfiguration

=OSG_SITE_NAME="FNAL_TEST_033"=

=OSG_LOCATION="/export/osg/grid"=

=OSG_GRID="/usr/local/osg"=

=OSG_APP="/app"=

=OSG_DATA="/data"=

=OSG_SITE_READ="dcap://fndca.fnal.gov:24525//pnfs/fnal.gov/usr"=

=OSG_SITE_WRITE="dcap://fndca.fnal.gov:24525//pnfs/fnal.gov/usr"=

=OSG_WN_TMP="$_CONDOR_SCRATCH_DIR"=

=OSG_DEFAULT_SE="UNAVAILABLE"=

=OSG_SITE_INFO="http://fermigrid.fnal.gov/gpfarm/FNAL_GPFARM_POLICY.html"=
<pre>
Here is output from a test run of a job with the scripts configured correctly:
[timm@fnpcg ~]$ globus-job-run fnpcg/jobmanager-fork /usr/bin/printenv
OSG_DATA=/data
hostname=fnpcg.fnal.gov
GRID3_TMP_WN_DIR=/local/stage1
OSG_LOCATION=/export/osg/grid
OSG_JOB_CONTACT=fnpcg.fnal.gov/jobmanager-condor
GRID3_SITE_NAME=FNAL_GPFARM_TEST
OSG_SITE_INFO=http://fermigrid.fnal.gov/gpfarm/FNAL_GPFARM_POLICY.html
GRID3_DATA_DIR=/data
OSG_DEFAULT_SE=UNAVAILABLE
OSG_GRID=/usr/local/grid
LOGNAME=fnalgrid
OSG_SITE_NAME=FNAL_GPFARM_TEST
GRID3_JOB_CONTACT=fnpcg.fnal.gov/jobmanager-condor
GRID3_USER_VO_MAP=/export/osg/grid/monitoring/grid3-user-vo-map.txt
OSG_USER_VO_MAP=/export/osg/grid/monitoring/grid3-user-vo-map.txt
OSG_WN_TMP=/local/stage1
GRID3_GRIDFTP_LOG=/export/osg/grid/globus/var/gridftp.log
OSG_UTIL_CONTACT=fnpcg.fnal.gov/jobmanager
OSG_SITE_READ=dcap://fndca.fnal.gov:24525//pnfs/usr
GRID3_SITE_INFO=http://fermigrid.fnal.gov/gpfarm/FNAL_GPFARM_POLICY.html
HOME=/home/fnalgrid
LD_LIBRARY_PATH=/export/osg/grid/MonaLisa/Service/VDTFarm/pgsql/lib:/export/osg/grid/voms/lib:/export/osg/grid/prima/lib:/export/osg/grid/expat/lib:/export/osg/grid/globus/lib:/export/osg/grid/expat/lib:/export/osg/grid/MonaLisa/Service/VDTFarm/pgsql/lib:/export/osg/grid/voms/lib:/export/osg/grid/prima/lib:/export/osg/grid/expat/lib:/export/osg/grid/MonaLisa/Service/VDTFarm/pgsql/lib:/export/osg/grid/voms/lib:/export/osg/grid/prima/lib:/export/osg/grid/expat/lib:
GRID3_TMP_DIR=/data
OSG_GRIDFTP_LOG=/export/osg/grid/globus/var/gridftp.log
OSG_APP=/app
GRID3_BASE_DIR=/export/osg/grid
GLOBUS_GRAM_JOB_CONTACT=https://fnpcg.fnal.gov:51487/10121/1134169575/
GLOBUS_LOCATION=/export/osg/grid/globus
OSG_SPONSOR=fermilab
GLOBUS_GRAM_MYJOB_CONTACT=URLx-nexus://fnpcg.fnal.gov:51488/
OSG_SITE_WRITE=srm://fndca.fnal.gov:8443//pnfs/usr
GRID3_APP_DIR=/app
GRID3_SPONSOR=fermilab
GRID3_UTIL_CONTACT=fnpcg.fnal.gov/jobmanager
X509_USER_PROXY=/home/fnalgrid/.globus/job/fnpcg.fnal.gov/10121.1134169575/x509_up
</pre>



(Editors note--I have not yet checked that the syntax of the =OSG_SITE_READ= and =OSG_SITE_WRITE=
variables is correct,  S. Timm 12/08/2005)

	* <b>Information System (eg. GIP and BDII) </b>

		Path or URLs consistent across the CE (headnodes and WN), published using an information system (e.g. GIP and BDII).  At the moment the only directories available via the GIP/Glue Schema are 
!GlueCEInfoApplicationDir and !GlueCEInfoDataDir when configured according to the instructions in this 
Twiki.  There is also the Grid3 schema, which still relies on the legacy Grid3 names and doesn't 
allow for exporting the OSG_SITE_READ, OSG_SITE_WRITE, or OSG_DEFAULT_SE variables or their equivalent.
The definition of what these GLUE schema attributes will eventually be is described in LocalStorageRequirements

Need to figure out what is the API/CLI to read these variables out of GIP.
	
	* <b>GridCat (DEPRECATED) </b>

		It is still possible but DEPRECATED (will be removed from future versions) the use of !GridCat Web pages or	!DataBase

	* <b>Self Discovery (DEPRECATED)</b>

		The use of self discovery looking for files like =osg-info.conf=. These internal mechanisms may change across releases and users cannot count on them.

---++Examples

---++Contributed Examples
Here OSG users can contribute (writing it or linking it) a description of their application and how it is using CE local storage. These may include specific references that may not apply to any other application.




<!-- MAJOR UPDATES
For significant updates to the topic, consider adding your 'signature' (beneath this editing box) !-->

*Major updates*:%BR%
<!--Future editors should add their signatures beneath yours!-->
-- Main.MarcoMambelli - 11 Nov 2005

%STOPINCLUDE%

