%META:TOPICINFO{author="KyleGross" date="1476285069" format="1.1" version="1.7"}%
%META:TOPICPARENT{name="OSGCEInstallGuide"}%
<!-- This is the default OSG Trash/Trash/Integration template. 
Please modify it in the sections indicated to create your topic!
If you have any comments/complaints about this template, then please email me:
rwg@hep.uchicago.edu.  (Adapted from Atlas wiki template, Ed Moyse)
--> 

<!-- By default the title is the WikiWord used to create this topic !-->
<!-- if you want to modify it to something more meaningful, just replace %TOPIC% below with i.e "My Topic"!-->

---+!!<nop>%TOPIC%
%TOC%
%STARTINCLUDE%


---++Introduction
What we did to install condor in a separate location:

Make a directory that is separate from where your $VDT_LOCATION is going to be.
Then change directory to it.  For example /export/osg/condor, presuming that your vdt
is in /export/osg/grid.

=mkdir /export/osg/condor=

=cd /export/osg/condor=

<pre>pacman -get http://vdt.cs.wisc.edu/vdt_139_cache:Condor</pre>

Answer "y" to the question of agreeing to the licenses.

Answer "y" to the question of whether to enable the condor batch system to run automatically

With the above directory structure, you would then 

=export VDTSETUP_CONDOR_LOCATION="/export/osg/condor/condor"=


---+++ Preserving a pre-existing Condor installation?
If you have installed Condor as your batch queueing system, you are required to set two environment variables so the Condor path is correctly configured. 

   * *VDTSETUP_CONDOR_LOCATION* - the location of your Condor installation  (e.g. _/opt/condor_). The Condor _bin/_, _bin_, _etc/_, _lib/_... directories should be directly under this location.
   * *VDTSETUP_CONDOR_CONFIG* (optional): The location of your Condor configuration file (if non-standard). Default is _$VDTSETUP_CONDOR_LOCATION/etc/condor_config_.

This will result in:
   * VDT middleware services pointing to appropriate locations in your external Condor installation.
   * The CONDOR_CONFIG and CONDOR_LOCATION variables getting set correctly when $VDT_LOCATION/setup.sh is sourced
   * All condor binaries and libraries being put in your path when $VDT_LOCATION/setup.sh is sourced.

For example, if you wish to preserve a Condor installed in the standard location,

==$ export VDTSETUP_CONDOR_LOCATION=$CONDOR_ROOT==

will suffice (provided $CONDOR_ROOT is set, per the usual Condor config)

---+++Starting Condor

Check to make sure that the correct value of CONDOR_CONFIG is set.
A successful installation of Globus-Condor-Setup should have taken care of that.

The commands
<pre># <b>CONDOR_CONFIG="$CONDOR_LOCATION/condor/etc/condor_config"</b>
# <b>export CONDOR_CONFIG</b>
# <b>$CONDOR_LOCATION/condor/sbin/condor_master</b></pre>
will start the default personal-condor batch installation with 
default queuing, if you followed the hints above.

There is a file $CONDOR_LOCATION/post-install/condor which can be copied
to /etc/rc.d/init.d for auto startup of personal condor if you wish.
Also note that the CONDOR_CONFIG variable is usually set correctly 
if you have sourced $VDT_LOCATION/setup.sh above.

To set lower priority for the MIS account  the command 
=condor_userprio -setfactor mis 1000000= 
can be used.

---+++Firewalls

The following entries from /etc/sysconfig/iptables 
will allow the condor collector and negotiator to be seen outside your host.

<pre>
# Allow Condor negotiator and collector, respectively
-A INPUT -d 131.225.166.93 -p tcp -m tcp --dport 9614 -j ACCEPT
-A INPUT -d 131.225.166.93 -p udp -m udp --dport 9614 -j ACCEPT
-A INPUT -d 131.225.166.93 -p tcp -m tcp --dport 9618 -j ACCEPT
-A INPUT -d 131.225.166.93 -p udp -m udp --dport 9618 -j ACCEPT
-A INPUT -d 131.225.166.93 -p udp -m udp --dport 61440:65535 -j ACCEPT
</pre>

The last range are the ports for condor which are created on demand as needed.
This range can be specified by setting the variables HIGHPORT and 
LOWPORT in the condor_config file.  For this configuration I used
<pre>
HIGHPORT=65535
LOWPORT=61440
</pre>
By default these variables are not set and Condor uses any port that is available.

There is much more detail in section 3.8 of the Condor manual.
[[http://www.cs.wisc.edu/condor/manual/v6.7.14/3_8Networking.html]]

<!-- MAJOR UPDATES
For significant updates to the topic, consider adding your 'signature' (beneath this editing box) !-->

*Major updates*:%BR%
<!--Future editors should add their signatures beneath yours!-->
-- Main.StevenTimm - 01 Dec 2005

%STOPINCLUDE%