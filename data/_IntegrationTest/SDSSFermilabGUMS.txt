%META:TOPICINFO{author="KyleGross" date="1225985977" format="1.1" version="1.2"}%
%META:TOPICPARENT{name="PrivilegeOSG"}%
<!-- This is the default OSG Integration template. 
Please modify it in the sections indicated to create your topic!
If you have any comments/complaints about this template, then please email me:
rwg@hep.uchicago.edu.  (Adapted from Atlas wiki template, Ed Moyse)
--> 

<!-- By default the title is the WikiWord used to create this topic !-->
<!-- if you want to modify it to something more meaningful, just replace %TOPIC% below with i.e "My Topic"!-->

---+!!<nop>%TOPIC%
%TOC%
%STARTINCLUDE%


---++ The following is from Neha Sharma.

<verbatim>

Report (part 2)  by Neha Sharma ,SDSS- Fermilab
Dated: Feb 25'2005


Gums Installation and Configuration Status Report
---------------------------------------------------
Feb 25' 2005

Continuation...

Following instructions from Gabriel yesterday , I was able to start gums service as root.

Steps to follow :


--> If you installed in /opt/gums-service

--> rm -rf /opt/gums-service/work/Catalina
        This will remove all temporary tomcat files

--> chown root:root /opt/gums-service -R
--> chown also the certificate files you are using.
        The one that are mentioned in the server.xml...
        If you didn't change them, they are /etc/grid-security/host*.pem

        However if you did change them, (copied them to gums*.pem ) make sure root owns them
        and 'gums-service/webapps/gums/WEB-INF/classes/gums.config' and '/opt/gums-service/conf/server.xml' both point to them.

--> root@sdsslnx10 opt]# ls -l /etc/grid-security/gums*
        -rw-r--r--    1 root     root         1171 Feb 23 15:58 /etc/grid-security/gumscert.pem
        -r--------    1 root     root          887 Feb 23 15:58 /etc/grid-security/gumskey.pem

--> blow away the logs,
        rm -rf /opt/gums-service/logs/*
        Make sure you donot remove 'logs ' directory or else, you will get
                Using CATALINA_HOME:   /opt/gums-service
                Using CATALINA_TMPDIR: /opt/gums-service/temp
                Using JAVA_HOME:       /usr/local/vdt-voms-server/jdk1.4
                touch: creating `/opt/gums-service/logs/catalina.out': No such file or directory
                ./catalina.sh: line 221: /opt/gums-service/logs/catalina.out: No such file or directory
        If you do, then 'mkdir /opt/gums-service/logs'

--> Make sure no gatekeeper is trying to connect to that gums server.
--> Then start the server
--> Follow what is happening in the catalina.out

--> Make sure log looks ok and that there are no exceptions
        root@sdsslnx10 opt]# tail -f /opt/gums-service/logs/catalina.out
        Feb 24, 2005 4:26:27 PM org.apache.catalina.core.StandardHostDeployer install
        INFO: Installing web application at context path /gums from URL file:/opt/gums-service/webapps/gums
        Feb 24, 2005 4:26:28 PM org.apache.coyote.http11.Http11Protocol start
        INFO: Starting Coyote HTTP/1.1 on http-8443
        Feb 24, 2005 4:26:28 PM org.apache.jk.common.ChannelSocket init
        INFO: JK2: ajp13 listening on /0.0.0.0:8009
        Feb 24, 2005 4:26:29 PM org.apache.jk.server.JkMain start
        INFO: Jk running ID=0 time=31/55  config=/opt/gums-service/conf/jk2.properties
        Feb 24, 2005 4:26:29 PM org.apache.catalina.startup.Catalina start
        INFO: Server startup in 8550 ms

--> Make sure all 4 ports are accounted for:

        netstat -p -l | grep java

        tcp        0      0 localhost:8005                              LISTEN      7374/java
        tcp        0      0 *:8009                                      LISTEN      7374/java
        tcp        0      0 *:5001                                      LISTEN      7374/java
        tcp        0      0 *:8443                                      LISTEN      7374/java
        udp        0      0 *:35279                                                 7374/java

--> Try to generate maps or map a single user using web interface of gums

--> Make sure the database is up , else you will see exception like

(16:37:32) gudoneha: gums-service/logs/gums-service-admin.log
(16:37:57) gudoneha: [neha@sdsslnx10 opt]$ tail -f gums-service/logs/gums-service-admin.log
24 Feb 2005 16:30:11,446 [INFO ]: Admin group ManualGroup: persistenceFactory='mysql' - group='admins' updated
24 Feb 2005 16:30:11,447 [INFO ]: ManualGroup: persistenceFactory='mysql' - group='sdssDevelopment' updated
24 Feb 2005 16:30:25,507 [ERROR]: GridID[/DC=org/DC=doegrids/OU=People/CN=Neha Sharma 986234] - Failed to update all groups - Couldn't connect to the database 'jdbc:mysql://sdsslnx10.fnal.gov:3306/GUMS_0_7': check gums.config or the status of the database.
24 Feb 2005 16:30:39,574 [WARN ]: VOMSGroup: https://hotdog63.fnal.gov:8443/edg-voms-admin-sdss/services/VOMSAdmin - voGroup='/sdss/grid3' - voRole='null' - sslCAFiles='null' sslCertfile='/etc/grid-security/gumscert.pem' sslKey='/etc/grid-security/gumskey.pem' sslKeyPasswd=[not set] wasn't updated successfully:  [Couldn't connect to the database 'jdbc:mysql://sdsslnx10.fnal.gov:3306/GUMS_0_7': check gums.config or the status of the database.]
24 Feb 2005 16:30:39,575 [ERROR]: Not all groups were updated correctly: check GUMS configuration or the status of the VO servers. Consult the logs for more details.
24 Feb 2005 16:30:39,575 [INFO ]: Automatic updateGroups ended
24 Feb 2005 16:34:35,092 [INFO ]: Admin group ManualGroup: persistenceFactory='mysql' - group='admins' updated
24 Feb 2005 16:34:35,092 [INFO ]: ManualGroup: persistenceFactory='mysql' - group='sdssDevelopment' updated
24 Feb 2005 16:34:35,969 [INFO ]: VOMSGroup: https://hotdog63.fnal.gov:8443/edg-voms-admin-sdss/services/VOMSAdmin - voGroup='/sdss/grid3' - voRole='null' - sslCAFiles='null' sslCertfile='/etc/grid-security/gumscert.pem' sslKey='/etc/grid-security/gumskey.pem' sslKeyPasswd=[not set] updated
24 Feb 2005 16:34:35,969 [INFO ]: GridID[/DC=org/DC=doegrids/OU=People/CN=Neha Sharma 986234] - Groups updated

--> In case you do see some exception, issue the update groups from the web interface: that way you avoid problems connected to the client...

--> Make sure environment variable X509_CERT_DIR is set to '/etc/grid-security/certificates

--> After this, things worked for me :)
</verbatim>






<!-- MAJOR UPDATES
For significant updates to the topic, consider adding your 'signature' (beneath this editing box) !-->

*Major updates*:%BR%
<!--Future editors should add their signatures beneath yours!-->
-- Main.RobGardner - 12 Mar 2005

%STOPINCLUDE%