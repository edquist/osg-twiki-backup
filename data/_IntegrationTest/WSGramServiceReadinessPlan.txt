%META:TOPICINFO{author="KyleGross" date="1225985978" format="1.1" version="1.6"}%
%META:TOPICPARENT{name="GlobusOSG"}%
<!-- This is the default OSG Integration template. 
Please modify it in the sections indicated to create your topic!
If you have any comments/complaints about this template, then please email me:
rwg@hep.uchicago.edu.  (Adapted from Atlas wiki template, Ed Moyse)
--> 

<!-- By default the title is the WikiWord used to create this topic !-->
<!-- if you want to modify it to something more meaningful, just replace %TOPIC% below with i.e "My Topic"!-->

---+!!<nop>%TOPIC%
%TOC%
%STARTINCLUDE%

---++Introduction

From the Globus website:

[[http://www-unix.globus.org/toolkit/docs/4.0/execution/key/index.html#s-key-index-overview][GRAM Overview]]

See also, VDT release notes: (to be provided)

---++Readiness and Integration Plan

We describe a service readiness and integration plan for WS-GRAM and the OSG ITB, following guidelines set forth in NewOSGServices with the nominal target ITB release ItbRel014 and later. Since the service is already developed and "ready", the following focuses on integration aspects.

---+++ Description of Service

[[http://www-unix.globus.org/toolkit/docs/4.0/execution/key/WS_GRAM_Approach.html][WS GRAM Approach]]

---+++ Dependencies and interactions with other services

WS GRAM runs in a GT4 Java container along with other GT4 services.  WS GRAM requires 3 other GT services: Delegation Service, RFT, GridFTP.

[[http://www.globus.org/toolkit/docs/4.0/execution/key/WS_GRAM_Approach.html#id2820771][GT Components used by WS GRAM]

---+++ Resources required

GT4 installation is all that should be required.

The GT4 container is typcially run as a priviledged user account "globus" from xinetd.  The xinetd entry is created by the VDT package install or can be created manually, and should be configured approxinately as follows:

This will be added to the 4.0.1 docs, but for now here is the XinetdHowTo


---+++ Installation Procedure

Download the source tarball from [[http://www.globus.org/toolkit/downloads/4.0.0/#source][here.]]  There are binary tarballs too on the same page.

Follow the install instructions in the [[http://www-unix.globus.org/toolkit/docs/4.0/admin/docbook/][ GT4 Admin Guide ]]  For WS GRAM only, skip chapters: 5 Pre-ws securty, 7 SimpleCA and 12, 13, 14, and 15

On the service-side (head node) WS GRAM, RFT and the delegation service will be run in the same GT4 container.

Note: WS GRAM assumes a shared file system with the compute nodes.

Note: RFT requires a database; 4.0.0 only supports PostgerSQL; 4.0.1 supports MySQL as well.  (Future releases may support loightweight embedded daataases that can be installed automatiucally, transparently to the sysadmin).

On the service-side, setup of GT4 GridFTP server.  The GridFTP server could run on the head node or any node that shares a file system with the compute nodes.  Ideally it is run as root, with access to host crentials.

For non-default deployments, such as, non-default: credentials, gridmapfile location, gridftp server port, container port, rft deployment, click [[http://www-unix.globus.org/toolkit/docs/4.0/execution/wsgram/admin-index.html#s-wsgram-admin-configuring-nondefault] [here]]

Client command line tools run on the submit hosts:

globusrun-ws

    submit and monitor a remote job submission

globus-cred-delegate

    This tool creates a delegated credential in the delegation service (service-side).  A credential is needed by WS GRAM for file staging and cleanup in order to authenticate with the RFT service.  A credential is needed by RFT to authenticate with the GridFTP server.  This credential can be used to make available a credential for the user's application.

wsrf-destroy

   Destroy a previously created delegated credential

wsrf-query

   find out published information about the compute cluster

globus-job-run-ws

   wrapper around gobusrun-ws to make it more like globus-job-run.  It would provide a greater degree of backward compatibility. A Prototype exists, but not in the GT 4.0.1 release.  What is the priority on this?  How much is this really needed?

Condor-G issues:

WS-GRAM servers can be used with very little change by Condor-G jobs.

The first release of condor that contained Condor-G capable of submitting jobs to WS GRAM was 6.7.6.  The latest stable release of condor is 6.7.10 with 6.7.11 due out soon.

WIth this version you need the following submit file changes:

FIXME - describe sub file changes here


---+++ Open Issues


---+++ Migration Guide and Backwards Compatibility Issues

Most existing clients will still work.  Some problems have been reported with ...


Using WS-GRAM through globusrun-ws, users will need to deal with:

   * FIXME:
   * credential delegation
   * forming job desriprion document (XML)
   * managing EPRs?


FIXME: Java container does a command.run of sudo of the rm-adapter (a perl script). Auth rules for sudo need to be configured.  All users in grid-mapfile must be listed in sudo conf file. (But there are other ways to handle this that dont requir listing every user???)  WIll these work for all/most OSG sites? What are any possible issues and interactions with OSG AAA?

FIXME: GridFTP file access mapping issue: will supply a default for the mapping: / to /.

FIXME: What contact string do we need to apply in GridCat to list WS-GRAM servers?  Describe new contact string here:

Old: host:port/service:subject

New: https://host:port/path-to-service(always fixed)FIXME  then -t type (for PBS, Fork, etc)

FIXME: provide details on changes to COndor-G submit file here

FIXME: provide details on changes to COndor-G behavior, performance, and error loging / debugging techniuques here.

---+++ Known Issues and Problems


---+++ Server requirements

Appropriately configured GSI security.  An exisiting GT2 security install will work.

---+++ Packaging

Comes with VDT 1.x.y and later, via Pacman 3. 

---+++ Installation and Configuration

Installation is provided by VDT. All you need to do is:
<pre>
pacman -get http://www.cs.wisc.edu/vdt/%OSG_ITB_VDT_VERSION%:Globus-WS-GRAM-Server
</pre>

The server will be automatically configured, but ...

Platforms for which binaries are available:  need to coordinate this with VDT team.

Config steps in the WS-GRAM Admins doc section:

- copy or link host cert to container{cert,key}.pem in /etc/grid-security

- configure rm-adapter (FIXME: correct name here)  - assuming you are using Condor, PBS, LSF, or SGE.  Others need to: FIXME

- configure sudo (FIXME: how to handle continual changes to gridmap file, and group accounts etc? Interaction with OSG AAA mechanisms)

---+++ Testing and Validation

FIXME:

Somehow (FIXME: via VDT???) we do a full install in the $GLOBUS_LOCATION/test/WS-GRAM (FIXME) directory. There will be a file called TESTS.pl that the administrator can run after all services have been installed and started.

It sets up its own environment, all you need to have is a valid proxy. (FIXME: need to give exact instructions on how to start, and how to point the tests to the installed server rather than have ot start ots own server)

Provide a test harness -- that is, once installed, how does one understanding everything is working properly? Are all required functionality tests successful?  Describe details of the integration test (what constitutes success?).  Describe the plan.

---+++ Scalability and Metrics

Note that as of GT3.9.5, the server will, by default, send back usage statistics to ANL.  This can be disabled.  You can also define additional targets for sending the stats and OSG could collect VirtualOrganizations/VOInfo wide usage stats.  The receiver for the stats is not included in the toolkit (or VDT), but is available from CVS.

The stats provided for WS-GRAM usage include: FIXME.  These can be utilzed by OSG as follows: FIXME.

FIXME: (From Rob:) What are the expectations in terms of performance and at what scale and in what metrics for successful integration?

The currently available measurements on WS_GRAM performance are posted at:  FIXME

   * docs/4.0/perf_overview.html
   * docs/4.0/execution/wsgram/reports/FIXME
   * test results from Jens/Mats/Gaurang are at: ...

FIXME: need to add here a summary of the major perf# form the automated tests wen 4.0.1 is cut.  (new links in WS GRAM Quality profile?)  FIXME

Measrurements for "# jobs queuable" - 32K was tested - show results

Measurements for 

Test links to bugzilla with all parts neede to enable OSG users/admins to rerun these tests (these are the ones where the test procedures are written up in the bugzilla bug)

Tests going out in 4.2 Trunk (HEAD) - needs updates to AXIS and thus not going out in a 4.0 branch...


---+++ Known Problems and Pending Issues


---++ Links to Documentation 
   * http://www-unix.globus.org/toolkit/docs/FIXME  - place a detailed list here

---++ Links to Test Results
   * [[http://fixme][MAts test pages? Others]]

show example of tests.pl results here, and other perf tests that we are telling the users how to run.

---++ Contact Information
   * Stu Martin - smartin@mcs.anl.gov
   * Globus Support and discussion:  (lists and support links here)
   * Bugzilla and VDT support links and procedures here

<!-- MAJOR UPDATES
For significant updates to the topic, consider adding your 'signature' (beneath this editing box) !-->

*Major updates*:%BR%
<!--Future editors should add their signatures beneath yours!-->
-- Main.MichaelWilde - 07 Jul 2005

%STOPINCLUDE%