%META:TOPICINFO{author="KyleGross" date="1225985982" format="1.1" version="1.28"}%
%META:TOPICPARENT{name="ItbRel030"}%
---+!!<nop>%TOPIC%
%TOC%
%STARTINCLUDE%

---++Introduction

This page is the starting point for all validations for the integration testbed.

---++ Current Validation Table

   * SiteValidationTableITB036

---++ Daily Validation
   * [[http://www.uscms.org/SoftwareComputing/Grid/Validation/][Daily Validation project]] from USCMS.

---++For !GridCat Validation
   * If resource is not registered (the resource is not shown in the <a href="http://osg-itb.ivdgl.org/gridcat/">ITB !GridCat</a>), go to <a href="https://goc.grid.iu.edu">Grid Operations Center for !OSG Registration page </a> and register the resource. (Check "OSG ITB Grid" to register the resource for the ITB %RED%AH -- I don't find the new equivalent link for this%ENDCOLOR%)
   * Start from <a href="http://osg-itb.ivdgl.org/gridcat/" target="_blank">ITB !GridCat</a>. 
   * Check if status dot is <FONT color='red'>red</FONT>/<FONT color='green'>green</FONT> ( if red, click dot, check source of problem, and solve the problem or report to GOC )
   * If status dot is grey, follow the instruction how to activate site from GridCat page
   * Check if sitename is correct
   * Check if !OSG version is correct
   * By clicking sitename, check if all the parameters are as expected. Particularly, jobmanger, $app, $grid, $data, etc are as expected.
   * If resource should be deregistered for some reason, send email to GOC

---++For !MonALISA Validation

   * See the MonALISA twiki web for details.
   * http://madman.uits.indiana.edu:8888/
       <br>then go to 'Site Status' and verify there are no red or orange boxes for your site and you are running version 1.4.4
      
---+++ Notes

I am having an inconsistent reporting of site information in MonALISA. Under the Statistics - VirtualOrganizations/VOInfo Jobs View the report is listing the number of jobs I submitted correctly. That is when I submit 10 CMS jobs, with 4 running and 6 idle the report correctly displays that information. However under my site report http://madman.uits.indiana.edu:8888/display?page=i&farm=UCSanDiegoITB3.1&pTime=1+day the current running jobs and running job graphs are blank. Are these two reports getting their information from different locations? -- Main.TerrenceMartin - 30 Nov 2005

---++For ACDC Operations Dashboard Validation

   * Start from the [[http://osg.ccr.buffalo.edu/operations-dashboard.php?grids=6&vos=13][ACDC Operations Dashboard]] web page.
      * The Ad-Hoc grid radio button should now already be selected under the *ACDC OPERATIONS DASHBOARD* area in the top center of the page.
      * The MIS VirtualOrganizations/VOInfo radio button should now already be selected under the *VIRTUAL ORGANIZATIONS* area in the top center of the page.
      * *NOTE:* all self-registered site resources will by default appear in the Ad-Hoc grid until they have been successfully verified and placed into the *Production Sites* area of the *Grid Health Monitor Service Resource - Service Matrix*.
   * You are now free to browse the operational status of the OSG-ITB sites that have registered with the ACDC Operations Dashboard as an unprivileged user.

---+++ Site Resource Data
   * On the ACDC Operations Dashboard page click on the blue "Ad-Hoc" hyperlink in the *ACDC OPERATIONS DASHBOARD" area next to the selected radio button.
   * You should see a table of important site resource data that has been uploaded into the operations database for all of the site resources in the Ad-Hoc grid.
   * This information is a function of the *VIRTUAL ORGANIZATIONS* area selected radio button denoting different information for the selected Virtual Organization.
   * As a unprivileged user you can view this information but a registered ACDC Operations Dashboard site administrator can update this information using the "Action Items" listed on the dashboard.

---+++ Grid Health Monitor Service Resource - Service Matrix
   * Offline Sites Area
      * Sites that appear in this area that have an entirely "black" Service Matrix are in general resources that have just been registered and the resource data has not been loaded into the ACDC Operations Dashboard database. Thus there is "No Information" available for the operational status of this resource, other Service Matrix designations are presented in the color coded key at the top of the Service Resource - Service Matrix.
      * Sites that appear in this area that display some operational status information have been marked offline by the administrator.
   * Pending Sites Area
      * Sites that appear in this area have failed one or more of the first four operational status validations. These validations are deemed "critical" meaning that a site cannot be moved into production level status until these validations have succeeded. Using the Service Resource - Service Matrix key you can at a glance determine the general operational status of any site resource. If you want to find out more detailed information about a resource dependent service specific validation, then click on the approriate Service Resource - Service Matrix cell and view the information presented in the *Detail Service Status* text box located near the top of the ACDC Operations Dashboard page. This text box will contain specific information about the operational service validation test that was performed and detailed service validation output.
   * Production Sites Area
      * Sites that appear in this area have passed the "critical" operational status validations and are currently operational at some level. Using the Service Resource - Service Matrix key you can determine at a glance what the general operation status of the site resources were on the date and time reported by the timestamp for each resource. This timestamp is in general the latest timestamp that a service was operational validated, if you want more fine grained information about a specific service timestamp or last status update then click on the specific service cell and the timestamp will be displayed in the *Detail Service Status* text box heading.

---+++ VirtualOrganizations/VOInfo Support Matrix
   * Start from the [[http://osg.ccr.buffalo.edu/statistics/acdc/vo_support_matrix.php][VirtualOrganizations/VOInfo Support Matrix]] web page or you can click on the ACDC Operations Dashboard menu item "VirtualOrganizations/VOInfo Support Matrix". You have the opportunity to select multiple grids simultaneaously, the OSG grid is selected by default, you should unselect the OSG grid and select the Ad-Hoc grid using the check boxes. Then press "go".
      * When does a resource appear in the VirtualOrganizations/VOInfo Support Matrix?
         * In general a site resource has to register with the ACDC Operational Dashboard and successfully uploaded its resource data into the operations database.  This is done by the a registered site administrator.
      * What does it mean?
         * This matrix presents the "intent to support" of a site resource. This intent is determined from the resource data that has been uploaded into the ACDC Operations Dashboard database. An update of this information occurs when a registered site administrator selects the Action Item "Pull resource data" for a specific resource, also this information is updated automatically on a periodic basis by the ACDC Operations Dashboard. In order to check the operational status of this "intent to support" you would look at the ACDC Operations Dashboard and select the appropriate *VIRTUAL ORGANIZATIONS* area radio button for the Virtual Organization of interest.

---+++ Privileged ACDC Operations Dashboard Site Administrator
   * If you are a new site administrator that has not registered your DN with the ACDC Operations Dashboard service then please follow these instructions.
      * Email your DN that you want to use to manage site resources in the ACDC Operations Dashboard to Mark L. Green (mlgreen@ccr.buffalo.edu), this will change in the future to an automated procedure devoid of the human-human exchange of information. But for now this works.
      * Make sure the certificate corresponding to the emailed DN is loaded into your browser.
      * Wait for a less than optimal response from the human (namely me) that your DN has been added to the registered site administrators list.
      * Now you have privileged access to the "Action items" listed on the ACDC Operations Dashboard page.

---+++ Registering a New Site Resource
   * You must be a privileged ACDC Operations Dashboard site administrator to do this. If you are not, please follow the directions in the previous section.
   * To register a new site resource, under the *Action Items* area select the "Register new resource" item.

---++++ Preliminary Host Information
   * Enter the Fully Qualified Host Name (FQHN) of the new resource.

---++++ Host Verification
   * After entering the FQHN a series of preliminary site validations will occur:
      * Acquire VirtualOrganizations/VOInfo information
      * Verify hostname
      * Verify fork jobmanager
      * Perform nslookup on the FQHN
      * Ping test remote site resource
      * Compute Element gatekeeper service check
      * Compute Element authenication check
      * Compute Element 'Hello World' check
      * Compare FQHN to previously registered Compute Elements in the operations database

---++++ Monitoring Information
   * After the Host Verification stage has been completed additional information can be uploaded for the new site resource. This information is valuable and it should be input to the best of the ability of the site administrator, but only three input fields are required and you do have the ability to update this information at a later date using the "Action Items".
      * Hostname: completed for you.
      * Fork Job Manager: completed for you.
      * Short Name: if you know it fine, if not the subsequent "Pull resource data" Action Item will obtain it for you.
      * VirtualOrganizations/VOInfo Sponsor: by default for a new site resource MIS VirtualOrganizations/VOInfo dependent entries are made in the operations database, the VirtualOrganizations/VOInfo Sponsor entry that you input here will make VirtualOrganizations/VOInfo dependent entries in the operations dashboard for the specified VO -- this is important because if there is an error obtaining information from your site resource using the MIS VirtualOrganizations/VOInfo or the MIS VirtualOrganizations/VOInfo is not supported by your site resource there is no way to authenticate to your resource other than using the specified Sponsor VO (in general the MIS VirtualOrganizations/VOInfo should be supported by all site resource for this reason)
      * ACDC Administrative DN: this should be your DN as in theory your are the site resource administrator for this resource
      * Support Center: input the corresponding support center for this site resource
      * Operations Contact: input your operations contact
      * Operations E-mail: operations email, this email will be used in the Action Items for emailing trouble tickets with respect to service status problems
      * Operations Phone: operations telephone number
      * Administrator Contact: administrator name
      * Administrator E-mail: administrator email, this email will be used in the Action Items for emailing trouble tickets with respect to service status problems
      * Administrator Phone: administrator telephone number
      * Auto-Notify:
         * Yes - indicates that you want to receive automated emails reporting the upgrade or downgrade of your site resource status
         * No - indicates that no automated emails will be generated
      * Submit the form

---++++ Complete
   * Your new site registration is complete, congratulations! It will appear on the ACDC Operations Dashboard Service Resource - Service Matrix Offline Sites area when the Ad-Hoc grid and MIS VirtualOrganizations/VOInfo radio buttons are selected.

---++++ Pull Resource Data
   * Click any "black" cell next to your new site resource, the "Detail Service Status" area near the top center of the page should show that you have selected your site resource. 
   * Now click on the "Pull resource data" button under the Action Items area, this will gather the required information about your site resource.
   * After this has completed you can verify the values by clicking on the [[http://osg.ccr.buffalo.edu/grid_vo_stats.php?showall&vo_id=13&grid_id=6]["Ad-Hoc"] hyperlink in the *ACDC OPERATIONS DASHBOARD" area next to the selected radio button.
   * If the values are not what you expect, then please check your site coniguration and re-run the "Pull resource data" Action Item.
   * When the site resource data is uploaded into the operations database entries for all of the "intent to support" Virtual Organizations are made in the database. Thus, this procedure should be repeated for all of the VOs in the *VIRTUAL ORGANIZATIONS* area in order to obtain the operational status of your resource with respect to the VOs have chosen to participate.

---++++ First Operations Dashboard Site Validation
   * Click any cell next to your new site resource, the "Detail Service Status" area near the top center of the page should show that you have selected your site resource. 
   * Now click on the "Re-test active resource" button under the Action Items area.
   * You have the option of just performing the critical site validation tests or perfoming a complete site validation test.
   * When this has completed, refresh your ACDC Operations Dashboard page and find your resource.
   * If any of the critical validation tests have failed your resource will appear in the Service Resource - Service Matrix Pending Sites area.
      * If there are problems then they click on the red or yellow box and look at the Detail Service Status box for what is wrong.
   * If all of the critical validation tests have passed then your resource will appear in the Service Resource - Service Matrix Production Sites area.
      * If there are problems then they click on the red or yellow box and look at the Detail Service Status box for what is wrong.

---++++ Changing the Grid Designation
   * After your site resource has been successfully validated and appears in the Service Resource - Service Matrix Production Sites area it can be re-designated to a stable production grid and moved out of the Ad-Hoc grid Operations Dashboard.
   * The ACDC Grid Dashboard monitoring will automatically be turned on and be displayed.

---++++ How to check whether ACDC is collecting job metrics?
   * In order to collect job metrics the site resource must pass the ACDC Operations Dashboard validation and be placed in a stable grid listed in the *ACDC OPERATIONS DASHBOARD* area in the top center of the page. All grids listed are viewed as stable except the Ad-Hoc grid.

---++For !GridEx Validation
By submitting a steady stream of continuous jobs to a site, the
[[http://www.cs.wisc.edu/condor/tools/exerciser/][Grid Exerciser]]
(abbreviated _GridEx_) can be used as a site validation tool.  The
GridEx can validate site capability to:

   * receive and run jobs without errors, using OSG software, 

   * handle a light but continuous job load: currently limited to no more than 10 jobs, or the number of site CPUs.

Site validation steps:
   * Configure the site to run GridEx jobs per the [[http://osg.ivdgl.org/twiki/bin/view/Integration/GridEx][configuration notes]].

   * Ensure the site is properly configured for the [[http://osg.ivdgl.org/twiki/bin/view/Integration/ValidationPage#For_GridCat_Validation][GridCat]]. The OSG-ITB GridEx is currently configured to only submit jobs to sites that report to the OSG-ITB GridCat with:
      * OSG software version 0.3.1 (as of Tue Dec  6 2005)
      * a valid batch system, such as PBS, LSF,Condor, SGE, etc
      * a valid site CPU count

   * The GridEx is periodically restarted to capture changes in the GridCat.  To request a manual GridEx restart to capture a new site, send a request to the GridEx [[mailto:grid-ex@cs.wisc.edu][administrator]].

   * GridEx reports are sent once a day for the previous 24 hours of activity, typically at midnight, to the OSG-INT@OPENSCIENCEGRID.ORG list.  Monitor succeeding GridEx reports for activity information on the new site.  There is a [[http://www.cs.wisc.edu/condor/tools/exerciser/reading_report.html][guide]] for interpreting GridEx reports.  In a nutshell, the goal is to show non zero run time, and no errors for the new site.  For validation purposes, the amount of run time is not as important, but should not be zero.  If there are errors associated with a site, these will be listed at the bottom of the report.  One of the most common errors is:<br> =1840 Globus error 7: an authentication operation failed= <br> and indicates the site was not able to authenticate the GridEx credential. Ensure the site is able to map the GridEx [[http://osg.ivdgl.org/twiki/bin/view/Integration/GridEx#GEx_User_Identity][distinguished name]].  Many Globus error code explanations can be found [[http://www.cs.wisc.edu/~adesmet/status.html#globus][here]]. Other errors may be more difficult to interpret, and may warrant a message to [[mailto:grid-ex@cs.wisc.edu][administrator]].  It is often helpful to enclose appropriate server side logs of a sample GridEx job error.

   * A site can be considered validated after more than 24 hours of GridEx job activity, with no errors.



---++For GIP Validation

   * GIP validation http://grow.its.uiowa.edu/osg-gip/.


---++VirtualOrganizations/VOInfo Status
   * See VoAdmins page for the latest.  (This page seems seriously outdated.)


---++Discovery Validation

Validation was performed at the Integration workshop in December 2005.  The DRM server running at LBL was successfully reported its existence to the ITB discovery server at Caltech.  We were able to see the DRM service show up in the web browser interface of the Discovery Service.

Gabrielle Carcassi installed the jClarens-Publisher package at BNL and successfully used it to publish the STAR and ATLAS voms services to the Discovery Service.:  http://osgitb-discovery.caltech.edu:8080/jclarens/web/rendezvous/rendezvous_interface.html

In addition, we successfully used the mkgridmapconf.sh script from jClarens-Publisher to generate a edg-mkgridmap.conf file from the above Atlas and STAR voms server registrations:

<verbatim>
$ bin/mkgridmapconf.sh
# Generating edg-mkgridmap.conf from 2 Discovery Service entries
# STAR VO admin star-vo@bnl.gov
group vomss://vo.racf.bnl.gov:8443/edg-voms-admin/star star
# ATLAS VO admin usatlas-vo@bnl.gov
group vomss://vo.racf.bnl.gov:8443/edg-voms-admin/atlas/usatlas usatlas1
</verbatim>

Since the December meeting Michael Thomas has started publishing the contents of the OSG:vo-0.4.0 package to the Discovery Service and validated that the mkgridmap.conf and gums.config template file can be generated from the provided scripts.

---++ Older Validation Pages
   * See validation section of the GridFTP page
   * Validations for the previous ITB releases are located at ValidationPageRel01.


---++Application Validations

Instructions for application validations by individual VOs:

   * It is up to the VirtualOrganizations/VOInfo to determine what application would be a resonable test of the site functionality.
   * Check with the latest validation table SiteValidationTableITB036 for a list of sites participating in validation of this OSG release.
   * Check site availability against [[http://osg-itb.ivdgl.org/][GridCat]]. The indicator must be green and the correct version of the OSG release (currently itb-036) must be displayed for this site.
   * Check with [[http://osg.ccr.buffalo.edu/statistics/acdc/vo_support_matrix.php][ACDC support VirtualOrganizations/VOInfo matrix]] for site support of your VO.
   * Check the current site status at the [[http://osg.ccr.buffalo.edu/operations-dashboard.php?grids=2&vos=13][ACDC dashboard]].
   * Before submitting your test jobs to a specific site, make sure your VirtualOrganizations/VOInfo can authenticate at this site.
   * Submit your jobs.
   * In case of success, put the success mark in the validation table SiteValidationTableITB036 for this site.
   * In case of failure, put the failure mark. Get in touch with the site administrator and try to work out a solution. CC your correspondence to application validation coordinators: [[Main.MichaelThomas][Michael]] and [[Main.IlyaNarsky][Ilya]].

-- Main.IlyaNarsky - 23 Mar 2006
<br/>
-- Main.MarkGreen - 02 Dec 2005
<br/>
-- Main.BockjooKim - 05 Dec 2005