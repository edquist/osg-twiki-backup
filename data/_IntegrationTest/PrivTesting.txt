%META:TOPICINFO{author="TimMesser" date="1114109037" format="1.0" version="1.4"}%
%META:TOPICPARENT{name="ValidationPage"}%
<!-- This is the default OSG Integration template. 
Please modify it in the sections indicated to create your topic!
If you have any comments/complaints about this template, then please email me:
rwg@hep.uchicago.edu.  (Adapted from Atlas wiki template, Ed Moyse)
--> 

<!-- By default the title is the WikiWord used to create this topic !-->
<!-- if you want to modify it to something more meaningful, just replace %TOPIC% below with i.e "My Topic"!-->

---+!!<nop>%TOPIC%
%TOC%
%STARTINCLUDE%


---++Introduction
This is record of full chain of authentication with
voms-proxy-init and extended proxies.

---++Test by Steve Timm

PRIMA new version as released this morning
GUMS existing version as installed by J. Weigand on cmssrv08
voms-proxy-init as installed from vdt1.3.5
voms-proxy-init -voms uscms:/uscms/hipt
(Using my grid cert which is member of uscms vo with
privilege in all groups).
site_verify.pl --host fnpcg.fnal.gov
(This tests gridftp, jobmanager-fork, jobmanager-condor)
It worked, mapped me to user uscms35 as it should,
passed site_verify.pl)

---++Test by Xin Zhao

Here are the tests I do with the BNL VOMS/GUMS/PRIMA setup:

1) I make a file ~/.edg/vomses, which looks like:


# "nickname" "host" "port" "hostcert's dn" "vo" "globus version (of the server to contact)"
#"wpsix" "gppvom06.gridpp.rl.ac.uk" "50001" "gppvom06.gridpp.rl.ac.uk" "wpsix" "22"
"atlas" "cmssrv08.fnal.gov" "15051" "/DC=org/DC=doegrids/OU=Services/CN=cmssrv08.fnal.gov" "atlas" "22"
"cern1" "tbed0152.cern.ch" "15001" "/C=CH/O=CERN/OU=GRID/CN=host/tbed0152.cern.ch" "atlas" "22"
"cern2" "lxb2094.cern.ch" "15001" "/C=CH/O=CERN/OU=GRID/CN=host/voms.cern.ch" "atlas" "22"
"bnl" "vo.racf.bnl.gov" "15003" "/DC=org/DC=doegrids/OU=Services/CN=vo.racf.bnl.gov" "atlas" "22"
"dteam" "voms.cern.ch" "15004" "/C=CH/O=CERN/OU=GRID/CN=host/voms.cern.ch" "dteam" "22"
"VDT" "vdt-rhas3-ia32.cs.wisc.edu" "15000" "/DC=org/DC=doegrids/OU=Services/CN=vdt-rhas3-ia32.cs.wisc.edu" "VDT"

2) get VDT-Client

	pacman -get http://www.cs.wisc.edu/vdt/vdt_135_cache:VDT-Client

3) source the setup file in VDT-Client dir

4) Try to create proxy with different attributes/role and authenticate
	to the BNL_OSG_test1 gatekeeper, which uses prima module and BNL GUMS:


[xzhao@atlasprod3 ~]$ voms-proxy-init -voms bnl:/atlas/Role=production

Your identity: /DC=org/DC=doegrids/OU=People/CN=Xin Zhao 102397

Enter GRID pass phrase:

Creating temporary proxy .................................... Done

Contacting  vo.racf.bnl.gov:15003 [/DC=org/DC=doegrids/OU=Services/CN=vo.racf.bnl.gov] "atlas" Done

Creating proxy ................................................. Done

Your proxy is valid until Fri Apr 22 00:17:34 2005

 
[xzhao@atlasprod3 ~]$ globus-job-run atestgk01.usatlas.bnl.gov /bin/pwd

/direct/usatlas+grid/u/usatlas1

[xzhao@atlasprod3 ~]$ voms-proxy-init

Your identity: /DC=org/DC=doegrids/OU=People/CN=Xin Zhao 102397

Enter GRID pass phrase:

Creating proxy ......................................... Done

Your proxy is valid until Fri Apr 22 00:17:59 2005
 
[xzhao@atlasprod3 ~]$ globus-job-run atestgk01.usatlas.bnl.gov /bin/pwd

/direct/usatlas+grid/grid0124

5) Use the role based proxy to anthenticate to a Grid3 style (no GUMS) gatekeeper:

[xzhao@atlasprod3 ~]$ globus-job-run agridgk01.usatlas.bnl.gov /bin/pwd

/direct/usatlas+grid/u/usatlas1

This simple test shows it works. 

---++Test by Suresh Singh
After installing OSG-0.1.5-2, I edited /etc/grid-security/prima-authz.conf file to select atlasgrid13.usatlas.bnl.gov as gums server as cmssrv08.fnal.gov is unavailable at the moment. I just ran voms-proxy-init without any options to get the extended proxy. I ran site-verify script. Every tests were passed except existence of "grid-mapfile" which is of course absent due to the use of prima module. I still have to figure out the use of "Role based authorization". One test looks like this:

globus-job-run atestgk01.usatlas.bnl.gov /usr/bin/id

uid=70161(grid0161) gid=69904(gridgr04) groups=69904(gridgr04)

Is there any example of role based authorization using voms-proxy-init for a uscms user ? 

---++Test by Tim Messer
My test for FNAL_CMST1_TEST was going to be similar to the one run by Steve Timm, with PRIMA configured to use GUMS server cmssrv08.  The site was green in Gridcat earlier today but is failing right now, presumably because cmssrv08 is unavailable.  My grid cert does not appear to be in the USCMS VO either (!) and I am trying to get that resolved; the plan is to have one of my team members who is in the VO run site_verify for me instead.  In the meantime, I get "An error accoured when connecting to GUMS: (500)No Context configured to process this request" when attempting to generate a mapfile on the command line.  Some additional debugging information would be helpful.

<!-- MAJOR UPDATES
For significant updates to the topic, consider adding your 'signature' (beneath this editing box) !-->

*Major updates*:%BR%
<!--Future editors should add their signatures beneath yours!-->
-- Main.StevenTimm - 15 Apr 2005

%STOPINCLUDE%

