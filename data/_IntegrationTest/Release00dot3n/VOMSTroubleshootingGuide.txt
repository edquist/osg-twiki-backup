%META:TOPICINFO{author="AnneHeavey" date="1116444589" format="1.0" version="1.2"}%
<!-- This is the default OSG Integration template. 
Please modify it in the sections indicated to create your topic!
If you have any comments/complaints about this template, then please email me:
rwg@hep.uchicago.edu.  (Adapted from Atlas wiki template, Ed Moyse)
--> 

<!-- By default the title is the WikiWord used to create this topic !-->
<!-- if you want to modify it to something more meaningful, just replace %TOPIC% below with i.e "My Topic"!-->

---+!!<nop>VOMS Troubleshooting Guide
%TOC%
%STARTINCLUDE%


---++Introduction
This document is intended to provide some assistance in troubleshooting  problems which may or may be relataed to VOMS: the server, voms-proxy-init and the web admin portions.

An important point to note is that the VOMS error messages are not always indicative of the real problem.  The VOMS team is aware of this and intends to address this in the near future.  In the interim, however, it is a challenge.

---++voms-proxy-init (Error: VERR_COMM)
 <b>Command:</b>

	$VDT_LOCATION/voms/bin/voms-proxy-init  --debug --voms fermilab:/fermilab 
	<verbatim>
		  :
	Your identity: /DC=org/DC=doegrids/OU=People/CN=John Weigand 458491
	Creating temporary proxy to /tmp/tmp_x509up_u1343_7169 .++++++++++++
	..................++++++++++++
	Done
	Contacting  fermigrid2.fnal.gov:15001 [/DC=org/DC=doegrids/OU=Services/CN=host/fermigrid2.fnal.gov] "fermilab"
						gss_assist_get_unwrap	 failure:
	GSS Major Status: Communications Error
	GSS Minor Status Error Chain:
	unwrap.c:gss_unwrap:220:
	Error with GSS token
	globus_i_gsi_gss_utils.c:globus_i_gsi_gss_put_token:671:
	Error with GSS token: The input token has an invalid length of: 0
		 :
	Failed. Error: VERR_COMM
	Failed to contact servers for fermilab.
	</verbatim>

<b>VOMS server log:</b>

 $VDT_LOCATION/voms/var/log/voms.{VO_NAME}

  <verbatim>
	Wed May 18 09:36:33 2005:fermigrid2.fnal.gov:vomsd(31032):ERROR:REQUEST:Execute (vomsd.cc:502):
					 Unable to interpret command: 43200G/fermilab
	Wed May 18 09:37:34 2005:fermigrid2.fnal.gov:vomsd(31036):ERROR:REQUEST:Execute (vomsd.cc:631):
					 Can't get Serial Number!
	</verbatim>

<b>Real Problem:</b>:
Apparently, the voms-proxy-init did contact the server despite the client error message, as the server log shows the contact.

The failure was due to the server's failure to open the !MySql database:
	* The OS permisssions on the mysql database were set to root.root.  The mysql process runs as daemon and therefore the permissions should have been daemon.root on most files and directories.




<!-- MAJOR UPDATES
For significant updates to the topic, consider adding your 'signature' (beneath this editing box) !-->

*Major updates*:%BR%
<!--Future editors should add their signatures beneath yours!-->
-- Main.JohnWeigand - 18 May 2005

%STOPINCLUDE%

