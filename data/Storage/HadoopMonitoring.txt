%META:TOPICINFO{author="BrianBockelman" date="1285856181" format="1.1" version="1.3"}%
%META:TOPICPARENT{name="Hadoop"}%
---+!! *<noop>%SPACEOUT{ "%TOPIC%" }%*
%TOC%

---+ JMX Monitoring in Hadoop

Add the following line to =hadoop-env.sh=:

<verbatim>
export HADOOP_NAMENODE_OPTS=" -Dcom.sun.management.jmxremote.authenticate=false \
    -Dcom.sun.management.jmxremote.ssl=false \
    -Dcom.sun.management.jmxremote.port=8004 \
    -Dcom.sun.management.jmxremote.password.file=$HADOOP_HOME/conf/jmxremote.password \
    -Dcom.sun.management.jmxremote.access.file=$HADOOP_HOME/conf/jmxremote.access"
</verbatim>

---+ Nagios JMX Plugin

The =check_jmx= plugin is available from
[[http://www.nagiosexchange.org/cgi-bin/page.cgi?g=Detailed%2F2338.html;d=1][NagiosExchange]].
Download and unpack the plugin and run =make=. Copy the contents of
the =plugins/= directory (a =.jar= and a script) to your Nagios
installation's plugins directory. Edit the =check_jmx= script as
necessary for your environment.

Finally, test the plugin:

<verbatim>
./check_jmx -U service:jmx:rmi:///jndi/rmi://node182:8004/jmxrmi -O hadoop.dfs:service=DataNode,name=DataNodeStatistics -A BlockReportsMaxTime -w 10 -c 150
./check_jmx -U service:jmx:rmi:///jndi/rmi://node182:8004/jmxrmi -O java.lang:type=Memory -A HeapMemoryUsage -K used -C 10000000
</verbatim>