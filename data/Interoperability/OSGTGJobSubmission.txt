%META:TOPICINFO{author="NehaSharma" date="1218481521" format="1.1" reprev="1.1" version="1.1"}%
%META:TOPICPARENT{name="OSGTeraGridInteroperability"}%
The OSG-TG Gateway (tg.opensciencegrid.org) has been deployed for users to submit OSG jobs on the TG resources. At present, all jobs submitted through this gateway will be submitted to "grid-hg.ncsa.teragrid.org"

Ok - Lets Begin

(1) Make sure you are authorized to run jobs on this TG resource.

(2) Make sure you have a valid proxy and have sourced the VDT setup.sh/csh file so that you have all client side commands in your PATH

(3) Run the "globus-credential-delegate" command. (This command will basically store your delegated credential with the delegation service. This delegated credential is used when job gets forwarded from one node to another. By default , the lifetime of this delegated credential is 12 hours, but you can use the -l option to set it according to your preference)<br /><br />Sample execution:<br /><br />-bash-3.00$ <font color="orangered">globus-credential-delegate -h tg.opensciencegrid.org -p 9443 neha.epr.tg</font><br />EPR will be written to: neha.epr.tg<br />Delegated credential EPR:<br />Address: https://131.225.107.164:9443/wsrf/services/DelegationService <br />Reference property[0]:<br />http://www.globus.org/08/2004/delegationService ">4e1113b0-5738-11dd-b9b0-967ff45aaf7c<br /><br />Note 1: The execution of this command will take a while.

Note 2: In above command, neha.epr is the name of the file which will store the endpoint reference of your delegated credential. You can give it any name.

<br />(4) Run a simple job through the OSG->TG gateway from command line<br /><br />A sample command:<br /><br /><font color="orangered">globusrun-ws -submit -Jf neha.epr.tg -F tg.opensciencegrid.org:9443 -Ft Cemon -streaming -se n.err -so n.out -c /bin/date</font><br /><br />Note 1: the jobmanager name is "Cemon" and not "Condor"<br /><br />Note 2: notice that you need to specify the name of the epr file (in above example - neha.epr.tg)<br /> "-streaming" option enabled the streaming of error and output files<br /><br />Once this command runs successfully, check the contents of the output file.<br /><br />(5) Run a more complex job through the OSG->TG Gateway using Condor-G<br /><br />Step 1: Create a condor submit file.<br />A sample:
<verbatim>-bash-3.00$ cat inout.submit
executable           = inout.sh
error                = inout.err
output               = inout.out
log                  = inout.log
universe             = grid
grid_resource        = gt4 https://tg.opensciencegrid.org:9443 Cemon
whentotransferoutput = ON_EXIT
notification         = Error
should_transfer_files = YES
#transfer_input       = true
transfer_output      = true
transfer_executable  = true
transfer_output_files = out1,out2,out3
globus_xml = <extensions><outputfileslist>out1,out2,out3</outputfileslist></extensions>
queue</verbatim>

Step 2: Submit the job<br /><br />> <font color="orangered">condor_submit inout.submi</font><font color="tomato">t</font><br /><br />Note 1: The "globus_xml" attribute. This attribute needs to be specified for all input files you want to transfer and all output files that you want back after job is completed<br /><br />In the above example, I only want the output files back and do not want to transfer any input files. If you wanted to transfer some input files as well, the "globus_xml" attribute will look like below<br /><br /><font color="royalblue"><verbatim>globus_xml = <extensions><outputfileslist>out1,out2,out3</outputfileslist><inputfileslist>in1,in2</inputfileslist></extensions></verbatim></font>
