%META:TOPICINFO{author="JenyTeheran" date="1444668737" format="1.1" reprev="1.2" version="1.2"}%
%META:TOPICPARENT{name="IncidentInformation2015"}%
%TOC%
---+ OSG-SEC-2015-10-09

Received report of incident at CLUSTER.USTC.cn, in China. Report received through grid-sec mailing list on October 2nd, 2015.
This incident affected OSG Sites
   * AGLT2: successful connections were logged from the machines affected in USTC. 
   * University of Michigan: user password stolen due to a SSH backdoor. Credentials used to connect to gateway machines and several connection attempts to network systems. 

---++ Status

<!--
Suggested status labels:
NEW: Initial report is received but incident is not confirmed.  This is a triage phase.
OPEN: The existence of a security incident requiring response has been confirmed. The response is underway.
RESOLVED: The incident has been resolved but the final report has not been submitted.
CLOSED: The final report has been submitted.
--> 

   * *Status*: Closed
   * *Lead*: Jeny Teheran
   * *Responders*: Jeny Teheran, Mine Altunay (see ticket for others)
   * *References*: https://ticket.opensciencegrid.org/26952

Additional OSG sites have reported no successful connections from USTC. 

---++ Analysis

   * *Severity*: High  
   * *Urgency*: Immediate 

Possibly, due to a weak password, an intruder obtained the root password, and got access to some nodes. The intruder implanted a SSH backdoor and record multiple SSH passwords. All the possible affected accounts are blocked. Also, the intruder installed a software package for digital currency mining. Due to this attack, some CPU power was lost, but there was not impact on grid resources since the machines were not in the same network with grid nodes.

---++ Mitigation Plan
   * USTC: Strong root password configured. Remote login disabled. 
   * AGLT2: User password stolen: ycguo. User contacted to change password and regenerate keys.
   * University of Michigan: hsong credentials recorded by the SSH backdoor. username locked out and removed for deletion. User account no longer needed.

---+++ Actions to take
   * Security announcement sent on October 2nd asking sites to report successful connections from ui01.lcg.ustc.edu.cn and ui05.lcg.ustc.edu.cn between Aug.13rd to Sep. 17th 2015.
      * Reports received from AGLT2 and University of Michigan. 

---+++ How to monitor progress

---+++ Acceptable response time estimate

---+++ List of affected parties
   * USTC
   * AGLT2
   * University of Michigan

---+++ Definition of End Of Event

---++ Incident Log

   * See the GOC ticket: https://ticket.opensciencegrid.org/26952

<!--
Incident information accessible by Security Team members and GOC only:
   * Set ALLOWTOPICVIEW = Main.SecurityTeamGroup, Main.GocGroup
   * Set ALLOWTOPICCHANGE = Main.SecurityTeamGroup, Main.GocGroup
-->


-- Main.JenyTeheran - 09 Oct 2015
