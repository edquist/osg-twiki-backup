%META:TOPICINFO{author="KyleGross" date="1481047954" format="1.1" version="1.18"}%
%META:TOPICPARENT{name="Documentation.SecurityBestPractices"}%
---+ Security Hands on Training 

%TOC%

---++ Topics covered 
   * How to respond to a security incident 
   * How to ban a user DN from your site 
   * How to track down jobs submitted by a DN
   * How to locate relevant log files
   * Basic forensics steps for incident response

---++ The scenario 
   * OSG Security Team contacts you about a “bad DN”
   * We're submitting jobs using the “bad DN”
   * In a real incident
      * Contact security at opensciencegrid.org  and local security response
      * Security team will send you a signed email indicating the action to be taken
      * Take actions identified in the email ASAP
      * Detailed incident response procedures can be found [[Documentation.IncidentDiscoveryReporting][here]]

---++ Major steps to take when responding to compromised user DN
   * Stop further exposure
   * Find out if your site was exposed and to what extent
   * Conduct basic forensics
   * Clean up suspect jobs

---+++ How to stop further exposure of your site?
   * Ban the user DN. We will discuss how later.
   * Keep CAs and CRLs upto date
      * Ensure that tools like vdt-update-certs and fetch-CRL have been enabled
   * Keep the VO list updated
      * Check if GUMS is contacting the VOMS server periodically and gums-host-cron service from VDT is enabled on CE
      * If using end-mkgridmap ensure that the edg-mkgridmap service is enabled in VDT
   * Watch the logs 
      * Gatekeeper logs, batch system logs and syslogs

[[https://twiki.grid.iu.edu/bin/view/Documentation/Release3/BanningUsersAtSite][Banning users at a site]]

---++++ Best practices to limit exposure 
   * Keep CAs and CRLs upto date
      * Ensure that tools like vdt-update-certs and fetch-CRL have been enabled
   * Keep the VO list updated
      * Check if GUMS is contacting the VOMS server periodically and gums-host-cron service from VDT is enabled on CE
      * If using end-mkgridmap ensure that the edg-mkgridmap service is enabled in VDT
   * Watch the logs 

---++++ What did this step accomplish 
   * User will not be able to submit new jobs (or get authorized in the future) to your site.
   * Existing jobs will continue to run.

---+++  Find out if your site was exposed?

   *  Look at log files 
      *  Globus gatekeeper and accounting logs
      * GUMS log can provide a centralized place to check multiple gatekeepers
      * Check syslogs
   * Location of some log files can be found at
      * [[https://twiki.grid.iu.edu/bin/view/Trash/Trash/Trash/Trash/Integration/ITB092/ComputeElementLogFiles]]

---++++ What should log files tell you
   * Has the “bad DN” run on your site?
   * What IP address did the job originate from?
   * When (timestamps)? 
   * What unix account did the user map to?
   * Did the mapping use a pool account or were all users from VO mapped to the same account?

[[https://twiki.grid.iu.edu/bin/view/Documentation/BasicForensics][Basic Forensics techniques]]

%META:TOPICMOVED{by="JamesBarlow" date="1280437157" from="ReleaseDocumentation.SecurityHandsOnTraining" to="Security.SecurityHandsOnTraining"}%
