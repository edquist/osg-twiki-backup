%META:TOPICINFO{author="KyleGross" date="1481047951" format="1.1" version="1.8"}%
%META:TOPICPARENT{name="IncidentInformation2012"}%
%TOC%
---+ OSG-SEC-2012-01-11

Several grid systems at Texas Tech University were compromised and the ssh daemons replaced.

---++ Status

<!--
Suggested status labels:
NEW: Initial report is received but incident is not confirmed.  This is a triage phase.
OPEN: The existence of a security incident requiring response has been confirmed. The response is underway.
RESOLVED: The incident has been resolved but the final report has not been submitted.
CLOSED: The final report has been submitted.
--> 

   * *Status*: _OPEN_ 
   * *Lead*: _Kevin Hill_
   * *Responders*: _list of involved responders (for resource tracking)_
   * *References*:
      * https://ticket.grid.iu.edu/goc/11449 - Vulnerability report ticket.
      * https://ticket.grid.iu.edu/goc/viewer?id=11451 - Announcement ticket.

_Optionally include additional status information here._

---++ Analysis

   * *Severity*: _Medium_: compromise was limited to root on the ttu.edu systems. It has not appeared to affect other grid systems.
   * *Urgency*: _High_: some proxies were still valid at the time of the systems removal, but most were less than 48 hours.

The largest risk is unexpired credentials that may have been on these systems. It appears that most jobs were submitted via proxies that expired in 48 hours or less.

---++ Mitigation Plan

Determine if any long lived credentials were used to submit jobs to the system. If there were unexpired credentials, contact the affected users and have them renew their credentials and revoke their old ones.

---+++ Actions to take

Monitor Gratia for any credential use we haven't gotten answers back from. Watch for unual activity.

Need to get information from TTU security team on the actual compromise.

---+++ How to monitor progress

Responders should report their actions back to the incident lead.

---+++ Acceptable response time estimate

Notice was sent to all OSG security contacts the same day. Individual users with credentials in the affected system logs were contacted within 24 hours and most responded within 48 hours.

---+++ List of affected parties

_This list determines who we need to communicate with, who needs to take action, etc.  However, be careful about handling sensitive information._`
There were 4 user proxies and 3 glide-in proxies dn's logged on the compromised systems.

---+++ Definition of End Of Event

_What is the condition under which we can declare this incident to be resolved?_
The event is over now that all the credentials used on the compromised systems have either been revoked or have expired.

---++ Incident Log
---
Vulnerability Ticket updated with info Submitted by Alan Sill from TTU security team. Looks like there was a second ssh installed that was out of date. Not sure if it had any vulnerabilites or if password brute-forcing was involved.
-- Main.KevinHill - 19 Jan 2012

---
No unusual increases in activity visible by reviewing Gratia over the 3 day weekend. 
-- Main.KevinHill - 17 Jan 2012

---
host sigmorph is misspelled, should be sigmorph.hpcc.ttu.edu -- Main.KevinHill - 13 Jan 2012

---
Certificates for antaeus.hpcc.ttu.edu revoked. -- Main.KevinHill - 13 Jan 2012

---
Call from Caltech, turned out to be feedback loop from this incident -- Main.KevinHill - 13 Jan 2012

---
List of dn's from TTU GUM's log:
   * /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=asciaba/CN=430796/CN=Andrea Sciaba
   * expired after 12 hours

   * /DC=gov/DC=fnal/O=Fermilab/OU=Robots/CN=fermigrid0.fnal.gov/CN=cron/CN=Keith Chadwick/CN=UID:chadwick
   * already expired

   * /DC=org/DC=doegrids/OU=People/CN=Anand Padmanabhan 75166
   * already expired

   * /DC=org/DC=doegrids/OU=People/CN=Bockjoo Kim 740786
   * replaced/revoked cert.

   * /DC=org/DC=doegrids/OU=Services/CN=frontend.ligo.caltech.edu
   * up to 72 hours. Monitoring Gratia for unusual activity. Nothing unusual as of Friday AM.

   * /DC=org/DC=doegrids/OU=Services/CN=pilot/glidein.chtc.wisc.edu
   * up to 48 hours. Monitoring Gratia for unusual activity. Nothing unusual as of Friday AM.

   *  /DC=org/DC=doegrids/OU=Services/CN=rsv/antaeus.hpcc.ttu.edu
   * Will need to be replaced when system comes back on line

---
Here's an example log entry. -- Main.JimBasney - 01 Jul 2008

<verbatim>
Use the verbatim tag when pasting in text to disable HTML code.
</verbatim>

---++ Summary

   * *Final Report*: [[https://osg-docdb.opensciencegrid.org:440/][OSG !DocDB Document ###]]

_What was the resolution of the incident?_

The compromised systems were taken offline, the affected credentials were either revoked or expired within 72 hours. Gratia logs were checked for any increased/suspicious activity from the affected credentials.

_What is the long-term mitigation plan (including changes in our operations, middleware or anything else that enabled the event) and timeline?_

_Lessons Learned_

   * The security team needs a short, concise SecurityIncidentChecklist.
   * All hosts involved in a compromise should be checked for host certificates even if the reporting institution doesn't immediately disclose that they have them. 
   * OSG admins should be reminded that software installed via other methods than the main packaging system (pacman. rpm, tarballs, etc) needs to be checked for updates regularly. 
   
---++ Access Control

_Uncomment the appropriate access control policy for this incident page. Logout of the twiki and try to access the page to ensure it is not publicly accessible. Do not attach files, as they will not be protected (see  [[http://twiki.org/cgi-bin/view/TWiki/TWikiAccessControl#Controlling_access_to_Attachment][http://twiki.org/cgi-bin/view/TWiki/TWikiAccessControl#Controlling_access_to_Attachment]])._

Incident information accessible by Security Team members and GOC only:
   * Set ALLOWTOPICVIEW = Main.SecurityTeamGroup, Main.GocGroup
   * Set ALLOWTOPICCHANGE = Main.SecurityTeamGroup, Main.GocGroup

Incident information accessible by all authenticated twiki users:
   * #Set ALLOWTOPICVIEW = Main.GridGroup
   * #Set ALLOWTOPICCHANGE = Main.GridGroup

%META:TOPICMOVED{by="KevinHill" date="1326469747" from="Security.OSGSEC20120111" to="Security.OSG-SEC-2012-01-11"}%
