%META:TOPICINFO{author="IgorSfiligoi" date="1173903163" format="1.1" version="1.14"}%
%META:TOPICPARENT{name="WebHome"}%
%TOC%

---+ OSG - LIGO working group on ID management and !AuthZ
A working group was set up in June 2006 to define workplan and goals for the OSG RA, Privilege Project, OSG Ops and LIGO so that OSG and LIGO efforts are optimized and meet the functional needs of LIGO.

Working group members:
   * LIGO - Warren Anderson, Murali Ramsunder, Albert Lazzarini, Kent Blackburn
   * OSG - Doug Olson, Igor Sfiligoi, Gabriele Garzoglio, Eileen Berman, Rob Kennedy

---+ Project plan
The problem have been split it 3 independent subproblems, that will be handled independently:
   * Having DOEGrid send a script-aware confirmation mail if a script requested a cert
   * Being able to "renew" several host certificates while presenting the admin private key just once
   * Handling changing sponsor information

---++ Having DOEGrid send a script-aware confirmation mail if a script requested a cert

---+++ Problem
LIGO is using a script to import the DOEGrids certificates into a standard local disk area.
However, the mail sent by DOEGrids after assigning a new certificate asks the user to follow a certain manual procedure to accomplish the task.
The two procedures are not compatible.

---+++ Desired result
The mail sent by DOEGrids to the user must be compatible with LIGO's automated procedure.
The user must be able to continue the procedure simply by following the instructions in the mail. I.e. the instructions in the e-mail must allow for an automated import of the certificate to the desired local disk area.

The solution need not be LIGO specific.

---+++ Proposed solution
As agreed on Feb 28th, 2007:
   * DOEGrid CA will implement an option in the cert request API, that will allow to select between a mail having
      * instructions to fetch the cert using a browser (default)
      * instructions to fetch the cert using the OSG certificate scripts
   * LIGO will modify their request scripts to include the proper value for that option.
   * LIGO will relinquish the use of their own retrieval script, and use the OSG certificate script, instead


---++ Being able to "renew" several host certificates while presenting the admin private key just once

To be writen...

---++ Handling changing sponsor information

Ro be writen...

---+ Historical evolution

---++ Feb 26th, 2007 Project management taken over by Igor Sfiligoi

The problem have been split it 3 independent subproblems, that will be handled independently:
   * Having DOEGrid send a script-aware confirmation mail if a script requested a cert (mapping H1)
   * Being able to "renew" several host certificates while presenting the admin private key just once (mapping L1)
   * Handling changing sponsor information (mapping L3)

---++ 13 Feb 2007 email from Mike Helm on LIGO requirements
About H1 - 
We can think of 3 alternatives (could be others)

   i. Make an exception for LIGO<br>
   a) We already do this for ou=people, vs ou=service<br>
   b) Changes the way notifications are done on certification<br>
   c) Means changing the namespace - adding an ou=ligo, probably<br>
   d) Not a general solution for all DOEGrids/OSG problems - if we want to go
      in this direction, then need to create our own, standalone notification system<br>
   e) DM points out that we have only done this for certification notifications, haven't
      looked at the renewal/cert lifecycle notifications<br>
   i. Make a LIGO CA<br>
   a) Probably technically easiest and cheapest thing to do 
      (need new host, probably)
   i. Make standalone notification system<br>
   a) Something we've always wanted anyway<br>
   b) low priority in past<br>
   c) prob several months' work - first some coding, then interative 
      improvements - a lot of UI work <br>

We know that there are changes coming in the CA product that DOEGrids 
uses, but we won't be ready (they aren't available yet) for some months.
One of these changes involves some improvements in the roles and 
access control of CA agents, and the other (partly available) involves
the capability to make different cert profiles.  Together these might
make ii and especially iii obsolete.   At the moment I like option (i)
better, because it is not expensive (as long as it is not a general
problem) and obsoleting it is not painful.

L1 - automated host replacement
This is not a bad idea - it's the way MS domains & Active Directory manage
certs for hosts - but I think we need to understand more of the back story.
It certainly has problem with the EUGridPMA controlled classic profile viz

http://www.eugridpma.org/guidelines/IGTF-AP-classic-20050930-4-0.html#_Toc116323573

In case of host or service certificate requests, the RA should validate the identity of the person in charge of the specific enti
ties using a secure method.

The RA should validate the association of the certificate signing request.

[source: EUGridPMA-minreq-classic-3.2, section 3.1]

Generally this is interpreted as a human must mediate the host/service certification.
This makes sense, since hosts can't sign agreements &c but humans can.
There are a couple reasons MS AD works, tho, so if something like them
applies - there is a strong management of hosts in some fashion - maybe it can
be sold to the IGTF.  The VO would have to describe how it can control for rogue
machines, zombies, ghost hosts &c - this is stuff we see all the time at 
DOEGrids, I have a regular Monday morning mailbox  chore to deal with
part of this issue.  If they want to go down this path anyway then it's a stronger
argument for (ii) above, in order to prevent this usage from causing problems
with interoperability expectations in Europe &  other places that don't like
this kind of host cert assurance & issuance.

L3 - cert meta data - isn't this really an argument about Grid Identity, like I made on 
the call?  This is a good thing to work on - figuring out how we collect this
info, which part is appropriate for the CA, which for the VO, and how to federate
(and adjudicate any conflicting info).  If we establish a stronger concept
of a DOEGrids account (and identity provider, perhaps), or alternatively a 
stronger concept of OSG or VO account (& identity provider), there are other
things we could do too.

We can provide an interface to allow people to change the attributes in 
ldap://ldap.doegrids.org
This is probably a few weeks' work - need to re-establish a web-based directory UI
and/or some scripts to go with it, and create a server instance with client - cert
authentication.

L4 - better RA doc?
Not really sure about this - DOEGrids PMA issue?  Most of the concept is in the CP/CPS Apx A - 
everything is delegated to the RA, so it can pretty much define itself, outside the
accountability constraints.  It's worth
writing about this however, as some EU Grid PMA people (mostly UK E-Science) 
propose to standardize this role!

Now about this URL
http://www.lsc-group.phys.uwm.edu/lscdatagrid/doc/certificates.html
LIGO wants this in notice sent upon certification.
People reading it should note that we (DOEGrids) can't send this notice until step 7 is complete!
(That is nearly the end of the LIGO process)

It seems to me there is a need for a comprehensive VO registration process for
LIGO, with 1 part of it being the creation of an authentication credential eg DOEGrids cert.

Also, how does this differ from OSG's own process - from the distance I am at,
it seems very similar to the way the PPDG scripts would work - is it just 
LIGO re-branding or are there some material differences?

I don't care - we at ESnet will be happy to give them whatever they want, if 
we can figure out how to do it & pay for it - but I just point this out
as a public service.

Dhiva may have some more comments and can go in depth on the technical
issues, coding & config issues &c.


---++ 8 Feb 2007 phone meeting OSG-LIGO
(These are not quite notes or minutes, but related info to the meeting).

Attending: Warren, Ruth, Gabriele, Eileen, Doug

Note from Warren on LIGO requirements (email 28 Jan 2007)
<verbatim>
High Priority
- LIGO specific email notifications - 
  upon the signing of a new certificate, the email message received by 
  OSG:LIGO VO users should direct the user to follow the instructions 
  at:
	http://www.lsc-group.phys.uwm.edu/lscdatagrid/doc/certificates.html 
  to retrieve the message, rather than containing the usual DOEGrids message.
  Likewise, renewal notices should point users at:
        http://www.lsc-group.phys.uwm.edu/lscdatagrid/doc/renewcert.html
  Note that these URLs may change in the future as we implement our plan to 
  start bringing all our web pages under the www.ligo.org domain.

Lower Priority
- Mechanism for automated service/host cert replacement - rather than 
  implement multi-year certificates (although we do note that Appendix H of 
  the DOE Grids Certificate Policy and Certification Practice statement that 
  it seems to indicate that PNNL certificates last for 18 months, rather than 
  the standard one year we have been told is the maximum allowable), we feel 
  everyone is better served by trying to make swapping out of service and host 
  certificates as transparent and automated as possible. Something that could 
  be run by cron would be ideal, but this might be problematic since it would 
  require automated invocation of a grid admins certificate. Perhaps Doug and 
  I can put our heads together to see what we can come up with.
- Allow VO field searches of database via script - done by Doug already.
- Allow certificate metadata to be updated to correctly reflect changing 
  affiliation/contact information. This is not a deal breaker, but surely 
  everyone would like to be able to keep better track of this information?
- Better RA agent docmentation. Again, wouldn't everyone like this?
</verbatim>

Label the items *H1, L1, L2, L3, L4* , in the order they appear above.

*H1* notifications are sent (currently) from the CA software. Any
work on modifications to the CA software will be done with the
[[http://www.redhat.com/docs/manuals/cert-system/][RedHat Certificate System]] 7.1 or 7.2.
Of course, we could come up with a plan where users do not receive notifications directly from the CA,
but this would also have to be consistent with CA requirements.

*L1* - Warren will look into how well the location of certificates in use is known or if
managing locations of certificates is part of the issue to be dealt with.

*L3* - This is about the DOEGrids ldap directory (ldap.doegrids.org) where certificates are
published, and some of the registration metadata is also published.
Some metadata gets stale as replacement certificates are issued.

FNAL has strong interest in seeing how well VOMRS meets needs.

Question - shall we investigate interfacing VOMRS and DOEGrids cert requests
so that VOMRS provides a single user interface?
   * LIGO procedures use a script interface to the CA and not the web interface
   * We should keep in mind that in EGEE certificate issuance is entirely outside the VOs and the Grid and handled by an independent PKI.  I don't think this means interfacing VOMRS to DOEGrids is a bad idea but we should think about it carefully.


---++ Seattle meeting, Aug. 20
The working group will meet in Seattle at UW on Sunday, Aug. 20, the day before
the OSG Consortium meeting.

We will start at 9am PDT, Aug. 20.

Room location - Physics and Astronomy Building, room B305, near east end of B wing, 3rd floor.
Campus map - http://www.washington.edu/home/maps/southwest.html?PAB.

Attending in person are: Warren, Murali, Kent, Doug, Leigh.  Gabriele will
attend by phone/internet 9am-noon.  We may get one other person from the Privilege Project.

Remote details: ESnet ad-hoc H.323 service, ID 88674572 (88 OSG LSC), teleconf. 510-883-7860.

Suggested agenda:
   * LIGO status & needs for ID management & authorization (Warren)
   * OSG RA/CA features (Doug)
   * Privilege Project features (Gabriele)
   * (other?)
   * discussion
   * review action items & identified workplan areas

---++ Notes and Action Items

%BLUE% Draft update -- Main.DougOlson - 21 Nov 2006%ENDCOLOR%

Action Items:
   1. Persistent certificates
      * onasys services are part of real-time data processing and should run for 2 or 3 years without down time and certificate expiration can cause failures of the service
      * Options for fix: long lived certificates, or improved replacement of expiring certificates
         * if long lived certificates is possible this is the simplest solution
         * procedure to monitor and replace expiring certificates may be more robust
         * certificate that do not touch anything outside of dedicated LIGO resources could be made manually without need for IGTF accredited CA
      * %BLUE% Requirement: Certificate expiration should not interrupt long running data processing or data analysis tasks.%ENDCOLOR%
   2. Registration with LIGO for VO membership is coupled (for efficiency) with certificate issuance
      * It is necessary for LIGO members to get certificate from LIGO agents in order to have the verification for LIGO VO membership
      * For consideration - it would he helpful to have a component like O=LIGO in the DN of the issued certificates.
      * %BLUE% Requirement: LIGO VO membership registration and certificate registration should be integrated into a single workflow%ENDCOLOR%
      * %ORANGE% Question for 1 & 2: Is IGTF accreditation required? %ENDCOLOR%
   3. Certificate renewal notices
      * Would be useful for agents to get notification when a certificate holder gets a self-authenticated replacement certificate, so that agent can check if re-authentication is necessary
      * %BLUE% Requirement: Certificates issued for LIGO should not be renewed without notification to LIGO agents. %ENDCOLOR%
   4. Consider making and publishing policy that certificate holders are required to notify RA when their affiliation changes
      * would help prevent self-authenticated certificate extension for people who no longer qualify to have a certificate or that have anyone associated with the RA who could authenticate them.
      * Should/can we revoke certificate for people who change affiliation?
      * %BLUE% LIGO policy. Requirement is item 3.%ENDCOLOR%
   5. Add additional output field to cert-lookup script to display o field (holds RA/VO affiliation)
      * %GREEN% Done. It shows the RA/VO affiliation of the first certificate request for the DN.%ENDCOLOR%
   6. When GUMS pulls info from VOMS is the order of users (DNs) repeatable? (helps with account mapping)
   7. Is it possible to use a set of arbitrary and pre-generated strings for the account names for pool accounts?
   8. LIGO requests that a replacement certificate interface would also require approval by an agent.
      * %BLUE% Requirement is listed in item 3.%ENDCOLOR%
   9. Is it or can it be possible for authorized people to edit the data in the ldap certificacte publishing database?
      * So that agents can update the metadata associated with a certificate when it changes
      * %BLUE% Preference is to have information published from the latest request for that DN.%ENDCOLOR%
   0. It is requested that all email notices sent to certificate subscribers have content tailored for LIGO.
      * %BLUE% Requirement: LIGO specific notifications to subscribers.%ENDCOLOR%
      * %ORANGE% Status: The CM software does not allow VO/RA specific notices without programming effort.%ENDCOLOR%
   1. Gabriele will send information on the upgrade plans for GUMS.
   2. LIGO needs to remove access for people leaving LIGO within 24 hours.
      * Possibly by certificate revocation (does not quite follow existing DOEGrids policies)
      * Could be done with VOMS, if VOMS is used for definitive VO membership
   3. Suggest to add generation of a PKCS12 file to the cert-retrieve script to simplify process to import a certificate to a web browswer/email client.
      * %ORANGE% Not done, but should have :(  LIGO has it in their own script however. %ENDCOLOR%
   4. Would be useful to have a secondary address in certificates for receiving notices about expiration/renewals
      * %ORANGE% Appears to work, need followup with Mike to see about usage. %ENDCOLOR%
   5. Need more complete documentation for agents
      * %ORANGE% In progress %ENDCOLOR%
   6. Privilege project is working on update procedures and instructions to smooth the software upgrade procedure and to preserve existing GUMS database.
      * For example, it is necessary to preserve the vdt-app-data contents during an upgrade
   7. Stop expiration notices when cert is replaced.
      * %ORANGE% How to distinguish between replacing a certificate and duplicating a certificate? %ENDCOLOR%
 



---++ List of Issues

From Warren, May 31:
<verbatim>
The root of the issue, however, is that the LIGO Data 
Grid's (LDG's) user model is different than OSG's (as I understand it). In 
particular, LDG users have local accounts on LDG clusters, and my 
understanding is that we are not looking to change that soon. This led us to 
a set of specific requirements for our Certificate issuance process that we 
thought would be best handled "in house", particularly in light of the fact 
that those requirements have been evolving and will certainly continue to 
evolve for the foreseeable future. The requirements identified by the LIGO 
Computing Committee were:

1) Certificates with multi-year lifetimes. We are gearing up to have analysis 
jobs that analyze multi-year data sets in real time on the LIGO data grid, 
for which we want certificates which last for multiple years. These jobs have 
in the past been associated with user certificates, which provide clear 
accounting. There has recently been a move toward service certificates for 
this so that a set of users can share the load of "managing" runaway jobs and 
so that some jobs can be given higher priorities in the Condor queue without 
giving any single user a higher priority. I think this is still sorting 
itself out.

2) User certificates should be tightly coupled to user accounts. Much work on 
the LIGO data grid is done with user accounts. We wish to use certificates 
for both authentication and authorization of users on the LIGO data grid. 
Eventually, the LIGO Computing Committee wants the signing of a certificate 
to automatically invoke a process which creates an LDG user account account 
across the LIGO data grid associated with that certificate.

3) Quick turn around on certificate revocation. Associated with requirements 
1) and 2), we do not want long-lived certificates hanging around after their 
usefulness expires. We also want to be able to lock out users who leave the 
collaboration on short (< day) time scales. If accounts are tied closely to 
certificates, and activated automatically with certificate signing, it is 
natural to use certificate revocation to close access to accounts as well.

4) Clear identification of LIGO certificates as opposed to OSG or other 
certificates. In particular, associated with 2) we wish to have clear 
visibility into the provenance of a certificate which is associated with an 
account on the LDG. There have been cases in the past where LIGO members from 
institutions which have access to DOEGrids certificates through 
non-LIGO-related mechanisms have used those non-LIGO-related mechanisms to 
obtain certificates with which they have applied for accounts. This has 
created confusion in the past. My understanding is that this problem has been 
mitigated to a large extent by separating LIGO from iVDGL in the current 
DOEGrids implementation.

In the collective minds of the LIGO Computing Committee, which Albert chairs, 
I believe these are the primary issues that argued in favor of implementing a 
simple LIGOGrids CA which would be associated only with LIGO data grid 
accounts. I, for one, would welcome any input on how best to satisfy these 
requirements, either using DOEGrids certificates or implementing our own CA.
</verbatim>

From Patrick, July 17:
<verbatim>
I was reminded 
today of a simple change that we would like to see to facilitate use of the 
OSG/DOE CA for LIGO.  I received the attached e-mail reminding me to renew my 
certificate.   It would be very useful to make the e-mail more precise about 
the where a given user should find instructions about renewing certificates.  
For example,  we currently have instructions at

http://www.lsc-group.phys.uwm.edu/lscdatagrid/doc/renewcert.html

which I followed and was good to go for another year.  Many LSC members with 
certs don't know to look for these instructions. Would it be possible to 
tailor the renewal e-mail to have a pointer to these instructions for 
certificates issued to LIGO collaborators?  (BTW,  the particular url will 
probably change near the end of august,  but it's the principal that I'm 
interested in.)
</verbatim>

---++ Material

   * Gabriele Garzoglio: The Privilege Project and the Ligo Data Grid ([[%ATTACHURL%/PrivilegeAndLigo.pdf][PrivilegeAndLigo.pdf]])
   * Doug Olson: Some RA/CA features([[%ATTACHURL%/ra-ca-features.ppt][.ppt]], [[%ATTACHURL%/ra-ca-features.pdf][.pdf]])

-- Main.DougOlson - 18 Jul 2006
 

   * [[%ATTACHURL%/ra-ca-features.ppt][ra-ca-features.ppt]]: Some RA/CA features

   * [[%ATTACHURL%/ra-ca-features.pdf][ra-ca-features.pdf]]: some RA/CA features, pdf format

   * [[%ATTACHURL%/warren-20060820-OSG.ppt][warren-20060820-OSG.ppt]]: warren-20060820-OSG.ppt

%META:FILEATTACHMENT{name="ra-ca-features.pdf" attr="" autoattached="1" comment="some RA/CA features, pdf format" date="1156054104" path="ra-ca-features.pdf" size="165228" user="Main.DougOlson" version="1"}%
%META:FILEATTACHMENT{name="raw-notes-doug.doc" attr="" autoattached="1" comment="Doug's raw notes, not necessarily meaningful to the casual reader." date="1156163607" path="raw-notes-doug.doc" size="30720" user="Main.DougOlson" version="1"}%
%META:FILEATTACHMENT{name="warren-20060820-OSG.ppt" attr="" autoattached="1" comment="" date="1156091209" path="warren-20060820-OSG.ppt" size="182272" user="Main.LeighGrund" version="1"}%
%META:FILEATTACHMENT{name="ra-ca-features.ppt" attr="" autoattached="1" comment="Some RA/CA features" date="1156054070" path="ra-ca-features.ppt" size="235520" user="Main.DougOlson" version="1"}%
%META:FILEATTACHMENT{name="PrivilegeAndLigo.pdf" attr="" autoattached="1" comment="The Privilege Project and the Ligo Data Grid" date="1155855606" path="PrivilegeAndLigo.pdf" size="429154" user="Main.GabrieleGarzoglio" version="1"}%
