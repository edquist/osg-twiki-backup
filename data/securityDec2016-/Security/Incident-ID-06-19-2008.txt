%META:TOPICINFO{author="BobBall" date="1213933646" format="1.1" version="1.4"}%
%META:TOPICPARENT{name="SecurityTeamWorkingArea"}%
Please correct if any info below is misleading
Incident ID: 06-19-2008
Please use this ID for all further communication, fixes and reports.

Bob Ball reported that only gridftp and LRC are running on the machine. The LRC is not included in the VDT. LRC uses username and password for access. The compromised machine is not a gatekeeper. It is only used for data access. The machine only has http and tomcat services from VDT installed and turned on.

BB addition: vdt-control --list showed other services turned on, and this list is now attached below.  Note that even though condor-devel is shown as "enabled", it was chkconfig'd off.

John says that LRC is basically a MySQL service.

There is no indication of what is the attack vector or the attack timeline. There are only outgoing connection logs for dropped packets. Therefore, we do not know which other machines may be compromised from the u of Michigan machine. The attack has been reported by a system admin in Denmark, whose machines was scanned from the port 10000 originating from the compromised u mich machine.

BB addition: isc.sans.org has this to say about port 10000:  "This is the kiddies looking for hosts running Webmin on Usermin."  Famous ports include 10000 through 10005 as reported [[http://isc.sans.org/port.html?port=10000][here]].

Bob said there must be only a host certificate on the machine. No user certificates are stored. Because gridftp only stores user proxies in memory and never writes to disk, we conclude there is a small risk of user proxy compromise. The gridftp deletes all instances of user proxies once the data transfer completes. If the attacker gained root access, he may steal the proxies during the data transfer. This is considered a low risk. After the local incident response team tells us the details, we can change the risk associated with compromised user proxies. Overall, so far we agree that the risk is low.

As our short-term mitigation plan: We agreed John will seek Atlas mgmt board's help; Bob will post gridftp, LRC and network log files on the twiki page we setup; Bob will ask local incident response team's help with the machine.  OSG asked Bob to seek the local incident response team at U mich in order to report on what services were running on this machine, the level of compromise, the attack vector and any other analysis they could gather. We will meet again tomorrow to discuss further details.

BB addition: A University IT forensics expert will join us in our server room in the morning to assist in diagnosing the machine.

To understand if this attack is due to the recent RPath announcement: we asked Bob whether they had a /home/execute/condor directory on the machine and whether he installed or turned on the condor service. there is no such directory and condor is not installed on this machine. So we conclude the compromise is not due to the RPath vulnerability.

Rob Quick confirmed that the compromised machine does not report to OSG. Therefore, this issue is still confined to ATlas and therefore must be addressed by Atlas and USAtlas security officers.
So far we have no reason to believe OSG users other than Atlas users may have contacted to this compromised machine.

We currently have no monitoring mechanism for the incident or an end of the incident/spread. We do not have enough information to determine those.
I would seek OSG executive Team 's approval on these actions.
Anything missing? please add on

    *  Set ALLOWTOPICVIEW = DougOlson, SecurityTeamGroup, RobQ, AlainRoy, JohnHover, DantongYu, TorreWenaus

    * Set ALLOWTOPICCHANGE = DougOlson, SecurityTeamGroup, RobQ, AlainRoy, JohnHover, DantongYu, TorreWenaus 

    * Set DENYTOPICVIEW = TwikiGuest? 


-- Main.MineAltunay - 19 Jun 2008

   * [[%ATTACHURL%/UMich_vdt_control_out.txt][UMich_vdt_control_out.txt]]: UMich_vdt_control_out.txt

%META:FILEATTACHMENT{name="gridftp-auth.log.3.gz" attr="" autoattached="1" comment="third rotated log" date="1213928910" path="gridftp-auth.log.3.gz" size="5619" user="Main.BobBall" version="1"}%
%META:FILEATTACHMENT{name="gridftp-auth.log.7.gz" attr="" autoattached="1" comment="Seventh (last) rotated log" date="1213928990" path="gridftp-auth.log.7.gz" size="15693" user="Main.BobBall" version="1"}%
%META:FILEATTACHMENT{name="gridftp-auth.log.1.gz" attr="" autoattached="1" comment="gridftp-auth first rotated log" date="1213928852" path="gridftp-auth.log.1.gz" size="13489" user="Main.BobBall" version="1"}%
%META:FILEATTACHMENT{name="UMich_vdt_control_out.txt" attr="" autoattached="1" comment="" date="1213929800" path="UMich_vdt_control_out.txt" size="798" user="Main.MineAltunay" version="1"}%
%META:FILEATTACHMENT{name="gridftp-auth.log.5.gz" attr="" autoattached="1" comment="Fifth rotated log" date="1213928948" path="gridftp-auth.log.5.gz" size="8059" user="Main.BobBall" version="1"}%
%META:FILEATTACHMENT{name="messages.txt" attr="" autoattached="1" comment="Excerpt from /var/log/messages at time of incident" date="1213929030" path="messages.txt" size="2387739" user="Main.BobBall" version="1"}%
%META:FILEATTACHMENT{name="gridftp-auth.log.2.gz" attr="" autoattached="1" comment="Second rotated log" date="1213928891" path="gridftp-auth.log.2.gz" size="7803" user="Main.BobBall" version="1"}%
%META:FILEATTACHMENT{name="gridftp-auth.log.6.gz" attr="" autoattached="1" comment="Sixth rotated log" date="1213928966" path="gridftp-auth.log.6.gz" size="13112" user="Main.BobBall" version="1"}%
%META:FILEATTACHMENT{name="gridftp-auth.log.4.gz" attr="" autoattached="1" comment="Fourth rotated log" date="1213928930" path="gridftp-auth.log.4.gz" size="9664" user="Main.BobBall" version="1"}%
%META:FILEATTACHMENT{name="gridftp-auth.log" attr="" autoattached="1" comment="gridftp-auth.log, current" date="1213928804" path="gridftp-auth.log" size="141828" user="Main.BobBall" version="1"}%
