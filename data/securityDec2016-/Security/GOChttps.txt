%META:TOPICINFO{author="IgorSfiligoi" date="1252424219" format="1.1" version="1.4"}%
%META:TOPICPARENT{name="SecurityTeamWorkingArea"}%
---+!! GOC Transition from HTTP to HTTPS

---++ The problem

GOC is currently distributing the CA certificates and pacman caches via HTTP.
This leaves OSG vulnerable to Man-In-The-Middle attacks.

To close this security gap, GOC is planning on providing the above services using HTTPS.

This document lists the steps needed for a smooth transition.

---++ Deploying the HTTPS server

In Aug 2009, GOC has acquired a SSL Web Server Certificate from a well known private CA.
They are currently in the process of deploying the HTTPS server.

The expectation is that, in the short term, they will provide the same data from both the HTTP and HTTPS portals.

Longer term, part of the data may only be available via HTTPS.

---++ Steps needed for transition

---+++ CA certificate distribution

The CA certs are pulled from the clients using the VDT-distributed
<pre>
vdt-setup-ca-certificates
</pre>

The URL is specified in the
<pre>
$VDT/vdt/etc/vdt-update-certs.conf
</pre>
 configuration file.

*Action item:* (GOC) Test that =vdt-setup-ca-certificates= is able to pull the CA certs using a HTTPS URL.

*Action item:* (GOC) Test that =vdt-setup-ca-certificates= is able to pull the CA certs using a HTTPS URL via a Squid.

*Action item:* (GOC) Test that =vdt-setup-ca-certificates= is checking the validity of the server certificate.

*Action item:* (GOC) Perform the above three tests on all VDT supported platforms, possibly through the NMI Build and Test infrastructure.

In any case, the CA certs should continue to be distributed also via HTTP as long as the OSG 1.2 is being supported, 
or there are strong security reasons to disable this distribution method.

---+++ Pacman software distribution

The pacman packages are served from two sources; GOC and VDT.<br>
For the purpose of this document we will only focus on the GOC part, but the VDT pacman cache should be secured via HTTPS as well.

An additional problem is that pacman itself is distributed via HTTP.<br>
*Action item:* (VDT) Investigate if pacman itself can be distributed via HTTPS.

As in the above section, check that HTTPS can be used at all:

*Action item:* (GOC) Test that =pacman= is able to pull the CA certs using a HTTPS URL.

*Action item:* (GOC) Test that =pacman= is able to pull the CA certs using a HTTPS URL via a Squid.

*Action item:* (GOC) Test that =pacman= is checking the validity of the server certificate.

Plus, switching to use HTTPS has two additional problems:
   * =pacman= has a hardcoded URL for OSG<br>
      Changing the URL to HTTPS will require a new version of pacman.<br>
     <br>
      *Action item:* (VDT/ITB) Investigate what would it take to get a new version of pacman.
   * By using HTTPS, Squid caching will not work anymore. Files delivered via HTTPS cannot be cached.<br>
      Squid should still work as a proxy, though.<br>
      <br>
      *Action item:* (Igor) Test that the current version of pacman fetch a pacman cache from a HTTPS URL.<br>
      <br>
      *Action item:* (VDT+Security) Evaluate alternative option for securing the pacman caches. One option is to transfer via HTTPS only the sha1sums (and still get the bulk of the data via HTTP)/


In any case, OSG 1.2 and 1.0 should be accessible via HTTP for the foreseeable future.
If we don't find unsolvable problems, we should plan on having OSG 1.4 accessible only via HTTPS.


-- Main.IgorSfiligoi - 08 Sep 2009