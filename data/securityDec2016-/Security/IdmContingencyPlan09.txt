%META:TOPICINFO{author="MineAltunay" date="1312403499" format="1.1" version="1.11"}%
%META:TOPICPARENT{name="IdMContingencyPlanning"}%
%RED% *OSG Restricted Information*

Information on this web page is restricted to authorized individuals only.  It should not be copied or distributed without
the express consent of the OSG Security Team and only to individuals, and while retaining this information protection notice.
%ENDCOLOR%

---+!! Contingency Plan in case of DOEGrids CA service outages and failures.

%BLUE% DRAFT 1, 8 June 2009 %ENDCOLOR%

---++!! Contents
%TOC%

---++ Forward

This document is developed following the guidance in [[http://csrc.nist.gov/publications/nistpubs/800-34/sp800-34.pdf][NIST SP-800-34]],
"Contingency Planning Guide for Information Technology Systems",
and the contingency planning material developed at
Security.IdMContingencyPlanning.


---++ Introduction

---+++ Purpose
This DOEGrids CA Service Replying Party and Registration Authority Contingency Plan ( *RPRACP* ) establishes procedures to mitigate the impact
to OSG operations following a disruption of DOEGrids CA services.  The DOEGrids CA is an important part of the
larger Public Key Infrastructure (PKI) essential to OSG.  The PKI includes many IGTF accredited CAs
as well as the means of distribution of the trust anchors (CA signing certificates and related files).
Because the CA services are operated by ESnet this document has elements of both a contingency plan and
a continuity of operations plan since its purpose is primarily to describe how OSG will continue it's PKI related
activities while service is restored to the DOEGrids CA.
The following objectives have been established for this plan:
   * Maximize the effectiveness of contingency operations through an established plan that consists of the following phases:
      * *Notification/Activation* phase to detect and assess damage and to activate the plan
      * *Recovery* phase to restore partial PKI operations and perform actions to mitigate the impact while normal operations of the DOEGrids CA is restored by ESnet.
      * *Reconstitution* phase to restore OSG Relying Party and Registration Authority to normal operations following re-establishment of DOEGrids CA operations by ESnet.
   * Identify the activities, resources, and procedures needed to carry out Relying Party and Registration Authority processing requirements during prolonged interruptions to normal operations.
   * Assign responsibilities to designated OSG personnel and provide guidance for recovering OSG Relying Party and Registration Authority during prolonged periods of interruption to normal operations.
   * Ensure coordination with other OSG and ESnet staff who will participate in the contingency planning strategies. Ensure coordination with external points of contact and PKI participants who will participate in the contingency planning strategies.

---+++ Applicability
This OSG Relying Party and Registration Authority Contingency Plan applies to the effects on OSG of outages and service failures of the
DOEGrids Certification Authority ([[http://www.doegrids.org][www.doegrids.org]]) and the [[http://www.opensciencegrid.org/ra/][OSG Registration Authority]].

---+++ Scope
---++++ Planning Principles
This document describes what actions OSG should take in the event of a disruption to DOEGrids CA services operated by ESnet.
It also describes what additional preparations OSG can make in order to mitigate the impact of such a future occurrence.

Various scenarios were considered that generally fall into two categories.
   1. Events that cause a functional outage of the service.
      * For these cases the response depends upon the length of the outage.  These are identified as
         * *Case 1* - CA service outage for < 1 week
         * *Case 2* - CA service outage for > 1 week and < 4 weeks
         * *Case 3* - CA service outage for > 4 weeks
   2. Events that corrupt the service or PKI leading to a need to replace certificates for the CA and/or End Entities but the CA service is functional.
      * For these cases the response depends on the nature of the corruption. The two general cases are identified as
         * *Case 4* - some occurrence requires all (or very many) EE certificates to be replaced but the CA certificate is still trusted.
         * *Case 5* - entire PKI is compromised and all EE certificates and the CA certificate must be replaced.
         * *Case 6* - end of service of CA and/or organization running it

---++++ Assumptions

For *Cases 1, 2, 4, 5* we assume that ESnet staff are able to reconstitute the CA service on some timescale.

For *Case 3* we assume that ESnet staff are not able to reconstitute the CA service, possibly due to massive damage by earthquake
and systems and personnel are lost.

---+++ References / Requirements
This contingency plan is modeled after the [[http://csrc.nist.gov/publications/nistpubs/800-34/sp800-34.pdf][NIST SP-800-34]] document.

Planning material for this *CP* is shown at Security.IdMContingencyPlanning.

---+++ Record of Changes

-- Main.DougOlson - 14 May 2009

-- Main.DougOlson - 08 Jun 2009

---++ Concept of Operations

---+++ System Description and Architecture

The DOEGrids Certification Authority is at [[http://www.doegrids.org][www.doegrids.org]] and operated by ESnet.
It supports the issuance and revocation of X509 certificates with a workflow for personal certificates
show [[Security.PersonCertReqWorkFlow][here]].  The workflow for services certificates is similar.

---+++ Line of Succession

The line of succession described here is to ensure that the decision-making
authority for this contingency plan is uninterrupted.
The OSG Security Officer is primarily responsible for the execution of this contingency plan.
In the event that the Security Officer is unavailable the OSG Deputy Security Officer will
be responsible for execution of this plan. If both those are unavailable then the OSG
Executive Director will appoint another person to execute this plan.
At any point in time, the person responsible for executing this plan is called the
_Contingency Plan Coordinator_.

---+++ Responsibilities

The OSG Security Team is responsible for carrying out the actions of this contingency plan.

---++ Notifications and Activation Phase

Characterizing the nature of the occurrence which prompts activation of this contingency plan is
done by the OSG Security Team lead by the Security Officer.

If the occurrence requires notifying all OSG sites and VOs the activation of this plan
is done by authority of the OSG Executive Director (ED).  In absence of the ED the plan
can be activated by the OSG Security Officer.  This applies to *Cases 3, 4, 5*.

If the occurrence does not require notifying the majority of the OSG sites and VOs
the plan can be activated by the OSG Security Officer.  In the absence of the
Security Officer the plan can be activated by the OSG Deputy Security Officer or
by the OSG ED.  This applies to *Cases 1, 2*.

Activation of the contingency plan will include the characterization of the occurrence, the
identification of the _Contingency Plan Coordinator_ and the _Contingency Response Team_ members.
All notifications following the activation of the plan originate with the _Contingency Plan Coordinator_.

The activation of the contingency plan requires notification to the OSG Executive Team (osg-et@opensciencegrid.org)
and the OSG Security Team (osg-security-team@opensciencegrid.org).
In the event that email services are not available notification will happen using contact information
from the OSG Information Management system (oim.grid.iu.edu).

The _Contingency Plan Coordinator_ will nofity ESnet staff that this contingency plan has been activated
and determine who from ESnet should participate on the _Contingency Response Team_.

The _Contingency Plan Coordinator_ will create a web page on the OSG Twiki with appropriate
access controls that the _Contingency Response Team_ will use to post information about the occurrence
and the status of the plan execution, recovery of the CA service, and return to normal operations.

---++ Recovery Operations
This section describes the actions to perform before CA services are restored.
Depending upon the nature of the event disrupting the CA service the characterization
may escalate (or de-escalate) between *Cases 1,2,3*.

---+++ Case 1 - CA service outage for < 1 week

   * Recovery Goal - preserve last good certificate and CRL information
   * Recovery Goal - inform subscribers of alternative CA options
   * Recovery Goal - transition certificate revocation to user banning

---+++ Case 2 - CA service outage for > 1 week and < 4 weeks

In addition to recovery goals for Case 1:
   * Recovery Goal - establish alternative CA service for urgent subscribers

---+++ Case 3 - CA service outage for > 4 weeks
In addition to recovery goals for cases 1 & 2:
   * Recovery Goal - disable CRL checking for DOEGrids CA on OSG sites
   * Recovery Goal - migrate existing DOEGrids CA certificates to an alternative CA

---+++ Case 4 - need replacement for all EE certificates

   * Recovery Goal - if caused by erroneous certificate revocation - generate fixed CRL
   * Recovery Goal - Notify people in order of priority indicated by Gratia accounting system for most used People and Services certificates.

Possible recovery operations are to duplicate public ldap and include PIN for re-issuance. We could notify people of their PIN for getting new certificate. 
Can certs be un-revoked? Jim - RFC5280 says trust anchor for CRL must be trust anchor for certs. OSCP responder signer is different from the EE certs. Can a CRL be signed by a different CA than the one that signed the certificates? - No. 

---+++ Case 5 - need all certificates replaced

   * Recovery Goal - propagate new CA certificate as fast as possible
   * Recovery Goal - Notify people in order of priority indicated by Gratia accounting system for most used People and Services certificates.

We need to work with ESnet on this one. They need to push a new CA cert out. We should determine most urgent & important certificates to issue first. We can get some info on this from  accounting data. In the meantime, we can go to the alternate suppliers such as NERSC, NCSA for people; TACC is catch-all in TG for server certificates.


   * Recover Goal - establish CA services with alternative supplier(s).

---+++ Case 6 - Service End of Life
   * Recover Goal - establish CA services with alternative supplier(s).
   * Recovery Goal - Notify all VOMS administrators that everyone with DOEGrids CA certificates will be getting new certificates.
   * Recover Goal - Notify people in order of priority indicated by Gratia accounting system for most used People and Services certificates.

Consider NERSC, NCSA for people. TACC is catch-all in TG for server certificates. Consider commercial services.


---++ Return to Normal Operations

---+++ Concurrent Processing

---++++ When DOEGrids CA returns to service
   * Verify that new CRL is accurate
   * Publish new CRL in place of any manually generated CRL (if exists)
   * Notify anyone who was previously notified to modify normal CRL handling procedures that the CRL has returned to normal.
   * Notify any VOMS administrators for which user banning was enforced in place of certificate revocation.
   * Notify all certificate holders that were directed to alternate suppliers that DOEGrids CA is back in service.

---++++ When DOEGrids CA is EOL
   * Remove DOEGrids CA from distribution on date specified for CA trust EOL.

---+++ Plan Deactivation
_Contingency Plan Coordinator_ shall notify the OSG Executive Team (ET) that the contingency plan
is deactivated and write a report on the occurance which will be submitted to the OSG ET.

---+++ Plan Appendices


<BLOCKQUOTE>
The appendices included should be based on system and plan requirements.
   * Personnel Contact List
   * Vendor Contact List
   * Equipment and Specifications
   * Service Level Agreements and Memorandums of Understanding
   * IT Standard Operating Procedures
   * Business Impact Analysis
   * Related Contingency Plans
   * Emergency Management Plan
   * Occupant Evacuation Plan - N/A
   * Continuity of Operations Plan.
</BLOCKQUOTE>

---++++ Personnel & Vendor Contacts
Telephone numbers for OSG staff are kept in oim.grid.iu.edu.

   * OSG Security Officer and Security Team (security@opensciencegrid.org, osg-security-team@opensciencegrid.org, osg-ra@opensciencegrid.org)
   * OSG Executive Team (osg-et@opensciencegrid.org)
   * ESnet ATF & Management
      * Mike Helm (M_Helm@lbl.gov), ATF Lead
      * Dhiva M (dhiva@es.net), CA operator
      * Steve Cotter (PCotter@lbl.gov), ESnet Department Head

---++++ Service Agreement between OSG and ESnet
TBD

---++++ Service Agreement between OSG and alternate CA service providers
TBD






----------------------------

-- Main.DougOlson - 11 May 2009

   * Set ALLOWTOPICVIEW = Main.SecurityTeamGroup, Main.MichaelHelm, Main.DanPeterson, Main.DhivakaranMuruganantham, Main.RuthPordes, Main.BrianBockelman, Main.FkW, Main.JohnHover, Main.DanFraser, Main.RobQ, Main.ChanderSehgal, Main.VonWelch
   * Set ALLOWTOPICCHANGE = Main.SecurityTeamGroup, Main.VonWelch    
   * Set DENYTOPICVIEW = Main.TwikiGuest