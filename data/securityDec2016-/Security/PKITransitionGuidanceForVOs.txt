%META:TOPICINFO{author="MineAltunay" date="1352317913" format="1.1" version="1.2"}%
%TOC%

---++OSG PKI Transition Guidance for VOs

This document provides the overall guidance for VOs regarding the OSG PKI Transition. It describes the tasks that a VO should consider in order to perform a smooth transition. Although OSG provides documentation for end users and system administrators, there are still some tasks that are specific for a VO and should be decided and documented by the VO management. This document lists such VO-specific tasks and guides VOs to plan for such tasks. In addition, this document provides a list of complete steps that needed to be taken by end users and system administrators to complete the transition.   

---+++ VO-Specific Tasks 

---++++ Tasks Related to Services/Hosts

   1 Identify the services that has a service and host certificate from DOEGrids CA. 
   2 Make a list of the expiration dates for the host/service certificates. Remind the service operators to keep an eye on the list. It is very important that the system administrators will obtain new host/service certificates from OSG CA before the expiraton date. We suggest that replacement certificates from OSG CA should be obtained a month before the expiration date of the current certificates. 
   3 Identify the services that authorizes end users based on end user certificates. These services will have to register new user certificates as the users obtain new certificates from OSG CA. For example, CMS VO has a list of VOMS, GGUS ticketing system, CERN twikis and indico service, and various other services that all uses certificates to authorize users. It is the VO's responsibility to identify all such services and produce documentation tailored for a specific service. 
   4 Encourage service operators to first build a test instance of the services that they run and perform the changes in the test instance.
   5 Direct service operators to OSG documentation on how to obtain [[https://confluence.grid.iu.edu/display/CENTRAL/User+Guide][host/service certificates]].  OSG has a web-based request form that you can make certificate requests at. If you prefer commandline tools to request and retrieve your certificates, follow the instructions on https://twiki.grid.iu.edu/bin/view/Operations/OSGPKICommandlineClients.
   6 Once new service/host certificates are installed, the service operators should also update the list of trusted root Certificate Authorities. This step will allow the service to accept and trust the DigiCert trust roots, DigiCert root and intermediate Certificate Authorities. 
      6.1 For a grid resource, simply do a *yum update osg-ca-certs* or *yum update osg-ca-certs-compat* depending on your system's openssl version. This will update your /etc/grid-security/certificates directory with the latest CA files form OSG. If you do not use rpms, get the CA tarballs by following instructions at https://twiki.grid.iu.edu/bin/view/Documentation/Release3/InstallCertAuth
      6.1 If this is not a grid resource, e.g. a web service, then download the trust roots from http://digicert-grid.com/. Follow the instructions specific to your service to add the CA certificates.
   7 On grid resources, update the vomses files. Vomses file has a list of all VOMS servers and their certificate DNs. As VOMS servers will change their own certificates from DOEGrids CA to OSG CA, vomses file will be updated. The OSG Grid Operation Center updates and distributes the most recent vomses file at http://software.grid.iu.edu/pacman/tarballs/vo-package/vomses 
   8. End User Authorization. Document the steps necessary for the services (identified in #3) to register the new user certificates. Consider whether a service can and should register multiple certificates for a single user. Some services simply do not have the capability to do so. 
      8.1 In particular, we strongly recommend that VOMS+VOMRS server should not try to register multiple certificates for a single user account. Instead, the VOMS Admin should create a separate VOMS user account for each user certificate. This is because the GUMS server version installed at most OSG sites cannot handle multiple certificates downloaded from the VOMS servers. We will provide additional instructions on how to achieve this. 
      8.2 As a result of having separate VOMS accounts for each user certificate, each user certificate will be treated as a separate user at a grid site. In other words, each certificate will be mapped into a separate local unix account at a grid site. Consider if this is suitable for your VO operations. If it is necessary for your users to link suh accounts, please notify OSG PKI team and we will help you work with sites. Sites can manually change ser mappings to make sure all user certificates are mapped into the same unix account.  
      8.3 Grid resources (CE/SE) will receive the new user certificate DNs directly from the VOMS servers. The system admins will not have to do anything specifically
      8.4 Non-grid services need to be updated manually by the system admin. If you have services such as twiki, ticketing systems, etc, provide documentation for your service operators on how they should register new user certificates. 
   9 Test whether the services are accessible via new OSG CA certificates
   10 If everything works well, apply the changes to production servers.
---++++End User Transition Tasks

end users will have to obtain new certificates as their existing certificates expire. Once obtained the new certificates, the users will have to register their new certificates with VO services that perform user authorization based on user certificates. It is crucial that the VO management identify all such services that does certificate-based authorization. The service operators should be informed that they need to register new user certificates. Also, end users should be alerted that they need to register their certificates with these services. Some services 

---++++  






-- Main.MineAltunay - 07 Nov 2012
