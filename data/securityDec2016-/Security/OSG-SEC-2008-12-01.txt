%META:TOPICINFO{author="AashishSharma" date="1228782846" format="1.1" version="1.9"}%
%META:TOPICPARENT{name="IncidentInformation2008"}%
%TOC%
---+ OSG-SEC-2008-12-01

OSG was notified on November 30th, 2008 by fellow grid sites about increased activity in account compromise, root compromise and installation of backdoors on non-OSG systems. OSG acted to inform sites about the activity and verify that compromises have not spread from fellow grid sites to OSG. DFN-CERT/CERNCERT released an advisory with details (see below).

---++ Status

<!--
Suggested status labels:
NEW: Initial report is received but incident is not confirmed.  This is a triage phase.
OPEN: The existence of a security incident requiring response has been confirmed. The response is underway.
RESOLVED: The incident has been resolved but the final report has not been submitted.
CLOSED: The final report has been submitted.
--> 

   * *Status*: RESOLVED 
   * *Lead*: Aashish Sharma
   * *Responders*: Mine , Jim Basney, Keith Chadwick, 
   * *References*: OSG GOC Ticket #6083. This incident is related to [[OSG-SEC-08-05-2008]].

This incident began with notification that user account Carleton E. Detar's account was compromised in Teragrid. This user also has credentials and certificates issued by Fermi Lab use in OSG:                                 
                                                                                                              
"/DC=gov/DC=fnal/O=Fermilab/OU=People/CN=Carleton E. Detar/CN=UID:detar"    

---++ Analysis

   * *Severity*: Medium (impact on user account, grid stability not at risk) 
   * *Urgency*: High:  (Since this was on going incident it was necessary to determine that users account was not compromised in OSG realm)

---++ Mitigation Plan

We had to make sure if user Carleton E. Detar had Fermi Lab certificate stored in his compromised account on Teragrid. Also, determine if the user has used his certificate in previous 7 days. 

The user has two certificates : DOEgrids and FNAL issued KCA cert.                                            
The DOEGrids cert was already expired in october.

---+++ Actions to take

Needed to make sure FNAL issued KCA and users Fermi lab issued kerberos credentials are not compromised or stored in Teragrid compromised account home directories. 

---+++ How to monitor progress

Responders should report their actions back to the incident lead. 

---+++ Acceptable response time estimate

Since this was a compromise account, we need to clarify the user activity as soon as possible. 

---+++ List of affected parties

Carleton E. Detar, OSG, Fermi Lab, Teragrid

---+++ Definition of End Of Event

Making certain that users credentials are not compromised in Fermi Lab or outside TG. 

Confirmation from Fermi lab: The FNAL issued KCA cert was NOT in TG account. 

<verbatim>
Date: Tue, 02 Dec 2008 17:03:46 -0600                                                                         
From: Keith Chadwick <chadwick@fnal.gov>                                                                      
Subject: Re: [SECTY-DISCUSS-OSG_LIMITED_DISTR] TG incident may affect OSG-                                    
 small  chance                                                                                                
In-reply-to: <4935BB40.2060909@fnal.gov>                                                                      
To: Mine Altunay <maltunay@fnal.gov>,                                                                         
        SECURITY-DISCUSS-L@OPENSCIENCEGRID.ORG 

At 4:48 PM -0600 12/2/08, Mine Altunay wrote:
>TG informed us that they discovered a security compromise late last
>night. User Carleton Detar's account at TG is compromised.
>
>The user has two certificates : DOEgrids and FNAL issued KCA cert.
>The DOEGrids cert was already expired in october.
>
>The FNAL issued KCA cert was NOT in TG account. However, there is a
>small  chance if the attacker could access this user's Fermilab account
>from compromised TG account. This is a small likelihood because Fermilab
>uses kerberos authentication and attacker could not gain Fermilab
>password for getting a Kerberos ticket.
>
>Nevertheless , I informed FNAL security team to check if there is a
>problem with this user's FNAL account.
>
>The user is a member of fermilab VO. any of the OSG sites who maps
>Fermilab VO users would allow access to this users FNAL kca cert. His
KCA cert is registered with Fermilab VO.
>
>I will wait until fermilab confirms the user's Kerberos password is
>compromised I am hoping to hear by tonight. In that case we will make an
>announcement to OSG sites to block access and ask fermilab VO to remove
>this user from their VOMS server.

The method to do this is to get the Fermilab CST to "revoke" his
Kerberos account - set it to disallow all tickets and disable the
account in the KDC.

That will automatically remove the affected user from the VO.

No additional action is necessary or required on the part of the
fermilab VO administrators.

-Keith.

>____________________________________
>Here is some additional information about user cdetar [ Carleton E. Detar ]:
>
>The machines we see cdetar logging in to NCSA from fnal are:
>
>- 131.225.202.12  cdetar    lqcd.fnal.gov
>- 131.225.202.1   cdetar    kaon1.fnal.gov
>
>Compromised login from account cdetar was using password based
>authentication. However, looking back at the spread of smiliar incidents
>we would consider all ssh-auth keys  for this user to be compromised as
>well.
>
>We do not have any evidence that users certificate has been compromised.
>We don't see it being used.
>
>Here is the recommendation:
>
>1) user cdetar should change all his passwords and keys - also its
>recommended that user put passphrase on the keys
>2) Flows for both fnal machines should be checked for connections to and
>from: 209.181.189.198 and  209.160.40.14
>3) cdetar should also try to account for all the logins on his systems
>and see if there is any IP address / timestamp which he cannot account for.
>
>
>--
>Mine Altunay, PhD
>Fermi National Laboratory
>Pine and Kirk Roads, Batavia, IL
>Offices: FCC 364 and W8E
>Phone: 630-840-6490
>Cell: 630-200-4687
>
>
>Content-Type: application/x-pkcs7-signature; name="smime.p7s"
>Content-Disposition: attachment; filename="smime.p7s"
>Content-Description: S/MIME Cryptographic Signature
>
</verbatim>

<verbatim>

Date: Tue, 02 Dec 2008 17:07:32 -0600                                                                         
From: Keith Chadwick <chadwick@fnal.gov>                                                                      
Subject: Re: [SECTY-DISCUSS-OSG_LIMITED_DISTR] TG incident may affect OSG-                                    
 small  chance                                                                                                
In-reply-to: <p0624080fc55b6e7d35c4@[131.225.82.8]>                                                           
To: Keith Chadwick <chadwick@fnal.gov>,                                                                       
        SECURITY-DISCUSS-L@OPENSCIENCEGRID.ORG     
                                                                                                             
I have reviewed the last ~31 days of the voms service logs on voms.fnal.gov,                                  
and find no evidence of the suspect DNs obtaining voms-proxy-init                                             
proxy credentials for any of the VOs that are supported on this VOMS                                          
server.                                                                                                       
                                                                                                              
-Keith.                                                      
</verbatim>

Dec 5th Notification from Prof. DeTar highlighting all the compromised credentials:

1) Fermi KCA 
2) Valid DOEGrids cerdentials 


<verbatim>
While the DOEGrids credentials we found in Professor DeTar's account at
NCSA were expired, he confirms that he had valid DOEGrids credentials on
his home workstation. I have revoked the certificate:

Serial Number: 0x67C0
Issuer: CN=DOEGrids CA 1,OU=Certificate Authorities,DC=DOEGrids,DC=org
Validity:
  Not Before: Tuesday, September 23, 2008 7:01:30 AM PDT US/Pacific
  Not  After: Wednesday, September 23, 2009 7:01:30 AM PDT US/Pacific
Subject: CN=Carleton DeTar 750433,OU=People,DC=doegrids,DC=org

Professor DeTar will be obtaining a new DOEGrids certificate with a new
private key but the same DN.

As Mine states, this certificate is not mapped to any OSG VOs, so this
is not an OSG operational concern.

Mine Altunay wrote:
> 1. Fermi KCA disabled this person's ability to request KCA certificates
> as of 12/5 10:24pm
> 
> 2. Fermi confirmed they did not issue this person a KCA cert past 7 days
> (the lifetime of a KCA certs) on Dec 3.
> 
> 2. His DOEGrids certificate has expired on Oct 14 of 2008. OSG is not
> concerned about his DOEgrids cert. Because only his Fermi issued KCA
> cert is mapped in Fermilab VO.
> 
> 3. He is a member of Fermilab VO. Fermilab VO suspended his membership
> 12/5 10 pm.
> 
> 4. I requested a list of KCA certs granted to this user from Fermi KCA.
> We can alert our site admins to check retroactively whether they have
> been compromised in the past months. if there was any activity from his
> DN. If Fermi confirms no cert was issued since September, the incident
> is closed from our perspective.
> 
> 5. During TG incident, we never confirmed that his Fermilab KCA cert was
> indeed compromised. His KCA was not in his TG account that got
> compromised. We just took some precaution to check his KCA cert and
> contacted Fermi KCA. See #2.
> 
> 6. I checked Gratia records and found no activity from this user.
> 
> 
> I think we should make an additional precautionary announcement to our
> sites, for checkign their past logs for this user's KCA cert. Apart from
> that, I do not take any other actions at this moment.
> 
> 
> 
> 
> ------------------------------------------------------------------------
> 
> Subject:
> Fwd: Carleton DeTar - multiple compromised accounts
> From:
> Keith Chadwick <chadwick@fnal.gov>
> Date:
> Fri, 05 Dec 2008 20:39:50 -0600
> To:
> computer-security@fnal.gov, Fermilab Nightwatch <nightwatch@fnal.gov>
> 
> To:
> computer-security@fnal.gov, Fermilab Nightwatch <nightwatch@fnal.gov>
> 
> 
> Note that this includes Carleton's Kerberos principal.
> 
> I'm going to page FCIRT/Mike Diesburg.
> 
> -Keith.
> 
>> Date: Fri, 05 Dec 2008 19:19:17 -0700 (MST)
>> From: detar@physics.utah.edu
>> Subject: possible compromised account
>> Sender: owner-lqcd-admin@listserv.fnal.gov
>> To: security@ncsa.uiuc.edu, marg@tacc.utexas.edu, issues@chpc.utah.edu,
>>  rdm@phys.columbia.edu, lqcd-admin@fnal.gov, security@jlab.org,
>> iso@iso.utah.edu
>> Cc: detar@physics.utah.edu, brad@physics.utah.edu, bowman@math.utah.edu,
>>  beebe@math.utah.edu
>> X-Greylist: Sender IP whitelisted,
>>  not delayed by milter-greylist-4.0 (mail.physics.utah.edu
>> [127.0.0.1]); Fri,
>>  05 Dec 2008 19:19:19 -0700 (MST)
>> List-Owner: <mailto:LQCD-ADMIN-request@LISTSERV.FNAL.GOV>
>> List-Subscribe: <mailto:LQCD-ADMIN-subscribe-request@LISTSERV.FNAL.GOV>
>> List-Unsubscribe:
>> <mailto:LQCD-ADMIN-unsubscribe-request@LISTSERV.FNAL.GOV>
>> List-Archive: <http://listserv.fnal.gov/scripts/wa.exe?LIST=LQCD-ADMIN>
>> List-Help: <http://listserv.fnal.gov/scripts/wa.exe?LIST=LQCD-ADMIN>,
>>  <mailto:LISTSERV@LISTSERV.FNAL.GOV?body=INFO LQCD-ADMIN>
>>
>> I have just learned that my home workstation has been compromised and a
>> sophisticated key logger was installed.  It appears that the compromise
>> dates from September and the targets were Redhat 4 machines.
>>
>> We were alerted to this possibility earlier this week when TACC called us
>> and reported that NCSA was investigating a possible unauthorized login to
>> my account on abe.ncsa.uiuc.edu.  I have been in contact with Jeff
>> Rosendale there.  A keylogger on aquila is very likely the mode of entry
>> at NCSA.
>>
>>
>> Unfortunately, because a keylogger was in use, any of my accounts that I
>> have accessed from aquila since September are vulnerable or may already
>> have been accessed.  All of my passwords are unique and strong, so only
>> accounts I may have accessed in the past two months are suspect.  But
>> there are a bunch of them. These are
>>
>> Utah physics department machines
>>
>> NCSA
>> cdetar@abe.ncsa.uiuc.edu
>>
>> Utah CHPC:
>> Unid password
>> arches cluster and updraft
>>
>> SDSC
>> u2219@tg-login.teragrid.sdsc.edu
>> u2219@bglogin.sdsc.edu
>>
>> JLab
>> cvs.jlab.org
>> detar@login.jlab.org
>> detar@qcdi01.jlab.org
>>
>> Columbia University
>> cvs server for viewvc and hotqcd
>> detar@qcdserver?.phys.columbia.edu
>>
>> FNAL
>> kerberos password
>> detar@kaon1.fnal.gov
>> detar@lqcd.fnal.gov
>>
>> TACC:
>> tg455530@ranger.utexas.edu
>>
>> grid certificate
>>
>> I have not noticed any suspicious activity in any of these accounts.
>>
>> As far as I know, I have no sensitive data or information in any of these
>> accounts.
>>
>> Actions being taken at Utah:
>>
>> We have disconnected aquila from the network.  We will be reformatting
>> the
>> hard drive and installing Redhat 5.
>>
>> Actions being taken elsewhere:
>>
>> I am in the process of changing passwords on all of the above accounts
>> and
>> services.
>>
>> Sincerely,
>> Carleton DeTar
>> Professor of Physics
>> Department of Physics
>> University of Utah
>> 801-581-7537 (office)
>> 801-521-8218 (home)
>> 801-244-4912 (cell)

</verbatim>

---++ Incident Log

   * Nov 30: OSG notified about compromise account 
   * Dec 1: OSG starts investigation extent of compromise of user account  
   * Dec 2: Confirmation that user doesn't have Fermi KCA and users (C. Detar) Fermi Kerberos account is not comromised 
   * Dec 2: Threat level changed to low-medium, OSG is unaffected 
   * Dec 3: Received confirmation regarding formal incident accouncement from CERNCERT
   * Dec 4: [[CERNCERT-20080805]] Announcement released
   * Dec 5: A follow up OSG Announcement regarding [[CERNCERT-20080805]] sent to OSG security contacts
 
---++ Summary

   * *Final Report*: [[https://osg-docdb.opensciencegrid.org:440/][OSG !DocDB Document ###]]

_What was the resolution of the incident?_

<verbatim>

Because this user has no KCA certificate issued, there is no risk                                             
involving OSG.                                                                                                
                                                                                                              
From OSG perspective I am ready to close this incident.                                                      
                                                                                                              
Once TG incident response team approves, I like to send a precautionary                                       
announcement to OSG sites concerning malicious IP addresses. There is no                                      
need to mention this user's name or OSG KCA cert as there is no OSG                                           
incident. I rather like our sites to watch for ongoing attacks from                                           
malicious IPs.                                                                                                
                                                                                                              
Aashish Sharma from TG incident response team will prepare a message and                                      
we can broadcast it to our security contacts in OSG once we approve it.                                       
                                                                                                              
Thank you all                                                                                                 
(if you are confused Aashish is also a member of OSG incident response                                        
team too. )                                                                                                   
                                                                                                              
--                                                                                                            
Mine Altunay, PhD                                                                                             
Fermi National Laboratory                                                                                     
Pine and Kirk Roads, Batavia, IL                                                                              
Offices: FCC 364 and W8E                                                                                      
Phone: 630-840-6490                                                                                           
Cell: 630-200-4687          



</verbatim>

Detailed description of issue 

<verbatim>
Date: Tue, 2 Dec 2008 17:48:47 -0600                                                                          
From: Aashish Sharma <aashish@ncsa.uiuc.edu>                                                                  
To: Mine Altunay <maltunay@fnal.gov>                                                                          
Cc: Jim Basney <jbasney@ncsa.uiuc.edu>, cst <computer-security@fnal.gov>,                                     
        "SECURITY-DISCUSS-L@OPENSCIENCEGRID.ORG" <SECURITY-DISCUSS-L@OPENSCIENCEGRID.ORG>,                    
        security@ncsa.uiuc.edu                                                                                
Subject: Re: FNAL-TG incident                                                                                 
In-Reply-To: <4935B4FB.2070008@fnal.gov>   
Hello Mine & All: 

On Nov 30th NCSA and TG security team were notified by Caltech (RuthAnne Bevier) regarding IP address 

- 209.160.40.14
- 209.181.189.198 

as she saw phlanax root kit alert triggered by her sensors, trigger alert looked like this:

pHALANX2!!209.160.40.14!21+++++  

On investigating both IP address here at NCSA's tg resources and our flows we determined 
that there are a few hosts in NCSA were had connections from both IP address. 

Also we saw a Teragrid user Carleton E. Detar who also had Fermi Lab account: 

"/DC=gov/DC=fnal/O=Fermilab/OU=People/CN=Carleton E. Detar/CN=UID:detar" 

The machines we see cdetar logging in to NCSA from fnal are:                                                  
                                                                                                              
- 131.225.202.12  cdetar    lqcd.fnal.gov                                                            
 - 131.225.202.1   cdetar    kaon1.fnal.gov                                                                    

Please Note: We do not have any evidence that these fnal.gov machines are compromised.
I will recommend to check flows and hosts for an anomalous activity. 

Here is the log line from NCSA's host for the compromise account: 

Nov 30 19:50:11 xxxxx sshd[3685]: Accepted password for cdetar from 209.181.189.198 port 2437 ssh2 

Both these IP address [ 209.160.40.14, 209.181.189.198 ] are malicious IP addresses.
 We have determined phalanx root kit on the machines which were making connections
 to these IP address. 

Look for these additional IP addresses which are also malicious and have made connections 
to phalanx rootkit on compromised machines: 

- 209.160.40.14   - m81.nearbygalaxies.org                                                                      
- 209.181.189.198 - ASN-QWEST - Qwest Communications Corporation                                                
- 207.224.103.198 - ASN-QWEST - Qwest Communications Corporation  
- 69.129.17.242   - h69-129-17-242.wnstmn.dsl.dynamic.tds.net
- 69.49.172.31 - 69.49.172.31.swcp.com - AS10381 SWCP-AS - Southwest Cyberport 

[ Activity seen around Sept 30th 2008 ] 

- 137.248.152.49 - pc15854.Chemie.Uni-Marburg.DE 
- 132.239.95.85 - npc.ucsd.edu 

As of phalanx rootkit - it hides itself fairly well. Most useful way for investigation is either imaging 
the disk or knoppix. Typical signatures for the rootkit are:

Things to Look for: 

- pHALANX2 - in clear text on port 22 in network traffic 
- /usr/lib/heahu.p2  directory 
- files .p2rc, .sniff, .p-2.2c in the heahu.p2 hidden directory 

Another signature we saw on a separate machine: 
- /usr/lib/huuuh.p2 (directory) 
- /usr/lib/huuuh.p2/.sniff (file) 

We are still looking through the data. Will keep you updated. Please let me know if you 
have any questions. 

Thanks, 

Aashish Sharma

NCSA & OSG Security Team
217-244-8838 
http://www.ncsa.uiuc.edu/~aashish/aashish-pubkey.asc 



On Tue, Dec 02, 2008 at 04:21:47PM -0600, Mine Altunay wrote:
> Jim
> what makes TG think that this user's TG account is compromised.
> I am asking this as a FNAL security person. FNAL will need as much
> information as possible to investigate if the incident involves FNAL
> account or not
> -- 
> Mine Altunay, PhD
> Fermi National Laboratory
> Pine and Kirk Roads, Batavia, IL
> Offices: FCC 364 and W8E
> Phone: 630-840-6490
> Cell: 630-200-4687
> 

</verbatim>
What is the long-term mitigation plan (including changes in our operations, middleware or anything
 else that enabled the event) and timeline?

Monitor for the IP address and user account activity and look for anamolies. 

<verbatim>

Email Announcement from DFN-CERT

** PLEASE DO NOT REDISTRIBUTE **  CERNCERT-20080805                                                           
                                                                                                              
** This message is sent to the CSIRTs of affected grid infrastructures and                                    
sites and must NOT be publicly archived **                                                                    
                                                                                                              
Dear CSIRTs,                                                                                                  
                                                                                                              
The information below was kindly provided by the DFN CERT (NREN in                                            
Germany), the SWITCH CERT (NREN in Switzerland), the EGEE Operational                                         
Security Coordination Team, the OSG security team, CfA Harvard, ISI                                           
University of South California, CERN security team and several CSIRTs                                         
from various sites.                                                                                           
                                                                                                              
*******************************************************                                                       
* What's new since the last update                            *                                               
*******************************************************                                                       
                                                                                                              
- Further attacks discovered                                                                                  
- New suspicious IP addresses                                                                                 
- Updated rootkit                                                                                             
- Updated tools                                                                                               
                                                                                                              
******************************                                                                                
* Further attacks discovered *                                                                                
******************************                                                                                
                                                                                                              
* ETH (Switzerland) affected (September)                                                                      
                                                                                                              
Several accounts have been compromised at ETH, and connections from a                                         
known malicious IP addresses have been detected between 2008-08-31                                            
23:49:54 - 2008-09-15 13:04:57 (UTC+2).                                                                       
                                                                                                              
* Another peer grid site attacked              
A partner grid site is reporting malicious connections on 2008/11/30 from:                                    
                                                                                                              
209.160.40.14   - m81.nearbygalaxies.org                                                                      
209.181.189.198 - ASN-QWEST - Qwest Communications Corporation                                                
                                                                                                              
* Malicious connections against NCSA                                                                          
                                                                                                              
NCSA reported successful connections from the IP addresses above.                                             
Investigations revealed a root compromised host running a new version (2.2c) of                               
the rootkit, which had been installed on 21st September.                                                      
                                                                                                              
* Malicious connections against CERN                                                                          
                                                                                                              
Based also on the information above, CERN has noticed malicious connections                                   
from a known malicious IP address on 2008-12-02 to one CERN account.                                          
However there is no evidence the attacker gained root access on the targeted                                  
host at CERN.                                                                                                 
                                                                                                              
************************************************                                                              
* New suspicious IP addresses as of 2008-12-04 *                                                              
************************************************                                                              
                                                                                                              
It is believed the attacker logged in from:                                                                   
                                                                                                              
- 64.72.120.48                                                                                                
- 137.248.152.49  [ pc15854.Chemie.Uni-Marburg.DE ]                                                           
- 132.239.95.85    [ npc.ucsd.edu ]                                                                           
- 69.49.172.31                                                                                                
- 207.224.103.198                                                                                             
- 69.129.17.24                                                                                                
- 209.160.40.14                                                                                               
- 209.181.189.198                                                                                             
- 189.6.137.174                                                                                               
- 190.81.35.90                                                                                                
- 202.51.211.2                                                                                                
- 131.142.42.17 (?)                                                                                           
                                                                                                              
The known list of suspicious IP addresses is now:                                                             
                                                                                                              
- 83.134.152.127                                                                                              
- 69.130.104.157                                                                                              
- 69.130.136.116                                                                                              
- 69.130.130.117                                                                                              
- 69.130.104.49                                                                                               
- 69.130.104.157 - h69-130-104-157.lkvlms.dsl.dynamic.tds.net                                                 
- 69.130.182.213 - h69-130-182-213.cytnin.dsl.dynamic.tds.net                                                 
- 69.130.80.36   - h69-130-80-36.kgldga.dsl.dynamic.tds.net                                                   
- 64.27.17.70    - vpn2.pcwerk.com                                                                            
- 208.35.255.106                                                   
- 208.35.255.106                                                                                              
- 66.230.230.230                                                                                              
- 209.181.122.222                                                                                             
- 207.225.248.150                                                                                             
- 207.206.202.54                                                                                              
- 207.206.215.122                                                                                             
- 207.224.215.94                                                                                              
- 209.181.138.229                                                                                             
- 209.181.131.209                                                                                             
- 209.181.242.70                                                                                              
- 208.42.23.94   - v-208-42-23-94.mn.visi.com                                                                 
- 99.236.185.205                                                                                              
- 99.237.220.123                                                                                              
- 208.42.23.94                                                                                                
- 216.184.13.238                                                                                              
- 216.186.49.132                                                                                              
- 75.60.89.233                                                                                                
- 136.159.55.31                                                                                               
                                                                                                              
Note that there are now several IP addresses in the 69.130 network                                            
block. Any connection from this location should be treated as suspicious                                      
and reported.                                                                                                 
                                                                                                              
* Update rootkit *                                                                                            
                                                                                                              
It is believed the attacker is now using a new version "2.2c" of the Phalanx2                                 
rootkit.                                                                                                      
It hides in different locations (ex: /usr/lib/heahu.p2/, /usr/lib/huuuh.p2,                                   
etc.).                                                                                                        
                                                                                                              
While the attacker has mostly been concentrated on SSH keys, it seems now that                                
standard passwords are being sniffed and reused.                                                              
                                                                                                              
At least the 64bit version of the 2.2c backdoor does not support                                              
some characters and should segfault using this command:                                                       
                                                                                                              
(echo SSH-2.0-OpenSSH_3.8.1p1; sleep 1; echo 'pHALANX2!                                                       
'kill_phalanx2'+++++++++++++++'| cut -c 1-31; sleep 1; echo                                                   
'test'; cat)|nc <POSSIBLY_INFECTED_HOSTNAME> 22                                                               
                                                                                                              
(<POSSIBLY_INFECTED_HOSTNAME> is the hostname that is checked for signs of the                                
rootkit)                                                                                                      
                                                                                                              
The resulting syslog message on <POSSIBLY_INFECTED_HOSTNAME> would look like:                                 
<DATE> <POSSIBLY_INFECTED_HOSTNAME> kernel: <malicious_kernel_thread>: segfault                               
at                                                                                                            
0000000000000000 rip 0000000000418900 rsp 0000007fbfff8698 error 4                                            
                                                                                                              
Once the host has been probed, the existence of such a syslog message is a very                               
strong indication it has been infected by the rootkit.                          
                                                                                                              
*************************************************                                                             
* Suspicious SSH key and rootkit detecting tool *                                                             
*************************************************                                                             
                                                                                                              
It is possible to use suspicious SSH keys and rootkit detecting tool                                          
provided by the community. The tools on the page below are kindly                                             
provided by their authors and do not come with any guarantee whatsoever,                                      
use it at your own risk!                                                                                      
                                                                                                              
https://cern.ch/osct/7e0564aeabe51c2b1c69570c8d931bf2                                                         
                                                                                                              
Please report any suspicious activity to enable other sites to search                                         
for the patterns you may have detected. This is essential to prevent the                                      
attack from spreading further in the community.                                                               
                                                                                                              
Regards,                                                                                                      
                                                                                                              
Romain Wartel on behalf of the EGEE Operational Security Coordination Team.                                   
--                                                                                                            
Romain Wartel                           Romain.Wartel@cern.ch                                                 
EGEE Operational Security Coordination Team                                                                   
C.E.R.N. http://www.cern.ch/LCG                                                                               
Information Technology Division http://www.eu-egee.org/security                                               
Bat.28-1-012 http://cern.ch/security                                                                          
CH-1211 Geneva 23, Switzerland   

</verbatim> 

Announcement to OSG security contacts:
<verbatim>
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

OSG Security Contacts,

Please be aware of an update regarding CERNCERT-20080805 available at:
https://twiki.grid.iu.edu/bin/view/Security/CERNCERT-20080805

Access to this page requires a TWiki account. If you don't already
have a TWiki account, please see the registration instructions at
https://twiki.grid.iu.edu/bin/view/TWiki/TWikiRegistration or contact
security@opensciencegrid.org. We are distributing this information via
the TWiki in an attempt to avoid leaks. Please do not redistribute
this information or archive it in public email lists.

At this time we are not aware of any compromises of OSG systems
related to these attacks, but we request your continued vigilance
regarding the security of OSG resources. All sites should:

* continue to actively monitor for ssh connection attempts from
  suspicious IP addresses and instances of suspicious ssh keys, files,
  and malware.

* promptly apply security updates from software vendors, including
  operating system kernel updates.

* use firewalls to restrict ssh access to OSG systems, so that ssh
  connections are allowed only from trusted hosts.

* promptly report security incidents involving OSG resources according
  to the instructions at:
  https://twiki.grid.iu.edu/bin/view/Security/IncidentDiscoveryReporting

Please contact security@opensciencegrid.org if you have any questions
or concerns.

Sincerely,
Jim Basney
on behalf of the OSG Security Team
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (Darwin)

iEYEARECAAYFAkk5iMIACgkQs5kqP2b0VszRqACgzcjZkU9x67Q46KBE0QOCUwug
Bm0AoIyBTQCIKrWRTQpR1UrhHKOU/vj6
=iEG1
-----END PGP SIGNATURE-----
</verbatim>

---++ Access Control

_Uncomment the appropriate access control policy for this incident page. Logout of the twiki and try to access the page to ensure it is not publicly accessible. Do not attach files, as they will not be protected (see [[http://twiki.org/cgi-bin/view/TWiki/TWikiAccessControl#Controlling_access_to_Attachment][http://twiki.org/cgi-bin/view/TWiki/TWikiAccessControl#Controlling_access_to_Attachment]])._

Incident information accessible by Security Team members and GOC only:
   * #Set ALLOWTOPICVIEW = Main.SecurityTeamGroup, Main.GocGroup
   * #Set ALLOWTOPICCHANGE = Main.SecurityTeamGroup, Main.GocGroup

Incident information accessible by all authenticated twiki users:
   * Set ALLOWTOPICVIEW = Main.GridGroup
   * Set ALLOWTOPICCHANGE = Main.GridGroup