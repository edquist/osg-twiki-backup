%META:TOPICINFO{author="KyleGross" date="1481047952" format="1.1" version="1.7"}%
%META:TOPICPARENT{name="IncidentInformation2016"}%
%TOC%
---+ OSG-SEC-2016-06-14

Received report of Open Science Grid website at [[http://www.opensciencegrid.org][http://www.opensciencegrid.org]] intermittent outage due to DoS attack between June 11th and June 12th. 

After checking the Apache logs, it was found that the requests lines coming from these IPs are "POST /xmlrpc.php HTTP/1.0"

“xmlrpc.php” is a php script that supports a standard WordPress function to remotely publish posts via email and get pingbacks.
It is widely used to perform brute-force attacks and do password guessing.
"One of the hidden features of XML-RPC is that system.multicall method can be used to execute multiple methods inside a single request.
Attackers are leveraging this method to attempt to guess hundreds of passwords within just one HTTP request."

---++ Status

<!--
Suggested status labels:
NEW: Initial report is received but incident is not confirmed.  This is a triage phase.
OPEN: The existence of a security incident requiring response has been confirmed. The response is underway.
RESOLVED: The incident has been resolved but the final report has not been submitted.
CLOSED: The final report has been submitted.
--> 

   * *Status*: Closed
   * *Lead*: Jeny Teheran
   * *Responders*: Jeny Teheran, Mine Altunay 

_Optionally include additional status information here._

---++ Analysis

   * *Severity*: Low -  OSG website was temporarily down [[http://www.opensciencegrid.org][http://www.opensciencegrid.org]]
   * *Urgency*: Immediate 

Timeline

   * Between 11/Jun 17:07 (eastern) and 12/Jun 11:45 www.opensciencegrid.org was intermittently unavailable.
   * The problem was detected by GOC operations monitoring on Sunday
   * Examination of /var/log/httpd/access_log shows about 60,000 access attempts over a ten hour period from two IP numbers:
      * 191.96.249.54 and 191.96.249.53- - [12/Jun/2016:14:33:23 +0000] "POST /xmlrpc.php HTTP/1.0" 500 251 "-" "Mozilla/4.0 (compatible: MSIE 7.0; Windows NT 6.0)"
      * Quick IP search located IPs at Russia and Chile (possibly a botnet)
   * The service returned to normal operation with no intervention by the GOC. 
   * GOC reported the issue to OSG security through https://ticket.opensciencegrid.org/30260

---++ Mitigation Plan

---+++ Actions to take
The following actions were executed by GOC Operations to stop the attack.

   * Set a maximum simultaneous connection limit in the web server hosting [[www.opensciencegrid.org][www.opensciencegrid.org]]. 
   * Disable the XML-RPC functionality in WordPress

Future actions:
   * Evaluate if there are more servers running important web services that need to be secured.

---+++ How to monitor progress

   * Make sure GOC operations team install the protection mechanisms for web servers.

---+++ Acceptable response time estimate

   * 5 days

---+++ List of affected parties

   * OSG website

---+++ Definition of End Of Event

   * Website is online and responsive. No additional attempts of attack have been detected. Taking corrections on Wordpress installations.

---++ Incident Log

   * Incident was announced and discussed during Operations Meeting on June 13th: https://twiki.grid.iu.edu/bin/view/Operations/Minutes2016June13

<!--
Incident information accessible by Security Team members and GOC only:
   * Set ALLOWTOPICVIEW = Main.SecurityTeamGroup, Main.GocGroup, Main.RobQ, Main.ScottTeige
   * Set ALLOWTOPICCHANGE = Main.SecurityTeamGroup, Main.GocGroup, Main.RobQ, Main.ScottTeige
-->


-- Main.JenyTeheran - 14 Jun 2016