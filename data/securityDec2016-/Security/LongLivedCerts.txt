%META:TOPICINFO{author="KyleGross" date="1480625569" format="1.1" version="1.2"}%
---+ OSG SecurityTeam Team Statement on Long Lived Certificates
---++ Background
Concern has been raised about long-lived proxies being submitted with jobs in OSG.
Some sites would like to limit the use of long-lived proxies. While client side software could be configured to have shorter-lived default lifetimes, and we recommend doing this where possible, that would require all clients to update. The simplest approach would be to provide tools and instructions to site admins to set lifetime limits at the site end.

There is a greater risk in longer-lived proxies, as they could be compromised and used maliciously for a longer period of time. However, shorter-lived certificates can inconvenience legitimate usage. Since all certificates belonging to users suspected of having had proxies on a compromised machine will be revoked and reissued, there is only limited risk in longer-lived proxies.

---++ Risk analysis

*Threat*: Unauthorized access to grid resources

*Vulnerability*: If a long-lived proxy is copied from a worker node, it could be used to authenticate as the user at a later date without the users knowledge.

*Risk*: (Medium) This is a known risk with proxy authentication.

*Mitigation*: Access to grid resources also requires separate authorization controlled via VOMS and CRLs. 
If a machine is known or suspected to be compromised, any certificates issued to any users known or suspected of having proxies on that machine would have their certificates revoked and reissued, thereby deactivating any existing proxies. 
If a user has left the VO, then their removal from the VO’s VOMS server will deactivate any existing proxies.
Sites can reject proxies that have a lifetime longer than their preferred limit, using SAZ or LCMaps filters.

*Residual Risk*: (Low) It is possible a proxy could be copied by a malicious user and saved for later unauthorized access before it expires, without drawing attention to the compromise of the machine. This risk would exist for any proxy lifetime.

---++ Possible Options for Sites

The options for limiting proxy lifetime at the site ar to either configure SAZ to do a proxy lifetime check, or configure the verify-proxy LCMaps plugin to limit proxy lifetime. GUMS could also be modified to limit proxy lifetime. 

Since SAZ is only currently available at Fermilab, until it is packaged and available to other OSG sites, the preferred mechanism for limiting proxy lifetime right now will be with the LCMaps plugins. This should be tested and documented.

SAZ is in the process of being packaged, and may be available in the OSG software repository shortly.

---++ OSG SecurityTeam Team Recommendations
   * The risk from long-lived proxies is rather low, so it will be up to the sites to determine what limit they would like to set, if any. 1 – 7 days would probably be a good target. In addition to site side limits, it would be good to have clients choose shorter lived proxies by default.
   * Log retention on all site systems should be set longer than the certificate lifetime limit at a minimum.
   * When updating client software or configurations, it is recommended to make sure default lifetimes for proxies is set to 1 - 7 days, or less if practical.

<!--
   * Set ALLOWTOPICVIEW = Main.GridGroup    
   * Set ALLOWTOPICCHANGE = Main.SecurityTeamTeamGroup    
   * Set DENYTOPICVIEW = Main.TwikiGuest
-->

-- Main.KevinHill - 24 May 2013
