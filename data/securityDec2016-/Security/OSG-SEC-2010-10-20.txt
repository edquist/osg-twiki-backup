%META:TOPICINFO{author="KyleGross" date="1481047951" format="1.1" version="1.3"}%
%META:TOPICPARENT{name="IncidentInformation2010"}%
%TOC%

---++ Notification Email 

<verbatim>
Introduction
============

Yesterday, Dan Rosenberg released information about a vulnerability in
the RDS module in the Linux kernel, complete with an exploit that on
many systems can give any local user root privileges.
  
This vulnerability has been labeled CVE-2010-3904, and is present on
many Linux distributions, including RHEL/CentOS/SL 5 (but *not* RHEL 3
and 4 and their derivatives). Vendor patches are so far only available
for Ubuntu.


Details
=======

The RDS module, when communicating over an RDS socket, performs
insufficient access permission checks, which lets an attacker
overwrite arbitrary kernel memory. This is easily exploited to give
root privileges.

Please note that the proof-of-concept exploit included in Rosenberg's
advisory does not work on RHEL 5 derivatives because of certain
implementation details, but the vulnerability *is* still present. The
EGI CSIRT has access to a non-public modified exploit that does work
on RHEL 5.


Mitigation
==========

Most systems do not utilize RDS and can simply block the vulnerability
by blacklisting the RDS module (after unloading it if it is present).
Running the following command will display if the module is present:

lsmod | grep '^rds '

If the module is present then sites will need to determine if they need
to use RDS.  Please note that some clusters with Infiniband may actually
use RDS.  In these cases, the only solution is to deploy a patched kernel.

To uninstall/blacklist RDP you can run the following script:

------- BEGIN SCRIPT -----------

#!/bin/sh                                                                                 

# Unload the module if present                                                            
if lsmod | grep -q '^rds '; then
  echo "RDS was loaded"
  rmmod rds 2>/dev/null
  if lsmod | grep -q '^rds '; then
    echo "FAILED to unload RDS"
  else
    echo "RDS was successfully unloaded"
  fi
else
  echo "RDS was not previously loaded"
fi

# Blacklist the module
echo "install rds /bin/true" > /etc/modprobe.d/disable-rds
echo "alias net-pf-28 off" >> /etc/modprobe.d/disable-rds

-------- END SCRIPT ----------

This will take effect immediately and does not require a reboot. The
blacklisting will stay persistent across reboots.


Recommendations
===============

Immediately apply the mitigation described above to all
user-accessible systems.

Apply vendor kernel updates when they become available.


References
==========

Rosenberg's advisory: http://www.vsecurity.com/resources/advisory/20101019-1/             

Red Hat bugzilla: https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2010-3904               

Ubuntu kernel update:
https://lists.ubuntu.com/archives/ubuntu-security-announce/2010-October/001181.html       


This advisory was put together in help with the EGI CSIRT.

Please contact security@opensciencegrid.org if you have any questions
or concerns.
  
This message is digitally signed. We encourage you to verify the
digital signatures on OSG security announcements according to:
    
https://twiki.grid.iu.edu/bin/view/Security/SecureEmail                                   
    
Sincerely,
James J. Barlow
on behalf of the OSG Security Team
</verbatim>

---++ Access Control

_Uncomment the appropriate access control policy for this incident page. Logout of the twiki and try to access the page to ensure it is not publicly accessible. Do not attach files, as they will not be protected (see  [[http://twiki.org/cgi-bin/view/TWiki/TWikiAccessControl#Controlling_access_to_Attachment][http://twiki.org/cgi-bin/view/TWiki/TWikiAccessControl#Controlling_access_to_Attachment]])._

Incident information accessible by Security Team members and GOC only:
   * #Set ALLOWTOPICVIEW = Main.SecurityTeamGroup, Main.GocGroup
   * #Set ALLOWTOPICCHANGE = Main.SecurityTeamGroup, Main.GocGroup

Incident information accessible by all authenticated twiki users:
   * Set ALLOWTOPICVIEW = Main.GridGroup, Main.RomainWartel
   * Set ALLOWTOPICCHANGE = Main.GridGroup, Main.RomainWartel