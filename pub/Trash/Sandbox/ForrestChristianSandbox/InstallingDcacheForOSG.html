<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Chapter 1. Installing a dCache System for the Open Science Grid</title>
  <link rel="stylesheet" href="http://osg.ivdgl.org/bin/viewfile/Sandbox/ForrestChristianSandbox?filename=dcb.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.68.1">
  <meta name="keywords" content="install, dCache, VDT, procedure">
  <style type="text/css" media="all">
  pre { 
    width: 100%
    margin:1em 0; /* Win IE tries to make this bigger otherwise */
  }
  html>body pre { /* hide from IE */
    /*\*/ overflow:auto !important; /* */ overflow:scroll; width:auto; /* for Mac Safari */
  }
  /* IE behavior for pre is defined in conditional comment */
  </style>
<!--[if IE]>
<style type="text/css">
pre {
 overflow-x:auto;
  overflow-y:hidden;
 padding-bottom:expression(this.scrollWidth > this.offsetWidth ? 16 : 0);
}
#patternLeftBarContents li {
 text-overflow:ellipsis;
}
</style>
<![endif]-->
<!--[if lte IE 6]>
<style type="text/css">
#patternLeftBar {
 position:relative; /* IE 5.5 needs this or the contents won't show
outside the parent container on print. IE 6.0 needs it only during
printable copy! */
}
</style>
<![endif]-->

</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="chapter" lang="en">
<div class="titlepage">
<div>
<div><h2 class="title"><a name="Main_Installation_VDTdCache"></a>Chapter 1. Installing a dCache System for
  the Open Science Grid</h2></div><div><div class="authorgroup"><div class="author"><h3 class="author"><span class="firstname">Ted</span> <span class="surname">Hesselroth</span></h3><div class="affiliation"><span class="orgname">Fermi National Accelerator Laboratory<br></span></div></div><div class="author"><h3 class="author"><span class="firstname">Timur</span> <span class="surname">Perelmutov</span></h3><div class="affiliation"><span class="orgname">Fermi National Accelerator Laboratory<br></span></div></div><div class="author"><h3 class="author"><span class="firstname">Neha</span> <span class="surname">Sharma</span></h3><div class="affiliation"><span class="orgname">Fermi National Accelerator Laboratory<br></span></div></div><div class="author"><h3 class="author"><span class="firstname">Michael</span> <span class="surname">Zalokar</span></h3><div class="affiliation"><span class="orgname">Fermi National Accelerator Laboratory<br></span></div></div><div class="author"><h3 class="author"><span class="firstname">E.</span> <span class="othername">Forrest</span> <span class="surname">Christian</span></h3><div class="affiliation"><span class="jobtitle">Writer<br></span><span class="orgname">Fermi National Accelerator Laboratory<br></span></div></div></div></div><div><p class="releaseinfo">vdt-dcache-SL4_32.1.0.2</p></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#Recommended_Hardware">1. System Requirements</a></span></dt><dt><span class="section"><a href="#Designing_Installation">2. Designing Your
    dCache System</a></span></dt><dt><span class="section"><a href="#Getting_package">3. Getting the VDT dCache tar
    pacakge</a></span></dt><dt><span class="section"><a href="#Configuring_Installation">4. Configuring your dCache installation</a></span></dt><dt><span class="section"><a href="#Customizing_Installation">5. Customizing Your dCache
    Installation Process</a></span></dt><dt><span class="section"><a href="#Dryrun_Testing">6. Dryrun Testing of <code class="filename">install.sh</code></a></span></dt><dt><span class="section"><a href="#Installing_VDT-dCache">7. Installing dCache</a></span></dt><dt><span class="section"><a href="#Configuring_Firewalls">8. Configuring firewalls for dCache</a></span></dt><dt><span class="section"><a href="#Starting_dCache_first_time">9. Starting dCache for the first
    time</a></span></dt><dt><span class="section"><a href="#Testing_Installation">10. Testing your dCache
    installation</a></span></dt><dt><span class="section"><a href="#Access">11. Setting up your dCache sytem</a></span></dt><dt><span class="section"><a href="#Cleanup">12. Cleanup</a></span></dt><dt><span class="section"><a href="#Installation_Support">13. Getting Installation Support</a></span></dt><dt><span class="section"><a href="#About_VDT-dCache">14. dCache Details</a></span></dt><dt><span class="section"><a href="#Samples">15. Samples</a></span></dt></dl></div><p>This document describes the process for installing dCache in an Open
  Science Grid site using the dCache scripts. For an overview of dCache, see
  <a href="http://www.dcache.org/manuals/dcache-whitepaper-light.pdf" target="_top">&#8220;<span class="citetitle">dCache, the
  Overview</span>&#8221; (PDF)</a>. For further details on installing dCache
  manually, see <a href="http://www.dcache.org/manuals/Book/in.shtml" target="_top">Installation</a> in
  <em class="citetitle">dCache, the Book</em>.</p><p>Installing dCache can be non-trivial. We suggest following an
  installation workflow that has worked at other sites:</p><div class="procedure"><ol type="1"><li><p>Join the OSG community! Besides the <a href="http://osg.ivdgl.org/twiki/bin/view/Documentation/WebHome" target="_top">OSG
      documentation wiki</a>, <a href="http://osg.ivdgl.org/twiki/bin/view/Documentation/MailingListsSubscribe" target="_top">mailing
      lists</a> exist to tie you in with other grid storage
      administrators.</p></li><li><p>Create your usage policies for storage. Broadly, you will need to
      determine what resources you are sharing, with whom, and at what level.
      A part of this management side of your site design is how your storage
      sytem will handle authentication and authorization, violations,
      precedence and support. The <a href="http://osg.ivdgl.org/twiki/bin/view/Documentation/WebHome" target="_top">OSG
      documentation</a> can help you with this.</p></li><li><p>Determine the architecture for your system: what servers will be
      part of it, in what way; what transfer types will you support, etc. An
      important part of this technical side of your design See <a href="#Designing_Installation">Designing Your
    dCache System</a>.</p></li><li><p><a href="#Getting_package" title="3. Getting the VDT dCache tar
    pacakge">Download the VDT dCache
      package</a> and <a href="#Configuring_Installation" title="4. Configuring your dCache installation">configure
      your installation</a>.</p></li><li><p><a href="#Installing_VDT-dCache" title="7. Installing dCache">Install dCache</a> on
      your site's nodes, and <a href="#Cleanup" title="12. Cleanup">clean-up after any failed
      installations</a>..</p></li><li><p><a href="#Testing_Installation" title="10. Testing your dCache
    installation">Test</a> your new dCache
      system.</p></li></ol></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Recommended_Hardware"></a>1. System Requirements</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#Rec_Hardware_Admin_Pool_Nodes">1.1. Admin &amp; Pool Nodes</a></span></dt><dt><span class="section"><a href="#Rec_HW_pnfs_Node">1.2. pnfs Node</a></span></dt></dl></div><p>The following are the recommended system minimums for an OSG dCache
    installation. All nodes should have Scientific Linux 4.2 or later.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>See <a href="http://cd-docdb.fnal.gov/cgi-bin/RetrieveFile?docid=1837&amp;version=1&amp;filename=dcache_tuning.pdf" target="_top"><em class="citetitle"><em class="citetitle">dCache
      Tuning</em></em></a> (PDF) for recommended Linux
      TCP/IP parameter tuning.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="Rec_Hardware_Admin_Pool_Nodes"></a>1.1. Admin &amp; Pool Nodes</h3></div></div></div><div class="itemizedlist"><ul type="disc"><li><p>Dual CPU or Dual Core Intel Xeon, 2.8GHz or better</p></li><li><p>4 GB RAM or more</p></li><li><p><span class="emphasis"><em>(Admin node only)</em></span> Raided (mirrored)
          system disks, hot swappable with spare recommened</p></li><li><p>Raided data disks, hot swappable with spare recommended
          (needed on the Admin node for the billing database)</p></li><li><p>Gigabit or better network links</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="Rec_HW_pnfs_Node"></a>1.2. pnfs Node</h3></div></div></div><div class="itemizedlist"><ul type="disc"><li><p>8 GB postgres databases on raided disk with back-up performed
          regularly.</p></li><li><p>Disk should be used exclusively for the pnfs database.</p></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Designing_Installation"></a>2. Designing Your
    dCache System</h2></div></div></div><p>Before configuring your site, you will need the following
    information about the architecture of your intended dCache system:
    </p><div class="itemizedlist"><ul type="disc"><li><p>number of <em class="glossterm">administration nodes</em> and
          their <em class="glossterm">Fully Qualified Domain Names</em>;</p></li><li><p>number of <em class="glossterm">door nodes</em> required and what
          types you will support and their Fully Qualified Domain
          Names;</p></li><li><p>number of <em class="glossterm">pool servers</em> and their Fully
          Qualified Domain Names;</p></li><li><p>path for the mount points of the <em class="glossterm">storage
          locations</em> for each pool (each storage location should
          already exist);</p></li><li><p>written site policies for use posted to an externally
          available web page.</p></li></ul></div><p>See the <a href="http://www.dcache.org/manuals/index.shtml" target="_top">dCache manual</a> for
    more information.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Getting_package"></a>3. Getting the VDT dCache tar
    pacakge</h2></div></div></div><p>Obtain the tar package from <a href="http://www-ccf.fnal.gov/~tdh/vdt/" target="_top">Ted Hesselroth's site</a>.
    There are different distributions for Scientific Linux 3 and 4 on both 32-
    and 64-bit hardware:</p><div class="itemizedlist"><ul type="disc"><li><p><code class="uri">http://www-ccf.fnal.gov/~tdh/vdt/vdt-dcache-SL3_32-<i class="replaceable"><tt>&lt;VERSION&gt;</tt></i>.tar.gz</code>
        for Scientific Linux 3 on 32-bit processors</p></li><li><p><code class="uri">http://www-ccf.fnal.gov/~tdh/vdt/vdt-dcache-SL3_64-<i class="replaceable"><tt>&lt;VERSION&gt;</tt></i>.tar.gz</code>
        for Scientific Linux 3 on 64-bit processors</p></li><li><p><code class="uri">http://www-ccf.fnal.gov/~tdh/vdt/vdt-dcache-SL4_32-<i class="replaceable"><tt>&lt;VERSION&gt;</tt></i>.tar.gz</code>
        for Scientific Linux 4 on 32-bit processors</p></li><li><p><code class="uri">http://www-ccf.fnal.gov/~tdh/vdt/vdt-dcache-SL4_64-<i class="replaceable"><tt>&lt;VERSION&gt;</tt></i>.tar.gz</code>
        for Scientific Linux 4 on 64-bit processors</p></li></ul></div><p>Choose the distribution appropriate for your platform.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Although untested, we believe that these should work on other
      similar Linux distributions, especially RedHat Enterprise 3 or 4.</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Configuring_Installation"></a>4. Configuring your dCache installation</h2></div></div></div><p>Configuring your dCache installation involves getting the
    appropriate package for your platform and creating the configuration files
    for the install process. The package comes with a script that creates the
    configuration files for you, based on your site-specific answers to a
    series of questions.</p><p>By running <code class="filename">config-node.pl</code> in the <code class="filename">install</code> directory, the system will create the
    necessary installation configuration files for you. You will need the
    following information: </p><div class="itemizedlist"><ul type="disc"><li><p>The number of <em class="glossterm">administrative nodes</em> you
          need for your site's dCache installation. See [TBD] for more
          information on determining this.</p></li><li><p><span class="emphasis"><em>If do not want to use the recommended distribution
          of services: </em></span>The list of particular dCache services to
          run on particular admin nodes. See ????.</p></li><li><p>The number of <em class="firstterm">door nodes</em> that you will
          be using</p></li><li><p><em class="glossterm">Fully Qualified Domain Names</em>
          (<span class="acronym">FQDN</span>) for each admin node, door node and
          pool.</p></li><li><p>The number of pools that you will be using</p></li><li><p>Full paths on a particular pool server to each
          <em class="firstterm">storage location</em></p></li></ul></div><div class="procedure"><a name="id696859"></a><p class="title"><b>Procedure 1.2. To configure your dCache installation:</b></p><ol type="1"><li><p>Login as root to the machine on which pnfs will run and obtain
        the vdt-dcache gzipped tarball.</p><p><strong class="userinput"><code>wget
        http://www-ccf.fnal.gov/~tdh/vdt-dcache-<i class="replaceable"><tt>&lt;SL4_32-1.0.2&gt;</tt></i>.tar.gz</code></strong></p><p>The file for your platform may have a different name.</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>SRM/dCache must be installed on the pnfs server machine before
          being installed on other machines in your installation.</p></div></li><li><p>Unpack the package.</p><p><strong class="userinput"><code>tar -zxvf
        <code class="filename">vdt-dcache-<i class="replaceable"><tt>&lt;SL4_32-1.0.2&gt;</tt></i>.tar.gz</code></code></strong></p></li><li><p>Change to the <code class="filename">install</code>
        directory and run <code class="filename">config-node.pl</code> to configure
        this node's installation files.</p><p><strong class="userinput"><code>cd</code></strong><code class="filename"><strong class="userinput"><code>./vdt-dcache-<i class="replaceable"><tt>&lt;SL4_32-1.0.2&gt;</tt></i>/install</code></strong></code></p><p><strong class="userinput"><code><code class="filename">./config-node.pl</code></code></strong></p><p>The system will prompt you to answer several questions.</p></li><li><pre class="screen"><code class="prompt">How many admin nodes (non-pool and non-door nodes) do you have? <i class="replaceable"><tt>&lt;SomeInteger&gt;</tt></i></code></pre><p>Enter the number of administrative nodes you want for your
        site's dCache installation.</p><p>If you have more than one admin node, the application will
        recommend a particular division of services across them. Although we
        have found these to be useful, the script allows you to configure the
        admin nodes as you wish.</p></li><li><pre class="screen"><code class="computeroutput">The recommended services for node 1 are: 
<i class="replaceable"><tt>&lt;lmDomain poolManager adminDoor httpDomain utilityDomain gplazmaService infoProvider srm&gt;</tt></i></code>
<code class="prompt">Which services do you wish to run (Enter for defaults)?</code></pre><p>Type the services you wish to run on this node, separated by a
        space. Or, accept the suggested list of services.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>You can change how the services are distributed later, if
          needed.</p></div></li><li><pre class="screen"><code class="prompt">Enter the FQDN node name for node 1: <i class="replaceable"><tt>&lt;server.domain.gov&gt;</tt></i></code></pre><p>Type the Fully Qualified Domain Name (e.g., server.domain.gov)
        for this node.</p><p>Repeat these steps for all admin nodes in your dCache
        system.</p></li><li><pre class="screen"><code class="prompt">How many door nodes do you have? <i class="replaceable"><tt>&lt;SomeInteger&gt;</tt></i></code></pre><p>Type the number of door nodes that you will have in your dCache
        system.</p></li><li><pre class="screen"><code class="prompt">Enter FQDN of door number 1: <i class="replaceable"><tt>&lt;server.domain.edu&gt;</tt></i></code></pre><p>Type the Fully Qualified Domain Name for this door.</p><p>Repeat this for every door node in your system.</p></li><li><pre class="screen"><code class="computeroutput">Enter the private network that the pools are in.</code>
<code class="prompt">If this does not apply, just press enter to skip:</code></pre><p>If your pools are on a private network, type it here.</p></li><li><a name="Configure_PoolsStart"></a><pre class="screen"><code class="prompt">Enter a pool FQDN name (Press Enter when all are done): <i class="replaceable"><tt>&lt;server.domain.com&gt;</tt></i></code></pre><p>Type the Fully Qualified Domain Name for the next pool in your
        system and press enter.</p></li><li><a name="Configure_PoolsStop"></a><pre class="screen"><code class="prompt">Enter the first storage location (Press Enter when all are done)): <i class="replaceable"><tt>&lt;/path/to/storageLocation&gt;</tt></i></code></pre><p>For each pool, you will be prompted to enter the paths of the
        associated storage locations.</p><p>When done entering storage locations for this pool server,
        simply press Enter at the next storage location prompt.</p></li><li><p>Repeat steps <a href="#Configure_PoolsStart">Step 10</a> through
        <a href="#Configure_PoolsStop">Step 11</a> for each pool. When done
        entering data for your pools, simply press Enter at the pool FQDN
        name..</p></li></ol></div><p>The system will create a <code class="filename">site-info-def</code> file.
    (See the <a href="#Sample_config_output" title="15.2. Sample output of
      config-node.pl">sample output from
    config-info.pl</a> and the <a href="#Samplesite-infodefFile" title="15.1. Sample site-info.def file">sample site-info.def file</a>.)</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>If you need to, you can also <a href="#Customizing_Installation" title="5. Customizing Your dCache
    Installation Process">customize the installation
      process</a> for your installation.</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Customizing_Installation"></a>5. Customizing Your dCache
    Installation Process</h2></div></div></div><p>Some dCache options not set by <code class="filename">config-node.pl</code>
    may be set by editing <code class="filename">site-info.def</code> after
    <code class="filename">config-node.pl</code> has been run.</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>Changing any parameter without understanding what it does is very
      risky. Change only those parameters that you need to change and document
      the changes.</p></div><p>The following parameters are the most commonly customized within the
    OSG: </p><div class="variablelist"><dl><dt><span class="term">MAX_FTP_STREAMS</span></dt><dd><p>Defines the maximum number of client streams allowed by
            gridftp.</p></dd><dt><span class="term">GRIDFTP_PRIVATE_NETWORK</span></dt><dd><p>Defines the network portion of the ip on the private network
            of the pools. For example, if the pool's IP addresses are
            192.168.1.x, you would set
            <em class="parameter"><code>GRIDFTP_PRIVATE_NETWORK</code></em> to
            <strong class="userinput"><code>192.168.1</code></strong>.</p></dd><dt><span class="term">USE_MULTI_MOVER_QUEUES</span></dt><dd><p>Sets up the default, WAN and LAN queues on the pools;
            directs gridftp to use WAN; and directs dcap and gsidcap to use
            LAN. If desired, set to <code class="option">yes</code>.</p></dd><dt><span class="term">BILLING_USE_DB</span></dt><dd><p>Causes billing information to be copied to a database as
            well as the log file. If desired, set to
            <code class="option">yes</code>.</p></dd><dt><span class="term">DCACHE_LOG_DIR</span></dt><dd><p>Causes logs for the dCache domain output to be written to a
            specified log directory. The directory must exist before dCache is
            started. Default is <code class="filename">/opt/d-cache/log</code>.</p></dd></dl></div><p>See the <a href="#Samplesite-infodefFile" title="15.1. Sample site-info.def file">sample
    <code class="filename">site-info.def</code> file</a>.</p><p>In addition to customizing <code class="filename">site-info.def</code>
    manually, you can use <code class="filename">etc/node_config.delta</code> and
    <code class="filename">etc/dCacheSetup.delta</code> to change any other lines in
    <code class="filename">etc/node_config</code> or
    <code class="filename">config/dCacheSetup</code>. To do so, add the line or lines
    to the <code class="filename">*.delta</code> file, creating the file if necesary,
    before running <code class="filename">install.sh</code>.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Dryrun_Testing"></a>6. Dryrun Testing of <code class="filename">install.sh</code></h2></div></div></div><p>If you would like to see what the installation script will do but
    not do the actual install, run <code class="filename">install.sh</code> with the
    <code class="option">--dryrun</code> option.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Installing_VDT-dCache"></a>7. Installing dCache</h2></div></div></div><p>This section describes how to install the SRM/dCache tar package for
    OSG.</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>You must install the pnfs manager on your pnfs server before
      installing dCache on other machines. Afterwards, you can install it on
      the other admin nodes, then door nodes and pool servers.</p></div><p>The next step is to install the dCache on every admin node, door
    node, and pool server in your dCache site.</p><p>Repeat these steps on each admin node, door node and pool server in
    your dCache site. You will use the <code class="filename">site-info.def</code> file
    that you just created on the system running pnfs on all the dCache
    servers.</p><div class="procedure"><a name="id697552"></a><p class="title"><b>Procedure 1.3. To install dCache:</b></p><ol type="1"><li><p>Login as root to the machine on which pnfs will run and obtain
        the vdt-dcache gzipped tarball. asdfasdf</p><p><strong class="userinput"><code>wget
        http://www-ccf.fnal.gov/~tdh/vdt-dcache-<i class="replaceable"><tt>&lt;SL4_32-1.0.2&gt;</tt></i>.tar.gz</code></strong></p><p>Replace the filename with that appropriate for your
        environment.</p></li><li><p>Unpack the package.</p><p><strong class="userinput"><code>tar -zxvf
        <code class="filename">vdt-dcache-<i class="replaceable"><tt>&lt;[version]&gt;</tt></i>.tar.gz</code></code></strong></p></li><li><p>Copy the site-info.def file that you created in the
        Configuration process to the <code class="filename">vdt-cache-<i class="replaceable"><tt>&lt;[version]&gt;</tt></i>/install</code>
        directory on this machine.</p></li><li><p>Change to the <code class="filename">install</code>
        directory and run <code class="filename">install.sh</code> to setup dCache on
        this machine.</p><p><strong class="userinput"><code>cd</code></strong><code class="filename"><strong class="userinput"><code>
        ./vdt-dcache-<i class="replaceable"><tt>&lt;[version]&gt;</tt></i>/install</code></strong></code></p><p><strong class="userinput"><code><code class="filename">./install.sh </code></code></strong></p></li></ol></div><p>The install.sh script installs dCache into <code class="filename">/opt/d-cache</code>.</p><p>For more information about the particulars of the installation
    scripts that run., see <a href="#Installation_Scripts">The Installation Scripts</a>.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Configuring_Firewalls"></a>8. Configuring firewalls for dCache</h2></div></div></div><p>See <a href="http:///www.dcache.org/" target="_top"><em class="citetitle">Firewall Configuration</em></a> in <em class="citetitle">dCache, The Book</em>.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Starting_dCache_first_time"></a>9. Starting dCache for the first
    time</h2></div></div></div><p>After installing dCache on <span class="emphasis"><em>all</em></span> the nodes in
    your system, start dCache in the following sequence.</p><div class="procedure"><a name="id697758"></a><p class="title"><b>Procedure 1.4. To start dCache after installation:</b></p><ol type="1"><li><p>On the Admin node that runs pnfs, start dCache:</p><p><strong class="userinput"><code>/opt/d-cache/bin/dcache-core start</code></strong></p></li><li><p>On each other Admin and Door node servers, start dCache:</p><p><strong class="userinput"><code>/opt/d-cache/bin/dcache-core start</code></strong></p></li><li><p>On each server running a pool, start the pool server:</p><p><strong class="userinput"><code>/opt/d-cache/bin/dcache-pool start</code></strong></p></li><li><p><a href="#Testing_Installation" title="10. Testing your dCache
    installation">Test the
        installation.</a></p></li></ol></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Testing_Installation"></a>10. Testing your dCache
    installation</h2></div></div></div><p>After a fresh installation, or after changing your site's
    configuration, test the dCache installation to ensure that files can be
    moved and copied back and forth.</p><p>Attempt to move files to and from the dCache instance using client
    tools appropriate for your doors . Ensure that files have indeed been
    moved onto the appropriate hardware by checking locally.</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>Do not just attempt local transfers. Attempt transfers to and from
      offsite clients to ensure that clients outside your internal network can
      access your dCache instance.</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Access"></a>11. Setting up your dCache sytem</h2></div></div></div><p>Post-installation configuration of the dCache servers is beyond the
    scope of this document. See <a href="http://www.dcache.org/manuals/Book/cf.shtml%20" target="_top"><em class="citetitle">Configuration of dCache</em></a> in the
    <em class="citetitle">dCache Manual</em>.</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>Authorization files are not set up by the install scripts.
      Configure the files used by gPlazma <span class="emphasis"><em>before</em></span> starting
      dCache. See <a href="http://www.dcache.org/manuals/Book/cf-gplazma.shtml" target="_top"><em class="citetitle">gPlazma authorization in dCache</em></a> in
      the <em class="citetitle">dCache Manual</em>.</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Cleanup"></a>12. Cleanup</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#CleanUp_Postgres">12.1. Postgres</a></span></dt><dt><span class="section"><a href="#CleanUp_pnfs">12.2. pnfs</a></span></dt><dt><span class="section"><a href="#CleanUp_dCache">12.3. dCache</a></span></dt></dl></div><p>Complete the cleanup only if you attempted to install dCache
    <span class="emphasis"><em>and</em></span> all of the following conditions are true:
    </p><div class="itemizedlist"><ul type="disc"><li><p>The installation did not finish successfully.</p></li><li><p>You want to do a clean up.</p></li><li><p>You want to run installation script again.</p></li></ul></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="CleanUp_Postgres"></a>12.1. Postgres</h3></div></div></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>This will erase all postgresql rpms and delete any existing
        postgres databases and installations.</p></div><div class="procedure"><a name="id697977"></a><p class="title"><b>Procedure 1.5. To clean up the postgres installation:</b></p><ol type="1"><li><p>Make a backup of your databases and anything else that you
          think you might need later.</p></li><li><p>Stop the postmaster:</p><p><strong class="userinput"><code>/etc/init.d/postgresql stop</code></strong></p></li><li><p>Erase all postgresql <span class="acronym">RPM</span>s.</p></li><li><p>Delete the <code class="filename">/var/lib/pgsql</code>
          directory.</p></li><li><p>As additional check, make sure following files do not exist:
          </p><div class="itemizedlist"><ul type="disc"><li><p><code class="filename">/bin/postmaster</code></p></li><li><p><code class="filename">/sbin/postmaster</code></p></li><li><p><code class="filename">/usr/bin/postmaster</code></p></li><li><p><code class="filename">/usr/sbin/postmaster</code></p></li><li><p><code class="filename">/usr/local/bin/postmaster</code></p></li></ul></div></li></ol></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="CleanUp_pnfs"></a>12.2. pnfs</h3></div></div></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>This will erase the pnfs-server RPM and delete all pnfs
        directories created in <code class="filename">/opt</code>.</p></div><div class="procedure"><a name="id698126"></a><p class="title"><b>Procedure 1.6. To clean up the postgres installation:</b></p><ol type="1"><li><p>Make a backup of your databases and anything else that you
          think you might need later.</p></li><li><p>Erase the pnfs server RPM:</p><p><strong class="userinput"><code>rpm -e
          pnfs-postgresql-3.1.10-3.i386</code></strong></p></li><li><p>Delete the various pnfs directories</p><p><strong class="userinput"><code>rm -rf /opt/pnfs.3.1.10</code></strong></p><p><strong class="userinput"><code>rm -rf /opt/pnfs</code></strong></p><p><strong class="userinput"><code>rm -rf /opt/pnfsdb</code></strong></p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Depending on where your installation failed, you might not
            have all of these directories.</p></div></li></ol></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="CleanUp_dCache"></a>12.3. dCache</h3></div></div></div><div class="procedure"><a name="id698207"></a><p class="title"><b>Procedure 1.7. To clean-up the dCache installation portion:</b></p><ol type="1"><li><p>Erase the dcache-server rpm:</p><p><strong class="userinput"><code>rpm -e
          dcache-server-1.7.0-19.noarch</code></strong></p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>If this returns <span class="errortext">scriptlet failed</span>,
            repeat it using the <code class="option">--noscripts</code> option.</p></div></li><li><p>Delete the d-cache directory:</p><p><strong class="userinput"><code>rm -rf /opt/d-cache</code></strong></p></li></ol></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Installation_Support"></a>13. Getting Installation Support</h2></div></div></div><p>For more detailed information, see <a href="http://www.dcache.org/manuals/Book/" target="_top"><em class="citetitle">dCache, The Book</em></a>.</p><p>Specific questions can be directed to the VDT support,
    <code class="email">&lt;<a href="mailto:vdt-support@cs.wisc.edu">vdt-support@cs.wisc.edu</a>&gt;</code>.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="About_VDT-dCache"></a>14. dCache Details</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#site_info.def_Described">14.1. The <code class="filename">site_info.def</code> file</a></span></dt><dt><span class="section"><a href="#Package_Directory_Structure">14.2. Directory Structure of the dCache Package</a></span></dt><dt><span class="section"><a href="#Installation_Scripts">14.3. The Installation Scripts</a></span></dt></dl></div><p>This section provides details about various components of the dCache
    package and installation.</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="site_info.def_Described"></a>14.1. The <code class="filename">site_info.def</code> file</h3></div></div></div><p><code class="filename">site-info.def</code> defines which node shall run
      each service.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>All required services that have not been associated with a
        particular node will run on the admin node.</p></div><p>The definition for services which may run on more than one node
      may be a space- separated list of fully-qualified hostnames. If a
      service needs further information, such as pool size and location, the
      may appear in colon-separated fields after the hostname.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="Package_Directory_Structure"></a>14.2. Directory Structure of the dCache Package</h3></div></div></div><p>After you untar the dCache package, you will see the following
      directory structure: </p><div class="itemizedlist"><ul type="disc"><li><p><code class="filename">./vdt-dcache-SL3_32-1.0.2</code> &#8212; the root
            directory </p><div class="itemizedlist"><ul type="circle"><li><p><code class="filename">./RPMS</code>
                  </p><div class="itemizedlist"><ul type="square"><li><p><code class="filename">dcache-server-1.7.0-19.noarch.rpm</code></p></li><li><p><code class="filename">postgresql-server-8.1.4-1PGDG.x86_64.rpm</code></p></li><li><p><code class="filename">postgresql-libs-8.1.4-1PGDG.x86_64.rpm</code></p></li><li><p><code class="filename">postgresql-8.1.4-1PGDG.x86_64.rpm</code></p></li><li><p><code class="filename">pnfs-postgresql-3.1.10-3.i386.rpm</code></p></li></ul></div></li><li><p><code class="filename">/install</code> &#8212;
                  contains installation scripts: </p><div class="itemizedlist"><ul type="square"><li><p><code class="filename">README</code></p></li><li><p><code class="filename">config-node.pl</code></p></li><li><p><code class="filename">find_java.sh</code></p></li><li><p><code class="filename">install.sh</code></p></li><li><p><code class="filename">install_dcache.sh</code></p></li><li><p><code class="filename">install_pnfs.sh</code></p></li><li><p><code class="filename">install_postgres.sh</code></p></li><li><p><code class="filename">site-info.def</code></p></li><li><p><code class="filename">site-info.def.template</code> &#8212;
                        template used by
                        <code class="filename">config-node.pl</code></p></li><li><p><code class="filename">./util</code>
                        </p><div class="itemizedlist"><ul type="disc"><li><p><code class="filename">config_file</code> &#8212; Yaim
                              configuration and setup file for dCache
                              1.7.0-x</p></li></ul></div></li></ul></div></li></ul></div></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="Installation_Scripts"></a>14.3. The Installation Scripts</h3></div></div></div><p>The following describes particulars about the individual scripts
      that make up the dCache package.</p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="Postgres_Installation_Script"></a>14.3.1. Postgres</h4></div></div></div><p>You must uninstall any existing Postgres installation before
        installing dCache. The script assumes a fresh installation of
        Postgres. Postgres is only installed on systems that run any of the
        following: </p><div class="itemizedlist"><ul type="disc"><li><p>pnfs server node</p></li><li><p>SRM service</p></li><li><p>GridFTP service</p></li><li><p>billing service</p></li><li><p>Space manager service</p></li><li><p>Pin manager service</p></li><li><p>Replica manager service</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="pnfs_Installation_Script"></a>14.3.2. pnfs</h4></div></div></div><p>The dCache install scripts install pnfs server only if the
        following are all true: </p><div class="orderedlist"><ol type="1"><li><p>pnfs server is not already installed;</p></li><li><p>this machine is defined as the pnfs server node in
              <code class="filename">site-info.def</code> (through the
              <code class="varname">$DCACHE_PNFS</code> variable);
              <span class="emphasis"><em>and</em></span></p></li><li><p>NFS server is not running on this node.</p></li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>There can only be one pnfs server node in any single dDcache
          installation.</p></div><p>If you have previously installed pnfs, the installation script
        will check that the pnfs export for the doors has the value
        <em class="parameter"><code>/pnfsdoors</code></em>. If not, script issues a warning and
        the installation may fail.</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>If you have a previous installation of pnfs, it must be
          running before you run the install script.</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="dCache_Installation_Script"></a>14.3.3. dCache</h4></div></div></div><p>The dCache install portion unpacks the dcache-server rpm (if
        necessary) and modifies the dCache configuration files. </p><div class="itemizedlist"><ul type="disc"><li><p>Services will be turned on and pools created according to
              the information in <code class="filename">site-info.def</code>.</p></li><li><p>The pnfs node should be installed and started before any
              GridFTP nodes.</p></li><li><p>pnfsManager will run by default on the pnfs node.</p></li><li><p>Authorization files are not set up by the install script.
              Configure the files used by gPlazma <span class="emphasis"><em>before</em></span>
              starting dCache.</p></li><li><p>Creates <code class="filename">etc/node_config.delta</code> and
              <code class="filename">etc/dCacheSetup.delta</code>. These files show
              exactly what lines in <code class="filename">etc/node_config</code> or
              <code class="filename">config/dCacheSetup</code> will be changed during
              the installation. These files can be used for custom settings as
              well. See <a href="#Customizing_Installation" title="5. Customizing Your dCache
    Installation Process">Section 5, &#8220;Customizing Your dCache
    Installation Process&#8221;</a>.</p></li></ul></div></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Samples"></a>15. Samples</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#Samplesite-infodefFile">15.1. Sample <code class="filename">site-info.def</code> file</a></span></dt><dt><span class="section"><a href="#Sample_config_output">15.2. Sample output of
      <code class="filename">config-node.pl</code></a></span></dt><dt><span class="section"><a href="#Sample_vdt-installerr">15.3. Sample vdt-install.err</a></span></dt><dt><span class="section"><a href="#Sample_install_log">15.4. Sample installation log</a></span></dt></dl></div><p>The following are a <code class="filename">site-info.def</code> file,
    <code class="filename">vdt-installer.err</code> file, log file and output of
    <code class="filename">config-node.pl</code> from test installations of
    dCache.</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="Samplesite-infodefFile"></a>15.1. Sample <code class="filename">site-info.def</code> file</h3></div></div></div><p>The following is the <code class="filename">site-info.def</code> file
      created by this user's <code class="filename">config-node.pl</code>.</p><pre class="screen">MY_DOMAIN="dhcp.fnal.gov"
#
# Location of java binary
#
JAVA_LOCATION="/usr/bin/java"
#
#
# Components -&gt; "hostname"
# Please use fully qualified host names.
# The admin host must be set.
DCACHE_ADMIN="admin1.domain.gov"
#
# These default to DCACHE_ADMIN if not set
DCACHE_PNFS="admin2.domain.gov"
DCACHE_INFO_PROVIDER="admin5.domain.gov"
DCACHE_LM="admin1.domain.gov"
DCACHE_HTTP="admin5.domain.gov"
DCACHE_POOL_MANAGER="admin1.domain.gov"
DCACHE_UTILITY="admin1.domain.gov"
DCACHE_DIR_DOMAIN="admin2.domain.gov"
#
# These default to no host if not set
#DCACHE_STATISTICS=""
DCACHE_ADMIN_DOOR="admin1.domain.gov"
DCACHE_REPLICA_MANAGER="admin4.domain.gov"
DCACHE_GPLAZMA="admin1.domain.gov"
#
#
# Doors -&gt; "hostname1 hostname2"
# All doors default to no host
#
DCACHE_DOOR_SRM="admin3.domain.gov"
DCACHE_DOOR_GSIFTP="door1.domain.gov door2.domain.gov door3.domain.gov"
DCACHE_DOOR_GRIDFTP=$DCACHE_DOOR_GSIFTP
DCACHE_DOOR_GSIDCAP="door1.domain.gov door2.domain.gov door3.domain.gov"
DCACHE_DOOR_DCAP="door1.domain.gov door2.domain.gov door3.domain.gov"
#DCACHE_XROOTD=""
#
#
# Pools -&gt; "hostname1:size1:path1 hostname1:size2:path2 hostname2:size1:path1 hostname2:size2:path2"
#
DCACHE_POOLS="pool1.domain.gov:all:/mnt/store1 pool1.domain.gov:all:/mnt/store2 pool1.domain.gov:all:/mnt/store3  pool2.domain.gov:all:/mnt/store1  pool3.domain.gov:all:/mnt/store1 pool3.domain.gov:all:/mnt/store2"
#
#
# Customizations
#MAX_FTP_STREAMS=
#GRIDFTP_PRIVATE_NETWORK=
#USE_MULTI_MOVER_QUEUES=
#BILLING_USE_DB=
#DCACHE_LOG_DIR=
#
#
# For the first installation, the following variables must be set to 'yes'.
# DO NOT set these values to yes on existing production services,
# dCache internal databases will be deleted.
#
#RESET_DCACHE_CONFIGURATION=no
#RESET_DCACHE_PNFS=no
#RESET_DCACHE_RDBMS=no
#
#
# VOs -&gt; "vo1 vo2"
#
#VOS="atlas cms dteam ops"
#
#
# Do not change this file below this line
DCACHE_SERVER_RPM=dcache-server-1.7.0-19.noarch.rpm

DCACHE_NODE_TYPES="\
admin:DCACHE_ADMIN,\
pool:DCACHE_POOLS\
"

DCACHE_REQUIRED_SERVICES="\
lmDomain:DCACHE_LM,\
poolManager:DCACHE_POOL_MANAGER,\
pnfsManager:DCACHE_PNFS,\
dirDomain:DCACHE_DIR_DOMAIN,\
adminDoor:DCACHE_ADMIN_DOOR,\
httpDomain:DCACHE_HTTP,\
utilityDomain:DCACHE_UTILITY,\
gPlazmaService:DCACHE_GPLAZMA,\
infoProvider:DCACHE_INFO_PROVIDER\
"

DCACHE_OPTIONAL_SERVICES="\
replicaManager:DCACHE_REPLICA_MANAGER,\
statistics:DCACHE_STATISTICS,\
GSIDCAP:DCACHE_DOOR_GSIDCAP,\
DCAP:DCACHE_DOOR_DCAP,\
GRIDFTP:DCACHE_DOOR_GRIDFTP,\
SRM:DCACHE_DOOR_SRM,\
XROOTD:DCACHE_XROOTD,\
"

DDCACHE_TUNING_OPTIONS="\
MAX_FTP_STREAMS:gsiftpMaxStreamsPerClient \
USE_MULTI_MOVER_QUEUES:gsiftpIoQueue=WAN \
USE_MULTI_MOVER_QUEUES:gsidcapIoQueue=LAN \
USE_MULTI_MOVER_QUEUES:dcapIoQueue=LAN \
USE_MULTI_MOVER_QUEUES:poolIoQueue=default,WAN,LAN \
BILLING_USE_DB:billingToDb \
DCACHE_LOG_DIR:logArea\
"</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="Sample_config_output"></a>15.2. Sample output of
      <code class="filename">config-node.pl</code></h3></div></div></div><p>The following lines show the screen output from running
      <span><strong class="command">config-node.pl</strong></span> for a site with six admin nodes, three
      door nodes, and three pools, using the recommended default
      configurations for everything.</p><pre class="screen">
$ <strong class="userinput"><code>./config-node.pl</code></strong>
How many admin nodes (non-pool and non-door nodes) do you have? <strong class="userinput"><code>6</code></strong>
The recommended services for node 1 are:
lmDomain poolManager adminDoor utilityDomain gplazmaService
Which services do you wish to run (Enter for defaults)?
Enter the FQDN node name for node 1: <strong class="userinput"><code>admin1.domain.gov</code></strong>
The recommended services for node 2 are:
pnfsManager dirDomain
Which services do you wish to run (Enter for defaults)?
Enter the FQDN node name for node 2: <strong class="userinput"><code>admin2.domain.gov</code></strong>
The recommended services for node 3 are:
srm
Which services do you wish to run (Enter for defaults)?
Enter the FQDN node name for node 3: <strong class="userinput"><code>admin3.domain.gov</code></strong>
The recommended services for node 4 are:
replicaManager
Which services do you wish to run (Enter for defaults)?
Enter the FQDN node name for node 4: <strong class="userinput"><code>admin4.domain.gov</code></strong>
The recommended services for node 5 are:
httpDomain infoProvider
Which services do you wish to run (Enter for defaults)?
Enter the FQDN node name for node 5: <strong class="userinput"><code>admin5.domain.gov</code></strong>
How many door nodes do you have? <strong class="userinput"><code>3</code></strong>
Enter FQDN of door number 1: <strong class="userinput"><code>door1.domain.gov</code></strong>
Enter FQDN of door number 2: <strong class="userinput"><code>door2.domain.gov</code></strong>
Enter FQDN of door number 3: <strong class="userinput"><code>door3.domain.gov</code></strong>
Enter the private network that the pools are in.
If this does not apply, just press enter to skip:
Enter a pool FQDN name(Press Enter when all are done): <strong class="userinput"><code>pool1.domain.gov</code></strong>
Enter the first storage location (Press Enter when all are done)): <strong class="userinput"><code>/mnt/store1</code></strong>
Enter another storage location (Press Enter when all are done)): <strong class="userinput"><code>/mnt/store2</code></strong>
Enter another storage location (Press Enter when all are done)): <strong class="userinput"><code>/mnt/store3</code></strong>
Enter another storage location (Press Enter when all are done)):
Enter another pool FQDN name(Press Enter when all are done): <strong class="userinput"><code>pool2.domain.gov</code></strong>
Enter the first storage location (Press Enter when all are done)): <strong class="userinput"><code>/mnt/store1</code></strong>
Enter another storage location (Press Enter when all are done)):
Enter another pool FQDN name(Press Enter when all are done): <strong class="userinput"><code>pool3.domain.gov</code></strong>
Enter the first storage location (Press Enter when all are done)): <strong class="userinput"><code>/mnt/store1</code></strong>
Enter another storage location (Press Enter when all are done)): <strong class="userinput"><code>/mnt/store2</code></strong>
Enter another storage location (Press Enter when all are done)):
Enter another pool FQDN name(Press Enter when all are done):
Created site-info.def file.
</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="Sample_vdt-installerr"></a>15.3. Sample vdt-install.err</h3></div></div></div><p>The following is a sample vdt-install.err file from a test
      installation.</p><p><code class="computeroutput">At least one of files
      "/bin/postmaster,/sbin/postmaster, /usr/bin/postmaster,
      /usr/sbin/postmaster, /usr/local/bin/postmaster" exists Postmaster from
      previous install is already running..</code></p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="Sample_install_log"></a>15.4. Sample installation log</h3></div></div></div><p>The following is a sample installation log from a test
      installation. The default location for dCache log files is <code class="filename">/opt/d-cache/log</code>, although you can set a
      different location. Other components, such as postgres and pnfs, will
      also have log files in their defaul directories. For example, pnfs has
      three log files in a usual installation:</p><div class="itemizedlist"><ul type="disc"><li><p><code class="filename">/var/log/pmountd.log</code></p></li><li><p><code class="filename">/var/log/dbserver.log</code></p></li><li><p><code class="filename">/var/log/pnfsd.log</code></p></li></ul></div><p>As you can see in this sample dCache log, a prior installation of
      dCache existed on this server.</p><pre class="programlisting">dCache rpm already unpacked.
Checking services running on this node ...
postgres  6773     1  0 Nov27 pts/5    00:00:00 /usr/bin/postmaster -p 5432 -D /var/lib/pgsql/data
PostgreSQL is already installed.
pnfs-postgresql-3.1.10-1.i386
PNFS Server rpm is already installed.
start install_sedcache
Installing dCache -
Skipping D-Cache configuration file reset
start yaim_config_dcache_files_key_value_dCacheSetup
start yaim_config_file_update_prepare
stop yaim_config_file_update_prepare
start yaim_config_file_set_value
stop yaim_config_file_set_value
start yaim_config_file_set_value
stop yaim_config_file_set_value
start yaim_config_file_set_value
stop yaim_config_file_set_value
start yaim_config_file_set_value
stop yaim_config_file_set_value
start yaim_config_file_update_done
stop yaim_config_file_update_done
stop yaim_config_dcache_files_key_value_dCacheSetup
Modifying dCache configuration files
start yaim_config_file_update_prepare
stop yaim_config_file_update_prepare
start yaim_config_file_set_value
stop yaim_config_file_set_value
serviceLocatorHost=cd-97177.fnal.gov
start yaim_config_file_set_value
stop yaim_config_file_set_value
java=/usr/java/jdk1.5.0_07/bin/java
start yaim_config_file_set_value
stop yaim_config_file_set_value
dCapPort1=${portBase}136
start yaim_config_file_set_value
stop yaim_config_file_set_value
dCapPort2=${portBase}137
start yaim_config_file_update_done
stop yaim_config_file_update_done
start yaim_query_conf_dcache_services_default_admin
stop yaim_query_conf_dcache_services_default_admin
start yaim_config_dcache_files_key_value_node_type
start yaim_config_file_update_prepare
stop yaim_config_file_update_prepare
start yaim_config_file_set_value
stop yaim_config_file_set_value
start yaim_config_file_set_value
stop yaim_config_file_set_value
Node type already set to admin. Will not set to pool
start yaim_config_file_set_value
stop yaim_config_file_set_value
start yaim_config_file_set_value
stop yaim_config_file_set_value
start yaim_config_file_set_value
stop yaim_config_file_set_value
start yaim_config_file_set_value
stop yaim_config_file_set_value
start yaim_config_file_set_value
stop yaim_config_file_set_value
start yaim_config_file_set_value
stop yaim_config_file_set_value
start yaim_config_file_set_value
stop yaim_config_file_set_value
start yaim_config_file_set_value
stop yaim_config_file_set_value
start yaim_config_file_set_value
stop yaim_config_file_set_value
start yaim_config_file_set_value
stop yaim_config_file_set_value
start yaim_config_file_set_value
stop yaim_config_file_set_value
start yaim_config_file_set_value
stop yaim_config_file_set_value
start yaim_config_file_set_value
stop yaim_config_file_set_value
start yaim_config_file_set_value
stop yaim_config_file_set_value
start yaim_config_file_set_value
stop yaim_config_file_set_value
start yaim_config_file_set_value
stop yaim_config_file_set_value
start yaim_config_file_set_value
stop yaim_config_file_set_value
start yaim_config_file_update_done
stop yaim_config_file_update_done
stop yaim_config_dcache_files_key_value_node_type
start yaim_config_file_update_prepare
stop yaim_config_file_update_prepare
start yaim_config_file_set_value
stop yaim_config_file_set_value
SERVER_ID=fnal.gov
start yaim_config_file_set_value
stop yaim_config_file_set_value
ADMIN_NODE=cd-97177.fnal.gov
start yaim_config_file_set_value
stop yaim_config_file_set_value
NODE_TYPE=admin
start yaim_config_file_set_value
stop yaim_config_file_set_value
lmDomain=yes
start yaim_config_file_set_value
stop yaim_config_file_set_value
poolManager=yes
start yaim_config_file_set_value
stop yaim_config_file_set_value
pnfsManager=yes
start yaim_config_file_set_value
stop yaim_config_file_set_value
dirDomain=yes
start yaim_config_file_set_value
stop yaim_config_file_set_value
adminDoor=yes
start yaim_config_file_set_value
stop yaim_config_file_set_value
httpDomain=yes
start yaim_config_file_set_value
stop yaim_config_file_set_value
utilityDomain=yes
start yaim_config_file_set_value
stop yaim_config_file_set_value
gPlazmaService=yes
start yaim_config_file_set_value
stop yaim_config_file_set_value
infoProvider=yes
start yaim_config_file_set_value
stop yaim_config_file_set_value
replicaManager=no
start yaim_config_file_set_value
stop yaim_config_file_set_value
statistics=no
start yaim_config_file_set_value
stop yaim_config_file_set_value
GSIDCAP=yes
start yaim_config_file_set_value
stop yaim_config_file_set_value
DCAP=yes
start yaim_config_file_set_value
stop yaim_config_file_set_value
GRIDFTP=yes
start yaim_config_file_set_value
stop yaim_config_file_set_value
SRM=yes
start yaim_config_file_set_value
stop yaim_config_file_set_value
XROOTD=no
start yaim_config_file_update_done
stop yaim_config_file_update_done
start config_dcache_config_file_pool_path
start yaim_config_file_update_prepare
stop yaim_config_file_update_prepare
processing pool=all:/mnt/win/work
start yaim_config_file_update_done
stop yaim_config_file_update_done
stop config_dcache_config_file_pool_path
start config_pnfs_install_mount
Door is already pnfsserver.
start config_dcap_create_doors
Creating 2 dcap doors from /opt/d-cache/config/door1.batch
stop config_dcap_create_doors
Running dCache setup script
start config_dcache_config_dcache_scripts

 Checking MasterSetup  ./config/dCacheSetup O.k.

   Sanning dCache batch files

    Processing adminDoor
    Processing dCache
    Processing dir
    Processing door1
    Processing door2
    Processing gPlazma
    Processing gridftpdoor
    Processing gsidcapdoor
    Processing httpd
    Processing infoProvider
    Processing lm
    Processing pnfs
    Processing pool
    Processing replica
    Processing srm
    Processing statistics
    Processing utility
    Processing xrootdDoor


 Checking Users database .... Ok
 Checking Security       .... Ok
 Checking JVM ........ Ok
 Checking Cells ...... Ok
 dCacheVersion ....... Version production-1-7-0

trying to stop previous version...
Using CATALINA_BASE:   /opt/d-cache/libexec/jakarta-tomcat-4.1.31
Using CATALINA_HOME:   /opt/d-cache/libexec/jakarta-tomcat-4.1.31
Using CATALINA_TMPDIR: /opt/d-cache/libexec/jakarta-tomcat-4.1.31/temp
Using JAVA_HOME:       /usr/java/jdk1.5.0_07
deleting previous version
AXIS_PATH=/opt/d-cache/libexec/axis-1_3
TOMCAT_PATH=/opt/d-cache/libexec/jakarta-tomcat-4.1.31
installing tomcat and axis ...Done
rm /opt/d-cache/libexec/jakarta-tomcat-4.1.31/webapps/srm/WEB-INF/lib/commons-logging*.jar
copying jars ...Done
modifying system CLASSPATH in /opt/d-cache/libexec/jakarta-tomcat-4.1.31/bin/catalina.sh ...Done
modifying default tomcat SHUTDOWN phrase  and permissions of /opt/d-cache/libexec/jakarta-tomcat-4.1.31/conf/server.xml ...Done
commenting out AJP CoyoteConnector on port 8009...Done
Starting up tomcat ...Using CATALINA_BASE:   /opt/d-cache/libexec/jakarta-tomcat-4.1.31
Using CATALINA_HOME:   /opt/d-cache/libexec/jakarta-tomcat-4.1.31
Using CATALINA_TMPDIR: /opt/d-cache/libexec/jakarta-tomcat-4.1.31/temp
Using JAVA_HOME:       /usr/java/jdk1.5.0_07
Done
deployng srm v2 application using axis AdminClient ...
- Unable to find required classes (javax.activation.DataHandler and javax.mail.internet.MimeMultipart). Attachment support is disabled.
Processing file /opt/d-cache/etc/srmv1-deploy.wsdd
&lt;Admin&gt;Done processing&lt;/Admin&gt;
- Unable to find required classes (javax.activation.DataHandler and javax.mail.internet.MimeMultipart). Attachment support is disabled.
Processing file /opt/d-cache/etc/srmv2.2-deploy.wsdd
&lt;Admin&gt;Done processing&lt;/Admin&gt;
Done
creating config files and adding configuration info into /opt/d-cache/libexec/jakarta-tomcat-4.1.31/webapps/srm/WEB-INF/web.xml ...Done
enabling GSI HTTP in tomcat by modifying /opt/d-cache/libexec/jakarta-tomcat-4.1.31/conf/server.xml ...tmp2:/tmp/tmp2Dec060935116541932512
Done
turning of sendMultiRefs option in turning off sending of Multi Refs in /opt/d-cache/libexec/jakarta-tomcat-4.1.31/webapps/srm/WEB-INF/server-config.wsddDone
commenting out HTTP CoyoteConnector on port 8080 in /opt/d-cache/libexec/jakarta-tomcat-4.1.31/conf/server.xml ...Done
shutting Tomcat down
Using CATALINA_BASE:   /opt/d-cache/libexec/jakarta-tomcat-4.1.31
Using CATALINA_HOME:   /opt/d-cache/libexec/jakarta-tomcat-4.1.31
Using CATALINA_TMPDIR: /opt/d-cache/libexec/jakarta-tomcat-4.1.31/temp
Using JAVA_HOME:       /usr/java/jdk1.5.0_07
installing config for startup/shutdown script
Installation complete
please use /opt/d-cache/bin/dcache-srm start|stop|restart to startup, shutdown or  restart srm server

[INFO]  Will be mounted to cd-97177.fnal.gov:/fs by dcache-core start-up script.
[INFO]  Link /pnfs/fnal.gov --&gt; /pnfs/fs/usr already there.
[INFO]  Link /pnfs/ftpBase --&gt; /pnfs/fs already there.


[INFO]  Checking on a possibly existing dCache/PNFS configuration ...
[INFO]  Found an existing dCache/PNFS configuration!
[INFO]  Not allowed to overwrite existing configuration.


[INFO]  There already are pnfs exports '/pnfsdoors' in
        /pnfs/fs/admin/etc/exports. The GridFTP doors need access to it.
[INFO]  You may restrict access to this export to the GridFTP doors which
        are not on the admin node. See the documentation.

[INFO]  Generating ssh keys:
Generating public/private rsa1 key pair.
Your identification has been saved in ./server_key.
Your public key has been saved in ./server_key.pub.
The key fingerprint is:
65:61:7b:b6:f6:15:a7:16:52:e3:f5:bf:7e:39:41:70 root@cd-97177


[INFO]  Not overwriting pool at /mnt/win/work.
stop config_dcache_config_dcache_scripts
Finished installing dCache
stop install_sedcache
</pre></div></div></div></body></html>
