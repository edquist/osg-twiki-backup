#!/usr/bin/perl

use strict;

my $time_left=`grid-proxy-info -timeleft`;
if ($time_left <= 0)
{
    die "ERROR: User proxy has expired. Renew and then rerun $0";
}

# SEG Tests
print "globus_scheduler_event_generator_test\n";
chdir("$ENV{GLOBUS_LOCATION}/test/globus_scheduler_event_generator_test/");
system("./TESTS.pl 2>&1 | tee tests.log");
print "\n";

print "globus_scheduler_event_generator_fork_test\n";
chdir("$ENV{GLOBUS_LOCATION}/test/globus_scheduler_event_generator_fork_test/");
system("./TESTS.pl 2>&1 | tee tests.log");
print "\n";

print "globus_scheduler_event_generator_pbs_test\n";
chdir("$ENV{GLOBUS_LOCATION}/test/globus_scheduler_event_generator_pbs_test/");
system("./TESTS.pl 2>&1 | tee tests.log");
print "\n";

print "globus_scheduler_event_generator_condor_test\n";
chdir("$ENV{GLOBUS_LOCATION}/test/globus_scheduler_event_generator_condor_test/");
system("./TESTS.pl 2>&1 | tee tests.log");
print "\n";

# Globus-gridmap-and-execute Tests
print "globus_gridmap_and_execute_test\n";
chdir("$ENV{GLOBUS_LOCATION}/test/globus_gridmap_and_execute_test/");
system("./TESTS.pl 2>&1 | tee tests.log");
print "\n";

# Rendezvous C Client Tests
print "globus_c_wsrf_rendezvous_test\n";
chdir("$ENV{GLOBUS_LOCATION}/test/globus_c_wsrf_rendezvous_test/");
system("./TESTS.pl 2>&1 | tee tests.log");
print "\n";

# Unit Tests
print "globus_wsrf_gram_service_java_test_unit\n";
chdir("$ENV{GLOBUS_LOCATION}/test/globus_wsrf_gram_service_java_test_unit/");
system("./TESTS.pl 2>&1 | tee tests.log");
print "\n";

# Scheduler Tests
chdir("$ENV{GLOBUS_LOCATION}/test/globus_wsrf_gram_scheduler_test/");
print "globus_wsrf_gram_scheduler_test (Fork)\n";
system("./TESTS.pl 2>&1 | tee tests-fork.log");
print "\n";
#print "globus_wsrf_gram_scheduler_test (PBS)\n";
#system("./TESTS.pl -scheduler PBS 2>&1 | tee tests-pbs.log");
#print "\n";
#print "globus_wsrf_gram_scheduler_test (Condor)\n";
#system("./TESTS.pl -scheduler Condor 2>&1 | tee tests-condor.log");
#print "\n";
print "globus_wsrf_gram_scheduler_test (Multi)\n";
system("./TESTS.pl -scheduler Multi 2>&1 | tee tests-multi.log");
