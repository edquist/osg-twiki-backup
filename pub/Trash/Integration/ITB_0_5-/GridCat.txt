%META:TOPICINFO{author="MarciaTeckenbrock" date="1158085362" format="1.1" version="1.2"}%
<!-- This is the default OSG Integration template. 
Please modify it in the sections indicated to create your topic!
If you have any comments/complaints about this template, then please email me:
rwg@hep.uchicago.edu.  (Adapted from Atlas wiki template, Ed Moyse)
--> 

<!-- By default the title is the WikiWord used to create this topic !-->
<!-- if you want to modify it to something more meaningful, just replace %TOPIC% below with i.e "My Topic"!-->
d93 1
---+!!<nop>%TOPIC%
%TOC%
%STARTINCLUDE%

---++Introduction
[[GridCat050][GridCat]] is a high level grid cataloging system using status dots on geographic maps as well as a catalog of participating sites. The status dots display site's health. The catalog contains information on site readiness, site problems, a brief reason for problems, number of job slots available, and disk space available with other valuable information per site to help job submission and job scheduling for application users and grid develpers. [[GridCat050][GridCat]] tries to present the grid-site at its simplest status representation. It is used as an operations tool as well as a monitoring service.
More documentation on !GridCat can be found from:<br/>
[[http://www.ivdgl.org/gridcat][GridCat Home]]

!GridCat was started as a web page code development project within iVDGL and as a subproject for the Grid3 project to support the high level grid site status cataloging. First release was made with the version number 0.0.1 on April 2, 2004.
Currently, [[GridCat050][GridCat]] is deployed for monitoring Grid3 project :
[[http://www.ivdgl.org/grid3/catalog][Grid3 Catalog]] 

OSG-ITB instance of the [[GridCat050][GridCat]] is deployed as:
[[http://www.ivdgl.org/osg-int/gridcat/][OSG-ITB GridCat]]

!GridCat is operated by aggregating information from all participating computing service and storage service sites. It uses MySQL database to store site status information. The database can be accessed using a xml-rpc client tool. Certain site requirements should be met for a site information to be displayed correctly. 

---++Site Requirements
In order for a computing or storage service site to be added, the site has to pass at least one 
'globusrun -a -r hostname'<br/>
!GridCat tests grid site status. The four fundamental !GridCat tests for a computing service site that will determine site's Green/Red status dot are:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1] Authentication Test ( globusrun -a -r hostname/jobmananger-batch )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2] HelloWorld Test ( globus-job-run hostname /bin/echo "Hello World" )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[3] Batch Test is a combination of Batch submission, Batch Query, and Batch Cancel<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    Batch submission      ( globus-job-submit hostname/jobmanager-batch /bin/sleep 57 )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          --> This gives jobid with the format<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          https://hostname:port/numeric_1/numeric_2<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    Batch Query ( globus-job-status jobid )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    Batch Cancel ( using fork jobmanager and globus-job-clean -force -r hostname jobid )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[4] gsiftp file transfer test out- and in-bound<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          (globus-url-copy file:///a/b/c gsiftp://hostname/usually_tmp/c<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;             ,and if successful,<br/>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          globus-url-copy gsiftp://hostname/usually_tmp/c file:///a/b/c<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;          )

In addition to the site status tests, GridCat obtains fundamental site information using the [[http://giis.ivdgl.org/twiki/bin/view/Integration/CoreMIS][CoreMIS (MIS-CI)]] information collector and jobmanager-mis which is included by default beginning the OSG-ITB 0.1.4. MIS-CI's sensor collects information and puts them in SQLite database in the site. The information can be queried using the jobmanager-mis which is based on the jobmanager-fork and customized.<br/>

Information collected from MIS-CI are Jobs and Disks. Jobs information is the number of available CPU slots for batch submission over total available CPU slots which could be different from the number in "CPUs" column of the GridCat display because Jobs information is obtained dynamically and from the batch system's jobs query which could provide only all the batch slots configured independently of the site's intended CPUs provision. Disks information is the number of disk space available in Gbyte for the direcotries, $app, $data, $tmp, $wntmp, and osg installation over the total disk space from which these directories are mounted.

The GridCat tests for a storage service vary depending on storage services advertised through
the storage service's information provider which could have a different hostname from the storage service host. Typically, in- and out-bound file tranfer client command execution must be carried out successfully in order for a storage service to be functional. The client command execution commands include globus-url-copy or srmcp for gsiftp and srm protocol, respectively. At the moment, these two service protocols are supported by GridCat. GridCat performs only very simple in- and out-bound file tranfer tests.

In order for a site to be cataloged to the OSG-ITB GridCat instance, a few requirements should be met. <br/>
If the site is a computing service (CS in GridCat display), these requirements should be met :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1] [[http://giis.ivdgl.org/twiki/bin/view/Integration/OsgItbInstallation][Installation and configuration of OSG-ITB]]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2] The site's gatekeeper hostname should be sent to the OSG-ITB GridCat administrator.<br/>

If the site is a storage service (SS in GridCat display), these requirements should be met :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1] Storage service hostname, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2] Information Provider protocol, hostname, and port number,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[3] Information Provider query string, e.g., "mds-vo-name=USCMS-FNAL-WC1,o=grid", should be sent to the GridCat administrator.<br/>

If the site is neither CS nor SS, the service COULD BE displayed in GridCat by providing:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1] The site's hostname<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2] A list of supported services in the site <br/>

---+++Setting Site State To Active
At the moment, all CS sites initially added to GridCat are presumed to be inactive.
All SS sites initially added to GridCat are presumed to be active.
Inactive CS sites will have the site status dot with the grey color. Once the site becomes active, the site status dot will become either green or red, depending on the GridCat test results.
Since the default site state is presumed to be inactive, the CS site admin has to proactively switch the site state to be active. The switching can be done by modifying the file
<pre>
$VDT_LOCATION/MIS-CI/etc/grid-site-state-info
</pre>
d83 1
If the value of grid_site_state_bit is 1, the site commences its active state, i.e.,
the content of $VDT_LOCATION/MIS-CI/etc/grid-site-state-info will look like:
<pre>
export grid_site_state_bit=1
</pre>
<font color='magenta'>It might take up to 2 hours until this change
takes effect in the GridCat display.</font>

If the site decides to become inactive for various reasons, e.g., site maintenance, the site admin can set the value of grid_site_state_bit to be other than 1. 
<br/>
Here is an example grid-site-state-info file:
<br/>
<a href="http://www.ivdgl.org/MIS-CI/grid-site-state-info">grid-site-state-info</a>
   $ %I% %RED% *NOTE* %ENDCOLOR%: It might take up to 2 hours until this change takes effect in the <nop>Integration.GridCat display.
---++So How Can I Add My Site to GridCat
In order for a site to be added to GridCat, the site admin should request site addition to the grid operations center (GOC) and typically a hostname should be sent to
the OSG grid operations center (GOC) [[goc-at-opensciencegrid-dot-org]]. Then, GOC will send the request to GridCat administrator.
If the site decides to become inactive for various reasons, e.g., site maintenance, the site admin can set the value of grid_site_state_bit to be other than 1.  See an [[http://www.ivdgl.org/MIS-CI/grid-site-state-info][example grid-site-state-info file]]. 
---++Extracting GridCat Information
GridCat provides xml-rpc service from the GridCat instance to provide collected information to grid users . The GridCat service can be accessed using GridCat client. Two versions of GridCat client are provided with python and perl languages. Perl version requires various other perl module installation and is more difficult to set up. Python version is recommended to be used. They can be obtained from:<br/>
[[http://www.ivdgl.org/gridcat/gcatc.py][GridCat Client]] in python version<br/>
[[http://www.ivdgl.org/gridcat/gcatc.pl][GridCat Client]] in perl version<br/>

GridCat client accesses database and displays necessary information.
The following information query are implemented and can be obtained using the client.<br/>

&nbsp;&nbsp;&nbsp;usage: <br/>
&nbsp;&nbsp;&nbsp;gcatc.py [--useservice= ] [OPTIONS [args]] <br/>
&nbsp;&nbsp;&nbsp;Here an example URI can be http://www.ivdgl.org/osg-int/gridcat/services.php <br/>
&nbsp;&nbsp;&nbsp;and <br/>
&nbsp;&nbsp;&nbsp;OPTIONS are <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                  Top level options: <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 -h | --help | --usage <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                          Print help <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 --useservice= <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                          Invoke useservice method to switch to the requested service <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                          This option should be followed by one of the Method options <br/>
</pre>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 Introspect options: <br/>
Here an example URI can be <nop>http://www.ivdgl.org/osg-int/gridcat/services.php and OPTIONS are:                   
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 --listmethods <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                          List available methods <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 --methodhelp= <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                          Provides help for a specific method <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 --methodsig= <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                          Provides what should be the argument for a specific method <br/>
| =--services= | Lists available services |
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 Method options: <br/>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 --sitenames <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                          Invoke sitenames method and list all site names <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 --hostnames <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                          Invoke hostnames method and list all gatekeeper host names <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 --jobmanagers <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                          Invoke jobmanagers method and list jobmanagers in a site <br/>
Download <nop>Integration.GridCat Client and try:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 --sitestatus <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                          Invoke sitestatus method and show site status in a site <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 --authstatus <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                          Show authorization possibility status in a site <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 --batchstatus <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                          Show batch job accessibility status in a site <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 --gsiftpstatus <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                          Show gsiftp accessibiltiy status in a site <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 --directories <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                          List grid accessible directories in a site <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 --cpuslots <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                          Show available CPU slots in a site 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 --diskspace <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                          Show available data directory disk space in GB in a site <br/>
</pre>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 --showtables <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                          Invoke showtables method and list all gridcat MySQL tables <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 --showfields= <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                          Invoke showfields method and list names of all fields in a table <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 --getsiteresult <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                          Invoke getsiteresult method and show query result <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 --getresult <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                          Invoke getresult method and show query result <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                          (This is the last resort if none of above methods get you what you want <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                           if you know what you are doing.) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 --services <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                      Lists available services <br/>

&nbsp;&nbsp;&nbsp;Example: Download GridCat Client and try : <br/>
&nbsp;&nbsp;&nbsp;Example: Download Integration.GridCat Client and try : <br/>
&nbsp;&nbsp;&nbsp;That's all <br/>
&nbsp;&nbsp;&nbsp;That's all

d141 2
Job and Disks information are collected by MIS-CI cron job every 10 minutes ( if MIS-CI is configured to the default configuration ) in each site. The collected informations are stored in each
site to the SQLite tables "site_cluster" and "diskinfo". 
Job and Disks information are collected by MIS-CI cron job every 10 minutes in each site, if MIS-CI is configured to the default configuration. The collected informations are stored in each site to the SQLite tables "site_cluster" and "diskinfo". 
The job information displayed in GridCat is obtained by the jobmanager mis and is updated every 30 minutes or longer (~1 - ~2 hours sometimes).
Therefore, while long jobs can be caught by gridcat easily, sometimes short jobs can not been seen because they finish quickly before the next GridCat update occurs.
By clicking the retangular bar in the Jobs column in the GridCat, a more detailed job information is displayed.
Therefore, while long jobs can be caught by gridcat easily, sometimes short jobs can not been seen because they finish quickly before the next <nop>Integration.GridCat update occurs. By clicking the retangular bar in the Jobs column in the <nop>Integration.GridCat, a more detailed job information is displayed.
The disk information ( again is updated every 30 minutes or longer ) displayed in GridCat is only for $data directory. A more detailed view can be displayed by clicking the retangular bar in the Disks column in the GridCat. 
Therefore, while long jobs can be caught by gridcat easily, sometimes short jobs can not been seen because they finish quickly before the next Integration.GridCat update occurs. By clicking the retangular bar in the Jobs column in the Integration.GridCat, a more detailed job information is displayed.
The job information displayed in <nop>Integration.GridCat is obtained by the jobmanager mis and is updated every 30 minutes or longer (at times up to 1-2 hours). Therefore, while long jobs can be caught by gridcat easily, sometimes short jobs can not been seen because they finish quickly before the next <nop>Integration.GridCat update occurs. Clicking the retangular bar in the Jobs column in the <nop>Integration.GridCat shows you more detailed job information.
The disk information ( again is updated every 30 minutes or longer ) displayed in Integration.GridCat is only for $data directory. A more detailed view can be displayed by clicking the retangular bar in the Disks column in the Integration.GridCat. 
The disk information (updated every 30 minutes or longer) displayed in <nop>Integration.GridCat is only for the =$data= directory. Clicking the retangular bar in the Disks column in the <nop>Integration.GridCat shows you a more detailed view. 
Facility name in GridCat is logically chosen during GridCat instantiation.
The convention is to take the TOP LEVEL domain (TLD) name:
For example, ufloridaigt.phys.ufl.edu has the TLD, UFL.EDU,
so, .EDU is remove to name it as the ufloridaigt's facility name.
Sitename is determined by the site admin during installation (See OSG-ITB installation quick guide above) . It is a desriptive short name for a collection of services within the site.
Facility is meant to be an administrative domain which is managed/operated by a number of site admins in the site. In other words, the facilities name is what describes the local administrative domain. For example at UF we have two clusters on grid3. One is the production cluster dedicated to CMS the is a production cluster for everyone. The policies implemented on each batch system differs in terms of what percetage CMS gets when compared to others. Our facility name describes the admin group here at UF HEP. 
So, in gridcat, "Facility" is a level above "Site", but all displays in GridCat is arranged using the concept of "Site".
Facility name in Integration.GridCat is logically chosen during Integration.GridCat instantiation. The convention is to take the TOP LEVEL domain (TLD) name. For example, ufloridaigt.phys.ufl.edu has the TLD, UFL.EDU, so, .EDU is remove to name it as the ufloridaigt's facility name.
CPUs are a fixed number of CPUs which the site is presumably providing. This number is taken from batch system information and this number is populated initially using this information. However, this number
can be mostly accurately provide by the site admin only. BNL site is such an example.
Facility is meant to be an administrative domain which is managed/operated by a number of site admins in the site. In other words, the facilities name is what describes the local administrative domain. For example at UF we have two clusters on grid3. One is the production cluster dedicated to CMS the is a production cluster for everyone. The policies implemented on each batch system differs in terms of what percetage CMS gets when compared to others. Our facility name describes the admin group here at UF HEP.  So, in gridcat, "Facility" is a level above "Site", but all displays in Integration.GridCat is arranged using the concept of "Site".
"Facility" is meant to be an administrative domain which is managed/operated by a number of site admins in the site. The facilities name describes the local administrative domain. For example, at UF we have two clusters on OSG, a production cluster dedicated to CMS and a production cluster for everyone. The policies implemented on each batch system differs in terms of what percetage CMS gets when compared to others. Our facility name describes the admin group here at UF HEP.  So, in gridcat, "Facility" is a level above "Site" but displays in <nop>Integration.GridCat are arranged using the concept of "Site".
---++Interactively Updating GridCat
As a site admin, GridCat information may be updated interactively. Site name, Facility name, and CPUs are three fields that can be updated by site admins.
Also a site status test can be performed as the site admin. 
These interactive site admin role can be activated by sending an email to GridCat operator or adding
a line in the following format:<br/>
SITE_CONTACT_CERT_DN="/O=Anywhere/Blah=Blah/CN=Your Name 3049493203"<br/>
to the monitoring configuration file <b>$VDT_LOCATION/monitoring/grid3-info.conf</b>.
<pre>
</verbatim>
<a href ="https://goc.grid.iu.edu/">
Go register your
Storage Element with OSG</a>.  The Grid Operations Center will add it to !GridCat.
to the monitoring configuration file =$VDT_LOCATION/monitoring/grid3-info.conf=
The !GridCat tests for an SE vary depending on storage services advertised through
the SE information provider which could have a different hostname from the SE host itself. Typically, in- and out-bound file tranfer client command execution must be carried out successfully in order for a storage service to be functional. The client command execution commands include globus-url-copy or srmcp for gsiftp and srm protocol, respectively. At the moment, these two service protocols are supported by !GridCat. !GridCat performs only very simple in- and out-bound file tranfer tests.
[[https://goc.grid.iu.edu/][Go register your Storage Element with OSG]].  The Grid Operations Center will add it to !Integration.GridCat.
In order for an SE site to be cataloged to the OSG !GridCat instance, a few requirements must be met:
The !Integration.GridCat tests for an SE vary depending on storage services advertised through the SE information provider which could have a different hostname from the SE host itself. Typically, in- and out-bound file tranfer client command execution must be carried out successfully in order for a storage service to be functional. The client command execution commands include globus-url-copy or srmcp for gsiftp and srm protocol, respectively. At the moment, these two service protocols are supported by !Integration.GridCat. !Integration.GridCat performs only very simple in- and out-bound file tranfer tests.
   2. Information Provider protocol, hostname, and port number
   3. Information Provider query string 
In order for an SE site to be cataloged to the OSG <nop>Integration.GridCat instance, a few requirements must be met:
   1. Storage service hostname
   1. cmssrm.fnal.gov
   2. ldap://cmslcgce.fnal.gov:2170
   3. "mds-vo-name=USCMS-FNAL-WC1,o=grid"
Examples of SEs include: 
After these three fundamental parameters are provided to the Grid Operations Center via the resource
registration forms, they will be provided to !GridCat.
As the first SE test, !GridCat will try an ldapsearch query on which services are provided (gsiftp and/or SRM).
Then, !GridCat will construct the second test command string, e.g., 
   1. ="mds-vo-name=USCMS-FNAL-WC1,o=grid"=
After these three fundamental parameters are provided to the Grid Operations Center via the resource registration forms, they will be provided to !Integration.GridCat. As the first SE test, !Integration.GridCat will try an ldapsearch query on which services are provided (gsiftp and/or SRM). Then, !Integration.GridCat will construct the second test command string. For example, for an SRM inbound test: 
After these three fundamental parameters are provided to the Grid Operations Center via the resource registration forms, they will be provided to <nop>Integration.GridCat. As the first SE test, <nop>Integration.GridCat will try an ldapsearch query on which services are provided (gsiftp and/or SRM). Then, <nop>Integration.GridCat will construct the second test command string. 
For an SRM inbound test: 
<verbatim>
for an SRM inbound test;
srmcp -x509_user_proxy=/home/gridcat/.gridcat/mygridcat.proxy -retry_num=0 \
</verbatim>


For a gsiftp inbound test:
<verbatim>
for a gsiftp inbound test.
globus-url-copy \
file:////tmp/gridcat.ss.test.gridcat 
</verbatim>
If the LDAP query is successful and inbound and outbound tests pass for each service provided,
the !GridCat status will become green for the SE.

In order for !GridCat to parse srm access root directory, etc, the BDII or MDS must have been configured with GIP. In the above example, the GIP is configued using the BDII service. However, since MDS comes with the OSG CE which could act as the information provider for both CE and SE or MDS can be installed on the SE directly, it is convenient for the site admin to configure the GIP.

<hr/>
<FONT color='magenta'><B>What !GridCat expects for Glue attribute values ?</B></FONT>
If the LDAP query is successful and inbound and outbound tests pass for each service provided, the <nop>Integration.GridCat status will become green for the SE.
Since !GridCat obtains SE information from MDS with GIP which implements Glue schema, !GridCat interprets Glue schema in the following way:<br/>
------------------
---++++ What does !Integration.GridCat expect for Glue attribute values?
---++++ What does <nop>Integration.GridCat expect for Glue attribute values?
| !GlueSchemaVersionMajor | 1 | | 
For Glue 1.2
| !GlueSEName | MY_STROAGE_SITE_NAME | Sitename for !GridCat. Pick a descriptive human readable and a name that can be used for unix file name | 

| dataGridVersion | OSG-0_2_1 | !GridName-Version, Only for Glue 1.1|
| !GlueSchemaVersionMajor | 1 |  | 
| !GlueSEName | MY_STROAGE_SITE_NAME | Sitename for !Integration.GridCat. Pick a descriptive human readable and a name that can be used for unix file name | 
| !GlueSARoot | cms:/cms | Access root from various protocols in the form {VO}:{ACCESS_ROOT} so that test command : <br/>srmcp !file:////tmp/gridcat.ss.test.gridcat \ <br/> srm://srmcms.phys.ufl.edu:8443/cms/gridcat.ss.test.gridcat <br/> can be executed successfully for example | 
| !GlueSEUniqueID | srmcms.phys.ufl.edu | SE hostname | 
| dataGridVersion | OSG-0_2_1 | !GridName-Version, Only for Glue 1.1 |
| !GlueSEAccessProtocolType | srm | protocol, srm or gsiftp | 
| !GlueSEAccessProtocolPort | 8443 | port number | 
| !GlueSARoot | cms:/cms | Access root from various protocols in the form {VO}:{ACCESS_ROOT} so that test command : %BR%  =srmcp <nop>file:////tmp/gridcat.ss.test.gridcat srm://srmcms.phys.ufl.edu:8443/cms/gridcat.ss.test.gridcat= %BR%  can be executed successfully for example | 
| !GlueSAAccessControlBaseRule | cms | accessible VO name  | 
| !GlueSAStateAvailableSpace | 1 | dynamic available space  | 
To check if GIP configuration for SE, this script
<a href='http://gdsuf.phys.ufl.edu:8080/releases/gridcat/gridcat-verify-ss-info.sh.txt'>gridcat-verify-ss-info.sh</a> can be used. The script reads in the number of Protocols, !GlueSEUniqeID, and VO from an ldapsearch (
ldapsearch -x -l 30 -b mds-vo-name=local,o=grid -h <<ldap_host_for_SE>> -p <<ldap_port_for_SE>>
) and then it compares these are aligned well with
each other. If everything is as expected, the script will
say 'Looks ok' and print a summary.
| !GlueSAPolicyFileLifeTime | Permanent | file type  | 
For example, if the script detected the following, publisching will work well with !GridCat.

To check if GIP configuration for SE, this script [[http://gdsuf.phys.ufl.edu:8080/releases/gridcat/gridcat-verify-ss-info.sh.txt][gridcat-verify-ss-info.sh]] can be used. The script reads in the number of Protocols, !GlueSEUniqeID, and VO from an ldapsearch (=ldapsearch -x -l 30 -b mds-vo-name=local,o=grid -h <<ldap_host_for_SE>> -p <<ldap_port_for_SE>>=) and then it compares these are aligned well with each other. If everything is as expected, the script will say 'Looks ok' and print a summary.
Use the =[[http://gdsuf.phys.ufl.edu:8080/releases/gridcat/gridcat-verify-ss-info.sh.txt][gridcat-verify-ss-info.sh]]= script to check for GIP configuration for SE. The script reads in the number of Protocols, !GlueSEUniqeID, and VO from an ldapsearch (<tt>ldapsearch -x -l 30 -b mds-vo-name=local,o=grid -h <<ldap_host_for_SE>> -p <<ldap_port_for_SE>></tt>) and then it compares these are aligned well with each other. If everything is as expected, the script will say 'Looks ok' and print a summary.
For example, if the script detected the following, publisching will work well with !Integration.GridCat.

<pre>
If the script detected the following two examples, publisching will not work with !GridCat.<br/>
Example 1 that will not work:
If the script detected the following two examples, publishing will not work with !Integration.GridCat.
If the script detected the following two examples, publishing will not work with <nop>Integration.GridCat.
The following example will not work because it uses same hostname for srm and gsiftp.:
The following example will not work because it uses same hostname for srm and gsiftp:

because it uses same hostname for srm and gsiftp.
<pre>
Example 2 that will not work:
number_of_vos="20 10"
</pre>

The following example will not work because there are two protocols, but number of hosts is 1:
The following example will not work because there are two protocols yet the number of hosts is 1:
because there are two protocols, but number of hosts is 1.
<pre>
---++Contacting GridCat
protocols="srm gsiftp"
Phone : (352)392-1791<br/>
Email : [[bockjoo at phys dot ufl dot edu]]<br/>
OSG-ITB GridCat DN : /DC=org/DC=doegrids/OU=People/CN=OSG-ITB !GridCat
number_of_vos="20 10"
| *OSG-ITB <nop>Integration.GridCat DN* | <tt>/DC=org/DC=doegrids/OU=People/CN=OSG-ITB <nop>Integration.GridCat</tt> |

%INCLUDE{ "Integration.WhuReferences" }%
*Major updates*:%BR%
<!--Future editors should add their signatures beneath yours!-->
-- Main.RobGardner - 09 Mar 2005
<br/>
-- Main.BockjooKim - 10 Feb 2006
%STOPINCLUDE%
---++!! Major updates
-- Main.RobGardner - 09 Mar 2005   %BR%  
-- Main.RobQ - 01 May 2006<br>
-- Main.MarciaTeckenbrock - 12 Sep 2006

-- Main.RobQ - 01 May 2006   %BR%  
-- Main.MarciaTeckenbrock - 12 Sep 2006   %BR%  


%META:TOPICMOVED{by="ForrestChristian" date="1166049447" from="Integration.GridCat050" to="Integration/ITB_0_5.GridCat"}%
