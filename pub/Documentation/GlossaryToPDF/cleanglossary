# This awk script with "clean up" the OSG TWiki Glossary html file 
if [ $# -ne 2 ]
then
echo "Usage: cleanglossary glossaryofterms.html CleanGlossary.html"
exit
fi

awk '
# Remove <base> so internal references will be internal
/^<base/ { next; }

# Remove EDITTHIS buttons
/EDITTHIS/ { next; }

# Remove forms (that implement the letter indexes)
/<form/,/<\/form>/ { next; }
/<span style/ { next; }

# Remove the Comment Boxes
/commentPlugin/ { next; }

# Remove Bottom of Page links
/JamesWeichel/ { next; }
/This topic: Documentation/,/problems regarding this page/ { next; }
/patternBottomBar/ { next; }
/GlossaryToPDF/ { next; }

# Make internal page links internal (not refering to TWiki)
/href=.\/bin\/view\/Documentation\/GlossaryOfTerms#/ {
    n = gsub("\/bin\/view\/Documentation\/GlossaryOfTerms#", "#", $0);
}

# Make references to other TWiki pages a true external reference
/href="\/bin/ {
    n = gsub("\/bin", "https://twiki.grid.iu.edu/bin", $0);
}

# Modify Title
/Glossary of Terms/ { 
    n = gsub("Glossary of", "OSG Glossary of", $0);
}

# Style the h2 (Letter) headers
/<\/head>/ {
 print "<style type=\"text/css\">";
 print "h2 {";
 print " background-color:orange;";
 print " border-bottom-style:solid;";
 print "}";
 print "</style>";
}

# This merely copies the content lines
{ print; }
' $1 >$2
