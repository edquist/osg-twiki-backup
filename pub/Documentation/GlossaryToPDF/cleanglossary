# This awk script with "clean up" the OSG TWiki Glossary html file 
if [ $# -ne 2 ]
then
echo "Usage: cleanglossary glossaryofterms.html CleanGlossary.html"
exit
fi

awk '

# Remove <base> so internal references will be internal
/<base/ { next; }

# Remove EDITTHIS buttons
/EDITTHIS/ { next; }

# Remove forms (that implement the letter indexes)
/<form/,/<\/form>/ { next; }
/<span style/ { next; }

# Remove the Comment Boxes
/commentPlugin/ { ignoreblock = 1; next; }

# Remove footer links
/This topic: Documentation/ { next; }
/Topic revision:/ { next; }
/myosg.grid.iu.edu/,/<\/font>/ { next; }
/patternBottomBar/ { next; }
/<script/,/<\/script>/ { next; }
/<style/,/<\/style>/ { next; }
/import url/ { next; }
/GlossaryToPDF/ { next; }

# Make internal page links internal (not refering to TWiki)
/href=.\/bin\/view\/Documentation\/Glossary.*#/ {
    n = sub("\/bin\/view\/Documentation\/Glossary.*#", "#", $0);
}

# Make references to other TWiki pages a true external reference
/href="\/bin/ {
    n = sub("\/bin", "https://twiki.grid.iu.edu/bin", $0);
}

# Modify Title
/Glossary of Terms/ { 
    n = sub("Glossary of", "OSG Glossary of", $0);
}

# Style the h2 (Letter) headers
/<\/head>/ {
 print "<style type=\"text/css\">";
 print "h2 {";
 print " background-color:orange;";
 print " border-bottom-style:solid;";
 print "}";
 print "</style>";
}

# This meerly copies the content lines
{ print; }
' $1 >$2
